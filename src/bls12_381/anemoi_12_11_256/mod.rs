use super::{sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 2 elements (96-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 13 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 13;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= y[i].square().double());

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t += y[i].square().double() + sbox::DELTA);

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];
    state[0] = x[0] + x[1] + x[2] + x[4] + (x[2] + x[5] + (x[3] + x[4] + x[5]).double()).double();
    state[1] = x[1] + x[2] + x[3] + x[5] + (x[3] + x[0] + (x[4] + x[5] + x[0]).double()).double();
    state[2] = x[2] + x[3] + x[4] + x[0] + (x[4] + x[1] + (x[5] + x[0] + x[1]).double()).double();
    state[3] = x[3] + x[4] + x[5] + x[1] + (x[5] + x[2] + (x[0] + x[1] + x[2]).double()).double();
    state[4] = x[4] + x[5] + x[0] + x[2] + (x[0] + x[3] + (x[1] + x[2] + x[3]).double()).double();
    state[5] = x[5] + x[0] + x[1] + x[3] + (x[1] + x[4] + (x[2] + x[3] + x[4]).double()).double();

    state[6] = y[0] + y[1] + y[2] + y[4] + (y[2] + y[5] + (y[3] + y[4] + y[5]).double()).double();
    state[7] = y[1] + y[2] + y[3] + y[5] + (y[3] + y[0] + (y[4] + y[5] + y[0]).double()).double();
    state[8] = y[2] + y[3] + y[4] + y[0] + (y[4] + y[1] + (y[5] + y[0] + y[1]).double()).double();
    state[9] = y[3] + y[4] + y[5] + y[1] + (y[5] + y[2] + (y[0] + y[1] + y[2]).double()).double();
    state[10] = y[4] + y[5] + y[0] + y[2] + (y[0] + y[3] + (y[1] + y[2] + y[3]).double()).double();
    state[11] = y[5] + y[0] + y[1] + y[3] + (y[1] + y[4] + (y[2] + y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x0006b602422d0294,
                    0x37bf34b72c7fd3b5,
                    0xbc9f7605861fffd4,
                    0xfb9d04fbf5a85153,
                    0x7c2081ab19c551df,
                    0x0d0af4b763dca0f5,
                ])),
                Felt::new(BigInteger384([
                    0x700c8d01b0bac502,
                    0x5398281f76661e07,
                    0x89ed2d86883a25e6,
                    0xba7d600bf9ae7c84,
                    0xcf426baed03b9f7b,
                    0x13d722c4f714434d,
                ])),
                Felt::new(BigInteger384([
                    0xdf344a7eacb34962,
                    0x273d1ca364d43e2c,
                    0x10c49a3504e1e7ac,
                    0xa13c4089d8f7e921,
                    0x1f32515335884dc9,
                    0x17a09fbafcb62562,
                ])),
                Felt::new(BigInteger384([
                    0x9dfcc2232cfc1c3d,
                    0x9bff61202532d743,
                    0x10596c0c5c29a23d,
                    0x9a44298eb0626bcb,
                    0xd5f041bf0b83958d,
                    0x0cebd051140aa8a6,
                ])),
                Felt::new(BigInteger384([
                    0x023b0729f81d6232,
                    0x40f4141c355a617a,
                    0x337e1e07545435dd,
                    0xd5b84fdc834d99a7,
                    0x871936e096c865c5,
                    0x14450c0642301b1a,
                ])),
                Felt::new(BigInteger384([
                    0xc0613eddcf86e099,
                    0x327edcb0b4898011,
                    0x6cf3f7ceb9c3d359,
                    0x3a62e741f35f0dc4,
                    0x2da8c3e8c0e0edb4,
                    0x146d1e2e5af419f1,
                ])),
                Felt::new(BigInteger384([
                    0x03f4376abc56f848,
                    0xf49a19af3450cba2,
                    0xbb752292175b45e9,
                    0xac42217adb4b17a1,
                    0x0df925c9a1d416e1,
                    0x0b56ba6a6ba3d509,
                ])),
                Felt::new(BigInteger384([
                    0x262bc4781c2004be,
                    0xc9d66847798f3f62,
                    0x65e6ea236dffd8ac,
                    0x41acd34014ff51eb,
                    0x004e7af34f806687,
                    0x0bbe7631e83153cf,
                ])),
                Felt::new(BigInteger384([
                    0x16dc46bef8ff473b,
                    0x7dab8b9f18afd9c5,
                    0x2fdfd33622be8fb4,
                    0x6392fcd711897415,
                    0x0107dc591c6b34a9,
                    0x0153dfef06da64c2,
                ])),
                Felt::new(BigInteger384([
                    0xbc7ea60f64542de6,
                    0x34ab551ac288782d,
                    0x3c993c3b81d0c024,
                    0x0f0fb23dd702acd1,
                    0x17b50cdd3fcfb088,
                    0x17ce948648d3012f,
                ])),
                Felt::new(BigInteger384([
                    0x53f339d1d05173ea,
                    0x690d72f2d8fc90ec,
                    0x7369f848a6af669f,
                    0xa723ac55555f85fd,
                    0x21629e5397b00d1a,
                    0x10a8ecd1a6dc3976,
                ])),
                Felt::new(BigInteger384([
                    0x2672d16e45fa345d,
                    0x3b1f03137d91f52e,
                    0xf1de8fc28825da0e,
                    0x308b90eabf2555ba,
                    0x067baa35bbb5a382,
                    0x064d6d7911f2908f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xd8b474b74c441bc9,
                    0x9dbc2a89ff6ff5c8,
                    0xfc0952b0241f4b1f,
                    0x70e672d2dbdf581b,
                    0x16e96c1c2bfcadea,
                    0x125b73011ed820fa,
                ])),
                Felt::new(BigInteger384([
                    0x41d85c5341e31559,
                    0x52ea7e75486d9e35,
                    0x2e4558bda1de1207,
                    0x2591d52d81bdf35a,
                    0x8eaaa3572b7d8796,
                    0x14acef45202b0cdd,
                ])),
                Felt::new(BigInteger384([
                    0xea61625c5e00242b,
                    0x5de91dc9f87604c8,
                    0x82eb9b20206b4fdf,
                    0x295a0db37a50e534,
                    0xacc789268b2f3d31,
                    0x0ddf2723b403cbcb,
                ])),
                Felt::new(BigInteger384([
                    0x373f28f81b707432,
                    0x68f873ea7a52b295,
                    0x85d9cb31e6ac983d,
                    0x91d39c607bcdb397,
                    0xaebb094629bb9b0b,
                    0x163c640111906b3f,
                ])),
                Felt::new(BigInteger384([
                    0xfe1fc1fc1da5a085,
                    0xc22313ccce4e66df,
                    0x02c66779bf2ac917,
                    0x33708ec94bd56454,
                    0x2d3f33a66bca8a5c,
                    0x19137c65797f157f,
                ])),
                Felt::new(BigInteger384([
                    0x14903a4b8b509ecf,
                    0xe3938ddd09b5bf98,
                    0x67f1539442dd0705,
                    0xbb98823e05e5d810,
                    0x6c447301cff96418,
                    0x18ea8fbecace306d,
                ])),
                Felt::new(BigInteger384([
                    0x7d75713e22873a6a,
                    0xe0df386e65f2a78c,
                    0x2467c4afbb4aecb7,
                    0xcc765c4f06f51a7e,
                    0x7dc7c938baa59307,
                    0x18ea9c6b7dc86591,
                ])),
                Felt::new(BigInteger384([
                    0x5f5804d64a1e67d4,
                    0xe9abb985512e501b,
                    0xc9ecca400c246fdf,
                    0xa883a2da2ab5067e,
                    0x435551593d9dd56e,
                    0x0cf65db0ef844625,
                ])),
                Felt::new(BigInteger384([
                    0xfb9f55dfa9e2c6bc,
                    0xa7e7cd5cd3847948,
                    0xaa232a331719d1f6,
                    0x361e334bdee0196f,
                    0xf3dea16603169c46,
                    0x125c7645b371089b,
                ])),
                Felt::new(BigInteger384([
                    0x86f8ce1a3bbef39c,
                    0xb35fff8981a9122d,
                    0xe3e2109da6e78669,
                    0x6e1d4fda8e234671,
                    0x1bd7ed0817fb57ca,
                    0x0246768c5a826abe,
                ])),
                Felt::new(BigInteger384([
                    0x2963f543fdf2a5d2,
                    0x80738a3db9928f48,
                    0x9d7ae94184d48eb2,
                    0x2771be8be2b8362f,
                    0xb93516e65e8fcc0b,
                    0x0f372fa3c4ea04c3,
                ])),
                Felt::new(BigInteger384([
                    0x77d630831cd2223e,
                    0x2c36936f98f0a523,
                    0x7a0a5cad3821c81b,
                    0x0921cd44184a5a83,
                    0xd1067dd334958b0a,
                    0x03a53abc9fc7d732,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb42e72ac4f2d5472,
                    0x075ff2898bff9b0e,
                    0xed2bf57f91ca7ef2,
                    0xd18d73b639905ccd,
                    0x7e2cd6f5c7eb56ef,
                    0x18a0f007a2936c34,
                ])),
                Felt::new(BigInteger384([
                    0xd9e0c24cd18ab45c,
                    0xf6435341714b23b2,
                    0x4555de3f1e7ef4be,
                    0x7b174bd288b07782,
                    0xf8b2bfb05624087c,
                    0x09498a904358d829,
                ])),
                Felt::new(BigInteger384([
                    0x808fede87ef17afa,
                    0x6bfd597d86490ceb,
                    0xa63aa33e00258512,
                    0x19544b4155c166d5,
                    0x626c4ec81b11f668,
                    0x08a2774a618a60e1,
                ])),
                Felt::new(BigInteger384([
                    0x57be09d67601562e,
                    0x46619662d58d2125,
                    0x8530806cf1680efe,
                    0xaee8025a85b62f8c,
                    0xb04253730cc15b41,
                    0x0dc8d8708885e52f,
                ])),
                Felt::new(BigInteger384([
                    0x04f80e94e2b4eab9,
                    0x55f76d4c38d1e152,
                    0xc5ea0c8fb221bf93,
                    0xbe203326ad2c251b,
                    0x721698b6936bb20a,
                    0x16a904b53f4f4342,
                ])),
                Felt::new(BigInteger384([
                    0xbbf83e3016b1921d,
                    0xfe63d2f111d13d7d,
                    0xdb8d86bbd6aaf68d,
                    0x0b5003ea15717951,
                    0x8bc05e60d05d3a50,
                    0x0e14594528809afc,
                ])),
                Felt::new(BigInteger384([
                    0xd2a1821be5334d79,
                    0x23219ef70012f9bc,
                    0x44b63578f62b2d08,
                    0xc2e08d4ca4671b10,
                    0x7979859bbe6e4890,
                    0x18f7dbced19e0003,
                ])),
                Felt::new(BigInteger384([
                    0xcbc3e29a91432673,
                    0x532c16358d807556,
                    0xf5dc04118e6f9cb2,
                    0xb9c3c77e94cfda74,
                    0x2a3eb66f8e5743f8,
                    0x17fac0411099662f,
                ])),
                Felt::new(BigInteger384([
                    0xa68d9306e0e0d5fa,
                    0x0ed36be3fe88dc3a,
                    0xb068c090c18a7f6c,
                    0xc4a5303a69a0310d,
                    0xa926cadcd44745ae,
                    0x17567d1957f4f9d8,
                ])),
                Felt::new(BigInteger384([
                    0xf189151ea5b949fb,
                    0x0ffb83006c06def6,
                    0x6bee4544ca653cf5,
                    0x92e9a571ea5749ef,
                    0x5c46773a3af1304c,
                    0x0e5a3df299640c9d,
                ])),
                Felt::new(BigInteger384([
                    0xfd3061d935e2bce9,
                    0x79e211385ee17a25,
                    0x55d96fe1654894bd,
                    0xf53412721db8cbd9,
                    0xcb45deccd9bdcf2a,
                    0x1529fd2d2a7d8278,
                ])),
                Felt::new(BigInteger384([
                    0xddab8933843f7929,
                    0xb5278bf5a62f7dac,
                    0x1f07d458e22c1c80,
                    0x01e41f582c24ef21,
                    0x27240511098dbde4,
                    0x09f87c649d719f9b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x55094e9b39cfcb7c,
                    0xd6c28813a2b72ae1,
                    0x10002e769fb2beb6,
                    0x3c4d8793c89d0325,
                    0x591c08fa7af4f7a8,
                    0x00d689d83898845c,
                ])),
                Felt::new(BigInteger384([
                    0xba3c7b68c314cea6,
                    0xb613ccc50bc6c603,
                    0x4d05d02d14dcb845,
                    0x0b3af929d62a9a3e,
                    0xe083147472184294,
                    0x1497cde44b6abb35,
                ])),
                Felt::new(BigInteger384([
                    0x91a7363b229585ec,
                    0x8414dd4ae7f157de,
                    0x510c13a8b02b6ac2,
                    0xb54516366cadfc61,
                    0x34e2448894e5ba2e,
                    0x051291341629354f,
                ])),
                Felt::new(BigInteger384([
                    0x55e6391297def57e,
                    0x50605b7f6784485f,
                    0x654d32d4a15d67c0,
                    0xcc1b67cda54ce9a8,
                    0x5e9f5aaec808c4a9,
                    0x0e13ce0449b29911,
                ])),
                Felt::new(BigInteger384([
                    0xb7da354304363a7d,
                    0x839bdbb31fdaf958,
                    0xafa849a10a778d03,
                    0x22291a6a90ab9b66,
                    0xeb915e28cd67dae8,
                    0x19d77242d8babff9,
                ])),
                Felt::new(BigInteger384([
                    0x8bf9de37383412ba,
                    0xf596be104e9d4568,
                    0xb08f4643ca9462cc,
                    0xee3cde06fcbf63cb,
                    0xf02607ace0676a0c,
                    0x0be58c436bf04a0e,
                ])),
                Felt::new(BigInteger384([
                    0x93211fab9370dc0f,
                    0x3c0abc577c15755a,
                    0xf9ea7cf4d3c9b76d,
                    0x9b4a6e6aa8552361,
                    0x467f73a720ca307a,
                    0x1307a1d5b2f763ef,
                ])),
                Felt::new(BigInteger384([
                    0xce9ea17ff573c235,
                    0xd2fc836168f19b4e,
                    0xd0036f9ec37b1212,
                    0x7478ded1434318ef,
                    0x28d761f7d7b6726d,
                    0x09cf58f2fde5d9d2,
                ])),
                Felt::new(BigInteger384([
                    0xd45022ce19d4a4de,
                    0x2cdc9643787a62f0,
                    0x79985548ba74e2eb,
                    0x4218a7dd38d42b88,
                    0x714dcc1c926bee57,
                    0x0d1eef0e484481ca,
                ])),
                Felt::new(BigInteger384([
                    0xb69271c862080917,
                    0xc63474aba22fef81,
                    0xe954499d1cc99c45,
                    0xf31ed68cb27f6d03,
                    0xfabcc2e5705befb2,
                    0x151b3f29f0ebc0e0,
                ])),
                Felt::new(BigInteger384([
                    0xc437d3a52368799e,
                    0xfb23d94d10d7a37d,
                    0xfc3ca93e3712ac57,
                    0x738fd923d9b7fd82,
                    0x95bdbb36d4b4c9e2,
                    0x0ea4fadd5b42d1fc,
                ])),
                Felt::new(BigInteger384([
                    0x0883153e9c8b2d99,
                    0xe437cef0a172bc7c,
                    0xa0abf2fea571ab85,
                    0x28c49df5946162bd,
                    0x37bf2a4ab9c9f2ad,
                    0x02e54f311668ef04,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x9633a7321cced319,
                    0x7459b45e15592df7,
                    0x03ab1cf5f0840ec1,
                    0x2b3df708b229efa5,
                    0x42a9ff2183210e91,
                    0x04e816f95ff3a381,
                ])),
                Felt::new(BigInteger384([
                    0xddc9a623fa213778,
                    0x51b96ac36e7e56a5,
                    0x6f94c4d798ba4ded,
                    0xc3d2abe700346b76,
                    0xf6a6ce2993784e14,
                    0x0ec612857b493146,
                ])),
                Felt::new(BigInteger384([
                    0x15a4a479ff953ebe,
                    0xc4b20e139ad252f1,
                    0x955c0e75b2c546fc,
                    0x9656b43839c07cb7,
                    0xebf0f2adb09bc8f0,
                    0x0bc67a413677637a,
                ])),
                Felt::new(BigInteger384([
                    0xece7ebd2d6070da2,
                    0xce8bbc5d07346b14,
                    0x35395509a31220a1,
                    0x4d62de5ee81de04c,
                    0x275db0cbd5bf38f5,
                    0x1577cfd42e310484,
                ])),
                Felt::new(BigInteger384([
                    0x5b03c7bf586fdf00,
                    0x648a1214fdfe3d7b,
                    0x711ce81c92ce886b,
                    0xe3aaac86b7ea8f96,
                    0xa9ebd2ee987f7e24,
                    0x062194d29f0b1913,
                ])),
                Felt::new(BigInteger384([
                    0xaf5cee622fa4a4e4,
                    0xf34d1c6be1b14a38,
                    0x7a4bf3d8835ed6db,
                    0x3e8a2fd0139d9eb5,
                    0x0e7100933636a532,
                    0x0041b62a61f02aa5,
                ])),
                Felt::new(BigInteger384([
                    0x1cf9a45950c0743f,
                    0x50ec018f326ef2df,
                    0x58b5bfc317842d8a,
                    0x50816be1c13884bf,
                    0x2bd0d27461a891c9,
                    0x01a0313e3f423d55,
                ])),
                Felt::new(BigInteger384([
                    0xf9bebf57f7ec9228,
                    0x7aa5b6b19c26b10f,
                    0x8bc63d09b44eccb7,
                    0x89758b3d103db0dd,
                    0x731c222e875f4319,
                    0x0fa5d57874e32ffa,
                ])),
                Felt::new(BigInteger384([
                    0x905438caaa0ef7d3,
                    0x4154b5ec652a3c1b,
                    0xf9966e3b2f28d9aa,
                    0xf252a0bda2ee8185,
                    0xde505be12d9ffb75,
                    0x1061fe7effe3688d,
                ])),
                Felt::new(BigInteger384([
                    0x54efdb120d3876b8,
                    0x5920511e6fe0e53b,
                    0x5abcf1155935940e,
                    0x8fb2f3ce73abe212,
                    0x8829384f9f83d95f,
                    0x139e60411e5ffa6a,
                ])),
                Felt::new(BigInteger384([
                    0x02ca8fce6047ef9c,
                    0x171fd8f61c035f2e,
                    0xaa2be3ce947eaa14,
                    0xba87429686d669b8,
                    0xd82fef44724ab078,
                    0x0ab0f5193c7bd428,
                ])),
                Felt::new(BigInteger384([
                    0xd9b0a154fdf2f1a3,
                    0x7490e1a10d466d47,
                    0xb4e1b30182e0ecce,
                    0x1bb8af2f1ee74c15,
                    0xa524b302fe664e91,
                    0x0bab3267528286af,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdd4c5fa7baa52d45,
                    0x2e463d58d6375901,
                    0xd2e3c53dcb56aa6c,
                    0x180a5a20e102b15b,
                    0xf4cf48c87b2c0117,
                    0x009cc27e91670246,
                ])),
                Felt::new(BigInteger384([
                    0x61feff21e64957c1,
                    0xa9dc3d33c7c35080,
                    0x263b2453f2d6408a,
                    0x5b898d6edb36a470,
                    0x1f22d85b61fdb1f4,
                    0x054da36a591b5c65,
                ])),
                Felt::new(BigInteger384([
                    0x3a53de2584f5b1fc,
                    0xaa050dbef56c4eb2,
                    0x0d832dcb306f7431,
                    0x9a36fe81d3bc21d2,
                    0x38559d39521bce00,
                    0x0d45c7887069342e,
                ])),
                Felt::new(BigInteger384([
                    0xbc48f3ea5d71b27b,
                    0xcc29eb209cdf91e5,
                    0x4e0c944a8774cda4,
                    0x2f5d926c4fce85bc,
                    0x676726f3bda04e90,
                    0x15789332e88e2390,
                ])),
                Felt::new(BigInteger384([
                    0x008e904cf259676f,
                    0xb2fe2a5a3a37af04,
                    0x89d3918a3a95fc58,
                    0x22033215e60923ee,
                    0xa1b69b0c98c74dd7,
                    0x10d4b967b97fa44b,
                ])),
                Felt::new(BigInteger384([
                    0xfa04772fc744167a,
                    0xcc7b9addab63aa2d,
                    0x3e831e8c094f3fda,
                    0x9acc5547f18f5e19,
                    0x4ec161058e7c1eb8,
                    0x08b3dae100ad5989,
                ])),
                Felt::new(BigInteger384([
                    0x4deb1f8c61bab72d,
                    0x88a14508d48a63fb,
                    0x2eaecd143ed31136,
                    0xcb2eca79d3a07750,
                    0xf4ee66007667c2ed,
                    0x010ae88ecd7a638a,
                ])),
                Felt::new(BigInteger384([
                    0x61d525c174106c14,
                    0xe478c153dba68334,
                    0xae1df6822766f7f5,
                    0x8b04c098b885c5ab,
                    0x99119e4f723c30bb,
                    0x12b1aa84ca240543,
                ])),
                Felt::new(BigInteger384([
                    0x6d77ea5a77a743ea,
                    0xbf98f0f97d92515c,
                    0x276d7a6c87d076d9,
                    0x4c55fecc2bca79bb,
                    0xbfaa286bf7be01c2,
                    0x19837f72b0afcb1d,
                ])),
                Felt::new(BigInteger384([
                    0x12be8c1d3770c0f0,
                    0xb85fc79c45bdf998,
                    0x340eaea010c82800,
                    0xd8f87cc3d7b885a9,
                    0x4683fbca200a4354,
                    0x063207e10b7c83e4,
                ])),
                Felt::new(BigInteger384([
                    0x488a29e2744cbb17,
                    0xbc456608b303a7cc,
                    0x8f89b3945be856a8,
                    0x7bb3554d350289f5,
                    0x5df90d61e2e5a3be,
                    0x0cd7126963e7ce34,
                ])),
                Felt::new(BigInteger384([
                    0xcffbd80e3ef5b42e,
                    0x602333dfc654792d,
                    0x92313bc8067acb27,
                    0xd62a2bdb49477b01,
                    0x74e72b6586f88532,
                    0x1232ad36e4cebdb5,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xba5092fc4be898d6,
                    0x177f00842e2bdcf2,
                    0x1cd4a9dd085ebf8e,
                    0x1fe15afe843f769b,
                    0xabbaf714f7846f5f,
                    0x12d290bece8d6e8a,
                ])),
                Felt::new(BigInteger384([
                    0x5843e1bc7b6d5a4a,
                    0x752f11d0c30d584d,
                    0x1790dc907ca8960a,
                    0x31a1f1acdcf98f89,
                    0x17d0e37f397d94c9,
                    0x0aa8fcb5945afbee,
                ])),
                Felt::new(BigInteger384([
                    0x3f28dff592685f14,
                    0x85ae7f91ad288bf7,
                    0x2febd5265e9d449a,
                    0xac3c343d1273dcbb,
                    0xd0de7b1f957a42f7,
                    0x0a15be6b177faa2a,
                ])),
                Felt::new(BigInteger384([
                    0xef2d2caa969ed1d8,
                    0x47989336b7d059ae,
                    0x6c5b083c88cd62df,
                    0xc1b2b8be0f745839,
                    0x0be42d4667ec3239,
                    0x0c618159def6fa26,
                ])),
                Felt::new(BigInteger384([
                    0x14d8a6b99ba0eb25,
                    0xd71f61160b989de4,
                    0xd8579066b4bb198d,
                    0x7f57b829f5fdd9a6,
                    0x48dea873dacbc1c2,
                    0x14113ecface980d6,
                ])),
                Felt::new(BigInteger384([
                    0xc8865c841c276100,
                    0x09f770ccecd5459b,
                    0xadf0fbf0d600bfa0,
                    0x412fce9d2f4896dc,
                    0xaa139debce5ae504,
                    0x07beb1bbec2ffdde,
                ])),
                Felt::new(BigInteger384([
                    0x644596a32839f49c,
                    0x7f782b966b1ae3b9,
                    0xdb6796c783f1a0e2,
                    0x91f7482f213801dd,
                    0x784809f351f9194b,
                    0x0f71a77174e7fd89,
                ])),
                Felt::new(BigInteger384([
                    0x3c89db3932155d7d,
                    0xe68d3fb72d2f3f67,
                    0xaf8a504621a0937d,
                    0xd05879de7f628399,
                    0x2e25cc1ca9aff434,
                    0x0cfb32023a56b5ec,
                ])),
                Felt::new(BigInteger384([
                    0x0b8ab1df79da874b,
                    0x91f4bed252a0514f,
                    0x636d9e6e9f0b00ed,
                    0x59518c3895d352e0,
                    0x56847e8869b4b899,
                    0x01019fb8e3271f2e,
                ])),
                Felt::new(BigInteger384([
                    0xad53c7b7c8ca41ed,
                    0xba0f6eace3f0a20f,
                    0x3451c74778e34d2e,
                    0x1bda7fe31f05498b,
                    0xf4900ca8aa3f53a2,
                    0x01aacdbe093b2eb5,
                ])),
                Felt::new(BigInteger384([
                    0x9fa95ab05f1766c3,
                    0xf5cfcdc912440b51,
                    0x272bd200d6471950,
                    0xfab44c61eb4c2259,
                    0x13d47dd5e0a9f48c,
                    0x1805cbd6387ac331,
                ])),
                Felt::new(BigInteger384([
                    0x035d37566857def5,
                    0x6639609a6b357f78,
                    0xa6701758631f563a,
                    0x9642bdaccff0bb2a,
                    0xbdca29b4cd5b329f,
                    0x032878e7cd384098,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7a09459d5afc36ce,
                    0x8a37befbbf97184f,
                    0x483c542428aa361c,
                    0x08adbae78b37e826,
                    0xd10feef0bccfa989,
                    0x14ca82d26a9df101,
                ])),
                Felt::new(BigInteger384([
                    0x1630bc56bbf1a8c9,
                    0x6e18fe6b2b02b08b,
                    0x8982262b28705aa9,
                    0x666503bfb94b8033,
                    0xf7f61b6ab16c4a3e,
                    0x14e53afd482d05ff,
                ])),
                Felt::new(BigInteger384([
                    0x53a88d79334b6283,
                    0x661c39e4dc21e382,
                    0x8f966dd94ef3d343,
                    0x84c98c8c14396795,
                    0xfd38c071d12d87f9,
                    0x032539f23e061890,
                ])),
                Felt::new(BigInteger384([
                    0x5404cc0cf88fd9b0,
                    0x9e59a010b8f94c72,
                    0x8166821f693ff759,
                    0xe8e9d9d979e08bdb,
                    0xf2fd1449767ad07a,
                    0x09b39b31f42a6778,
                ])),
                Felt::new(BigInteger384([
                    0xbcef956a49b3070d,
                    0x11bd5f94ef75ac2f,
                    0x95cf6faa93900205,
                    0x7fd4ca0c44fcdc46,
                    0x81b650d78800a29f,
                    0x195ddbc0d2e848b6,
                ])),
                Felt::new(BigInteger384([
                    0x5813174c999a42af,
                    0x6c36fb4f3964d22b,
                    0x4abd30bee12b150a,
                    0x1f24645b899dae6d,
                    0xf29633e767aae1be,
                    0x07e4e0848dc506c6,
                ])),
                Felt::new(BigInteger384([
                    0x062dca105f9d616d,
                    0x4e003bda79d10935,
                    0x9b911f3e080ef805,
                    0x66442a5c72c4c2ff,
                    0x292d7e766b1aadec,
                    0x18b2e08d56d4ee35,
                ])),
                Felt::new(BigInteger384([
                    0x23a83afd71bf5846,
                    0x1da5567bf5cfdfd7,
                    0x53d1aaac2d240e3a,
                    0x80dce0919f116e34,
                    0x0b3fa885df51ee3d,
                    0x08ca90851ef715cb,
                ])),
                Felt::new(BigInteger384([
                    0xb60f6002f91f99ae,
                    0x85d1f7399d0258e3,
                    0x9187af7eb3ced5d6,
                    0x8782930273578058,
                    0xb027c6b883aa5bc7,
                    0x10593dbc9a7d9a28,
                ])),
                Felt::new(BigInteger384([
                    0xb7fd698c7233fba7,
                    0x527873a267f5f515,
                    0xa8b79ce2597c4c85,
                    0xb3e585485cfdf7f5,
                    0xad2c1c3b614b3c53,
                    0x0e57e7821d270f6f,
                ])),
                Felt::new(BigInteger384([
                    0xde9e98ec6aabd3dc,
                    0x56fb7ecdcb2d9e05,
                    0x35fd85b5c2f8ee69,
                    0x7e39043821117341,
                    0x9ebf8af4fe546f49,
                    0x10779e6da66dbc8a,
                ])),
                Felt::new(BigInteger384([
                    0x750cfde20db30781,
                    0x4e52a989d3437d93,
                    0x94a5cb628d8c2375,
                    0x0660435433308017,
                    0x3f536e53899f0acb,
                    0x19f162d5d9e5c670,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc11031b794f47c8a,
                    0x6947b70a761fdfbc,
                    0xd61f8b04b6f8e885,
                    0xf9daf6e36deee545,
                    0x816d81c1ae5fd216,
                    0x03db12c6d271f15c,
                ])),
                Felt::new(BigInteger384([
                    0xf49bb5cd8784d81c,
                    0x9f25a8fc1f4f0ede,
                    0x37f4a78c853856a6,
                    0x7fc750d06651a99d,
                    0xa7293c282270dda8,
                    0x031f8730829d8399,
                ])),
                Felt::new(BigInteger384([
                    0x09a38f4901e4f6f4,
                    0x6c8e47cf0daf83fd,
                    0x47c547960c874d6f,
                    0x38958090185fa121,
                    0x58be97aa6a52b574,
                    0x0473e024d5c12f1f,
                ])),
                Felt::new(BigInteger384([
                    0x76ad4c3050234d34,
                    0x5d8191958e326209,
                    0x96a16ec1abbf18dc,
                    0x223d490d475ee820,
                    0x7c67711eea3ce260,
                    0x149eb5acc4fd4e6a,
                ])),
                Felt::new(BigInteger384([
                    0x4f2a93cb84a4d413,
                    0x3b0da63fda717dcc,
                    0x301cf2ecb0b9c215,
                    0xf15487025cac5f3f,
                    0x5649d2e8bc7b897e,
                    0x0f7b8ee94a02d8fb,
                ])),
                Felt::new(BigInteger384([
                    0x2f4dbfe2749e4f9a,
                    0x39cd2e7498c5fb93,
                    0xc94989f68787b87b,
                    0xa0f74b8da4171a08,
                    0x417b83e99ac34e2c,
                    0x035317e961f70431,
                ])),
                Felt::new(BigInteger384([
                    0xc2bd83790f6ffd9d,
                    0xb5e2b9e306ec5e53,
                    0x0a2e37a1ee698931,
                    0x324f619184311cc4,
                    0x990a9fc711d99a4e,
                    0x15a0789418355b72,
                ])),
                Felt::new(BigInteger384([
                    0xa828eaf1691e79ff,
                    0x5264334d9aaaad37,
                    0x2cf478dfe2452164,
                    0xf0ed221e6487fe88,
                    0x8e88f86a3725eb49,
                    0x162ef2bc43292f37,
                ])),
                Felt::new(BigInteger384([
                    0xb97f9eee3e9e563f,
                    0x345820a6a8d1b2fe,
                    0x52b9ea5c740a4d31,
                    0x8d43541d790e1307,
                    0x8fcefa550f45fb4f,
                    0x00c1d47e7b586a73,
                ])),
                Felt::new(BigInteger384([
                    0x31791ba29cc64205,
                    0xd1a94fa3e00cef9d,
                    0xfe7bc30b14a7fb63,
                    0x9934b765be5078e4,
                    0xf9c8b256ebb04e44,
                    0x09abeef6c23e3031,
                ])),
                Felt::new(BigInteger384([
                    0x2378ca8f4d4e20d6,
                    0xd88e5ade08f82761,
                    0x70bdba125c81d54e,
                    0xf69a4231b9cf0320,
                    0x22060d36774dec4e,
                    0x0e56b426d3201729,
                ])),
                Felt::new(BigInteger384([
                    0xd48f8712402829f0,
                    0x1742fa043dbebde1,
                    0x772bcf51ac1b9a1f,
                    0x49fc294d348b376c,
                    0xc53934bab2415cea,
                    0x12d0cb92070e143d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x247fa04595f5eaa1,
                    0x37a5117e3d212152,
                    0xb63a28ecd3ed94d0,
                    0xc3053668baf249af,
                    0x905aa2bcffb1b49f,
                    0x0ee607688809a61d,
                ])),
                Felt::new(BigInteger384([
                    0x7e01bd61eddfbf86,
                    0xe5eb2fb652183647,
                    0x3b542d9ff357cd39,
                    0x34bba8b7c5b8ba07,
                    0x075d62f2f6d641bd,
                    0x027692c9f52c416a,
                ])),
                Felt::new(BigInteger384([
                    0x993baca961741004,
                    0x9161c5697dcfc75f,
                    0x62125b6cedfcf51f,
                    0x21535bf52340bb0a,
                    0x61401f5503e6b904,
                    0x0c8ee43bdc694f3b,
                ])),
                Felt::new(BigInteger384([
                    0xda67e6be363f286c,
                    0xe1f5aa90e9685f09,
                    0x4533dc60dcb8db69,
                    0x9dc3513e25cdc36c,
                    0xb3c6ab7798f43759,
                    0x0a7724b7c9e313b2,
                ])),
                Felt::new(BigInteger384([
                    0x7e4ccee0b8214df8,
                    0xf5bf1941bd33eef7,
                    0x746221fd14b91f24,
                    0xa654fdafde9d6a5e,
                    0x7fd1f195146aa760,
                    0x16211f3bd6e2587b,
                ])),
                Felt::new(BigInteger384([
                    0x7c60c1e922b5472e,
                    0x671f74c19398b1bc,
                    0x311e52ca286ceb6a,
                    0x477188dbdcb8ca55,
                    0x4bd0b2032f7c959a,
                    0x1868522818eea2ab,
                ])),
                Felt::new(BigInteger384([
                    0x4ffb5d113ef2727e,
                    0xd2c492254d0dad3f,
                    0x6afb0c2c7eb44149,
                    0xe8c364ad6adfd66e,
                    0xeb56b7bcf9ebddf2,
                    0x092522d565e1fa27,
                ])),
                Felt::new(BigInteger384([
                    0x6aa91ac7c121f7d0,
                    0x1c4a2998d691aba1,
                    0xb6f2f163a1ddd134,
                    0xcf0359ace52d3469,
                    0x000136c368dedf6c,
                    0x0b0ae305c185a52c,
                ])),
                Felt::new(BigInteger384([
                    0xb1c040f1fb4c6d5e,
                    0x8c7f39f459c7602d,
                    0x3bd3dbbc9f22c299,
                    0xc48026523d20addf,
                    0xb05a8e56d45a188e,
                    0x08c75f5d4f2a5fd3,
                ])),
                Felt::new(BigInteger384([
                    0x7f40a0133ef51d0f,
                    0xef225bbd5c02ca24,
                    0xb2852c9d83e1cdb2,
                    0xfe84893833304c2a,
                    0xb016d18b87f387ed,
                    0x17be19e403021439,
                ])),
                Felt::new(BigInteger384([
                    0xe8d1a85cfa0c4dc0,
                    0x1412e57eeddc0452,
                    0xa34e044b41e7871a,
                    0x518ec5d579cf71c7,
                    0xf5b2be2d9c4ed7a4,
                    0x08cb4a6b07d0afd4,
                ])),
                Felt::new(BigInteger384([
                    0x6f35590bcee96969,
                    0x86ebde20ed274db1,
                    0x3ec0ba1a1e6d058e,
                    0xe2c01926a0e88999,
                    0x1fa1b4e7b0ef7d40,
                    0x079648d35a13157e,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x894b802e2637bea0,
                    0x07a19a5e0bf67fc5,
                    0x8ecb0e4ca0ebf8c5,
                    0x51eb18318647ad15,
                    0x6afad39c097006c5,
                    0x10fb6a753ef06117,
                ])),
                Felt::new(BigInteger384([
                    0x4ca50eb77145f44a,
                    0xd67d4406c1d13843,
                    0x41f3af3eb9628390,
                    0xbf8bcfe259087d5f,
                    0xaf2aa6d54cfcb3ec,
                    0x1774089e53852abf,
                ])),
                Felt::new(BigInteger384([
                    0x586f5c921aa9d41b,
                    0xa416c7c347d9beaf,
                    0x1637911f7d21df24,
                    0x426e898607ab18d5,
                    0x81f41ab1a87a0738,
                    0x14d49933aaf1aae3,
                ])),
                Felt::new(BigInteger384([
                    0xbaf6e88e47048bec,
                    0x67b7f06262614f38,
                    0xc4d24dbe687782e1,
                    0x850ad87d57af656a,
                    0x7cd1e280258cd5be,
                    0x17e3061cbe2dc260,
                ])),
                Felt::new(BigInteger384([
                    0x25ed7204fd2b4ec1,
                    0xeaea7b2cd732dafe,
                    0xa64691b2d16a95e2,
                    0x80d1588f87ff408d,
                    0x46fc40a282adc007,
                    0x0ed2e2933a50f797,
                ])),
                Felt::new(BigInteger384([
                    0x5b32ef0e7bd58761,
                    0x7246f56cafbc94f2,
                    0x4ffe117ae95b6939,
                    0xe14fc9b4a6a81b8d,
                    0x76eaf85c6390c889,
                    0x0d7ccd092f0f82e6,
                ])),
                Felt::new(BigInteger384([
                    0xc7006cdffd80af1e,
                    0x60de200dd9b751ef,
                    0x1e94fe86eba56b58,
                    0x05558affed89cfb0,
                    0x6840367a915e19ff,
                    0x0fedf538982ef12f,
                ])),
                Felt::new(BigInteger384([
                    0x3d1015b344b416ab,
                    0xd806dc7e65aadf7a,
                    0x3dd6e0efe364fdae,
                    0x910afc7b4f1b13ac,
                    0x8ef6c6edbdaba9cd,
                    0x16108fa3b3cf0c20,
                ])),
                Felt::new(BigInteger384([
                    0x55fbf56b375bebcb,
                    0xf9fa0bbeb3f48cc7,
                    0x4e87ad2df142ed51,
                    0x6a3cd669e2f52fba,
                    0x11ce574ea548a91d,
                    0x0ca7e355dc9036a5,
                ])),
                Felt::new(BigInteger384([
                    0xc7f7803a0e097e35,
                    0xf699ad95213b6bd6,
                    0xf671c01ecab11ec3,
                    0x3c0f9dd8af56d4f3,
                    0x4b0cec293ac58999,
                    0x083cc786449b0ce4,
                ])),
                Felt::new(BigInteger384([
                    0xe21af31cd7d4f0b9,
                    0x64aac47556164db9,
                    0x0d3dbfb8dc1d15dd,
                    0xae98d346045745b1,
                    0xfa99515d57d95b4e,
                    0x160b176b1aca58aa,
                ])),
                Felt::new(BigInteger384([
                    0x9718865d880e0720,
                    0x057a02cb436aec06,
                    0xbba6bb57d7d7c2bd,
                    0xc2c19e4b631c40b1,
                    0x7d8d8cee9b429f45,
                    0x0f41c60936296602,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xec0a61cf6da8a37d,
                    0x72faabd27ca6f264,
                    0xf1b9d4727961cd44,
                    0x1a4a79051c27ecf2,
                    0x54cefa1c5db577e7,
                    0x065062efbf951029,
                ])),
                Felt::new(BigInteger384([
                    0x921b45f7229b460e,
                    0xda8952eee058259d,
                    0xd38a7914345b5cfe,
                    0xb23071c570e24ebe,
                    0xfac54d7b3b53ebed,
                    0x147df939cb7955a6,
                ])),
                Felt::new(BigInteger384([
                    0x53298d0014643bd9,
                    0xc43a9b1124baccf5,
                    0xbc9da1f3fac7dc07,
                    0x8621cad3bcdd8ca7,
                    0xf2cdd961f0e1b795,
                    0x1098c7d20f61bf62,
                ])),
                Felt::new(BigInteger384([
                    0xfffbb2613bca7c63,
                    0x688e46e3fef0eca0,
                    0xd2bb5b8dfb99dce5,
                    0x4187038cff2374b2,
                    0x8b651ffc74e8fb6b,
                    0x0b86da4eb45a0dc8,
                ])),
                Felt::new(BigInteger384([
                    0x4a52139b9bbd1782,
                    0x7249d847f70c5491,
                    0x4c3d1d954d344b89,
                    0xd08f34d89b4015d2,
                    0x29a6ebdb79b7a5ee,
                    0x0eb93e3f0637b080,
                ])),
                Felt::new(BigInteger384([
                    0xa1269cf259a7a9d8,
                    0xf7ff4304f913e502,
                    0xecccfccf0ca397d6,
                    0x04fc1dc76367c85b,
                    0xf2ea2d0094d86274,
                    0x0277fa076f8152b0,
                ])),
                Felt::new(BigInteger384([
                    0x08fba337e9bf68df,
                    0x6f88bc155208e3f9,
                    0xcee0fa7f9906088e,
                    0x0c0554423472e49d,
                    0x9bcc0c12e3a78afb,
                    0x0145f58b1010e3d0,
                ])),
                Felt::new(BigInteger384([
                    0x9073b3e70c627327,
                    0x5e79e289b1586cf1,
                    0x26ad9409aa4fe4fe,
                    0x9a62b47b03031aaa,
                    0x77a24bd5e17c6edc,
                    0x0da82e7e98de387d,
                ])),
                Felt::new(BigInteger384([
                    0xeb3f4f21b39fb19d,
                    0x1697ab8810c0bc46,
                    0x898a75e3ce19c849,
                    0x5d7cc4ce98c10c5a,
                    0x31e017550b302514,
                    0x0d37b7e7560a02fa,
                ])),
                Felt::new(BigInteger384([
                    0x250db34b0792c7c9,
                    0xe4b416433152ebbb,
                    0x9805178e0608c1bc,
                    0xfa94c933b05a4d86,
                    0x8f1c8fc98d65c734,
                    0x04cfe83fda6f730d,
                ])),
                Felt::new(BigInteger384([
                    0x772bdabd1b9c4884,
                    0xd01bb6e9d9a0fab6,
                    0x1bc0367ced81bae5,
                    0xf268c1ce5b57402d,
                    0xc1340946fb7ee80e,
                    0x051fdbd0bb6a6ddc,
                ])),
                Felt::new(BigInteger384([
                    0x9c258a3fb1f5848f,
                    0xafaecae79f50b6df,
                    0x1539b608f7fee520,
                    0x04efe319ac6d4134,
                    0x778daa5fed392338,
                    0x018e6d28aee7bee7,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x8b6d80ab3b385ef4,
                    0x04fee29dbf395e17,
                    0x0552299cc221f86b,
                    0x80ff8bf7caeda7b7,
                    0xf56e54824606984b,
                    0x004e90030fda43ee,
                ])),
                Felt::new(BigInteger384([
                    0xe903fce6110b8dc0,
                    0x45e018f1f6e7a9b8,
                    0x709508f137c611bd,
                    0x538c5975ad4ecc64,
                    0xcc86fc9ed0b9dd16,
                    0x151bf4d353822174,
                ])),
                Felt::new(BigInteger384([
                    0xd35d30a486398e2d,
                    0x5ad22a0b57c47af9,
                    0xc8315ff8a0c5d829,
                    0x181c5c0fa28d9bd1,
                    0x41313921cf7377b6,
                    0x03e415cb91a67a43,
                ])),
                Felt::new(BigInteger384([
                    0x744f89435cdd40ac,
                    0x767889bd24c0d8ba,
                    0xa20328795c3c386c,
                    0x5d52bc29f66e613d,
                    0xcdc2f43f5a55ecf0,
                    0x0188d26137966f28,
                ])),
                Felt::new(BigInteger384([
                    0x73b9e30723e8e2cd,
                    0xff7213f2c3ba3160,
                    0xbf72849c433cdbd8,
                    0x867861d5c61b645b,
                    0xf43877c2fd33a35a,
                    0x08902491b6ca8150,
                ])),
                Felt::new(BigInteger384([
                    0x3b12a018b293be5d,
                    0x8147732b428b2ab0,
                    0xfc6faafd7ca4da65,
                    0xa713e379d5b5167a,
                    0xf20045bb05c00d94,
                    0x12ee8f38b849e94a,
                ])),
                Felt::new(BigInteger384([
                    0x26c72509e4aa11ec,
                    0x79c4501a86618d3f,
                    0x6feebeccfeb01574,
                    0x9251d171bf8984c3,
                    0x400aae6446e9f713,
                    0x15e2570c493f7276,
                ])),
                Felt::new(BigInteger384([
                    0xb6d9dab117624e8e,
                    0xfec1bbe1201c70f7,
                    0x9624555f805c3284,
                    0x7046b3472ba27214,
                    0xef9c59e86e563bad,
                    0x04afd9ae20265c72,
                ])),
                Felt::new(BigInteger384([
                    0x34151c6fb9b8af6c,
                    0x3eac1dac145e1e3d,
                    0x7f2f224339798221,
                    0xa9146a12408ecf9e,
                    0xd14455b1a89889fa,
                    0x0584b4e370b0a3ad,
                ])),
                Felt::new(BigInteger384([
                    0x898e22ac6abaa71a,
                    0xf3757d2a2d56e824,
                    0x031bd0ee233361e4,
                    0x5cb6be7dc4bbdeff,
                    0x92345c57f3a7381d,
                    0x0650e7c4733e1b40,
                ])),
                Felt::new(BigInteger384([
                    0xed6fc618387a40b2,
                    0x688f5ffb45d9857e,
                    0xbe3644636d5f3d02,
                    0xd56672a54a29e72e,
                    0x1867405c3003b21a,
                    0x05ce1573549b657c,
                ])),
                Felt::new(BigInteger384([
                    0xa7bc518056f38bc7,
                    0x49e36fdf8f9c17a4,
                    0x59b453b0e3220a70,
                    0xc7cd4e9963ed2e59,
                    0xb9cb68cc9fcd2aea,
                    0x0604563b4297908a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x409b1abaaab31bd2,
                    0xdcd01f5da19cb125,
                    0x58d898ccc783e3b7,
                    0xb034d4738685c62e,
                    0x253bc9e315bfc221,
                    0x013c4f4ebb073f3a,
                ])),
                Felt::new(BigInteger384([
                    0x4dac71d15147ad48,
                    0xe972dae085011543,
                    0x039ff7811c77fb01,
                    0xa7ebdda0d7d3b32a,
                    0x49b33a0dea81ddd7,
                    0x0f0075a2795ee957,
                ])),
                Felt::new(BigInteger384([
                    0x23a4d1cb08367ae0,
                    0x699b80a80b5ceff3,
                    0xe1285064251d4797,
                    0x87dcb65d9291afb2,
                    0xb1b87fec076435ca,
                    0x11a387486a2b848d,
                ])),
                Felt::new(BigInteger384([
                    0x834db0e91ba957cd,
                    0x444faa868fac9fbd,
                    0x8fca25971081c4af,
                    0x9eac9dd4e446da24,
                    0x7f36ab662b29459d,
                    0x03bd32cb69ff5132,
                ])),
                Felt::new(BigInteger384([
                    0xbe17fa6749c673a6,
                    0xabec1e2b2e22b19c,
                    0x5576950146de6acd,
                    0x43a12400ce8cccbc,
                    0x04868107fbaf61a3,
                    0x0bb1ef54542af71b,
                ])),
                Felt::new(BigInteger384([
                    0x2069716662be155d,
                    0xb66f107c8b818db6,
                    0x10fae062b60f2ade,
                    0x3ec532c775708e60,
                    0xa85c892fd108de93,
                    0x0b8da6749a0085c7,
                ])),
                Felt::new(BigInteger384([
                    0x4a7552afe795839f,
                    0x57843d081b75a506,
                    0xac424d1edcc904f4,
                    0xa92789032804edf5,
                    0x57d7e226a85a1da3,
                    0x0fce998a89bb71b0,
                ])),
                Felt::new(BigInteger384([
                    0x8423b97509d6e5ea,
                    0x7f8d00995225fc57,
                    0x5c75bfcc9010d28f,
                    0x5910531f1df4181b,
                    0x93876a5ce15b9eb1,
                    0x0160e74b3cfb5ed4,
                ])),
                Felt::new(BigInteger384([
                    0x9d6644d98c970406,
                    0xa9ff8d0eb692a71a,
                    0x83cddefaece2ff3a,
                    0x0d9094fdd174fcb9,
                    0x95457f936a4e0a15,
                    0x07bb80252a1fc4c5,
                ])),
                Felt::new(BigInteger384([
                    0x6700446fa4b298f1,
                    0x15e7f90a21cb351e,
                    0x64124fa2ca5e8d17,
                    0x783ca294833dd714,
                    0x51c29bcccc735ffd,
                    0x02baa34b4ee06ad6,
                ])),
                Felt::new(BigInteger384([
                    0xde7c9b6413265e31,
                    0x00b9684462cf1a46,
                    0xccc35f4256dbef88,
                    0x7c951bae252c47be,
                    0x5df7e473a1dd2fab,
                    0x0e05507c200af6da,
                ])),
                Felt::new(BigInteger384([
                    0xfecce9c07c06e404,
                    0xeb46011cc60cda8f,
                    0x3161a06408d5c149,
                    0x638fe381ab62f6af,
                    0xfac165b9211bdbf6,
                    0x11abcd3f79ef38dd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x19509eda25c0fc97,
                    0x9060ce4cd8eaa4df,
                    0xc0ac8de3d19a2dd6,
                    0x2d20da4d9a2939e3,
                    0xfe2b6e17cdd2d0dd,
                    0x03a39bb3cf080fec,
                ])),
                Felt::new(BigInteger384([
                    0xb18abb1ef11f0027,
                    0xd4f899f42e27c48d,
                    0x232c9008033a0a76,
                    0x4c072159faa8b107,
                    0x39b13df0b71766eb,
                    0x0cab708cb48ea3a3,
                ])),
                Felt::new(BigInteger384([
                    0xdcb05a86814e84a8,
                    0x62c1f290c9806f12,
                    0x7d974edec4be1dd0,
                    0x59f7131631859f63,
                    0x9a49a9e87d89d3e8,
                    0x0df77d204ab18c06,
                ])),
                Felt::new(BigInteger384([
                    0x7536fdd429f32599,
                    0x9cd7a8e3b9466bd8,
                    0xa20825eca11c2360,
                    0x90d3dcbdcbc4e71c,
                    0xae767977dff515b5,
                    0x1355d0e22835ecd9,
                ])),
                Felt::new(BigInteger384([
                    0xbada89947d5705e5,
                    0xa5ac2c50dc7a023b,
                    0xfef790c85fdf7bed,
                    0x25b0210abc64bbf1,
                    0xd0267bdb7f3c636f,
                    0x1362871f0409bb88,
                ])),
                Felt::new(BigInteger384([
                    0x96b0521af01dcd64,
                    0xfaf022042cf4a89f,
                    0xf9a37e4c453f5094,
                    0xabf6fa3bf6a33a4e,
                    0x6bbd079dd7256f9b,
                    0x00835d9357a661ee,
                ])),
                Felt::new(BigInteger384([
                    0xefc7f72ba726ef53,
                    0x8d6140717c2d30a0,
                    0x7d70e99016912a4c,
                    0x1a52bbb5f937f3ab,
                    0x28b6d12957de16c4,
                    0x10f05b5662b52bcf,
                ])),
                Felt::new(BigInteger384([
                    0x64bb2cf4863055b0,
                    0xe86354579eb3f34e,
                    0x373f7afd9e2fec4e,
                    0x08c1a6a4b1e2275d,
                    0x902496cffcd5d659,
                    0x17b0f16aa1eb6fe1,
                ])),
                Felt::new(BigInteger384([
                    0x684aa56816cdb74e,
                    0xb948e16976a34c93,
                    0xce8b772fd2b36d3b,
                    0x7cb796cbc769d6a5,
                    0x1b0253d0d73c7c03,
                    0x147c62805e24e000,
                ])),
                Felt::new(BigInteger384([
                    0x1a805d753779fc37,
                    0x380518460f933594,
                    0xceefc377b3c44670,
                    0xc94beda77aef0521,
                    0x31d564eb63b73f55,
                    0x0da64103ce854a7d,
                ])),
                Felt::new(BigInteger384([
                    0x5453714088524aff,
                    0xca893d8aeb977ac7,
                    0x4778c7c51e3dc5c0,
                    0x801c641699205e57,
                    0x6c4997ee67571038,
                    0x0cbc6dec82f41a18,
                ])),
                Felt::new(BigInteger384([
                    0x5ecafd441d3f86b0,
                    0x33383b9d1085d15c,
                    0x90f6b77f2dc8d801,
                    0x50219f4784a48a7d,
                    0x5e96569a651dd4a3,
                    0x0487d71e1516e38c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x84c621a27b12a787,
                    0x4c7a42dd8f594315,
                    0x96b5660d7a82b7be,
                    0xee81e1671ca38179,
                    0xbc8f44ace74e5468,
                    0x128cc3c0e12fac42,
                ])),
                Felt::new(BigInteger384([
                    0xb3b9327135314867,
                    0x1b2af04f0622e3f9,
                    0xe03f83a08bd3582d,
                    0xbd3a0df314692a41,
                    0xd51c610d82bfb62b,
                    0x0d29c873c78a7360,
                ])),
                Felt::new(BigInteger384([
                    0x610ac09c57381cef,
                    0x98cd6c13a7ee277e,
                    0x2c89a3c56e634898,
                    0x5b406fafbec414f2,
                    0xa964adf4b9b0ca65,
                    0x0b86893e89e2df1a,
                ])),
                Felt::new(BigInteger384([
                    0x47c372d959f6a96d,
                    0xf65e45d4eb8c746f,
                    0x06879091a11f607e,
                    0xa29c38d59b484a7d,
                    0x610f654783fd0673,
                    0x04680e25afd7e593,
                ])),
                Felt::new(BigInteger384([
                    0x933cf58a86263088,
                    0xd3fd1b30b5dcb943,
                    0x989c00fe7756de61,
                    0xc48fab3f9e292841,
                    0xaf0696680507ed65,
                    0x1758b3a0add72802,
                ])),
                Felt::new(BigInteger384([
                    0x4f9ac00f37ee4eed,
                    0x0a899bedcd946c32,
                    0x815ae8b083814494,
                    0x498ab4e64aa5c64a,
                    0x4d7a2d00e48a715a,
                    0x142052adbfd80e18,
                ])),
                Felt::new(BigInteger384([
                    0x0032dd8bb112eda3,
                    0x30e1f926d7639a95,
                    0xcb4ab4316b56ed8d,
                    0x4ed175db77812d9f,
                    0x932517eff6acdef3,
                    0x09de9be5d2a4f1b3,
                ])),
                Felt::new(BigInteger384([
                    0x70b4ca55163597e0,
                    0xea563029803337bc,
                    0xeb208047cf2b3175,
                    0x9c9410b2352985fc,
                    0x962f7cf50d0003c7,
                    0x0a59bc1ec1cb7cec,
                ])),
                Felt::new(BigInteger384([
                    0xb4fe9a6a118658df,
                    0x84fb153dc8c7e98e,
                    0xc548c208ede3c14a,
                    0xd11fb250bb633e82,
                    0x44a4ba3e59c396a1,
                    0x03228eff5c63a35b,
                ])),
                Felt::new(BigInteger384([
                    0x75f4bc9543e9cdfa,
                    0xaff8e8b999ab870e,
                    0x98531ba47f8a9b1e,
                    0xc52683e1f056b351,
                    0x0dd974b1586fe7ff,
                    0x0371b9bf1924996d,
                ])),
                Felt::new(BigInteger384([
                    0x4cd4675e6db3b7e7,
                    0x033032a2e54daaee,
                    0xd016ae6738e46289,
                    0xde95d6d03af24898,
                    0x06891be83d8ac646,
                    0x073d594bdace3e85,
                ])),
                Felt::new(BigInteger384([
                    0xc5ccc5f74c35903a,
                    0x134df93df49ba405,
                    0x51bedb58bcca6602,
                    0x3db129248531cabf,
                    0xe349ec38c189f942,
                    0x139530c396a2f715,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xd3d60fa6dbbad6d0,
                    0x7dce5528098dfd9b,
                    0x5a6bb037203709ee,
                    0xcf2184943f9572e2,
                    0x7bda48a6c68c0333,
                    0x01e67d78e58eee99,
                ])),
                Felt::new(BigInteger384([
                    0x9cdb1d8dc9d32109,
                    0xa9ddff68d16d422f,
                    0x0c509846e0dddf85,
                    0x36053e801e8d7d61,
                    0x91e57659664a7041,
                    0x1700db12ae3c5b44,
                ])),
                Felt::new(BigInteger384([
                    0xa5190f610759e2bf,
                    0xe4bd08e53debd6eb,
                    0x71fc7a0fb52449e5,
                    0xdb028ca7f10aab3f,
                    0xfdde7a7850a01f8d,
                    0x19dd4784d17d3210,
                ])),
                Felt::new(BigInteger384([
                    0xabee3dfec45f3160,
                    0x3e6b8f055614a047,
                    0x3a10ce1113ea4815,
                    0x1e0282c9953903ec,
                    0x4a18a7466ca68dd6,
                    0x0a1ec1272c23dc27,
                ])),
                Felt::new(BigInteger384([
                    0x5d9e4dcf1a8db716,
                    0x162697c9036eba8e,
                    0xff150b37593eb4ff,
                    0x10da7be2d59b020a,
                    0x174dff380e949161,
                    0x18773660b721b9f6,
                ])),
                Felt::new(BigInteger384([
                    0xa21497401f51126f,
                    0xccded42016339ab2,
                    0x0e25673cd89a80af,
                    0xe005416a8e33dede,
                    0x07656425932a0501,
                    0x13e7481b3e7177ca,
                ])),
                Felt::new(BigInteger384([
                    0x200ddc19391dbde1,
                    0xce44a20d4ca3760d,
                    0xc7cbb367860342b3,
                    0x0916c2f95e7d1b13,
                    0xc29cb9ed0678cce0,
                    0x0b56ec5cb42071f0,
                ])),
                Felt::new(BigInteger384([
                    0x0b21c0fa9f14614f,
                    0x0c09d53bf7abf248,
                    0x7815d5a38773fca3,
                    0x3ab185d530725ec5,
                    0xbd052f2579621976,
                    0x0b8b0e06d3aa7eba,
                ])),
                Felt::new(BigInteger384([
                    0x859cc41fa0d612fb,
                    0x5f59dd7f9b7f2ff6,
                    0xc1b1864cdc84f281,
                    0x9ac931b7e218ab30,
                    0x146220aa1e734b8f,
                    0x1553ee1446fda699,
                ])),
                Felt::new(BigInteger384([
                    0xeed9552ed38b1252,
                    0x931e0584fc76bd19,
                    0x65bf9d4308e29f34,
                    0x6212332d36d95100,
                    0x910e908433bf6daf,
                    0x128fe545288f8810,
                ])),
                Felt::new(BigInteger384([
                    0x8ead86cd9ee52bd7,
                    0x2c2088c619350051,
                    0x32a68b99382c3e71,
                    0xd7561b6ee6deaeff,
                    0x0cd591726299cfef,
                    0x190cfbfebe6464c6,
                ])),
                Felt::new(BigInteger384([
                    0xbd57912b516c7d30,
                    0x19823b15818032c4,
                    0x3c225e673b4636ea,
                    0x81746ce638a598ad,
                    0xfbf4b237ddc3a8f5,
                    0x0c8b03e4d2f8b97b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2ed2ff6273394c08,
                    0x9e68c11478c9ac05,
                    0x129e96db7e480e4a,
                    0xd8fcd0a10c8044ff,
                    0xe260c7a80c71ed94,
                    0x0544fba233c01f45,
                ])),
                Felt::new(BigInteger384([
                    0xc8fd096978865286,
                    0x1609bcddf75a6e58,
                    0xb3c56e180152bb9d,
                    0x6fd96c198d3b809c,
                    0xfb01ce2459645721,
                    0x08cb2c883de693e7,
                ])),
                Felt::new(BigInteger384([
                    0x857019d465d35c17,
                    0xae4a7963e13e8543,
                    0x789aa9e8f6027e26,
                    0xb6d603f704e905ca,
                    0x941ba844fba701bf,
                    0x0cb2481a19d3c32a,
                ])),
                Felt::new(BigInteger384([
                    0x52aed2b053a3a552,
                    0x06ad3cb6ade7aed9,
                    0x8fd5520ba3c119df,
                    0x674db4046af91430,
                    0xe70adc431c36a1eb,
                    0x14c7c7201bb8d929,
                ])),
                Felt::new(BigInteger384([
                    0x3e6a6bd5a3227fbd,
                    0x66a324493cf54f7c,
                    0xcedeb3eee4b08d8b,
                    0x8ae927597a92ce94,
                    0xc2256eb12e7c7ed9,
                    0x05fec1bca74523a3,
                ])),
                Felt::new(BigInteger384([
                    0xff8b2a17e51fb88e,
                    0xb1e6bf87c88db9d0,
                    0x61a06819aee80ca2,
                    0x1a61f795f3ffa001,
                    0x4fc8eeeac2e44805,
                    0x03fe72c325bcf3fb,
                ])),
                Felt::new(BigInteger384([
                    0xbcfc2b158c156019,
                    0xd2af0af6d806372b,
                    0x6125fd36531973bc,
                    0x903b2d42c0648363,
                    0xdec356a717a97a2a,
                    0x170bc28d38f07034,
                ])),
                Felt::new(BigInteger384([
                    0x70f93ec4d0378eed,
                    0x0dcd48470ba757c6,
                    0x201b8c7e4d158b7c,
                    0x278a6843c7736801,
                    0xfc01e198c83aa8b1,
                    0x144fdcf0ae2225d5,
                ])),
                Felt::new(BigInteger384([
                    0x7e44ea6c07742dbf,
                    0x828ef0b0a990792f,
                    0x8c5d829c40534492,
                    0x6f88288c537c44d3,
                    0x96b2252efabab43c,
                    0x02a8fe97a2850824,
                ])),
                Felt::new(BigInteger384([
                    0x4247eef2b254c487,
                    0xbb86b4f63bffa4cf,
                    0xb6b9a36b3dc2703c,
                    0x8bafaf50d35e612a,
                    0xc997fc5d9d5daf29,
                    0x080a70c13440d2c4,
                ])),
                Felt::new(BigInteger384([
                    0x821512c5890d5466,
                    0xb4a33c78ebcd6490,
                    0x7841801e98a18797,
                    0x896ca16f4fcb3a08,
                    0xcad5e00c0264c718,
                    0x1577a8b93764fc02,
                ])),
                Felt::new(BigInteger384([
                    0xa1d5dbf08959cb2d,
                    0x2273f07ad1d7019f,
                    0xf4d9a0d3d764a842,
                    0x46acaf8c88283c4b,
                    0x05ffdae326a9b081,
                    0x10ffb1d1cb37b6d8,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x4edf6444356ad36d,
                    0x636ab770d90bd2ad,
                    0x2c0ccaf4ca6122f7,
                    0x5dba17a971c2c5f8,
                    0x1fef30b92be358a2,
                    0x0d9aa48347da40ef,
                ])),
                Felt::new(BigInteger384([
                    0xf82b79f01db75aac,
                    0xee3abf926bef7e63,
                    0xbf9055a12e125434,
                    0x8c17656c84920b92,
                    0xffd45af9d11f71a7,
                    0x0454d4ba06a5ace8,
                ])),
                Felt::new(BigInteger384([
                    0x3469541ca7829df5,
                    0x7cedbf1a1b796364,
                    0xb7ac604b2661aaf8,
                    0x973df88eb8f1ec41,
                    0xa5f758721d379975,
                    0x00fe7e8c0d951385,
                ])),
                Felt::new(BigInteger384([
                    0x3241639afff84981,
                    0xb555faafb4d73503,
                    0x7dc8fea43a9a33cf,
                    0x5029cf53f297c98b,
                    0xe5be3f259a288007,
                    0x0efbb227cf99f2b9,
                ])),
                Felt::new(BigInteger384([
                    0x2dd9238498a4ea98,
                    0x9ac89f6d3c47987c,
                    0x3f4285c36131a319,
                    0xb0e60abee395985b,
                    0x999d3e15f2b97226,
                    0x0b7e38cef2f3397d,
                ])),
                Felt::new(BigInteger384([
                    0x6eefda83e19e936d,
                    0x582e71366bb6d5c2,
                    0xafe0659301a4e509,
                    0x21ce1ec7f2736284,
                    0x4d441a2a1adf83c0,
                    0x0127e0b70ef446b9,
                ])),
                Felt::new(BigInteger384([
                    0x9cb8ed4401f4c723,
                    0x10b6e1003d9b2352,
                    0x3e1782358b2fd22a,
                    0xb64c38e9b7bee9c3,
                    0xa176aab9601370bb,
                    0x05bac5cc7572347b,
                ])),
                Felt::new(BigInteger384([
                    0x19e9b0be2d52cdfb,
                    0x1609721ad8f85d7d,
                    0x05ed06f66e15a436,
                    0x6331f5268e57dea0,
                    0x63fa03bccd0503a2,
                    0x08d485d988c34a56,
                ])),
                Felt::new(BigInteger384([
                    0x7815618109f9781d,
                    0xda89caa42e55d3d5,
                    0x0cd5944347395891,
                    0x9fdc9a69e13a0be9,
                    0xab2a6619a636a07d,
                    0x123a6e58a08238e9,
                ])),
                Felt::new(BigInteger384([
                    0xc6ad4fb3bbf2942b,
                    0x50dc331036f410ce,
                    0xe3b5cb187870630f,
                    0x3426c6e0c55043ba,
                    0x11ae0439cb07a67f,
                    0x05af631a81732d80,
                ])),
                Felt::new(BigInteger384([
                    0x61cfca4bd12bb964,
                    0x55e91c0ad6f31a71,
                    0x09a92d7fb79448cb,
                    0x28e8d0e57ba6b02b,
                    0x03a3850265fbe1f0,
                    0x006cbbd6cb680f39,
                ])),
                Felt::new(BigInteger384([
                    0x8fb6a736f83b3ff3,
                    0x2f25d8d4dd3822d8,
                    0x5d64eda05c79f6ea,
                    0x542c5820c88f1df4,
                    0x4983eacadc0dccf8,
                    0x037f05879f87049e,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xaf6551fc449b0602,
                    0xc12b201e287ddf8e,
                    0x16c5ae2586862e58,
                    0x1173d509d464b0f6,
                    0x30e1afe2795810b8,
                    0x03df2a078fc0bc67,
                ])),
                Felt::new(BigInteger384([
                    0x77511754c17eba8d,
                    0xf35de270047e9651,
                    0x5006e644f88299d1,
                    0x7f157c8202293375,
                    0x3cd4e2fea94ff07d,
                    0x19cc152ab6e2d528,
                ])),
                Felt::new(BigInteger384([
                    0x61f96810c95b7330,
                    0x7d7985c2c041d0af,
                    0xb4e6bd29b40391d0,
                    0x8dcdd2b6bf30b834,
                    0x46918af07e775e71,
                    0x10d5f2d4258c3826,
                ])),
                Felt::new(BigInteger384([
                    0x75528e470026be77,
                    0x7ba0c1fc8805c917,
                    0x33ee0f29586c2c49,
                    0x4e069ea3441b6003,
                    0x089c2bef542bcfe4,
                    0x01d7295b4ea96527,
                ])),
                Felt::new(BigInteger384([
                    0x8715c1b0c0c75c1a,
                    0x71ca7abb700f1602,
                    0x71abcee7231f73ef,
                    0xd2cc7cd4c4bb826d,
                    0xa9843e1e08d9f2bc,
                    0x0f8fb20601130fa9,
                ])),
                Felt::new(BigInteger384([
                    0x0db97bba671a3c14,
                    0x5dbcccca422486d4,
                    0x8f884636ada7c517,
                    0x919c0a997e3ea5fd,
                    0xafef2269676c5092,
                    0x092e7e6da8d1bf0a,
                ])),
                Felt::new(BigInteger384([
                    0xff46ba0faac5b752,
                    0xff958da44064cee0,
                    0x9f4693bde4297415,
                    0x22363e81c7327580,
                    0xe6d1b34272777180,
                    0x168a8d836a79ea91,
                ])),
                Felt::new(BigInteger384([
                    0x5838f8a51bcfe7d9,
                    0x2caef824048eb87c,
                    0x62383952d9f6b713,
                    0xca395c46516c263c,
                    0xbf7c0adc18534e8d,
                    0x027b2609136c343d,
                ])),
                Felt::new(BigInteger384([
                    0x9ad8243747029cb3,
                    0xd98eaa254d794b85,
                    0x88cdfb064daf317e,
                    0x139199c020859c5d,
                    0x52e2b54f8099362c,
                    0x043fc99f9ecefb9c,
                ])),
                Felt::new(BigInteger384([
                    0xa83e55e6086db927,
                    0x2cd1ba6ba8d15784,
                    0x5c4201c7c38185e8,
                    0x5ec7258d29910519,
                    0x0bbf7832cf35f177,
                    0x09a48272b77bd7fa,
                ])),
                Felt::new(BigInteger384([
                    0x293976bc5de25b52,
                    0x2347c3008419b84a,
                    0x580782ca7e37d4a2,
                    0x380cc7b72d38913f,
                    0x6c3bfcb44c6aeeee,
                    0x0a49c52454c051d2,
                ])),
                Felt::new(BigInteger384([
                    0xc4116fe771e7b314,
                    0xbe92d90320390deb,
                    0x12fef2038ec38dd2,
                    0xac6aa8b6e955f169,
                    0x4fbcd557d00909ee,
                    0x1365610a306abcd4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xda37fd6556010ee8,
                    0x0aef8d3b68d764f1,
                    0x18b304457a1fc71e,
                    0x066582d23e93c661,
                    0xb3c94335a6c18597,
                    0x0183fafd211ae4e0,
                ])),
                Felt::new(BigInteger384([
                    0x4ca6891778c050ff,
                    0x1733b85eb25ea873,
                    0x14a19c3bafcd6d13,
                    0x9a8f3f2f4693f12e,
                    0x21ec6857010c6306,
                    0x048d797f85f9df58,
                ])),
                Felt::new(BigInteger384([
                    0x6f12ba80473f36b0,
                    0xd5624bba443f57cc,
                    0xc728839206fe604a,
                    0xf64336e1472467f3,
                    0xab66b989b062964b,
                    0x05b18a14919f0a70,
                ])),
                Felt::new(BigInteger384([
                    0xe743bfe3cc1bf80c,
                    0x178a25a746c66ca6,
                    0x5fb1502304e2749f,
                    0x47975e573a81e7c7,
                    0x6af05fb6c98b4b93,
                    0x13ef83a423c63a01,
                ])),
                Felt::new(BigInteger384([
                    0x2e6d5c53257297da,
                    0x0dc0d343a6ae5e23,
                    0xff902c7c224b4bce,
                    0xc347c847a72d342b,
                    0x484d62beaeb2c6b0,
                    0x074c1dc8c2bf22ff,
                ])),
                Felt::new(BigInteger384([
                    0xe49fbb0bb0436712,
                    0x361dded6e0f88016,
                    0xcf100d29feaf19f9,
                    0x8a2d5c2f355a21d7,
                    0x8f29e8d1375918c1,
                    0x18f7b982d7e9a9b3,
                ])),
                Felt::new(BigInteger384([
                    0xa2856d18e1dfc053,
                    0x9189218640d30651,
                    0x4e0c303bce90dc46,
                    0x23be263939ee35c4,
                    0xcff183fa0469409f,
                    0x0050731ef2230e4c,
                ])),
                Felt::new(BigInteger384([
                    0x4e482d44c5255dfd,
                    0xe2f4dd19603ddeed,
                    0xa028022a2dfe3899,
                    0x096f3603bf73ee53,
                    0xb32f9d14823d9c62,
                    0x0541e3f710f1b211,
                ])),
                Felt::new(BigInteger384([
                    0x41c96467dbeee627,
                    0x24a5f8adfd8472f4,
                    0x6d17d7e135c8ea82,
                    0xa11f12aa4f00aa9c,
                    0xff1aaa01eaa0796a,
                    0x0b0cbed68e8a7809,
                ])),
                Felt::new(BigInteger384([
                    0x4be773a172acc989,
                    0xa741849f98d46b9d,
                    0xd29d5e7bd59816d9,
                    0x4f8b7f3a39debd9b,
                    0x673b399be708a3b0,
                    0x091ea66c0a31a9b2,
                ])),
                Felt::new(BigInteger384([
                    0xe4718bbaf9820354,
                    0xc627e96ac6d8fac9,
                    0xcf8d8f3111b3f52d,
                    0xb1261cac445abd93,
                    0xa15ce71b4781e267,
                    0x071992593e7620c9,
                ])),
                Felt::new(BigInteger384([
                    0x4bd0b008a8c3fae1,
                    0x95a7338e7e3c2e0b,
                    0x867ea427f99dbd95,
                    0x9790e5cd76e3216c,
                    0x823510f76f0397da,
                    0x0d83076860f321fd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x808aad5e0c1fb8a1,
                    0xfea1be514a5296ca,
                    0x4393b0d4af6bd560,
                    0x22652d2846eda294,
                    0xc8c96638f3eeb495,
                    0x095afbc23807a0a4,
                ])),
                Felt::new(BigInteger384([
                    0x71b9abdead01f0d9,
                    0x57d9378ba6e2fd54,
                    0x545c1aaba48a614e,
                    0xff3fd04be0fab447,
                    0x7c2091495439b3cb,
                    0x052b95ab33293d74,
                ])),
                Felt::new(BigInteger384([
                    0xfd32eb25c9e3e106,
                    0xc7f26370dbae1fca,
                    0xf7de3beea8117e7d,
                    0x6f8d62d30b058290,
                    0x2a7fa3e8091d8296,
                    0x002699936a4ed0d4,
                ])),
                Felt::new(BigInteger384([
                    0xa7d2aefb897d271c,
                    0xe7247a54b732df79,
                    0x7b683fb044dec47d,
                    0x82582d8bf3df4e41,
                    0xd27b5990d7807985,
                    0x0b41257cca7c7bcc,
                ])),
                Felt::new(BigInteger384([
                    0x49e2586bd3f520dc,
                    0xdece005edb05feb3,
                    0xc43b58f5dc21b194,
                    0xde4217eb5e369aee,
                    0x77faf5b205353bc7,
                    0x01cdd53efa66a9f3,
                ])),
                Felt::new(BigInteger384([
                    0x50017af4962f605d,
                    0x821c60624d5d96f3,
                    0xb02a3499b316ac74,
                    0x54075fd8e63db213,
                    0xf43598aa08bb553f,
                    0x00554c3428f61437,
                ])),
                Felt::new(BigInteger384([
                    0xc91c47134dc847e5,
                    0x1c6e7f48f3f435cc,
                    0xdcb13bb79db62c79,
                    0x2122de9d78317257,
                    0xa8f7f3f1dba01cc8,
                    0x01dfe96de9e32f73,
                ])),
                Felt::new(BigInteger384([
                    0xfde6b6b0ca046d8d,
                    0x08cb799d905054d4,
                    0x568d47e449733771,
                    0x3aa1b48469ae68ad,
                    0xff3a5b4775fec132,
                    0x0a0bfc943c7d45e9,
                ])),
                Felt::new(BigInteger384([
                    0x2a807e2e32bdf9b3,
                    0xaa245bfbc812186a,
                    0x57034ab27332a016,
                    0x32ec69cf51e7b72c,
                    0xd2f894fd7d1ba37f,
                    0x1772b0059cbf6126,
                ])),
                Felt::new(BigInteger384([
                    0x80c75edf1514ab6a,
                    0x71ddb6907029b7c6,
                    0x98a1fa56459df182,
                    0x393cbd9684acc2e5,
                    0x2ec65c959a126c74,
                    0x04271a2035dc46bb,
                ])),
                Felt::new(BigInteger384([
                    0x64df874b6bcba8ee,
                    0x00c09350594030ea,
                    0xc9c19c024ecc7536,
                    0xc1acbd0bdb825ad0,
                    0x407c0c5a213b0b86,
                    0x03ae9bf29f45e238,
                ])),
                Felt::new(BigInteger384([
                    0x74b01217f949163a,
                    0x171de09b757ada03,
                    0x9026b2d7ccb5651a,
                    0x7f2fc5513d71e4a7,
                    0x95501547589743ab,
                    0x0f1151a84987734a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x845663df0dc81244,
                    0x5e239b15d0d88aa8,
                    0x50930da5c455fe9b,
                    0x241646dab61e3ea6,
                    0xb520f484df108aa0,
                    0x14aaf96e9e2524c8,
                ])),
                Felt::new(BigInteger384([
                    0xdfae70514b7b83f2,
                    0x44443821290bdb52,
                    0x1efbc1f799700120,
                    0x983c66e7f37b79fc,
                    0x9d2e5754da0a3dd4,
                    0x01f6d3dd01be0f8d,
                ])),
                Felt::new(BigInteger384([
                    0x0a9193629e437b5f,
                    0x99435612bf8092d5,
                    0x199629eb8d2f98d0,
                    0x45d90c6ecae37e7e,
                    0xfccf04cc549b0d00,
                    0x18778b0cfc0218a1,
                ])),
                Felt::new(BigInteger384([
                    0x020e8034c90b1b50,
                    0xb2c42a4c9a6775d5,
                    0x121720ce9d5649e3,
                    0xbd1638680181de05,
                    0x182ef82383fab5dd,
                    0x080abf685ff4102e,
                ])),
                Felt::new(BigInteger384([
                    0x77c04b18b35c6810,
                    0x820eefae66284b1e,
                    0x0dc93b5e86dd69dc,
                    0x7bdd8ad06713bde2,
                    0x06788a2c860837b4,
                    0x141378b9cd7bbea4,
                ])),
                Felt::new(BigInteger384([
                    0x884c45e8eb2018b5,
                    0xcc28a4fbeacc3b4c,
                    0x666ababa76a98b0d,
                    0xd56ebc95948f7d89,
                    0xc81a65bc5462e406,
                    0x019a742e3da965f3,
                ])),
                Felt::new(BigInteger384([
                    0x53159e4d23f53fce,
                    0xba56da2df0c91cfc,
                    0x3ac88f041b78df9e,
                    0x6140e6ec3a7f75d4,
                    0xae1141401195edc6,
                    0x0776628f3387cc72,
                ])),
                Felt::new(BigInteger384([
                    0xfaf7c4c26ed54578,
                    0xdb1093659832b50c,
                    0xf852b5e8ac32ce79,
                    0xc52a1df2348c5dad,
                    0xbcc2b6120576f8c8,
                    0x052003d0f8bf8c5e,
                ])),
                Felt::new(BigInteger384([
                    0xd7265d862b9b05a6,
                    0x4d1422f9f8210920,
                    0x784884234b04a1b9,
                    0xf2b7de721630325d,
                    0x424ff37f37999693,
                    0x003ba2064aa7730e,
                ])),
                Felt::new(BigInteger384([
                    0x55e983e6317134b5,
                    0xbffd739f03a3bccd,
                    0xfb2eca4c16e91e13,
                    0xfb988a01461b70fa,
                    0x8bab57e7e081372f,
                    0x17bf2c1ea0bb1124,
                ])),
                Felt::new(BigInteger384([
                    0xeb9b936ec63ab834,
                    0xc43d2324f61bf2f2,
                    0xfaef7f05c9825640,
                    0x1d9e0b74db0c2559,
                    0x4df08b896e6480bb,
                    0x16e13a2a3a38aa88,
                ])),
                Felt::new(BigInteger384([
                    0x3ee947360be9c10d,
                    0x2bc8344c8e6e1ed8,
                    0x4488cf3abc16958a,
                    0xbfc6eb7a8917cac0,
                    0x58830d6b5ef1be42,
                    0x17927426bd4d9fa9,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf239b8c5fa356f73,
                    0x2feb0f9ed64f4de2,
                    0xf14f7cbac2b30064,
                    0xa0259a51c8936d71,
                    0xd1902ca26c5c421d,
                    0x072f18d3c24d7d33,
                ])),
                Felt::new(BigInteger384([
                    0xfad3196b92c7007b,
                    0xead6c1b46dabe74e,
                    0x040f7fbf0d6d8da2,
                    0xc7481e1a173c4ad1,
                    0x675f3037e8fc2693,
                    0x035f8914e22b890d,
                ])),
                Felt::new(BigInteger384([
                    0x8f9d0dca4aa378cd,
                    0xb36653b619a7fc05,
                    0x8b5321dcb15951a1,
                    0x0e1b2e857be604a9,
                    0xd71f00d9b4fd8ec8,
                    0x1086bb4618f869f6,
                ])),
                Felt::new(BigInteger384([
                    0xfc9e846130a043ff,
                    0xc88f2c9e1bf0232f,
                    0xb965cbdd90d0e09d,
                    0xc2c773d01e0d0c17,
                    0xbf174062d6416040,
                    0x17f4f3777aad64c0,
                ])),
                Felt::new(BigInteger384([
                    0xefb52b02b70112d7,
                    0xc762e5cd8afc7a2b,
                    0x50be6f250c161e38,
                    0x6575e579d3b72d63,
                    0x4fea7aa8b229acd3,
                    0x0f194b8e81d59074,
                ])),
                Felt::new(BigInteger384([
                    0xe306517bce3d5034,
                    0xdf6ba618f5070d18,
                    0xe0d62dace29367dd,
                    0x4084306715fc2474,
                    0x2ad769d853bdfdf4,
                    0x1244f32124bbba79,
                ])),
                Felt::new(BigInteger384([
                    0xe38d8f530a24e9a1,
                    0xa31f3dfe4080a4cd,
                    0x83555b1349c9bf05,
                    0x0887cc0ea19a068e,
                    0xa0ff462989130f62,
                    0x122df0342d3813f3,
                ])),
                Felt::new(BigInteger384([
                    0xf8f5d17a181500dd,
                    0xa8a2058bbbc774b3,
                    0x80f9e1ea95dffe3d,
                    0xf210acfc54413fc7,
                    0xff23fc1db3795de8,
                    0x10243062b65421ed,
                ])),
                Felt::new(BigInteger384([
                    0xca55fa404597829a,
                    0x2539fc50927678ed,
                    0x0dc1bc1512bc80dc,
                    0x3bd3d25720a73466,
                    0x5b80d9f057aa880f,
                    0x0429bc556e58b98b,
                ])),
                Felt::new(BigInteger384([
                    0x99d598d64ac9fb74,
                    0x64406038f030a598,
                    0x76714476a59f0a04,
                    0x0a89b8c93ce496ea,
                    0x643903fbc9241573,
                    0x105c1236c69598b8,
                ])),
                Felt::new(BigInteger384([
                    0xbec1886355e1b562,
                    0xdb838abb389bb84e,
                    0x4309457c38b79211,
                    0x11f8f9ca6940918f,
                    0xf5780c0e022a4baa,
                    0x14967a86ab45bd02,
                ])),
                Felt::new(BigInteger384([
                    0x095b6a68215d9e12,
                    0x5ac7ca74b7ce8e51,
                    0xa888d7dbc61b91d9,
                    0x3b27d23018f7fc42,
                    0xa537e5fd553c9578,
                    0x06c90fc1ff6d4608,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
