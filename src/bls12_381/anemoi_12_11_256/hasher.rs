//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 47 == 0 {
            bytes.len() / 47
        } else {
            bytes.len() / 47 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 47-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 48];
        for chunk in bytes.chunks(47) {
            if num_hashed + i < num_elements - 1 {
                buf[..47].copy_from_slice(chunk);
            } else {
                // If we are dealing with the last chunk, it may be smaller than 47 bytes long, so
                // we need to handle it slightly differently. We also append a byte set to 1 to the
                // end of the string if needed. This pads the string in such a way that adding
                // trailing zeros results in a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 48];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 47 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn merge(digests: &[Self::Digest; 2]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        // 2*DIGEST_SIZE < RATE_SIZE so we can safely store
        // the digests into the rate registers at once
        state[0..DIGEST_SIZE].copy_from_slice(digests[0].as_elements());
        state[DIGEST_SIZE..2 * DIGEST_SIZE].copy_from_slice(digests[0].as_elements());

        // Apply internal Anemoi permutation
        apply_permutation(&mut state);

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        // We can output as few as 2 elements while
        // maintaining the targeted security level.
        assert!(k <= NUM_COLUMNS);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger384;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger384([
                0xad1b91e831a5d7d7,
                0xdb266c0740c7d77c,
                0x159602748179e561,
                0x8c0dc7d7243ed768,
                0x9e2892c58104af1e,
                0x183d765df3da447c,
            ]))],
            vec![
                Felt::new(BigInteger384([
                    0x31c4831aa612488c,
                    0x6d9a553dda6088d5,
                    0xbd7b34958d3c9ccd,
                    0xf7fcaef6bcc0683d,
                    0xa584a785072bad59,
                    0x04d843a01c3e8586,
                ])),
                Felt::new(BigInteger384([
                    0x87a890414816eb02,
                    0xa3742ce5ce830604,
                    0x4125493c1fefdfdb,
                    0x38b6d3ac6a304586,
                    0xd2255dccab8abf10,
                    0x12794d706219166b,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xec60ebc178d85b8a,
                    0xfd90d5d61acc8207,
                    0x47ff14fa5f3b86cd,
                    0x9bc4ace7de5b812f,
                    0x73c546490786b36a,
                    0x18ac2116d4981850,
                ])),
                Felt::new(BigInteger384([
                    0x806346e05f485175,
                    0x64af18791e681902,
                    0xf5381119ddc31b70,
                    0xb7456bb0489fdb80,
                    0x868ccbcee0316e6e,
                    0x0ad1f3b8d1d04a7c,
                ])),
                Felt::new(BigInteger384([
                    0xf3151d3dc325a8c7,
                    0x1766c33fa7adcd9b,
                    0x6985a987dbb1622c,
                    0xc940b73d1ea7c758,
                    0xd7965786d6827dd1,
                    0x0713186098e50ad0,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xa7a742c959c4e601,
                    0x9b7d6daf40993a0e,
                    0xdb938339abab0f40,
                    0x6d68bdd24e835728,
                    0x225993888c37d77e,
                    0x10941a3e21282650,
                ])),
                Felt::new(BigInteger384([
                    0x7df83ba070a2eec7,
                    0x34c0892bf41bdd30,
                    0x1a7a9780e58839a7,
                    0xf362c4a5058bc352,
                    0x36404965abe60f16,
                    0x060c2b8c0caaf259,
                ])),
                Felt::new(BigInteger384([
                    0xa7b8f2e2f87bd054,
                    0x856cb67339d9495c,
                    0x18c245e01a9b6273,
                    0xaaac9f49177769b3,
                    0x5c80de38a121035b,
                    0x193b39eeb677a856,
                ])),
                Felt::new(BigInteger384([
                    0x57dd832fd48be65d,
                    0xbdbaaf47bbd63dfa,
                    0x7d3011a436938c97,
                    0x9a0cf85cc8b5742a,
                    0xa94fd7aecf7fa68b,
                    0x0e50b4a849a6011c,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x6474c68e0b27e43b,
                    0x308c99feb7cade21,
                    0x6d940a513c7454d1,
                    0x3645bfd6ead6324c,
                    0x143db31fa47a6b4b,
                    0x0640a4fc160a45bc,
                ])),
                Felt::new(BigInteger384([
                    0x56cc5c0a310f7321,
                    0x5857762de8e8bc07,
                    0xa3aa592bc63b4713,
                    0x72e4227e411b6d66,
                    0x59ee2dbf25839baf,
                    0x1509b8ab18f16a42,
                ])),
                Felt::new(BigInteger384([
                    0x89e60c799eb4d5bd,
                    0x780c87b2b01e20f0,
                    0x5e7714365eba98fa,
                    0xbf52a9e2afc6a828,
                    0x92c8927a7073ca4c,
                    0x0c377f14bb0a19cf,
                ])),
                Felt::new(BigInteger384([
                    0x1eba2d792d750b65,
                    0xd9c0c6f9da4d7ea1,
                    0x227d48aa02dc0495,
                    0x02592920d5456e66,
                    0x36fec8ffeebc365f,
                    0x148fa5bb2f86fdd3,
                ])),
                Felt::new(BigInteger384([
                    0x1c286215e6822c6e,
                    0x7122374497b5ae86,
                    0xe157bc32224f7e37,
                    0x27207a9c0956f574,
                    0x9fc889f9ed777350,
                    0x0b3b928821bd3550,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x815829e44a3ad038,
                    0x13c3ebe8b710b635,
                    0xc2dd3b3eb5d8642a,
                    0x7ca3ef9fe5f16ea6,
                    0xaa2978aca028a713,
                    0x18d2da7d46112b12,
                ])),
                Felt::new(BigInteger384([
                    0xc2f408818e5daa33,
                    0x7a10d9f0d34cbdba,
                    0xd516fcc439cdd681,
                    0x6e3625ba4fdd83df,
                    0x4015c93262c5f7fe,
                    0x1974b05d57bde68f,
                ])),
                Felt::new(BigInteger384([
                    0xd4d6132cdf037bee,
                    0x98b4286ff5796c46,
                    0x14aaa3b423598bc3,
                    0x722c03872d074692,
                    0xf341cdf335027b09,
                    0x068960ec3362992e,
                ])),
                Felt::new(BigInteger384([
                    0x58bac30d0ab6fac5,
                    0xa8db3ec49d5cf772,
                    0xa5cc1ec033588b0b,
                    0x1ad8c6d72113c90f,
                    0x303b7aa4b3777232,
                    0x0c00889fe1d6a14b,
                ])),
                Felt::new(BigInteger384([
                    0xc40ef1a60214740c,
                    0xa304d274e0076dc2,
                    0x2921cb4213e59095,
                    0x6f1f4d2319cda5aa,
                    0x34b53abdcd5899cd,
                    0x06b5241fd3e06a15,
                ])),
                Felt::new(BigInteger384([
                    0x6d26c776a4841302,
                    0x89ecd7004032a1db,
                    0xdd59c7f1cbe4345f,
                    0x51318542be6a256a,
                    0x97a1332d7c41db8e,
                    0x0717a1956b996b96,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x1f6df9c82c9c2122,
                    0x09d08cacd32b2da2,
                    0xcb91331cff622efc,
                    0xec0c4cf3ebfe0cf3,
                    0x2f29f5e61cc45760,
                    0x15bb28ce5d4f726c,
                ])),
                Felt::new(BigInteger384([
                    0x987f7b75c0ffbf91,
                    0x5201fe057c25768a,
                    0x3bfba9a8ab83aa7c,
                    0xca1401bd25d182fe,
                    0x5e7cc5e387d99c76,
                    0x03c1ac776ffb9a20,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1f6b774a35b40412,
                    0xb60e16b4f96004e4,
                    0x583efa6cbb5869d2,
                    0x731ce03a078effe4,
                    0xadbbad765ba33901,
                    0x15e6c43216f2e6a8,
                ])),
                Felt::new(BigInteger384([
                    0xf6b976eabcb30840,
                    0xfa363bfd509c67cc,
                    0x14371aa3595057bc,
                    0x4968faaaef0a1059,
                    0xa80d861489817afc,
                    0x05d464b497a72e8f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x98f8130a82ec830c,
                    0x183b0c1fdab2c6ad,
                    0x58cab590e42dbdb6,
                    0x65a3d2d6ebdde2aa,
                    0x44d3632242fe7736,
                    0x12ee7007a87149d0,
                ])),
                Felt::new(BigInteger384([
                    0xccefc96dc00c16ec,
                    0x071a8796c835a4cc,
                    0x0e3c2292e8a4d30a,
                    0xece9db61493e6f4a,
                    0x15244976ac99aab4,
                    0x08cf47fea8931732,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5a81e743a18850c5,
                    0xe1e341f423f9126c,
                    0x3f615f25363b3b5b,
                    0x0d2b7eea93734f62,
                    0x6da211578761d753,
                    0x05fa2565889896d9,
                ])),
                Felt::new(BigInteger384([
                    0x82392a8ec3344a22,
                    0x13e3a58fddde4c16,
                    0x810d7f3317d4ae59,
                    0xcddc133990778585,
                    0xc7dfc877772cf45f,
                    0x1044c1e950876ca3,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8309c141979bef7e,
                    0xbbd6c61fc5650ad2,
                    0x9767a880befbeb0c,
                    0x95a8f2dc13677a4f,
                    0xfa87734b306de7db,
                    0x1153faf0ec4290f8,
                ])),
                Felt::new(BigInteger384([
                    0x43644737a2aa5fa3,
                    0x1f3171a60b109fef,
                    0x9a7ec55c58a78247,
                    0x32c3c1082d5bb951,
                    0x13db80a84d89b2cf,
                    0x17f34caa718753eb,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x203d55360f71a9b1,
                    0x9ab3a0941c9b5169,
                    0x755d52c54446e665,
                    0x97e038ea7d09d29a,
                    0x593c73ceb54bc15e,
                    0x0abb6976bd69473d,
                ])),
                Felt::new(BigInteger384([
                    0xb7c742a5e226ed88,
                    0x0b32e5725bb9ed75,
                    0x479fe5efef5e700e,
                    0xfe934dac7e0c33ba,
                    0x757eb252422f3ec2,
                    0x16a995a3c63d174c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x55eed8f3dd4bf41a,
                    0x365df05868d04d6d,
                    0xdccdfdc4597ac1df,
                    0xc26ffcfd7c63272c,
                    0xb2e7cf55569b461e,
                    0x068068c8e8785915,
                ])),
                Felt::new(BigInteger384([
                    0x4aa24f0a9c8bfa34,
                    0xe0debad43c3dbf3e,
                    0x933ada4948db53b6,
                    0xe579268930362e7e,
                    0xe0791c32a8b588c4,
                    0x17d0749b2ce01576,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x54e453626ee6e43e,
                    0x466106788d1904df,
                    0x01945bb1d31d7fac,
                    0x4744740aae2ee611,
                    0x49695d8a97b5988e,
                    0x106b27b3615a9eb5,
                ])),
                Felt::new(BigInteger384([
                    0x67b7bf5388387f84,
                    0x58264d34ef5d230c,
                    0xa4066fa1e37040b6,
                    0x5b89eded41c058ab,
                    0xce4836d5ac0eddf5,
                    0x003e3ee0bd50f442,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc21a1a210f3af9ff,
                    0x50b99befa61bdf46,
                    0x8f3c464ecf0b74ca,
                    0x2cdd194c6e7294d3,
                    0xdfeef14059b35d8b,
                    0x06b94268fe2e40a7,
                ])),
                Felt::new(BigInteger384([
                    0xc5e1d1dcff76c7ba,
                    0x509d47b7b2ec410e,
                    0x3a51c54b8ea4a5bb,
                    0x602426abb0c6a9d8,
                    0x594be7b5cb7a02eb,
                    0x17645bf053adf64a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x24532bc8b681b6ad,
                    0xd2d0f95353baef41,
                    0x533ae718c3784b05,
                    0xa8ade5b2f7b111f4,
                    0xd83e9d025620a589,
                    0x15e135bc7e3e8244,
                ])),
                Felt::new(BigInteger384([
                    0xf7d05d0b0fba03c6,
                    0x2a01ae86db476cd9,
                    0x41850d46b6315f21,
                    0x85fc2b0f66694f23,
                    0x22cb4f15212cbc7f,
                    0x0e27a260752f6c1c,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xea7d67d5efe6bd58,
                    0xd81ae82513fa3041,
                    0x8cecc003e42d72dd,
                    0x8976f3992833d36c,
                    0x10e3f123ba82503e,
                    0x1475eb86b1d8c3ff,
                ])),
                Felt::new(BigInteger384([
                    0x9c3be60ef606aef3,
                    0xbf64fd5db089c60b,
                    0x532f235c9eb41722,
                    0xd8b086191508d5e9,
                    0xbade3b24d5f7d8b9,
                    0x1957b57a0dffe727,
                ])),
                Felt::new(BigInteger384([
                    0xd2f7b729b1061d8e,
                    0xdfc08ebc459670e3,
                    0x1206c620baa5dff1,
                    0x66a722c4f941bec7,
                    0x8d8a2a3d81379eca,
                    0x18b3245aca062143,
                ])),
                Felt::new(BigInteger384([
                    0x5aecdf37a54062bf,
                    0x01c2d520a56198ff,
                    0xd7b0210be0676003,
                    0x17f8274b25da4cfe,
                    0x1c495a78bcf92b27,
                    0x06e38e4cf2c16d91,
                ])),
                Felt::new(BigInteger384([
                    0x8c25654fca2ea27d,
                    0xbb0db82cf6013a22,
                    0xe1c7596901430bfc,
                    0x23fec9950d290e8e,
                    0xa43bb7d7ad4bef8c,
                    0x191d13929f700c33,
                ])),
                Felt::new(BigInteger384([
                    0x8bcea66b3fa668a4,
                    0xfdca73cfbfeeea48,
                    0xa494cb355eb053da,
                    0x91ca21902749b39d,
                    0x9aa296ce4b3394ac,
                    0x0dd6d90a01baa67f,
                ])),
                Felt::new(BigInteger384([
                    0x3de34a469ede3c37,
                    0x6a94cae9b7c5c28e,
                    0x1012ba7ab03fea63,
                    0xccf82df27a2e6196,
                    0x37cb2ab8051a9eff,
                    0x1474263c53298c74,
                ])),
                Felt::new(BigInteger384([
                    0x07b72a30d8b4a5d5,
                    0x16a0f8ce587c4d0a,
                    0x6dd05a84827045dc,
                    0x4c70a4fb83bdfdb1,
                    0x6e3f2ce7a8f08729,
                    0x1943a0a09d1b9e6a,
                ])),
                Felt::new(BigInteger384([
                    0x058dd37e3cde25f3,
                    0x67424a3849f61b33,
                    0x6e87d4f7318cae37,
                    0xa6510292f4e5311c,
                    0xf8d6a4abe9d15bd9,
                    0x106f00668d45b0ab,
                ])),
                Felt::new(BigInteger384([
                    0x3d12d17a1ed5e4e6,
                    0x09016cab9ecddc72,
                    0x18760dc231a3bb53,
                    0xe1583fe60a014e34,
                    0x6f258d18ab31318a,
                    0x0793be50c9c2f776,
                ])),
                Felt::new(BigInteger384([
                    0xedfa0e9316e60426,
                    0xddefa027464fbe95,
                    0x3daf3ed9b44e91db,
                    0x11c857879ed07af7,
                    0xc69c226d3fd7cf3d,
                    0x05d0bf406a9ba77b,
                ])),
                Felt::new(BigInteger384([
                    0xdf3cced43bfb7ebb,
                    0x97f2f6e3f16514bd,
                    0x1caad23e235d138a,
                    0x00ce98c00215fbcb,
                    0x34b0c2c2fe896ef6,
                    0x12f58c338987d6ed,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x3be5911ab59147aa,
                    0x2ba4427b3c7c89ed,
                    0xcf257a078660db9b,
                    0x601322422a2b5e70,
                    0x62782a7f04a03f3e,
                    0x06b189405e923c45,
                ])),
                Felt::new(BigInteger384([
                    0xac459ff03ae95fb9,
                    0x2d5da13c45eb4624,
                    0xf5cbe2af6837c9bc,
                    0x48567260379049d7,
                    0x22da2aad4d783ab7,
                    0x0f883c523306b27b,
                ])),
                Felt::new(BigInteger384([
                    0xee878aaac22d20cb,
                    0x25e2e6b0c4d10587,
                    0x72407a20dd94d5d9,
                    0xead0d839b12ada71,
                    0xff3411e4a0214206,
                    0x19772a1efd3173c5,
                ])),
                Felt::new(BigInteger384([
                    0xc52efb6fb4087db3,
                    0xc11951c9a303638d,
                    0xb948bab9159ff773,
                    0x614dd89f8ae0bb74,
                    0xb88603bb3e7a56d1,
                    0x129e3c5444febada,
                ])),
                Felt::new(BigInteger384([
                    0xef2a35a11ce92388,
                    0x688ed8ff01143ca8,
                    0x724fbc3b6da73be4,
                    0x0721984a2f3b1283,
                    0xbb695c7d90f853d4,
                    0x1357f54aeccd8cea,
                ])),
                Felt::new(BigInteger384([
                    0x3188b97fa3b1cb75,
                    0xf66e8bf7fd6cb2ab,
                    0x59acdad52cf768a0,
                    0x84ffc395f081690f,
                    0xfa817ea5d1843b67,
                    0x18c0a3c9bfd25223,
                ])),
                Felt::new(BigInteger384([
                    0xe1a4a63131021f37,
                    0x2bc94639a03c715b,
                    0xe60ea346c23c2468,
                    0x42abf0e971daab2a,
                    0xb5b0a5d5e158714b,
                    0x14677e90306c397c,
                ])),
                Felt::new(BigInteger384([
                    0x65bcbfbafd1c262a,
                    0x04c96f54e45f67a7,
                    0x082706dd7fbc21a9,
                    0x8d6f4a30632165bc,
                    0x5a7e69c382fa15ad,
                    0x18ddbf91500e7280,
                ])),
                Felt::new(BigInteger384([
                    0x3213ff50e13833ba,
                    0x0ed8d04a78e57c12,
                    0x8741b4e6471ef152,
                    0x6d767eb87ecfa9c0,
                    0x6475003ad8eb0ad0,
                    0x133196087015ea02,
                ])),
                Felt::new(BigInteger384([
                    0xa822b5db43ace989,
                    0xf81c723f85560024,
                    0x87e787c0c56b44ce,
                    0xb0984ac6952f8904,
                    0x67615ed6f54eee9a,
                    0x18f2c62b4db52ae7,
                ])),
                Felt::new(BigInteger384([
                    0x916fcf70d92db4a3,
                    0x66050d9078b1b5ef,
                    0x18b493e169efd48d,
                    0x0435df952355eeab,
                    0xb7b8d73d6a89d513,
                    0x0011416d2ad8cde7,
                ])),
                Felt::new(BigInteger384([
                    0x58f9a6a7b36ccfcc,
                    0x9928c23283b6752e,
                    0x84623262ee8f4bb6,
                    0x7ee4cb992e10d3ed,
                    0x60246a0b4c57bc67,
                    0x10500c3a962b1df2,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xb9fcd90e6f683b92,
                    0x5a824623cef3a404,
                    0x9db8f941216d8e4d,
                    0x6adba86ed4cdf050,
                    0x2a64c58a7968cf5a,
                    0x0ef923bcebb79ffe,
                ])),
                Felt::new(BigInteger384([
                    0xf22ded8e9c3e7890,
                    0xd0e7e9405aeba7dd,
                    0x9166807ce401fbf8,
                    0xdcdcd7dca9a92d8c,
                    0x119ba5c626fd505f,
                    0x0a65fdfe3a935e5c,
                ])),
                Felt::new(BigInteger384([
                    0xda9c1f5b0b3b9e1d,
                    0x0587e6d3962366a0,
                    0xd9cb73f4d0197dd4,
                    0xcd003f658b681c32,
                    0x74bc3bc7038f9751,
                    0x04c4e589df489c2a,
                ])),
                Felt::new(BigInteger384([
                    0x7dc80a1febe918af,
                    0x7e08e33d4a6436eb,
                    0x8d0f0fe016bce5df,
                    0x0a01cd6090e9de96,
                    0x0365a0b1bc162593,
                    0x12f21d65d6084b6a,
                ])),
                Felt::new(BigInteger384([
                    0x2606b76663c42d0b,
                    0x30f8f94f95b38f82,
                    0x6d270c9f49bb740a,
                    0x4578c10b2b83188e,
                    0xa257e0e89503c92d,
                    0x117afc8a5a2b876d,
                ])),
                Felt::new(BigInteger384([
                    0x5f78d08cde9b184d,
                    0x6d97fc9114660682,
                    0x1ba0ed7047a2ba7a,
                    0x01bc5780819034a8,
                    0xa98610f73108b3b1,
                    0x1631212c0aac17e4,
                ])),
                Felt::new(BigInteger384([
                    0x054bbba2baeb3c0d,
                    0x82d8c2780b4da9dd,
                    0x71bfe616b08a310a,
                    0x48a0abf7cb691ff7,
                    0x69456450112182d7,
                    0x194ae84497650d38,
                ])),
                Felt::new(BigInteger384([
                    0xf8d24b109fd12858,
                    0x1429d1a405d82749,
                    0xc1ed0628084d0342,
                    0xa0973ea32b7147ea,
                    0x305b82cea97c375e,
                    0x02079a603ef37897,
                ])),
                Felt::new(BigInteger384([
                    0x78ea8c3c98f6fff1,
                    0x6c5e9b5f45b40e60,
                    0xb318f4c4f4616652,
                    0x772cc3ad29ddef8d,
                    0x8af094f651051b51,
                    0x113851bb8d066bf9,
                ])),
                Felt::new(BigInteger384([
                    0x9355a82a2bde6595,
                    0x2d89e1a4b7516d95,
                    0x984812e63bd38728,
                    0x7ca198c4451aee9e,
                    0x3263495e14d76810,
                    0x0a994b0d9a127df7,
                ])),
                Felt::new(BigInteger384([
                    0x5280fca1fdf34874,
                    0x1c2187405bf8a82c,
                    0x3e0d2fd41f71416e,
                    0x958ee862637e38ca,
                    0xfba544eee19b1d61,
                    0x0cd738135eb2bfe9,
                ])),
                Felt::new(BigInteger384([
                    0x1dfc835f3fe6b7ab,
                    0x5ae5be9a07b57700,
                    0x8874fd95de0def90,
                    0x200829ad31fd6f3e,
                    0x17ba76715b7bac34,
                    0x041503076d4122ee,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x7e1037c682db8b0e,
                    0xb1623d89e922e043,
                    0x079664a3d55f4d87,
                    0x411b23701b73814f,
                    0x23e7b9f1c9a97cd7,
                    0x059b019298a5c7fe,
                ])),
                Felt::new(BigInteger384([
                    0x97c571b682419dc3,
                    0x81587c4ba380d3f1,
                    0xb510388fa38c83f1,
                    0xc52a41dfec34d9a5,
                    0x10c1d9810daef936,
                    0x0bc3ab65adeb33f5,
                ])),
                Felt::new(BigInteger384([
                    0xfe7df406241bbcf2,
                    0xf9647a7ed046c37a,
                    0xc27dc5e430f5a673,
                    0xbd71475842d4df42,
                    0xc4632cca7151b759,
                    0x05928a6e890088a9,
                ])),
                Felt::new(BigInteger384([
                    0xd171418ed43a8787,
                    0x36958db25ade3f15,
                    0x9d070ee98ccefe8a,
                    0x7f15611025490edf,
                    0x9a13ae7505b1c598,
                    0x0f2b4cc25a5e5919,
                ])),
                Felt::new(BigInteger384([
                    0x506ce53a5172baaf,
                    0xb610b2c56db3c35e,
                    0x29d342377ef25620,
                    0xc5412b592f5719f4,
                    0x75c56d746c9c4f5c,
                    0x0420ea41922207b4,
                ])),
                Felt::new(BigInteger384([
                    0x2a240e277215da40,
                    0xc5b4da3d3741a525,
                    0xaa396253e806acf3,
                    0xed21f51a5b51c772,
                    0x3b80629a81d0fb93,
                    0x18ce9af84a8c5a45,
                ])),
                Felt::new(BigInteger384([
                    0x182f06e6b0552b66,
                    0xecea8b6c7a175752,
                    0x93d14eb26ebd669d,
                    0x2433126dbe7e91da,
                    0x3226e08da9177e0c,
                    0x052965e085cec643,
                ])),
                Felt::new(BigInteger384([
                    0x387a33404b64c6d6,
                    0x91bab6f338dfa06e,
                    0x8342ad7cec812344,
                    0x71840242512fc6cf,
                    0x9e0b475c06e6b9c2,
                    0x128b82615854009a,
                ])),
                Felt::new(BigInteger384([
                    0x0eb9e2b882e7143a,
                    0x279578f14ddd0925,
                    0xf011fc076f47ef23,
                    0x6ad8ba7e64eba672,
                    0x3034243e74b92a0a,
                    0x0bc101c0532607eb,
                ])),
                Felt::new(BigInteger384([
                    0xedff307ac3ec53b4,
                    0x564306838cfe6233,
                    0x81c94436b0cc74df,
                    0x8dcf431f57328a99,
                    0x466514f704daaafa,
                    0x0a51fc6111440088,
                ])),
                Felt::new(BigInteger384([
                    0x9f5e4194b5259a8c,
                    0x6497d91c1f77b6be,
                    0x7e84c8b59fa16d70,
                    0x3a55f7e901408ce7,
                    0xb316847284ef528d,
                    0x049992b08dd83f8a,
                ])),
                Felt::new(BigInteger384([
                    0x95bd8138623d16aa,
                    0xb82766fb5eb4702a,
                    0x78ae06673b719fae,
                    0xa066569138a17e32,
                    0xbccc2463a479fa62,
                    0x0e8577aa36ac50c2,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x2cc1d1826c4d49b9,
                    0x29a3b5a9dbcf7657,
                    0xe6eef87c073687d7,
                    0x3b35900ec190aef4,
                    0xce00b3750cca3f5e,
                    0x17240fac0801c572,
                ])),
                Felt::new(BigInteger384([
                    0xed6fc28ffd86d6b1,
                    0x69a2259052ef73ab,
                    0x4cb2102d0dc26f1f,
                    0xde74c1f6a53c1148,
                    0x648060ce47477446,
                    0x11b0fd2fc72bbc45,
                ])),
                Felt::new(BigInteger384([
                    0x50cc481327992ed4,
                    0x0e56dfcdcac7564d,
                    0x29a5147c66b94cb0,
                    0xa808acfbb45da096,
                    0xdae1ef9abed179f7,
                    0x183da3ec370f10cb,
                ])),
                Felt::new(BigInteger384([
                    0xefd5e53fb0bbbab3,
                    0xf72a271b7c16ae74,
                    0xbc210ddd9d1e742f,
                    0x0df00cf0d80fcbe4,
                    0x44536989b33ee65e,
                    0x0cc5a6cd69a489b1,
                ])),
                Felt::new(BigInteger384([
                    0x004eedd6ea95a377,
                    0xa28b5ff34d482e9c,
                    0x7f6df28001c12f9d,
                    0xdbc8ec27fddec26d,
                    0xeb1c4cfee5c26939,
                    0x018c57732c5cd1c0,
                ])),
                Felt::new(BigInteger384([
                    0x8cac57e0cd6fce20,
                    0x0abce449e37a418c,
                    0x9965dd8ad7eac37b,
                    0x7c7c6e4921a4b0fd,
                    0xad463484b3cca2e5,
                    0x0606d2a6d9b7ca7f,
                ])),
                Felt::new(BigInteger384([
                    0x2a045dfd936e9e72,
                    0x9e8948473545e52c,
                    0x0522d968c91c6b00,
                    0x3ef85c0074c41378,
                    0x70b92f0fd519fde7,
                    0x17d0f6e9b880062f,
                ])),
                Felt::new(BigInteger384([
                    0x8e8777b3a3f03335,
                    0x5df4616266a567ca,
                    0xccf0ed4c13e66e41,
                    0xcca292d371212646,
                    0x3c4858423826d0f0,
                    0x185421dacf5b9856,
                ])),
                Felt::new(BigInteger384([
                    0x3ce775f3241fdc65,
                    0x402584ddf36be433,
                    0xe8c540d4319172cc,
                    0xf2cd27b0d7964701,
                    0xc0b1b46e134d4e86,
                    0x0ec4b6c4c4c71cc4,
                ])),
                Felt::new(BigInteger384([
                    0x945e420e0d2604ba,
                    0x555feabb79148f14,
                    0x0dbd4fefbfa63016,
                    0x1436dca08a92fe73,
                    0x2d2dcdf04c9d5351,
                    0x020f5a81a0aac685,
                ])),
                Felt::new(BigInteger384([
                    0xafb5d862661bc983,
                    0xd30b25a3c88b8619,
                    0xc368435a84a266a2,
                    0x418fdefa197e4fc8,
                    0x75aa32c216e68410,
                    0x14a8955d6500cdbc,
                ])),
                Felt::new(BigInteger384([
                    0xe98896839d2a69ba,
                    0x67e439e67b496553,
                    0x37c94697255589a2,
                    0xf3c0b7cc8610fb75,
                    0x9bdf799654a23f40,
                    0x09f46b1c84db9975,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x10c35a1e9958e9a9,
                    0xa761ffd3adf4ab2c,
                    0x5b2e3d4e1c1ba8e0,
                    0x5eea01a7268bce69,
                    0xbc758622c3674864,
                    0x186a6740740208c5,
                ])),
                Felt::new(BigInteger384([
                    0x5257dfeac1b4fa7c,
                    0xa40b025a0d89faee,
                    0xaec3e079b76b9c0e,
                    0x03eb8050d71b2962,
                    0x3b91404a9678ac4b,
                    0x1432c6427a301f4a,
                ])),
                Felt::new(BigInteger384([
                    0x2acfb7eca847ddce,
                    0x9482a6de98943a50,
                    0x508cfdb0d308065e,
                    0x92b7d6423c912c12,
                    0xfef808affdc0cde8,
                    0x196157f3a0186ffe,
                ])),
                Felt::new(BigInteger384([
                    0xc57aae00e1fc0d68,
                    0x27ddf608647ce9e3,
                    0xad9bbe95d11a41a4,
                    0x8bf8fbcbd2cd6295,
                    0x4f99868778e59d7f,
                    0x06e3c843a383a028,
                ])),
                Felt::new(BigInteger384([
                    0x08d0fcc5161f7adf,
                    0xc2c3efe36241c7f8,
                    0xa592c61f9f8fd179,
                    0xfa132ec37ea47e90,
                    0xae90297fd66f9178,
                    0x082cf7fdefb1af8b,
                ])),
                Felt::new(BigInteger384([
                    0x5fab6c1037c1774a,
                    0xda2bcb589ea9724c,
                    0x5be1bc819dff7342,
                    0x1f8e8ffe276de1fe,
                    0x24787601aeab10d2,
                    0x0ce53bfa7c774dea,
                ])),
                Felt::new(BigInteger384([
                    0x0f3cbf9d929f3182,
                    0x0d523989f17ca3a4,
                    0x20bc6734e9eaa233,
                    0xd7981475a4d5ef43,
                    0x0e4153b8b12f895d,
                    0x07195e6494ec1ebb,
                ])),
                Felt::new(BigInteger384([
                    0xcdfe55b4bcdbc84c,
                    0x92c6d8fd4279aacf,
                    0xfe484983a91828b1,
                    0xd9f46d3485ce54ab,
                    0xe2bab737a428f2b2,
                    0x1474ee9170909b1d,
                ])),
                Felt::new(BigInteger384([
                    0x927c61fee7c729cc,
                    0x4e1106b37d523431,
                    0xac66d892463be9b6,
                    0xa10148117101270d,
                    0xda3c5fe9e533306f,
                    0x0213b0a6e5e3b45f,
                ])),
                Felt::new(BigInteger384([
                    0x2a830b04564b4236,
                    0x4f329810766b2e3d,
                    0x99a773316e2e056c,
                    0x3ffe3374ba88a0e2,
                    0x1a5d6d59ea919a1a,
                    0x06efab27e673b213,
                ])),
                Felt::new(BigInteger384([
                    0xac7a11f97e6ea66e,
                    0x8d1750fcf98ffa13,
                    0x8e2e71fdb4059cd5,
                    0x8386ffaf95ebf7a6,
                    0x3da6108f1bfe268e,
                    0x07a5ba7fa34475ea,
                ])),
                Felt::new(BigInteger384([
                    0x16154dea562ea99e,
                    0x961356ef446b7c11,
                    0x2e3cc7bbb89b737e,
                    0x17d87f00da0398b7,
                    0xb872d73e71af07e5,
                    0x074865eaa7f137ff,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x11431fe7dc3f3233,
                    0x208f40f875f85804,
                    0x45c5109f196eb576,
                    0x689211cc6f8333fa,
                    0x90853cfadde405cb,
                    0x0e7a76927bb9eed8,
                ])),
                Felt::new(BigInteger384([
                    0xb775499bec6ffa03,
                    0x63e294f207569269,
                    0x95d586a957f71451,
                    0xcdb2e29147fc63e8,
                    0x000a2048f91667b5,
                    0x0b6702b98ee56b0b,
                ])),
                Felt::new(BigInteger384([
                    0xbb424fd69e31ab8e,
                    0x6be6d59bd510e3bc,
                    0xb7e63707d7e6abad,
                    0x7fd6a57945f8fa1d,
                    0xe3889fe685f8d87c,
                    0x06e654317903d900,
                ])),
                Felt::new(BigInteger384([
                    0x31051c4dcf57700e,
                    0x6e8db3a2316d0126,
                    0x00db826f8d0fd4b2,
                    0x4aaf6f15428092a8,
                    0x6dd3e9bd69a86bab,
                    0x073d7e17c4f39475,
                ])),
                Felt::new(BigInteger384([
                    0x5cf6dfaedc62cf27,
                    0xd7b0399f6319fb89,
                    0xc59d5bccc40e1b36,
                    0x914faf041db6e7d2,
                    0x467aed473f9bc047,
                    0x13e15002c5d6c90c,
                ])),
                Felt::new(BigInteger384([
                    0x9bc5bd2e2353eee9,
                    0x4b0bca046657283a,
                    0x036243d3ed7d7c4a,
                    0xeac5fe021ffd2f0e,
                    0xcc9ff19fc1e90f29,
                    0x04e808b57b33155c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5e0a965a1b0576bf,
                    0xc509ffa89d887e6b,
                    0x8432b30ba97356c6,
                    0x56495e9a37cdbe48,
                    0xbc55c545ef34bb7e,
                    0x15cbb7d8de374d3e,
                ])),
                Felt::new(BigInteger384([
                    0x516fe0539819fd98,
                    0xdfd749e98c4c256e,
                    0x9ed0082e19b56a4b,
                    0x2677d4ab3a2ed461,
                    0x4556705e6da66bad,
                    0x0f1ef9deab1b4990,
                ])),
                Felt::new(BigInteger384([
                    0x5ee2a5f26dc52a76,
                    0x8c7d410669980686,
                    0x343b6785006d6dca,
                    0x405dded2c7b513b7,
                    0xbc10d15fa9476b83,
                    0x11ada5e1996294eb,
                ])),
                Felt::new(BigInteger384([
                    0x34929e46301e16d1,
                    0x98cebd7cc913736f,
                    0x576b323341d748c4,
                    0x7692313c14f944dd,
                    0x7818753f69c03e99,
                    0x0ac6c77a437bf8ce,
                ])),
                Felt::new(BigInteger384([
                    0x28485cc20d51957c,
                    0xa3079df3d994b6b3,
                    0xff7baf061edf9fab,
                    0xe802341a9656583a,
                    0x90b3c84efc1b57fb,
                    0x1065c5076cf48a33,
                ])),
                Felt::new(BigInteger384([
                    0x3f424672210f2ec4,
                    0xb8266bcdbebdae90,
                    0x0ec74d563aaa8506,
                    0xdef2204b0729937a,
                    0x6307145d6cde12f3,
                    0x154708e2220b3cde,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2ebd0c2875909f84,
                    0xb788bfedfe60a4b7,
                    0x5b86784dbee7b25e,
                    0x0460b582587bf2b4,
                    0x081faddfc252df09,
                    0x11356bcfacf8bf32,
                ])),
                Felt::new(BigInteger384([
                    0x6038383bdd6847e9,
                    0x95f1eede6ecee32d,
                    0x7721b60ecfdf4515,
                    0x4d77ec4745deb056,
                    0xf7540d4675c31fd4,
                    0x18b4ec99ef3677a1,
                ])),
                Felt::new(BigInteger384([
                    0xc2cd98e04a618ba5,
                    0xc7ae3848a3e76d51,
                    0xcc4cfb605fc93e82,
                    0x18ae357a2da5bcfd,
                    0xd52a9c75691d66b4,
                    0x0b99ec1822f256cd,
                ])),
                Felt::new(BigInteger384([
                    0x5a2c7a7bcd9df797,
                    0x3943b17f3187701e,
                    0x874474a1f61667c6,
                    0x577d1d8afe939c23,
                    0x499e01e8b84c0b69,
                    0x0ebf35ca66d38186,
                ])),
                Felt::new(BigInteger384([
                    0x7a8c4ade9f8c722d,
                    0x3532dd3f3d9d6a31,
                    0xa409649a3383a636,
                    0x5a4ca84830523bab,
                    0x7bfa45198f0a878c,
                    0x092b2180c69ea79c,
                ])),
                Felt::new(BigInteger384([
                    0xf335dd4d284da0bd,
                    0x2888c11f88b85a26,
                    0x1af2ca4e3d57b113,
                    0xcb2bd0faa37ca1f1,
                    0xcbc80fb9b95f2d10,
                    0x006718c06d8b9dab,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xfb6f4e1c885b9908,
                    0x8d440b9896cad4c3,
                    0x565fc8eefc2fbdb7,
                    0x60ccb26548ca3def,
                    0x163c63a12a165c5a,
                    0x04b36cb9bd541ede,
                ])),
                Felt::new(BigInteger384([
                    0x21a53769ae2387e3,
                    0x3a357e114d19538b,
                    0x31930eb280373a9c,
                    0x2acf4b7d753742ba,
                    0x79d4f2b15934e8f6,
                    0x0d6a2e220107f1a5,
                ])),
                Felt::new(BigInteger384([
                    0x6aa478563399b789,
                    0xae14107ae8fdbf71,
                    0x2928dc4e97a6dec1,
                    0x4dcd414c4aadc5b6,
                    0x085688ee7da2c15e,
                    0x1919af0a9b8a1f44,
                ])),
                Felt::new(BigInteger384([
                    0x6043d981abadc5dc,
                    0x216ad3c6cb57bf93,
                    0x8b5665712381d6e8,
                    0x11b3f25cc117c7c4,
                    0x82bd5da7f798673e,
                    0x08e1a6d2446f2025,
                ])),
                Felt::new(BigInteger384([
                    0xb144ac6b61d5e6af,
                    0x4b4744319c8eff3f,
                    0x89ce29a96b68b5ae,
                    0x73dc2de6a94e2d79,
                    0x074801667f422322,
                    0x0aa9df823bb5c880,
                ])),
                Felt::new(BigInteger384([
                    0x8070df25afceee27,
                    0xab296b4d1d90229b,
                    0x122428fe19fdbc5c,
                    0xc578a1b8ca4ca5e2,
                    0xec930379903bdaa1,
                    0x0ce13dcec5aa24a2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x9167666ea1c80083,
                    0x5017e10cf10cd8d1,
                    0x6135a046c1cf4321,
                    0x4fc8535f006f546c,
                    0x9f5ab10626016500,
                    0x103a0463e1f48f44,
                ])),
                Felt::new(BigInteger384([
                    0x75247790d0caceb4,
                    0xc35854060f8dc1a7,
                    0x0db86f72d7e309ee,
                    0x037988a78b05a61d,
                    0x4abd75c1f4af364e,
                    0x044c4df269d598df,
                ])),
                Felt::new(BigInteger384([
                    0x8a473e43b38aa116,
                    0xc9ca2a5f3718231b,
                    0xfcdb3e63b441d417,
                    0x2519b21b09970a2e,
                    0x3bd081fb5292034f,
                    0x059c7fcde0da6bfe,
                ])),
                Felt::new(BigInteger384([
                    0xff1847b45266b73c,
                    0x178d341aa5a48817,
                    0x050d817620dd7edd,
                    0x93074bb2bea35c7a,
                    0x7f5dc0c0d14cf219,
                    0x104e6f300c5d833e,
                ])),
                Felt::new(BigInteger384([
                    0xc56c30f073efff06,
                    0x23e85081f5fa1706,
                    0x984c93ce0e58c390,
                    0x11c22cd2482d979b,
                    0x63c85a2846100f28,
                    0x01ae2928ba95e010,
                ])),
                Felt::new(BigInteger384([
                    0x1e3193dde2ccb89e,
                    0x78aec9f8a35a9080,
                    0x808b91c274657c8d,
                    0xe4c009178ca34c40,
                    0x6e0c10a0415be12c,
                    0x06deb09e84b5b37d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8ea1f8dca177dc43,
                    0x1177190f1f579f04,
                    0xb07f1c8fffd2f48d,
                    0x257f3bafe976c226,
                    0xff1f2cc832e90ce9,
                    0x00b23be55f0cc4f2,
                ])),
                Felt::new(BigInteger384([
                    0x63f966ba40cceb0f,
                    0xbe00b231ccf27f76,
                    0xbe2b35ef516aab6c,
                    0x4097c10fd5f8c39a,
                    0x08722ed56f628f74,
                    0x1221d708a30ead47,
                ])),
                Felt::new(BigInteger384([
                    0xe2e51fb74b19b88e,
                    0xa9cb4eceed631d93,
                    0x8cb55886225eb597,
                    0x67a6a2e5c473f41c,
                    0x2a0302d37388a426,
                    0x0d2b4490ee7f58f0,
                ])),
                Felt::new(BigInteger384([
                    0x3a1be21f68ca8870,
                    0x4ce0df1a9d6a9760,
                    0x236904a6d7ccfa0f,
                    0x5ffb9879e06f12c8,
                    0x07eb068efe24105d,
                    0x093169118047c966,
                ])),
                Felt::new(BigInteger384([
                    0x37b16869783ba341,
                    0x053f69f386379e71,
                    0xfd8af5aef69b81f4,
                    0x5b302b79435c8c9b,
                    0xda360ab2de7e115c,
                    0x1089207c08d6bcb1,
                ])),
                Felt::new(BigInteger384([
                    0x1be4dbeae5814664,
                    0x225bd6ba6306697b,
                    0xaef0871c2bc0a97e,
                    0x926e86f8aad3b131,
                    0xf217535054b6fcdd,
                    0x014ad8a71e4c9930,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x602e147ec4b6436b,
                    0xeb61c7bcf3a49311,
                    0x41bbdb43e3b05118,
                    0x6f05e2a857b577a5,
                    0x8d657a149eeb72a4,
                    0x17dcd0b702987467,
                ])),
                Felt::new(BigInteger384([
                    0xc938d2ec03c8e504,
                    0xfe8fbb3eb4e6ceeb,
                    0xcff8f27ab9fe0224,
                    0xad8c7d93abdcf14d,
                    0x85f30f80c40bb98a,
                    0x0df4121933627e65,
                ])),
                Felt::new(BigInteger384([
                    0x0ab9c69095a64a11,
                    0xe63f6b43820aea8f,
                    0x3e6922ea71c60dba,
                    0x67b4f36c7b351285,
                    0x0f8d3d925bb83afa,
                    0x06c033f3ded47800,
                ])),
                Felt::new(BigInteger384([
                    0xd2194aca6c76a939,
                    0x3d8004ef3d75d665,
                    0x09f33b9699c9b9de,
                    0x0249c8b8d70ac8db,
                    0xafb247cabd62115c,
                    0x0715fbdccbc3c2b5,
                ])),
                Felt::new(BigInteger384([
                    0xc0fbfb4498d2c454,
                    0x047f9f2c5bad6faf,
                    0x06c6156f22a90456,
                    0x197d4accedcde4c9,
                    0x4d83cbcf838d25f4,
                    0x0930104a115b021a,
                ])),
                Felt::new(BigInteger384([
                    0xe8adc4341f94058b,
                    0xde4a49666962e166,
                    0x789cfa66df15b923,
                    0x8358b722f8df6e33,
                    0x157fc3d0a0adbdf5,
                    0x0e7f485ee3c7246e,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x45e87b994e629aba,
                    0x9013116ae7ffb323,
                    0x5069efd8e365a59b,
                    0xfea836817b361f9a,
                    0x15af538579fd8af4,
                    0x06489eb7ee863926,
                ])),
                Felt::new(BigInteger384([
                    0x462a508cfe7535d7,
                    0x70f8e9e273ff3b73,
                    0xacdcd2f750b4e609,
                    0xad35c6245c73fae9,
                    0x21d0c98d1fd0e5ef,
                    0x0286e564f9d8e3fd,
                ])),
                Felt::new(BigInteger384([
                    0xce765bc48592161d,
                    0x9b2687609e698fbd,
                    0x4f4723820698d4e1,
                    0xb004fe1f6cfc02f8,
                    0x5a5c132a8b72bcc9,
                    0x17ee10a63220f1d2,
                ])),
                Felt::new(BigInteger384([
                    0x8d3422f2f9bc341c,
                    0x467f364539bfdad1,
                    0x3f00dacb469d713a,
                    0xed8d8986320dfe06,
                    0x7e37a24979513745,
                    0x077276c070a860f5,
                ])),
                Felt::new(BigInteger384([
                    0xbfb99ac63f6d4bf6,
                    0xc9250e088b7a3e69,
                    0x1e5b809e14f0f765,
                    0xdfab61c14ebcdc42,
                    0x9142db7ba3d59778,
                    0x0623b7c6a69eea16,
                ])),
                Felt::new(BigInteger384([
                    0xdbb8eae7fd0ea346,
                    0xd828271e97d05a98,
                    0xbe23ee0bebbcef87,
                    0xff68916e035c8b6b,
                    0xa020cff44a2cd324,
                    0x15d85279a4b9c0cf,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5380b0913c1461b1,
                    0x9c6589be51656bac,
                    0x16a8ab1cf035961a,
                    0x7c3e09adf6023511,
                    0x28cd5b3ff0c65538,
                    0x186fd7c19748762f,
                ])),
                Felt::new(BigInteger384([
                    0x4a02bb93fac4b838,
                    0xb38b83e174c79d26,
                    0x79913eadb8b62763,
                    0xd21471392e5a74ae,
                    0x1623b6e9e104c256,
                    0x03740ff2befe2145,
                ])),
                Felt::new(BigInteger384([
                    0x598e45ea20d69df5,
                    0x5948ca62f5f9f761,
                    0x987bce3065df54e1,
                    0xc27775ffdecbff2a,
                    0x19a0df46f897eedd,
                    0x0f4648187f3bf721,
                ])),
                Felt::new(BigInteger384([
                    0x16ffee12a0db0928,
                    0x30c6f263d0641c84,
                    0x732f2d276d900cce,
                    0xc68ae1b097b12e18,
                    0x871250ddd8c4be42,
                    0x15cdbd01e414aac9,
                ])),
                Felt::new(BigInteger384([
                    0xad8e3d41fef1ffe1,
                    0xddb05a112858bc23,
                    0xe3c22c6e77c2ff4e,
                    0x2d175b009c8d5089,
                    0xd5d9b481a9b92437,
                    0x165ee26a9a8f02ba,
                ])),
                Felt::new(BigInteger384([
                    0xb77624cf9e366980,
                    0x9697b47d4e20b043,
                    0x97e029fb4fd2073e,
                    0xb85afcbcb7a3bc1c,
                    0x0a639ac3332f6f5e,
                    0x00f91927ee35a263,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xed27fb5c61190b06,
                    0x960980a9bce07c8d,
                    0xedab527cbaf4ee2d,
                    0x3198a4393e5cebe5,
                    0x146b2506eacb07a3,
                    0x073406436fe672ef,
                ])),
                Felt::new(BigInteger384([
                    0x70bb200fae370f1c,
                    0x5013239c059747b8,
                    0xc90697f25da0be7c,
                    0xd541aa11167f624a,
                    0xf23389c78159057a,
                    0x0820f282b9c9ba38,
                ])),
                Felt::new(BigInteger384([
                    0xa7654315a77a8630,
                    0x90510383a559ff2c,
                    0x72e695fe823eb74c,
                    0x0f22b08ac2215b08,
                    0xbc1108aaf71a9077,
                    0x15eb7bd23a6f46a4,
                ])),
                Felt::new(BigInteger384([
                    0xf52edbf7f73657ba,
                    0x2b0f98bfcbeea33a,
                    0xd8066ec9dbdcd8aa,
                    0x1eb3179783ab603a,
                    0x0bd70102ed9283cf,
                    0x04be094d178d3162,
                ])),
                Felt::new(BigInteger384([
                    0xe9d2bdf34250bdb8,
                    0x8b51a52e46a389ee,
                    0x35d0b37cffdcfde5,
                    0x682a3d8b7d698391,
                    0x6e1ea94aa81189f9,
                    0x132921d311ac5f9d,
                ])),
                Felt::new(BigInteger384([
                    0x7abf14793fd464e7,
                    0x9a1ff59d3a0ad48f,
                    0xa697d9baace39968,
                    0x34aa53752cde4048,
                    0xf50921abea3ea00a,
                    0x19f2553dfff12c18,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xc79f85b5b7360339,
                    0x3ec161ecf190fdaa,
                    0x8ec7e962c9725eb3,
                    0xd128f014882b8c9f,
                    0x7b31a514df12250b,
                    0x18b483c42884f6dc,
                ])),
                Felt::new(BigInteger384([
                    0xabfe1ba89e0242a8,
                    0xe5745eb4f8226cd5,
                    0x42002519501432bc,
                    0xd8ba4d251d8276aa,
                    0x0c60a5e9a8ebe5cd,
                    0x125f54af183faa47,
                ])),
                Felt::new(BigInteger384([
                    0xd86e490a12cae187,
                    0xa5d0fd66cf66ada3,
                    0xb347ab086bcb924a,
                    0x0bbc6b4f8711624e,
                    0xe52b774ed97e9ac6,
                    0x081f54fb99cf9bab,
                ])),
                Felt::new(BigInteger384([
                    0x04fdf645e37464d8,
                    0x8ca1fbb2d0f0ec18,
                    0x116d79a614e8bbd0,
                    0x12adcc00a0cefc48,
                    0x2c3a9d0abeed77c2,
                    0x184722a8e768d82a,
                ])),
                Felt::new(BigInteger384([
                    0xc39c5a2c7d9ee1ec,
                    0x4b272e5e4eca35e7,
                    0x8b0ab737cdb47c74,
                    0xe71c9f361069618c,
                    0xb5b02c257abb0e95,
                    0x16c592f25d41ee0e,
                ])),
                Felt::new(BigInteger384([
                    0x01debf3898b84e02,
                    0x03f6cc8a828fa8c4,
                    0x095fdcf128c75858,
                    0x2f93b2bcc0bcd538,
                    0x67a371d87d618dbb,
                    0x04f8e47db9aa7e1f,
                ])),
                Felt::new(BigInteger384([
                    0xbd43347e967525cc,
                    0x209dc055d687eb10,
                    0x79674f6bf62c54f6,
                    0x76bf33a7e60cd95e,
                    0xca40a9a56c83f01e,
                    0x068581f850732c6e,
                ])),
                Felt::new(BigInteger384([
                    0xac2d1d62c9b7c4e8,
                    0x181253eeb404d7fe,
                    0x619fed9734369dfb,
                    0xb73146b7b81dac2a,
                    0x2267a14c055a4656,
                    0x04713481f1f15ef0,
                ])),
                Felt::new(BigInteger384([
                    0x3bfe55fbdc5b1f39,
                    0x2eb76738c868dde0,
                    0xfbd334a8e2fde47b,
                    0x67eec31a8cbd7ec4,
                    0x32cc712402c3aa45,
                    0x0c7a57679a4ef7a1,
                ])),
                Felt::new(BigInteger384([
                    0x68fa7aa5be77fbe5,
                    0x317f65a277d75ab0,
                    0x556197a2f0bd3a89,
                    0x6b36464ad45c3f6a,
                    0x0c9219270d47b866,
                    0x0627af3e121dd7d2,
                ])),
                Felt::new(BigInteger384([
                    0x5e56d219b8b9357b,
                    0x236a7303db88d59f,
                    0x202e7a1d374e832d,
                    0x45def4931e617505,
                    0x07863025149af88c,
                    0x18d8ac9a53e56c7b,
                ])),
                Felt::new(BigInteger384([
                    0x87e3d57c5a1f1f5a,
                    0xd1b6c720388291bc,
                    0x54771c8f7cdbb8f0,
                    0xbcfd3fcaae3f71cb,
                    0xacd8939744d5294e,
                    0x160bf1de981e8f8d,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x4659c8ae0eb53d39,
                    0x2356d3505cf5a614,
                    0x1f5a195da7ad35e6,
                    0x00fcbf823688ae33,
                    0x235cea3914ad30ba,
                    0x19a64cff4907036b,
                ])),
                Felt::new(BigInteger384([
                    0x350a17c2dfdf9d7f,
                    0xe025b3c6a8e5f3e9,
                    0xc3b591440e54de2d,
                    0xa1ea1ab32263a38c,
                    0xbbee667fddebd9f1,
                    0x10c076d06c3568c9,
                ])),
                Felt::new(BigInteger384([
                    0x38ca749666dcf4f1,
                    0xff85ede8be2fcedb,
                    0x3d62bc59aae3d9db,
                    0xe1a8a73522b9c164,
                    0x5b0d69ca5a3305f0,
                    0x0dba9fa629e0db50,
                ])),
                Felt::new(BigInteger384([
                    0x1be2112acd0839ed,
                    0xb694b29cd3c7e3e0,
                    0x663a5823b69b72c3,
                    0x91d8196d3aaf7fc6,
                    0xaa5412d8b92985ab,
                    0x03285e32f5c0e4ff,
                ])),
                Felt::new(BigInteger384([
                    0x7b9783613292a670,
                    0x9e4e5325ddf39993,
                    0x05f7f584e40199c7,
                    0xbeca3e81a555e827,
                    0xe37a29004a2bd0f9,
                    0x0d21f45ec56ba94a,
                ])),
                Felt::new(BigInteger384([
                    0xb964535f46dbcc7c,
                    0x58020685692f587d,
                    0x66bb12db8b8a1eb4,
                    0x67cb08387b9c54ee,
                    0x54fe9d9288765d77,
                    0x0c31f7aaf0517d7d,
                ])),
                Felt::new(BigInteger384([
                    0x47d741bc81e9cef6,
                    0xa42dc13d08c9c5ac,
                    0xf54f762d0877994b,
                    0x258f9d24c772f612,
                    0x55abb195b1e75c6e,
                    0x07d4bbdb7c2f3f77,
                ])),
                Felt::new(BigInteger384([
                    0x2d98276c77cc7b5b,
                    0xc9f48af304080b58,
                    0x5ec1b0b44410df07,
                    0x2cffb4d3a3704f6b,
                    0x93c2fabd800f5992,
                    0x0734ed958396b167,
                ])),
                Felt::new(BigInteger384([
                    0x3ad57349be1c570d,
                    0xf94a6a1f81f8f173,
                    0x454dffdccbaba526,
                    0x9d4a7874eae5b81c,
                    0x59222ba018571e01,
                    0x14ab1ceee988c1bd,
                ])),
                Felt::new(BigInteger384([
                    0x283a6ee0b827db39,
                    0xf64f5a77720f0db0,
                    0xcee6b8cc16df1ade,
                    0xfc89ea8f7aab5cfb,
                    0x196c3884145799e3,
                    0x12b8cc2b5ed50a32,
                ])),
                Felt::new(BigInteger384([
                    0x50f06aa9bedcef1a,
                    0x2961b8956a12b4e6,
                    0xf9d576f319011526,
                    0xd0fbf7a8b8811213,
                    0xc3b3a664eec8e77c,
                    0x000abe9ee531ebce,
                ])),
                Felt::new(BigInteger384([
                    0x424a14a63e470225,
                    0xf0dd1aa729567901,
                    0x0cc843fb4f0bd194,
                    0xbae2113bb48dae27,
                    0x7cfd49c283082861,
                    0x0cb4ec17c63adf6a,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xafd0c76262250052,
                    0x0873d469a4d43c80,
                    0xb573e31ceccb5fd6,
                    0x8a8cfd4e6eb011ea,
                    0xdf29217123268d29,
                    0x056eef54056cec3b,
                ])),
                Felt::new(BigInteger384([
                    0x58e22fb72a3239a4,
                    0x695c588e68f3242e,
                    0xe0e4c294e6704ef9,
                    0x943062f50ba1583b,
                    0x051c6701655b9cde,
                    0x0c3f49314d6abdc8,
                ])),
                Felt::new(BigInteger384([
                    0x58c3ba4939e8c53d,
                    0x60b8d73c3ba57fbf,
                    0x7a04759a41bc7c5a,
                    0xc343d34db37a0bd0,
                    0xb5cdea63060be781,
                    0x103c6f17e313f5fa,
                ])),
                Felt::new(BigInteger384([
                    0xf8ddaac74e75cc1b,
                    0x75ee9e41dbbbb6c7,
                    0x12d387804335482c,
                    0xe42c6f685334bab1,
                    0x9a6b13ce3cc05e44,
                    0x100090f94d9ce5a9,
                ])),
                Felt::new(BigInteger384([
                    0x5620e159e5181c4b,
                    0xa4da8c216e141428,
                    0x68af255e5521fd08,
                    0x3059d866ffb26dbe,
                    0x0a7c72ed15c89dc7,
                    0x1105b371d5e7f7f1,
                ])),
                Felt::new(BigInteger384([
                    0xde88b016c5c45d26,
                    0xc9ababed0f7bafec,
                    0x32633fec5c7a87fa,
                    0x1a481f7a8e198c5c,
                    0x7fe538d4ffe9d39a,
                    0x1541c9e4aa55f99b,
                ])),
                Felt::new(BigInteger384([
                    0xa94b552ad9a2b84d,
                    0xf9c3c6e45c54fd88,
                    0x9af4bd4c8ad270d5,
                    0xf2e1de2b7d5a1110,
                    0xc573b438e4b056ae,
                    0x0536472ca4a3f933,
                ])),
                Felt::new(BigInteger384([
                    0x8274f73bf11b4b5d,
                    0xd7b560d6b2100815,
                    0x205d534e6e967c09,
                    0xc4bf0297c84b4a06,
                    0xfe76e51813900dd7,
                    0x0497c1330d347f8b,
                ])),
                Felt::new(BigInteger384([
                    0x0618971d40c9b78a,
                    0xc2b9c62234bddc54,
                    0x010cfc7b50bddc98,
                    0x252c62cdd5b6fce9,
                    0xc86273eba8e102a5,
                    0x048318e005e75777,
                ])),
                Felt::new(BigInteger384([
                    0x4933e81ecc94f888,
                    0x1092c7bdcdcc3eeb,
                    0xeb66718efbba3b18,
                    0x6d6525fa5430dc0b,
                    0x3150583c8d6362a7,
                    0x0b86397f033a07ec,
                ])),
                Felt::new(BigInteger384([
                    0x43baca544861f243,
                    0x2ed934a2b27b3b95,
                    0x27dbf29561763163,
                    0xf6c43c713cefa583,
                    0x59919185b0f66e16,
                    0x04892db82bb6bc15,
                ])),
                Felt::new(BigInteger384([
                    0xc4bfa8d6849aff3d,
                    0x6420d21351ceca4e,
                    0xae4acdf1c7f8266c,
                    0xca601783e3d86b6e,
                    0xbcdc90a797a681b5,
                    0x02aa41c1312ab899,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x52e21e90c1309c2b,
                    0xaad38772d04aef16,
                    0xfca80b6ccddd3aac,
                    0xfb5e20a4623eb108,
                    0x6fbaf6a3d0a3f866,
                    0x12b1ac72ddcd9390,
                ])),
                Felt::new(BigInteger384([
                    0x4393de4cea518dc2,
                    0xd842e3b344086090,
                    0xe9bcce3333949517,
                    0x26191a51836dd2d5,
                    0x2dcf98a4a5edab7e,
                    0x08463d322c845484,
                ])),
                Felt::new(BigInteger384([
                    0x22c886bd47e6fc2c,
                    0x76aedbc10ea27179,
                    0x46a3e377f7b52801,
                    0x73b268bf447ca782,
                    0x6b7dbe52a03989bc,
                    0x0d9b415eb799e17d,
                ])),
                Felt::new(BigInteger384([
                    0x9cc10424a4df59fe,
                    0x620e7ab37dd042e3,
                    0x8d59a25cd6112a2f,
                    0x8afbe0e043ab425e,
                    0xf562ca0bd5e80d97,
                    0x136c8bcdf3c831fb,
                ])),
                Felt::new(BigInteger384([
                    0x68558dbc427b5772,
                    0x812d01d119c39632,
                    0x788c1afaf2a437ce,
                    0x9a767fddbea98fe7,
                    0x1824352ce4356d5e,
                    0x18d9c2615b27a72b,
                ])),
                Felt::new(BigInteger384([
                    0x449e7c3c4a47f591,
                    0x517467acd3683cb9,
                    0xa5e9f064f16d4ad3,
                    0x5809cb0d9312e1c2,
                    0x700ae3ea87eb8f02,
                    0x0a88a64955adf952,
                ])),
                Felt::new(BigInteger384([
                    0x8f55dd227f778b57,
                    0xf5ed007ffc2d030e,
                    0xd7525d79e7c206c6,
                    0xfdc1efbee8b79e1a,
                    0xba20d6f28c900b27,
                    0x04f9498e8be69150,
                ])),
                Felt::new(BigInteger384([
                    0x3ac4f76b47d9bbe6,
                    0x66a4b5fa1dbb594c,
                    0x676d73687105767b,
                    0xf21bc8bfe591cd67,
                    0xc8d20197cb4ac0f3,
                    0x0d10ea716617b5fd,
                ])),
                Felt::new(BigInteger384([
                    0x555c9ed0f3548e0a,
                    0xa1684c8987be87f7,
                    0x32930b13827c04a8,
                    0x128483e617550db6,
                    0x53e53aa4433f7f78,
                    0x198cbbbcf99176b7,
                ])),
                Felt::new(BigInteger384([
                    0x40398802d89059e4,
                    0xf529ae48d3ae93dd,
                    0xbe4230307cdfad14,
                    0xbeea8f7d6cf275b6,
                    0x8aabb239740e9369,
                    0x0fdb3e45194e2354,
                ])),
                Felt::new(BigInteger384([
                    0x395cb0d22a7545c3,
                    0xd4a345779f081aa9,
                    0xff3bd618c0b861fa,
                    0x75f59e09aafc9ac5,
                    0xf1901dc7125c21bd,
                    0x047c69abd8189db3,
                ])),
                Felt::new(BigInteger384([
                    0xf006239454859297,
                    0xfb8fdc1754731e46,
                    0xf64b66eba9dceb43,
                    0x9f02117794aa5df1,
                    0x727e1f5801ef3654,
                    0x074dfe054710a60d,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x7023243283d4641f,
                    0xa10d46608e48cd5c,
                    0xadfc9bd6a4ff9d0c,
                    0xd0daf9299f66a213,
                    0x5be9e06c2dc8f527,
                    0x028e2c5ea1e61616,
                ])),
                Felt::new(BigInteger384([
                    0x7fb120ec66a63c47,
                    0xf7f33de0a3f8d4c3,
                    0x3ef115c5a1691405,
                    0x18f7998b0672597d,
                    0x73e1e900351b35fd,
                    0x10af786fc409160f,
                ])),
                Felt::new(BigInteger384([
                    0x6ccfd2f50fc498b4,
                    0xcd7f30a7878f325b,
                    0xa15252b93a377533,
                    0x59990590ddff6fd0,
                    0xe8f934157b536cd7,
                    0x071749c5d28900b3,
                ])),
                Felt::new(BigInteger384([
                    0xf3726a80209fe3df,
                    0x0012c2de79169c11,
                    0x5bb237a03ccdbf62,
                    0xf41e8a83cd1e0398,
                    0xf6b7566780639d72,
                    0x173d05171cb29add,
                ])),
                Felt::new(BigInteger384([
                    0x272b87fa92df3e5b,
                    0x62f566329e4136b3,
                    0xf0bd4e65d1ea8d2b,
                    0xe85251e4426d527a,
                    0xc5eff1fdf43064b3,
                    0x05d24cd2bae01931,
                ])),
                Felt::new(BigInteger384([
                    0x403006c08dc7ae30,
                    0x42875b5229135118,
                    0xca29168b8bacea7d,
                    0xecde4a88aab494d5,
                    0x211a2cf588dc4706,
                    0x00da7fb4c6004489,
                ])),
                Felt::new(BigInteger384([
                    0x13883287541011a3,
                    0x02de9faedbc54190,
                    0x03ff8440cb8dac7e,
                    0xb99c9b9ef8822b7f,
                    0xa4cd16f050f58593,
                    0x16d41c2ae4b54947,
                ])),
                Felt::new(BigInteger384([
                    0x60045942b0a6d524,
                    0x69211351204e2630,
                    0x33891d26e26e1dbc,
                    0xaa5b256c8b25812d,
                    0x93a4e56c62d66131,
                    0x04a15bcdf4cbb29d,
                ])),
                Felt::new(BigInteger384([
                    0xff2826d24bf3a74a,
                    0x461b4336563601ac,
                    0xf2f0729faf58865a,
                    0x9bbd2823558cb974,
                    0xd6b5621cefc20485,
                    0x15c1838f43c224b1,
                ])),
                Felt::new(BigInteger384([
                    0xd222ac93d1f05192,
                    0xc4af38d7bcaf935a,
                    0x01bce7be7fd14d49,
                    0x5d47d2d4bcdf2f4e,
                    0x24f69ab6fbcc3027,
                    0x16284ea428089c71,
                ])),
                Felt::new(BigInteger384([
                    0x26b3f730908123a5,
                    0x85411bd1b7b7a2a9,
                    0xd8f5219a1105bae1,
                    0x2ac0606305ee5c43,
                    0x86dfced86783170b,
                    0x0817428368239ebd,
                ])),
                Felt::new(BigInteger384([
                    0x66fcb86cf405e61a,
                    0x47f93ad54e95afd1,
                    0xd3ac1825c322d7ac,
                    0x43aa2398ae4a0a68,
                    0x93f2d88ebb5170ae,
                    0x15c51d6623d9e161,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x1f634ef4c0b83a17,
                    0x5020f445409593cc,
                    0x0adbc391e1f7bbae,
                    0x7701e78650a7d367,
                    0xbd9748106a71db83,
                    0x0a669523bdce09b0,
                ])),
                Felt::new(BigInteger384([
                    0xdd73d1d2dd4d1d8c,
                    0x3a3d0935b3dafa3b,
                    0x7f9f4c26ef41820d,
                    0xd96df24dc4a89b15,
                    0xf01f93b20ed8e395,
                    0x070f6cef745d9221,
                ])),
                Felt::new(BigInteger384([
                    0xab6e263a8d08b257,
                    0xe738ef8ec6d76da5,
                    0x27332d683d6908d7,
                    0x883f12a1c73e10da,
                    0xd382929a5f8c37f5,
                    0x1139e461b6402f45,
                ])),
                Felt::new(BigInteger384([
                    0x5e237d9bf019aa54,
                    0x23c43ebe8ccc21c3,
                    0x7f5119a013e5f9f7,
                    0x6733454edb6c2399,
                    0xc5f523f812ac00f6,
                    0x17161856d7735ad3,
                ])),
                Felt::new(BigInteger384([
                    0xc0f0b31127dddf2d,
                    0xd57d4b6374983be6,
                    0x671f9942c066589b,
                    0x0ada25f22bd347fa,
                    0xd0ec692aeb3ada03,
                    0x1399bf07141356ca,
                ])),
                Felt::new(BigInteger384([
                    0xed68b8593953bbc7,
                    0x59650e8705d37a00,
                    0xfbd18afed61bb2df,
                    0x28c9ee6c77519129,
                    0x67d4f42df3712b8c,
                    0x19d7a25112bc4ccd,
                ])),
                Felt::new(BigInteger384([
                    0xccd38394f4502ef5,
                    0xcb1491442ff64abf,
                    0x7dc6199da72ce162,
                    0x515133455f5e1586,
                    0x252709e29ac3a732,
                    0x1002a224f6ac3932,
                ])),
                Felt::new(BigInteger384([
                    0x5625f01689a51392,
                    0xf58f2de22789158f,
                    0x2f679fbe6378f1a8,
                    0x3f673566f31ab465,
                    0x2bc42ab35af74f2f,
                    0x0fc3fd7f7521a88e,
                ])),
                Felt::new(BigInteger384([
                    0x65a7375011d70ba9,
                    0xa9debfd2bf499abe,
                    0x135d5c39612978e7,
                    0x4f4f0ac2623ff554,
                    0xbf2df42c02fa2292,
                    0x191573fd85911da3,
                ])),
                Felt::new(BigInteger384([
                    0x2e6308456093e3ff,
                    0xc65fd7b4ee2cc9f8,
                    0xdc56da51d70c2dd0,
                    0x9114ce9cc56b44cc,
                    0x3769bd18ec3a72cd,
                    0x0e74aae497c4b9e1,
                ])),
                Felt::new(BigInteger384([
                    0x44a49b4913c138ea,
                    0xefc2e9d3d0071cdc,
                    0xbb9e00115debc20d,
                    0xe6004334d927db52,
                    0x3880b886d5204fbc,
                    0x100f9862ad0dabcd,
                ])),
                Felt::new(BigInteger384([
                    0x953b396251e14ccf,
                    0x53d5cbece3c93db2,
                    0xe29f4bf76431505e,
                    0x79907398c72b5899,
                    0x10eb56355167bc72,
                    0x0d283057369c63d9,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x6f7d4f6d56d4023d,
                    0x457a5034fccf374a,
                    0x5c17d0d2beb28636,
                    0x15411ac4dfae032b,
                    0x6f6d2272602cf1b8,
                    0x0f4108dc8114aa4b,
                ])),
                Felt::new(BigInteger384([
                    0x84402317df1b58fa,
                    0x1d7c12989f1abbca,
                    0x9a134cecd284654e,
                    0x03284fa8aa7a259e,
                    0x3a7dfba624a7e28b,
                    0x178c8986cf0c14dd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7137990e961ce15b,
                    0xb736dea57e0d3ba5,
                    0xe9882454db5e77f4,
                    0xb5bada7daecf04bb,
                    0x72e30f880e00254e,
                    0x03dcfeed718e9f29,
                ])),
                Felt::new(BigInteger384([
                    0x0b45c50be9479882,
                    0x1220733562c9476e,
                    0x9dd1b5169f8641f3,
                    0x1784daad62cc99f9,
                    0xd55a524500f91063,
                    0x152bb850d72298a2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb217efe75f7ef2ab,
                    0x95bdd5772e917c3a,
                    0x64ac05a75b83a0f3,
                    0x12e447bfc2eed89e,
                    0x0e28e7b8772f2072,
                    0x0bf9677e5d09d702,
                ])),
                Felt::new(BigInteger384([
                    0xf39b9004d3543592,
                    0xd912617e77baad72,
                    0xb228225e0c9c67ca,
                    0x0ba98f47f469dbab,
                    0xc19e7732a422ab77,
                    0x0dda293a8a15b039,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5d5972de1dcb8c95,
                    0x67f360466b039375,
                    0xa225fc46088e5c03,
                    0xbdfed61349411e5f,
                    0xdabf463fe3af9403,
                    0x0e75e95c5b142007,
                ])),
                Felt::new(BigInteger384([
                    0x485af01109a0913b,
                    0xe81dbd2684ad35ba,
                    0x67dcca80c705d7bc,
                    0x9d84940e0d169da1,
                    0x9e09ac1c9dbd7dfe,
                    0x092c00d8d1a14fd3,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf42b53d4134e082a,
                    0x3025e1b6aa994d77,
                    0xcb2d3a30fb6df65f,
                    0x65a3febf84f5ba50,
                    0x9ec86bd4b6094b12,
                    0x156fef1555d61766,
                ])),
                Felt::new(BigInteger384([
                    0xc5b1e04820e42447,
                    0x911f69d598011faf,
                    0x57238fd0221205a5,
                    0xe7653269696784b5,
                    0x4544947584191cd6,
                    0x17e571d00e457888,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xfd4d1bade98c7865,
                    0x2a15b488f5f13620,
                    0x1808e8476cca94a0,
                    0x5ce73b00090183a6,
                    0x4b6e5b6dac46d251,
                    0x1494dadb1af90fb1,
                ])),
                Felt::new(BigInteger384([
                    0x843d7416be7b2f45,
                    0x7d34b465302910b0,
                    0xdab1432f16b326c0,
                    0x2714cd1e1127189e,
                    0x8967117377de7b37,
                    0x0aa45f8d1b678cbf,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x771fd35bdfd80f91,
                    0xa19fa9c51b2a65ba,
                    0xcb12e7744dde52d4,
                    0x2dbca14a77bce38f,
                    0x8b5cd23449d80c3a,
                    0x03942d9e754990cd,
                ])),
                Felt::new(BigInteger384([
                    0x682cd61f7c95823a,
                    0x97e983b347386df3,
                    0xbbe75069e5e6f18d,
                    0xd221df7836de9223,
                    0x11120879dc03e335,
                    0x02ef9a809d2acba9,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x6eef9e9f3d1487fb,
                    0x447ace573b4eb66a,
                    0xbf040a0e483d1d86,
                    0x72da249fea190d10,
                    0xf91841c85728c65c,
                    0x079bff32285fff98,
                ])),
                Felt::new(BigInteger384([
                    0xcf1d0732523ce602,
                    0x6f1fdb331fdf0c48,
                    0xca96810cdbf9fb45,
                    0x13b580600d8eaf41,
                    0x6e4dea47869f4fd3,
                    0x10329a5c226342c7,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x09208f64eaebcfa2,
                    0xbfc64ee75650f13c,
                    0x5cc67959e64fe24d,
                    0xd37432e1a42fec22,
                    0xb175f51b7bcfc600,
                    0x038ca5d1ebd83928,
                ])),
                Felt::new(BigInteger384([
                    0xb8dfb0803d800418,
                    0xd48dd97bf1f5440a,
                    0xc76aa9298e764b82,
                    0xcdd2409358633a16,
                    0xc48d0bbe7b6a7e76,
                    0x008e2e0b2e858f38,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xeec1940ddce90409,
                    0x91a0359216072871,
                    0xb2c2308b8287fca9,
                    0xd10ae2c3a0bb5246,
                    0xd51be90f09960b63,
                    0x08da8b345b06af60,
                ])),
                Felt::new(BigInteger384([
                    0x285e165cbfa101dd,
                    0x5b7a158f2cfcf565,
                    0x0b2a991e47c2ab35,
                    0xabac8ab73190d2ad,
                    0xebdedd05e92b2b9a,
                    0x0a8004c451ce4d7e,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 6));
        }
    }
}
