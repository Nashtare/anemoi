use super::{sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 8 field elements or 384 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 8;
/// 7 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 7;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 4;

/// 2 elements (96-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 14 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 14;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= y[i].square().double());

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t += y[i].square().double() + sbox::DELTA);

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3]];
    let y: [Felt; NUM_COLUMNS] = [state[5], state[6], state[7], state[4]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3];
    state[0] = sum_coeffs + x[2] + x[3].double();
    state[1] = sum_coeffs + x[3] + x[0].double();
    state[2] = sum_coeffs + x[0] + x[1].double();
    state[3] = sum_coeffs + x[1] + x[2].double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3];
    state[4] = sum_coeffs + y[2] + y[3].double();
    state[5] = sum_coeffs + y[3] + y[0].double();
    state[6] = sum_coeffs + y[0] + y[1].double();
    state[7] = sum_coeffs + y[1] + y[2].double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 8],
            [Felt::one(); 8],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xed694f75b4c99cfd,
                    0x684bc0e28f3245c8,
                    0x70852c61c47fe0d3,
                    0x35153df1e85e72a0,
                    0xf8ef66ad04a98e8e,
                    0x072408ef87f94434,
                ])),
                Felt::new(BigInteger384([
                    0x10a1600640ee9319,
                    0xbf82ef1501b3e026,
                    0x481390a60c0502f1,
                    0x74db83bf22ec19a0,
                    0x486a86bff9e18593,
                    0x0dc0e9c4063d33cb,
                ])),
                Felt::new(BigInteger384([
                    0x36644c27885b4880,
                    0xcd8d6cb9b938a4b7,
                    0x00ed4c405c2952ea,
                    0xe9bab45f35d9b721,
                    0x4695ef71e88a4280,
                    0x0d413e4096044a82,
                ])),
                Felt::new(BigInteger384([
                    0x65c42aceefe3b97d,
                    0x91e871d04f229d47,
                    0xc6fba6eb6c513f57,
                    0x23c60917e5383d59,
                    0xad79f49ef6dc2b92,
                    0x0641089f93fa06d6,
                ])),
                Felt::new(BigInteger384([
                    0xb5b46dab68026413,
                    0xddc666aca470bb07,
                    0x0f507ef8b5eed3d6,
                    0x88f20b3c070267e4,
                    0x1f66d94520b2f8da,
                    0x0f5bf23bc547f228,
                ])),
                Felt::new(BigInteger384([
                    0xd6f63978f0b90905,
                    0x6253eb338b22f518,
                    0x6d2169c5ff11fd00,
                    0x028e757257e9f8cc,
                    0x71c4c5958ba31434,
                    0x03355c3be515ce39,
                ])),
                Felt::new(BigInteger384([
                    0x62305c89c4456a31,
                    0x64ba6ea5d1ce1004,
                    0xbfefee5ad8b2e675,
                    0xa4d248e52ea5dffe,
                    0xd75a7c22b6e67279,
                    0x0fdbce440078fcc1,
                ])),
                Felt::new(BigInteger384([
                    0x2c2ef44e528098ca,
                    0x4276fcf902fd2627,
                    0xf5c0b5e7ad16de3f,
                    0xfebc2eae45eddaea,
                    0x74cd74edcedf4358,
                    0x0ffbf26644e352c6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x30ed3b7756729c7d,
                    0x39d8dff5962beff1,
                    0xcb76a27414e8a2bb,
                    0xf53d2488ddebae3c,
                    0x0ea581f0000a9393,
                    0x12cf87dd8962ad1a,
                ])),
                Felt::new(BigInteger384([
                    0x365629b90904ecae,
                    0xd7f541b404241637,
                    0x705f248d51df2f2a,
                    0xd47beb45c0d887ed,
                    0x6e8f63116d384fb8,
                    0x0302d5553d2235d4,
                ])),
                Felt::new(BigInteger384([
                    0xb33259e0990a9fc1,
                    0x544c791eaf3e9c1e,
                    0x0a5089f385bd9e5d,
                    0x56b9f76f1a65f531,
                    0x6c3b9b3716924cac,
                    0x0bb06bce00c193a6,
                ])),
                Felt::new(BigInteger384([
                    0x672cd43d570290ee,
                    0xc176f433171c427e,
                    0x9156c0941a9a8fd5,
                    0x1199044d11f0398d,
                    0x2bb47efba922632d,
                    0x0102786328dc5dcd,
                ])),
                Felt::new(BigInteger384([
                    0x34a8c768446317e1,
                    0x08fbf27d69fa7117,
                    0x3261da235ad31c90,
                    0x27f96cc53501a08b,
                    0x465f0e6bca390e2a,
                    0x065e8b5972d6dcee,
                ])),
                Felt::new(BigInteger384([
                    0x439bf9cc8500e281,
                    0x4d4b334c153b63d0,
                    0xcf407ce9109e12c1,
                    0x7dd73cbd21216ff0,
                    0x61e84d9cc110aeec,
                    0x0d2a1ce3f95417b1,
                ])),
                Felt::new(BigInteger384([
                    0xe9a9c6b795993efa,
                    0x0e720e148fc68dcc,
                    0x0017545e82b47557,
                    0xb2d422e154cd81af,
                    0x92465b15009d035c,
                    0x0ad032a3308b4a0a,
                ])),
                Felt::new(BigInteger384([
                    0xb00440ff02222148,
                    0xb15d705c10243bb4,
                    0xa3e1f6fff89d5461,
                    0x7312de6da53ba193,
                    0x2cc6c7ccdfcc8ea7,
                    0x11f3e92986a34dc6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x63bd69651037039c,
                    0x9f27736f7e06b101,
                    0x84f72c3d93df46d7,
                    0xa57412ee8cc60260,
                    0xb777e60150ca783e,
                    0x0e0caaf4fe8aa983,
                ])),
                Felt::new(BigInteger384([
                    0xcda899b62b7e50e4,
                    0x7a9183365e79c953,
                    0x2bbec5c1e368abb1,
                    0xefe0d914a5717dd6,
                    0x419670209f258bc5,
                    0x18178c6b73880710,
                ])),
                Felt::new(BigInteger384([
                    0x241e339b4763b960,
                    0xcfd75bf7f39cea90,
                    0x3b5ec214d0af4ee9,
                    0x796c54d86ac563fe,
                    0x65f3152a3ba46d99,
                    0x0c2990e623f48819,
                ])),
                Felt::new(BigInteger384([
                    0x056f08a222dc1dc7,
                    0xb752cd51226e2ff0,
                    0xd642b9aea969f9ab,
                    0xc242ae2bbf75a9a1,
                    0xa07dcf88dbd1e25c,
                    0x0eb0ff7121707856,
                ])),
                Felt::new(BigInteger384([
                    0xd95b3795f4d2d255,
                    0xdc4c98cd52846bba,
                    0x0570316e94dc581f,
                    0xc51ff1b7139a7085,
                    0x31e3de57b06b6a16,
                    0x11dc488e4e22f4bd,
                ])),
                Felt::new(BigInteger384([
                    0xf2e8b3faff03fa9f,
                    0xc39c02431110e374,
                    0xc6092d68d1651275,
                    0x7bc980ecc463cbea,
                    0x727c5d75a15faf77,
                    0x183d7ef16bd7712d,
                ])),
                Felt::new(BigInteger384([
                    0x0a06c7fc6f3a2480,
                    0x6c80859788034380,
                    0x39ee958d21ffe6bf,
                    0x26f8292e234f41fc,
                    0x641a09ac507edf8d,
                    0x125c16deb9b55157,
                ])),
                Felt::new(BigInteger384([
                    0xf22869d33271f63c,
                    0x65f91d902a4fd902,
                    0xf889a7accde21958,
                    0x539e7c53c2556652,
                    0x41294ed4588a2d4d,
                    0x19d290587bf2daa2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x929c2cb07c34f404,
                    0x0a8615800e52ccfa,
                    0xa91f13532ae3d8ca,
                    0xcfec957d36519f97,
                    0xa2220e4cba106462,
                    0x05de2b7d8f6227cf,
                ])),
                Felt::new(BigInteger384([
                    0x0d34aea8a4f2f289,
                    0x7bc6c0188ee20797,
                    0x3f53609e29699196,
                    0x18dae336540f8e78,
                    0xd84e603fe9cd5dd3,
                    0x0da8bc3e18c2df45,
                ])),
                Felt::new(BigInteger384([
                    0x72517cba7ce4d8de,
                    0x9b8087faee1b75d2,
                    0x5dba89352aca6a7d,
                    0x7ff66e4fa31b1a62,
                    0x097a16c318bc9e3e,
                    0x0b39b8283e1c562a,
                ])),
                Felt::new(BigInteger384([
                    0xfdf738ab6ee47845,
                    0x377937d6ea576561,
                    0xeaa4d9395972192d,
                    0x05d1ea98d2a03d64,
                    0xcaa09c2300af1484,
                    0x0933356c320aeb6f,
                ])),
                Felt::new(BigInteger384([
                    0x544591dddf591a6d,
                    0x9a10224570fa0f3a,
                    0x340bb3074ac9223d,
                    0xd93f164577ea58c0,
                    0x91dbb64f1c50a215,
                    0x1811cf479e7b7681,
                ])),
                Felt::new(BigInteger384([
                    0xf6825597f73205a1,
                    0x6408758f07598a65,
                    0x775b848047fdcd95,
                    0x021d39fd067b5c6a,
                    0x91a9f55d1047bd12,
                    0x1451b1dea08a2188,
                ])),
                Felt::new(BigInteger384([
                    0x47158119f0a4a024,
                    0xbc4b98a267d7dae5,
                    0x07bcd4f3a268725d,
                    0x768993079bfeb655,
                    0x5bc90505cc6f4c0c,
                    0x1425ff43331b7820,
                ])),
                Felt::new(BigInteger384([
                    0xd440574d141ebdbd,
                    0xe88a35f4a4182f2d,
                    0xa627cc0e8defcc7d,
                    0x6c41c809e1ff6d99,
                    0x18c47310bf7fc035,
                    0x103d399f7866b14f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xce6e355f14d723df,
                    0xbfc6773954ee9326,
                    0x9db78bd60c3deaa6,
                    0xd263a49152ad32b1,
                    0xd308d50565cd93b5,
                    0x12a2eb26b56683ec,
                ])),
                Felt::new(BigInteger384([
                    0xc6b0a1148dee96e4,
                    0xcfe8fd6bf2f087c5,
                    0x0c6edc5c82b21b16,
                    0xa95cf51ea68985fa,
                    0xb8315681184c606f,
                    0x0ea0f08c74e73829,
                ])),
                Felt::new(BigInteger384([
                    0x9f6f2daa0a0ee402,
                    0xef8ea2a623d9d4cf,
                    0x13ede0aa746a4a57,
                    0x150eaf0fb96f401e,
                    0xb355e5cc5e8ee33a,
                    0x0f179c5d3badf0bf,
                ])),
                Felt::new(BigInteger384([
                    0x170ce6c0fdcc7c64,
                    0xca2fb9ad92a35dad,
                    0xd7c37bf240252c1f,
                    0xfb9f607be3ba2372,
                    0xfddc2c975b86122f,
                    0x1675e5052bb39407,
                ])),
                Felt::new(BigInteger384([
                    0x9f2ddd69d83b1a61,
                    0xc2714cf5609e1cc7,
                    0x1b8423db6d547117,
                    0x32af43e07c3d0fbb,
                    0xf22485705464ac1d,
                    0x0f69d7b4df4e4c98,
                ])),
                Felt::new(BigInteger384([
                    0x8f609931124d4efb,
                    0x3530bcf9db8447f9,
                    0x8c61b96a424966ab,
                    0x7e01b931eea88cd9,
                    0xc00132a7e8169977,
                    0x039676e7947ed07e,
                ])),
                Felt::new(BigInteger384([
                    0x2dc874485434e1db,
                    0xb6edc3721c29a56b,
                    0xa48bf1767de0eea8,
                    0xe90bd6a994122481,
                    0x2d09213e080ce71e,
                    0x05f2bfb4fec91718,
                ])),
                Felt::new(BigInteger384([
                    0xe94ed738f9f076d3,
                    0xaadd28c69ecbafaf,
                    0x033f26c7e5dd3cab,
                    0x487fb47377272a98,
                    0xbf1e6b9e0743ce00,
                    0x14994c968af70552,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x94f44a9b2122f970,
                    0xfa0246a6b312aa72,
                    0x9b0c01129c12c15d,
                    0x4a3693039bcf65d1,
                    0xd5493c760e114376,
                    0x0a2874d2e968e2dc,
                ])),
                Felt::new(BigInteger384([
                    0xfa9727687510681d,
                    0xdc415ec9e780138a,
                    0xea59884f8cc7958a,
                    0xff49719d91f02b71,
                    0x74b3fc2a5c6aae4c,
                    0x04e6ea75d1cdbff7,
                ])),
                Felt::new(BigInteger384([
                    0xb6e2a0454d00a09e,
                    0x2852cc737ca5dbc3,
                    0xc6a5abc965bec241,
                    0x39aa2f186672bb69,
                    0x3f5940457c36ebc5,
                    0x0fc077e8f3ac61c2,
                ])),
                Felt::new(BigInteger384([
                    0x4183d8471087b4cb,
                    0xfc0945a3681a4810,
                    0x321ff41d62535ef3,
                    0xe65420550015a659,
                    0x3639c93111086331,
                    0x19839834e86452a4,
                ])),
                Felt::new(BigInteger384([
                    0x52bf2f13c003de64,
                    0x7a844d6af484b8fd,
                    0x7dd30369749bf668,
                    0x8f186410aba59280,
                    0xbcf856bda464d0fa,
                    0x03edf937f9cee0f3,
                ])),
                Felt::new(BigInteger384([
                    0xa343df957f049ce9,
                    0x29b8eeb326d92889,
                    0x949f996438206d4a,
                    0xcfc7b4972c6109ae,
                    0x5d0f1741eac1052d,
                    0x0a3d0c70b2b538e5,
                ])),
                Felt::new(BigInteger384([
                    0xa4eb8b00d0d324d6,
                    0x53c5266a2ffd9f77,
                    0x723643bd2219cae6,
                    0xb15653ac27651785,
                    0xa74d5d33002fc88f,
                    0x18cbeea2ed8fe141,
                ])),
                Felt::new(BigInteger384([
                    0x824e6cf02fdaa4e0,
                    0x60cf3cfacf65aed8,
                    0x69f751662cb147d6,
                    0x9b9a9dadf5860e8e,
                    0x30b0ce0bd7359ead,
                    0x039c7ee521e2b685,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x783c78bf0abc76bc,
                    0xdbf68ca6f0786ecc,
                    0x027bc669cb002066,
                    0x175c62f43eb63c8a,
                    0xc23e5314cce429a4,
                    0x053f69ece85c4db4,
                ])),
                Felt::new(BigInteger384([
                    0xd2ae6ad61e273ede,
                    0x105a7d4d05626730,
                    0x5308fbbb683c793a,
                    0x6fd0e3b18c348f25,
                    0xece056673a1b7c61,
                    0x0f9f3c12938a9100,
                ])),
                Felt::new(BigInteger384([
                    0xc670cfc107d3a71f,
                    0xd0e28216f278c292,
                    0x8800a77d2849dcaa,
                    0x8360a8ebca6c0f1c,
                    0xd86fcb444534abb3,
                    0x096d124a70b44761,
                ])),
                Felt::new(BigInteger384([
                    0xe357b8ffabacdff6,
                    0x58d811d71f39cd4d,
                    0x81c08ca588cade55,
                    0x982a66f0d1315f66,
                    0xe3a7b94d57b2036b,
                    0x180832efbe3b93e1,
                ])),
                Felt::new(BigInteger384([
                    0xf2e3bf6968420364,
                    0xfa8cff73d47bb41f,
                    0xf31ab9ec3d1df0ed,
                    0xa6d9597a54ce928a,
                    0x33f0d3747f61d173,
                    0x07b947e8809e5dc8,
                ])),
                Felt::new(BigInteger384([
                    0x2eec2b3a241ef547,
                    0x8cb48f0d3f75eb72,
                    0x59d77afc3e873548,
                    0x4d72d78235311405,
                    0xa25564e1c534e9df,
                    0x14649c7c9b424bdd,
                ])),
                Felt::new(BigInteger384([
                    0xfda7ad942ea15993,
                    0x5ae9df8ae27f2266,
                    0xf43aefe80a438e25,
                    0x28370585fe1ec284,
                    0x7659ee1fee27a7da,
                    0x0e069633b3f84190,
                ])),
                Felt::new(BigInteger384([
                    0xff4e6f0d7c73f9a7,
                    0x68c35f24ea27e78e,
                    0x92f85290f2d65447,
                    0xf25cc7ec1ca67e9c,
                    0xfcbea2672fedd8a5,
                    0x0c2474616dd07b78,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5b1fce9f746e4bd3,
                    0xe430405846d9cb2f,
                    0x48f23b2d5cc597e6,
                    0xa3e5ebbd57b96893,
                    0x679c627c7c5ee26f,
                    0x19c9ed70659511e7,
                ])),
                Felt::new(BigInteger384([
                    0x187248a19f7d2916,
                    0xbaf54943ad734f35,
                    0x8d2fdb54441622dc,
                    0x182c80e1e142190d,
                    0xc6de23f1dee60ec7,
                    0x08edd504e02bf0c6,
                ])),
                Felt::new(BigInteger384([
                    0x21838cb52ceb2566,
                    0x1a18c434c323581f,
                    0x3dc66db10609a578,
                    0xf84913338323e241,
                    0x1f2610d4a998b73b,
                    0x002d02e0b8927b3b,
                ])),
                Felt::new(BigInteger384([
                    0xb7bb1eeb6358a53c,
                    0x6ca92ef7e2adedaf,
                    0x9a6924d7a4d42535,
                    0x3b697a7160c245f4,
                    0x4406b12661baddca,
                    0x08e4f3f569d70a24,
                ])),
                Felt::new(BigInteger384([
                    0x2a9f7c7ea7afee3c,
                    0x2e45bfaf1b5e45bc,
                    0x0be5e267399665bb,
                    0xac7b289aba077743,
                    0x218cac038a83a219,
                    0x05b2de7f587444ab,
                ])),
                Felt::new(BigInteger384([
                    0x4f3519e474c00942,
                    0x2512d2cc0efdf936,
                    0xa681c6900c85e2dc,
                    0x61ccb2aac1764798,
                    0xfffe0c986f518ecf,
                    0x0e0e5e2143ea847f,
                ])),
                Felt::new(BigInteger384([
                    0x5b5cf3f8a28dac4d,
                    0xc4a2fda759ebf51a,
                    0x51de4423271b2910,
                    0x85bb9819a1689906,
                    0xdfbd4606d01bbf6a,
                    0x0979a18f9eb272df,
                ])),
                Felt::new(BigInteger384([
                    0x844078614ee424d5,
                    0xa8255905123de024,
                    0x9a9e6ccab8a1784a,
                    0x7496ef50a2c3d0f1,
                    0x5b6f26b04664e9bd,
                    0x01a2417f612a8053,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x40534eaea33c9837,
                    0x4c50955a336ef504,
                    0x573056c1a258253f,
                    0xcccf7446d98fc8a5,
                    0xb4048455521cda63,
                    0x1865147916987e18,
                ])),
                Felt::new(BigInteger384([
                    0x47fe661642a78c0e,
                    0x6ca9ac0a5562d8cc,
                    0xeff635cd4fb0719a,
                    0x095f3508226d7698,
                    0x7cc733bf276a0df3,
                    0x0f887ada6aef1ebd,
                ])),
                Felt::new(BigInteger384([
                    0xce3b436ab5e6467b,
                    0xa92f85f5dab9069b,
                    0xb640fec0869da956,
                    0x4a354ba7827e6485,
                    0x106e9680307724b6,
                    0x064773c8d4f6c623,
                ])),
                Felt::new(BigInteger384([
                    0xd122eace42ec4f55,
                    0xecbb0c62e1afb0c1,
                    0x83a3e040bc404f67,
                    0xdc72cc7b9e37e9f7,
                    0xe5385f743b92a0c3,
                    0x12de5e2c45f09b38,
                ])),
                Felt::new(BigInteger384([
                    0x1a68137aac82a8d0,
                    0x1264344a145e2c95,
                    0xd58cad5fccfb26a3,
                    0xd02c7aaa7e2c464b,
                    0x544dfaab1ea91822,
                    0x0247ba0a66e59695,
                ])),
                Felt::new(BigInteger384([
                    0xe4dc7c198eed1512,
                    0x78ec4200ffb65ee3,
                    0x58f57250aaeec5e8,
                    0xc730d0f4d94efc26,
                    0x01f2cea3c5b55650,
                    0x02510e9cbbfbd580,
                ])),
                Felt::new(BigInteger384([
                    0x37501ab214c342b7,
                    0x29368c6b0f126c57,
                    0xbcf68c94dd647cbc,
                    0xc387b302dd869edf,
                    0x70acdcfe7a1cdf4e,
                    0x083a880024857ff6,
                ])),
                Felt::new(BigInteger384([
                    0x8c7dd272ade2486f,
                    0x2eb49f11b4f9fe86,
                    0xd1ba3a023f0aa7cc,
                    0xc8ebf36c9f475c78,
                    0x5ec13f2d7258f5e6,
                    0x0177238dbb4eb4e6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1de95cd3f17eb96f,
                    0x92b3384a16f427cf,
                    0xdffa68012b62004f,
                    0x954a721f66f656a9,
                    0x1b5db9e75969a9f1,
                    0x0b2b57f3fe693255,
                ])),
                Felt::new(BigInteger384([
                    0x75962eadcdf45cba,
                    0x1d46af97e02e0970,
                    0x383967d0e3e3fb9b,
                    0x197f798df97591eb,
                    0xae6a358e7afdb8df,
                    0x04a4a68545e7f8d9,
                ])),
                Felt::new(BigInteger384([
                    0x22c7207c8b2de44b,
                    0x720ed0d3afb982a6,
                    0x20ffb8867d1b7b66,
                    0xc7d78f1ec933dedf,
                    0xb1a122967c4e77af,
                    0x073006f4c830fd9b,
                ])),
                Felt::new(BigInteger384([
                    0xb24cc850ad447078,
                    0x45fc10f6fa22b600,
                    0x0e776819b1cf476e,
                    0x2f1a07d922260b19,
                    0x761983b0ecbeaf95,
                    0x00678ef35ffb7fec,
                ])),
                Felt::new(BigInteger384([
                    0x4cc768987164c3de,
                    0xf57720705fde41d4,
                    0x12a0f8212c39b2d6,
                    0x763c4c3a6a5617a6,
                    0x906bdaafd9d576b6,
                    0x03bbb5c8cf3bc6cb,
                ])),
                Felt::new(BigInteger384([
                    0xdf93c50017e4b4cc,
                    0xd0a41fc39a73bf60,
                    0x7637b1cc19ef23a3,
                    0x63a25bda624cb447,
                    0x355ed9cd8bfdfd49,
                    0x065927a0f6e7e9ef,
                ])),
                Felt::new(BigInteger384([
                    0x03b14fa75a0959b4,
                    0xf475b54ab3822043,
                    0x70d76379dfb35d31,
                    0x31938895d530f033,
                    0xa839ed453be1ad6c,
                    0x0da98921ad7fe80d,
                ])),
                Felt::new(BigInteger384([
                    0x4f3fc19b79cc7ec6,
                    0x81739127ce1fa909,
                    0xe727558a141563f4,
                    0x3322f169d9725c47,
                    0x925d7833e262358b,
                    0x12b29817b71c70f1,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7daa9ceef3e10704,
                    0xfa23fc00fc102136,
                    0x5061408c9e6d03d4,
                    0x96a0020d6084c457,
                    0xd6f2154deb4d133a,
                    0x073498e3f6eb1201,
                ])),
                Felt::new(BigInteger384([
                    0x01c786a3301a869f,
                    0x6f36c339a83f001e,
                    0x460d8b4ecbff4cab,
                    0x2c6c603b684481f6,
                    0xe6dae8bc0f96c758,
                    0x14bfce3730895736,
                ])),
                Felt::new(BigInteger384([
                    0x2a83cdce7795fed7,
                    0x6f9c8128899e4ccf,
                    0x8beb8948bcefcb53,
                    0xf48de8ac1874a69e,
                    0x105353293568d2f3,
                    0x13c8d9d75f96f83e,
                ])),
                Felt::new(BigInteger384([
                    0xe2082f083cf4d054,
                    0x06946439094324d1,
                    0x534a5ee34e295bf8,
                    0x5ddfdf9009e376e0,
                    0x0c412465c312b104,
                    0x140530531502e2af,
                ])),
                Felt::new(BigInteger384([
                    0xe51dc9d721dbf6f3,
                    0x1cca8ce7c53043a7,
                    0x16d1393382813a41,
                    0x2b15e0fe83218ed1,
                    0x403178df6daef3c3,
                    0x06f840553b6fea8b,
                ])),
                Felt::new(BigInteger384([
                    0x9cddc49424e03f55,
                    0x8fe9d3c7799a2e74,
                    0xc6ee54824c9590d0,
                    0x66f51ec310b0cb09,
                    0x214e8f17c196ca5c,
                    0x0d7518b350444267,
                ])),
                Felt::new(BigInteger384([
                    0xbe3d4371abcd97d9,
                    0xdc122157d6879d03,
                    0x69dc05c136e27b41,
                    0xa18ed43b00cf3940,
                    0xe651a20f6a0b678c,
                    0x0fe5eb506391c1a1,
                ])),
                Felt::new(BigInteger384([
                    0x6f61e3a25c3511d4,
                    0xb3e15ad95d211309,
                    0x91a0521de4b0496a,
                    0xfc4bf77d6d124187,
                    0xf03b9a57e7dd419f,
                    0x19231b4c36a27457,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x219d87b3f86534dd,
                    0xf2870dc9dee82054,
                    0x80274221299707d7,
                    0x304b39adad3528eb,
                    0x8207fe12fbd97a72,
                    0x06bb9d4eb32993bd,
                ])),
                Felt::new(BigInteger384([
                    0x60b06418add4c9c9,
                    0xd6c54886398cd9d5,
                    0x072f4828c38c1fbe,
                    0x66bf1379442d7a67,
                    0x117285bde5e57f42,
                    0x09eb930c9eadff3e,
                ])),
                Felt::new(BigInteger384([
                    0xe58386a101d9362f,
                    0x7697ca20a6e976e0,
                    0xdaae4104642d364b,
                    0x3bfb6372f9692a0a,
                    0x9f43f84453084738,
                    0x04d8206ca576056d,
                ])),
                Felt::new(BigInteger384([
                    0x002d96ac37939976,
                    0x586769404ddab23e,
                    0xe7910c49f06e395f,
                    0xf91345a4921aad73,
                    0x7c8310092b7d117d,
                    0x080e39307f87eeb5,
                ])),
                Felt::new(BigInteger384([
                    0x86a752c8420f5c8b,
                    0xe7e1a28b2a5ddfc8,
                    0x1ab1e47380890851,
                    0x51b6cdb6b2736104,
                    0xba775763981c37dd,
                    0x09724b251a792f2f,
                ])),
                Felt::new(BigInteger384([
                    0x8add0c5593719aad,
                    0xba6b5d4eaeba1fb2,
                    0x3ad635f1b2642c00,
                    0x941ebbd5bff10104,
                    0xad6a0b2c13455cc1,
                    0x0915d36304686fdd,
                ])),
                Felt::new(BigInteger384([
                    0xb3c73170ff35de0a,
                    0x3c9e3efc9c0a6fde,
                    0x8d638527453841b8,
                    0x97b9153509e7b07b,
                    0xe221a6a218b1103c,
                    0x0c39e40093839563,
                ])),
                Felt::new(BigInteger384([
                    0xeb30b623159b8b43,
                    0xd15e8fe3e652e242,
                    0xe0af0c9dd65feb2a,
                    0x68f9d05cf30fc19c,
                    0x5e3482dbf5f8b634,
                    0x117183d32112bb2b,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 8],
            [Felt::one(); 8],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xb2b9af64d1394d52,
                    0x4c3efda6b58bb8c5,
                    0x2cbee9e4c0dd98fb,
                    0x2853400e147e9d80,
                    0x9005c3c982269489,
                    0x1123facf80e8b0c7,
                ])),
                Felt::new(BigInteger384([
                    0x4352ecd4c0fcb310,
                    0x22784f3b87d05aac,
                    0x1b86d209c2a9e24e,
                    0xb2bdc2c406000dcd,
                    0x4cf0c03a66819d42,
                    0x136be721a1fda810,
                ])),
                Felt::new(BigInteger384([
                    0x49af4b2d4b51d831,
                    0xa0b89dcad813b45d,
                    0x682ba161e887ddae,
                    0x4f15d475da12b138,
                    0x1d60206a8f25187b,
                    0x089b1b36d7c35790,
                ])),
                Felt::new(BigInteger384([
                    0x7f4207ddf4e7d5fb,
                    0x6d3e43266924d24e,
                    0x9906689bd8a3789b,
                    0xc2306a7be90fa593,
                    0x4bb5147166a03f30,
                    0x07ff6eeb2be2b26a,
                ])),
                Felt::new(BigInteger384([
                    0x676ee5a92ccfdcfc,
                    0x61401adb8f3dd078,
                    0x93ce7e8085d64c8e,
                    0x51ae319eb1d98442,
                    0x91b1dbc882d78dd9,
                    0x16128de3ded8cbaf,
                ])),
                Felt::new(BigInteger384([
                    0xbdcda35d670928d9,
                    0xee44e7a0a5d5fd9b,
                    0x75c70812cf22f64e,
                    0x3a355a0810771296,
                    0x5ada56137efab742,
                    0x06d2e38a01e3513f,
                ])),
                Felt::new(BigInteger384([
                    0x3b44349d8134bb64,
                    0x4b8df8311dc3b130,
                    0x5d65a32800f3134b,
                    0x69ac678df4976450,
                    0x0ec60472fa3321d5,
                    0x0fd5c50fffc6037c,
                ])),
                Felt::new(BigInteger384([
                    0xac5b00e98e425ac4,
                    0x20c178900a03fb3f,
                    0x921c1d91856d9520,
                    0xde4a21322ca46d43,
                    0x72f8037aca800fba,
                    0x196da75fecfadb2c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x369b5d6340200101,
                    0x43c599f7b6a840a1,
                    0x6bbcb481f50eadeb,
                    0x6c3a5df83ef99750,
                    0xc26ebec4afebe89c,
                    0x076d2c446acdbe89,
                ])),
                Felt::new(BigInteger384([
                    0x5bbea53c75d37078,
                    0x7f55ed2c04c568e2,
                    0x394b190b20555c29,
                    0xbb2fac4bf6712414,
                    0x64037f24c5521bfa,
                    0x15f608798b79af08,
                ])),
                Felt::new(BigInteger384([
                    0xa8343e1d16864b61,
                    0x233e9ccfd45c32b8,
                    0x61c578b81f39d08f,
                    0x25f4ad60b6773178,
                    0x5f28b7d0f3dcfa9e,
                    0x1701910f377b76cb,
                ])),
                Felt::new(BigInteger384([
                    0xf7c983cb2cfe3b0a,
                    0x7334aa9f08c9e613,
                    0x39f864a5fc7d3b47,
                    0x64b02319c6746c5c,
                    0xb68fa27b7b59f47e,
                    0x14fedd408a513e4f,
                ])),
                Felt::new(BigInteger384([
                    0x9c108fa365b23939,
                    0xd28b9c9bc6a05bc8,
                    0x3334dafaf15236d9,
                    0xf7dc1e9fc25969d4,
                    0x3be0d1afb4241dab,
                    0x0f64bfaa4b3a0be2,
                ])),
                Felt::new(BigInteger384([
                    0xa2c1adf1899aa818,
                    0x697da7b897282659,
                    0x3ea2b57675579c9e,
                    0xb85aa42384140ada,
                    0x303d4f0bcadd31cd,
                    0x0d9866aca622f11d,
                ])),
                Felt::new(BigInteger384([
                    0x63d447f92188ea4b,
                    0x5a125d1d7d96450c,
                    0x7fb42f171bea5afb,
                    0xcfe2c08a79e62606,
                    0x8037f57b2497786b,
                    0x08552f5f53f482d3,
                ])),
                Felt::new(BigInteger384([
                    0xb65039ce63422a2a,
                    0x2dab989747a7d6fe,
                    0x151f3149923855b3,
                    0x03f40b02147a0aa1,
                    0x339312fab4c4fe02,
                    0x04c41c1123a6b147,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x44e204f22abd59d7,
                    0xa1c2cab372576a47,
                    0x6c357be211f673dd,
                    0x84202e6a0871e898,
                    0x840609e88bd22e8d,
                    0x0d47bcd8ed30a393,
                ])),
                Felt::new(BigInteger384([
                    0x0156fca1e527c283,
                    0x337748f957b16f63,
                    0x8ecfd9f1de53ceaa,
                    0xd830c99ba56ceda5,
                    0xa60ca0db2aaaadb0,
                    0x0ee1404179cca7b6,
                ])),
                Felt::new(BigInteger384([
                    0x67626810a3fecd7d,
                    0xd993b16161dcd32a,
                    0x5f72f4416a5b1fc1,
                    0xeb1b5b69e5ead0c9,
                    0x00431f7f626a8d20,
                    0x0eaa5f328b2a8387,
                ])),
                Felt::new(BigInteger384([
                    0x710d44ee421408f0,
                    0xf93c1fd00d50eff0,
                    0x982ed36583c52bd1,
                    0xd31624460c08e433,
                    0xbcae466aa7ba5f05,
                    0x0c1c5baf66c30585,
                ])),
                Felt::new(BigInteger384([
                    0x296298f795f8df4b,
                    0x2eb07cd82cc5918d,
                    0x8d9c62adb64e8e74,
                    0xf4b312369069fdf5,
                    0xad8e97367dd48c71,
                    0x0f36d27f1e1ccec0,
                ])),
                Felt::new(BigInteger384([
                    0x1f7bad1f40bfd49f,
                    0x5378ddfec968069f,
                    0x1f506627dd87479d,
                    0xa5fc18ea8564d6dd,
                    0x14afb31e3d9de1ff,
                    0x13c445e96c0163e1,
                ])),
                Felt::new(BigInteger384([
                    0x5328ccd4b1e6f85f,
                    0x2bbcbcb38b692b5d,
                    0x475040ac80fb81d3,
                    0x8f4556ab086ac3af,
                    0xd426225a56c4fbc0,
                    0x181f5ce1b9d556ce,
                ])),
                Felt::new(BigInteger384([
                    0x5f06f17699e9c1b1,
                    0x4b08905455c79f99,
                    0x3f822f60acbced57,
                    0x68682acd1003bfae,
                    0x64fd0157828f961c,
                    0x1748cddd9464b5d8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf41697a79f1ec50f,
                    0x7e14fb77b6b97ba1,
                    0x08b0010f714fb74a,
                    0x8383871fc042db56,
                    0x8f26e8993293272d,
                    0x0149a904af0a1d71,
                ])),
                Felt::new(BigInteger384([
                    0x015d6c9f587fc53b,
                    0xe897fea7bdec0428,
                    0x7d7bcb1866722009,
                    0xafebf9b06c07c97f,
                    0xcb3bb65aa8448cba,
                    0x0c3cd4c015401dc9,
                ])),
                Felt::new(BigInteger384([
                    0xdef8b742bff32e4e,
                    0x4665f396f80cd41c,
                    0xa00c2fb11ea52352,
                    0x8aa86a82f8ddf578,
                    0x3b6822a86115e168,
                    0x0f96ccc49ee8d39e,
                ])),
                Felt::new(BigInteger384([
                    0x2014fec0bf358f97,
                    0x9d5cf1e3d4fabcad,
                    0xc43f2d3c237f4a73,
                    0x0fe839c83198f2aa,
                    0xd008257f31212ca9,
                    0x083edfa5a3d1905b,
                ])),
                Felt::new(BigInteger384([
                    0x2a22a1abfc424e88,
                    0x79d9867e423f0819,
                    0xbc3c17d84b590fe2,
                    0x18d27260af96baa7,
                    0x35fa4e2f4a53d118,
                    0x10e2e1fa712a7133,
                ])),
                Felt::new(BigInteger384([
                    0x348a32b47a9a6959,
                    0x0c6f9840612951d3,
                    0xe5f0f93e47ea52b1,
                    0x6c0d420fc7a30373,
                    0x83c49b188b5fcaab,
                    0x0fe314632246118f,
                ])),
                Felt::new(BigInteger384([
                    0x355d9ee7211c804e,
                    0x541788ed563c28dc,
                    0x6af287dcb2c5e076,
                    0xbf730bc3d78818c2,
                    0x006b4cc9607970c5,
                    0x19e22539b5b210f3,
                ])),
                Felt::new(BigInteger384([
                    0xaa2133c96219caa6,
                    0x3e34c4f71dac21b4,
                    0x417ab26773b1efd4,
                    0x04d9782f292cc941,
                    0x42560fd473e7cadd,
                    0x10425781fd26bd54,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x97c1d55e9091359f,
                    0xdbd596428b083f88,
                    0xc76dee42afac9eec,
                    0xcf41e752c4fe4339,
                    0x93c2279ace92341b,
                    0x0bbf02d3ce6020a5,
                ])),
                Felt::new(BigInteger384([
                    0x71b0152326dd9a84,
                    0xa8f6ab13dbe42ec8,
                    0xb322a9f15e453b3a,
                    0x915fa6c05bfda143,
                    0x4f6bb954b029a064,
                    0x14b0d15e187cf7e0,
                ])),
                Felt::new(BigInteger384([
                    0x069517d8ea6745e4,
                    0xd32ac4aa597e288c,
                    0x25fed20ecc632d45,
                    0x1464f9f669b6b169,
                    0x3d3642072b9c5a62,
                    0x0e040167b9e8693f,
                ])),
                Felt::new(BigInteger384([
                    0x9a1256e1fac4e1ae,
                    0x1a87d95f40a8b1d6,
                    0x653d067013c10a02,
                    0xed1a401f2625fdf0,
                    0xa4b63fbd6106d0d9,
                    0x174d0465c6efafb4,
                ])),
                Felt::new(BigInteger384([
                    0xd82a0a76dd41b142,
                    0x4ce8f99c993f2beb,
                    0x770dbed6f005880e,
                    0x020dac88293a28c2,
                    0x1cceb78e6ea47107,
                    0x087f14835f969a2c,
                ])),
                Felt::new(BigInteger384([
                    0x85abfdf51ec7a442,
                    0x9ff0b5daa49c66ef,
                    0xc8ed13c5121cbe56,
                    0x92e5e6f690ae8f4d,
                    0x248a442f9bbaa2ff,
                    0x116003cce1102d3e,
                ])),
                Felt::new(BigInteger384([
                    0xeb0cd3e64c103ed7,
                    0xde75dd49711ec2ee,
                    0xc5933030dc78c69a,
                    0xb2e000b6456d9e9e,
                    0xf3f9179c5e70383a,
                    0x03e69552d9224b96,
                ])),
                Felt::new(BigInteger384([
                    0x9807996cd5f408c6,
                    0x375254cac0cefcc5,
                    0x65454179259f476c,
                    0xf47dd2572d104764,
                    0xddfb8d3038f211c9,
                    0x02af53701af41903,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x51e5ee28232d175f,
                    0x5ac0d81b75663b6b,
                    0xcc4b65df6b8b3377,
                    0x112e1d242d1cf4a3,
                    0x4b6ead8f684a7c54,
                    0x00e149c9e0a7f6e3,
                ])),
                Felt::new(BigInteger384([
                    0xe8b4b136847d052f,
                    0x47119de67411bd86,
                    0x5220b6436fb15ece,
                    0xa69e65adb593d124,
                    0xd00055886c4e7347,
                    0x11d28a543290ce06,
                ])),
                Felt::new(BigInteger384([
                    0x2c9fe17763f2d7fc,
                    0x5e85c4b6f68a9fb0,
                    0xfe3c1ebaf5a1eebc,
                    0xe14a2787320f79bb,
                    0xfedc214629c4c1ec,
                    0x08ee5fa72f1892f2,
                ])),
                Felt::new(BigInteger384([
                    0x09823d45e8e99056,
                    0xb4b0d4e8c0f6a86d,
                    0x6ccf4add5144596b,
                    0x2df598a3fb7fbcd3,
                    0xc3b44df6f5b4b8c3,
                    0x0f4f35092cf250af,
                ])),
                Felt::new(BigInteger384([
                    0x932c3729c9d210d1,
                    0x2285f258b80d65f5,
                    0xc3630322a9370f42,
                    0xba63ed08ffdcd976,
                    0xfb33f38a2fb524fc,
                    0x0ba396a645f0dc3d,
                ])),
                Felt::new(BigInteger384([
                    0x2c66c45c1909745d,
                    0x9f6c0a37186ba9d1,
                    0xaa41379e02bde765,
                    0xf55daff1980f5f83,
                    0x8338287224ab2d7b,
                    0x10f5996e400e6ebb,
                ])),
                Felt::new(BigInteger384([
                    0x86868faea1b313f6,
                    0x82ad5035f20b105e,
                    0xdd976987368abea6,
                    0x6137e16fc88b2be8,
                    0xe21f2bf70daa0b12,
                    0x114718eef61b5dde,
                ])),
                Felt::new(BigInteger384([
                    0xe79953f3ff0146d2,
                    0x1ef044bde964c69d,
                    0x1bacd15290bd189e,
                    0xfcaae29c1c29e0c6,
                    0x0f6f9fea4b227d56,
                    0x18313981e617865b,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 8],
            [
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::new(BigInteger384([
                    0x984400000016aa94,
                    0xda500058e5b00012,
                    0x97080d3e78fe9e67,
                    0x504ff0af50a70528,
                    0x0ca773961fe616c9,
                    0x17b73dc8ba06bf04,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x93334a2e0791dd5f,
                    0xba8b51edc649f318,
                    0x154e9343f11fb430,
                    0xf6df5427a2c8d8fa,
                    0x649eb2c0b43bc6a5,
                    0x19c2414be3155202,
                ])),
                Felt::new(BigInteger384([
                    0x75b655ec69cb1f2c,
                    0x26666c4b3ed4ddf8,
                    0x06698a6ebafe99b9,
                    0xd1c849cd151eaa6f,
                    0xd0795dc17f77eb34,
                    0x116e9adea7c0c2fc,
                ])),
                Felt::new(BigInteger384([
                    0x1061785325a3b754,
                    0x932dc9f67e71083d,
                    0x10810960b020569a,
                    0xe848d946300b7036,
                    0x43845e452068a528,
                    0x0521ed7d0570c951,
                ])),
                Felt::new(BigInteger384([
                    0x67b272742a1111ff,
                    0x8493b8a8a2905d85,
                    0xffc362d6f4598cd2,
                    0x0fdacae4bd373a18,
                    0xec69c2cc9956512b,
                    0x0bc953e3cb910633,
                ])),
                Felt::new(BigInteger384([
                    0xe6198ac98b33db62,
                    0x05ba218b0eb716b5,
                    0xaedc44ba9aff4ad1,
                    0x5f2c1f3db24a8078,
                    0x8d1bae46463a41e4,
                    0x09b6477258a9ed1f,
                ])),
                Felt::new(BigInteger384([
                    0x07e9eaf19e339fff,
                    0x7eee5d5f72754635,
                    0xdbb08b6f24b24be4,
                    0x0815cc01e83fc6de,
                    0x894222e03a23bfac,
                    0x01dceb2cca1ccf5c,
                ])),
                Felt::new(BigInteger384([
                    0x5935cb260cc410f2,
                    0xc6854b4578e8da81,
                    0x8ce64b2bd19f2f9d,
                    0x4f8b0f770f1df8a6,
                    0xba41f9ea2cb7be3b,
                    0x04a303dee8ecb965,
                ])),
                Felt::new(BigInteger384([
                    0xfedaf4fe410b3792,
                    0xaf895c9518032234,
                    0x76c1087315b35a1f,
                    0x03c644c06fd34987,
                    0xeb75fea3053e57c2,
                    0x06d4981a87b93468,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x28240a3b69fc6402,
                    0xc9dac0a707dfc132,
                    0x1287cfca77da8e54,
                    0xab0f54ba341d05ad,
                    0x90e84e6e7e8b7719,
                    0x085d950ae4b29514,
                ])),
                Felt::new(BigInteger384([
                    0xaf5c0319a6b78a44,
                    0xd99ead26495e29a7,
                    0xb5742e113cf1d478,
                    0x5d568bb528a9a938,
                    0x4b291961b278060d,
                    0x0538912e320143a7,
                ])),
                Felt::new(BigInteger384([
                    0x38746c6425402f29,
                    0x215042e79376d4b7,
                    0x825546ff8c10a399,
                    0x02cb633b101dedb4,
                    0x9a31b66b11d660e8,
                    0x14b8989c53d5a4de,
                ])),
                Felt::new(BigInteger384([
                    0x3c83e5fe9c59a9c7,
                    0x8605f564cf6d90a5,
                    0x39a79841be6f447e,
                    0xc2d36833541c8281,
                    0xe6f5406d4106a4b5,
                    0x0b57741293053e48,
                ])),
                Felt::new(BigInteger384([
                    0xd36a1871a2bf3d0c,
                    0x59320bda95472cbd,
                    0xb3d232cf9c475b45,
                    0xaecb3f8786f05e20,
                    0x3506901eeed3a592,
                    0x19a1e958b0132cf1,
                ])),
                Felt::new(BigInteger384([
                    0x0c8daae2ed007f2e,
                    0x0d4a261a03fb46aa,
                    0x8192bed70cbb11d1,
                    0xbf3912a7c4bfeca0,
                    0xdaf1a1d5d85940a8,
                    0x06a8c90c53f86b67,
                ])),
                Felt::new(BigInteger384([
                    0x4f62fd4040c51d1e,
                    0xa4119bff52b34ea0,
                    0x76545f34d496ea73,
                    0x133f1c7e65a3d6be,
                    0xba5f13c6e5d28ede,
                    0x1457135e44045aa9,
                ])),
                Felt::new(BigInteger384([
                    0xb56d7af25c25df0f,
                    0x3bd8c857cd449137,
                    0xe23bdd3a67c59e40,
                    0x92e9cdd4909dbb1f,
                    0x710ff5355fe7e0a8,
                    0x07f1b574913a4947,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3a28a0801e1fd223,
                    0x1811d5e3a1b94fd1,
                    0x4ce540a46c3d2315,
                    0x7e64391cc33fec2d,
                    0x7f50c5dfa89e0d0b,
                    0x0fcf98cf051baf1a,
                ])),
                Felt::new(BigInteger384([
                    0xeb7cfd658d87af64,
                    0x88c79a19173a6144,
                    0x2dae70c1a209bf3c,
                    0xc8731640e2300861,
                    0xca6b73c6b61d7dff,
                    0x0f98579eed8f6d34,
                ])),
                Felt::new(BigInteger384([
                    0x383bacc8eb05d1a3,
                    0x54b7418846f4e5d3,
                    0x46e9d55dc8f5bce1,
                    0x219e56c8188f16e0,
                    0xd5d06529d7e64bce,
                    0x13f6bf998d351388,
                ])),
                Felt::new(BigInteger384([
                    0xc0c77b56231e5043,
                    0x32a4909e40a5b27d,
                    0x0aca680cad61b9dd,
                    0x9b8415963685e235,
                    0xac43f964e63e89d1,
                    0x152280e43c8ccf4c,
                ])),
                Felt::new(BigInteger384([
                    0x0adf27c7e86698ea,
                    0x07fc31ea100d25d8,
                    0x8a86107a097380c7,
                    0xedd6823a9d7bb60c,
                    0x43f1573bc2854f19,
                    0x06145c708977119f,
                ])),
                Felt::new(BigInteger384([
                    0xc16cf7983a03a12c,
                    0x3534e0bb205001ef,
                    0xfc084abb61769436,
                    0xdcb3770c07d7a622,
                    0x5ac524ea3d5cf08a,
                    0x071d47e6aef854c8,
                ])),
                Felt::new(BigInteger384([
                    0x1ee04b2ac718de00,
                    0x0a84ff4b40f4c07e,
                    0xddbc033ecf97c1cb,
                    0x608ef94102de58ae,
                    0x40d31f4a2f74799a,
                    0x1460e9419884cfc4,
                ])),
                Felt::new(BigInteger384([
                    0x6a49b42408459464,
                    0x2160854197b2cdb4,
                    0xf61fbb2bca8ed309,
                    0xfc1ddf4595163d7e,
                    0x21f74c80a030c812,
                    0x170ee2319b7780c5,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x9fa66f0eb5264055,
                    0x8e37b6fb81075e0b,
                    0x44a00dfc9228110b,
                    0xaf8a6c24cbc74248,
                    0xab140555a9cfa305,
                    0x116e926a7a90c656,
                ])),
                Felt::new(BigInteger384([
                    0x42c4e85a743ab739,
                    0xc54ac86ed2c6c485,
                    0x58e585cf295407fe,
                    0x8078219e155b2390,
                    0x090d3616c00a9026,
                    0x162d49f3cf6a83da,
                ])),
                Felt::new(BigInteger384([
                    0x77552b30c6e6425e,
                    0x5c5cd86411969486,
                    0x1fbd1b136ab85030,
                    0xe86d08920809d5cf,
                    0xf539ecfd6993a8ed,
                    0x0b1d58df6d8f2b05,
                ])),
                Felt::new(BigInteger384([
                    0x85d3956f4f2e6a05,
                    0x63cfc573dbb6bcf6,
                    0x7278dbacd98fc95c,
                    0x65d71142d9f6092b,
                    0xc68beba40d9c0aff,
                    0x02c362b9ad96b06c,
                ])),
                Felt::new(BigInteger384([
                    0x54961e3254b2bfdf,
                    0xcfcd3e9bf42ad665,
                    0x6bc9e2eee95b69e6,
                    0xedcd6740323493b2,
                    0x7e5c533fa5759115,
                    0x14ee46e73fc5565b,
                ])),
                Felt::new(BigInteger384([
                    0xe966ae25eb8b7963,
                    0x309e23a75692503d,
                    0x39f50b2bba250f92,
                    0xa83c00cfe8b716b1,
                    0x0d952b6cfdf98a77,
                    0x138f363116004af3,
                ])),
                Felt::new(BigInteger384([
                    0x3b761793b6e81773,
                    0x33d816c4ae4e480a,
                    0x067c372d95bc77c7,
                    0x3dcb18622d08775b,
                    0x09913401a5ed2368,
                    0x0c8c785cb474037c,
                ])),
                Felt::new(BigInteger384([
                    0x25d0ad8adf64c318,
                    0x4fba7f85324110c4,
                    0x388e1ae182702448,
                    0x1bfdbaece036eda7,
                    0x0a0d6bc8a1e37db1,
                    0x034bedc3d6c95ba2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x42d81ed97c8dab9e,
                    0xe15d56cf653ed4ee,
                    0xf251327d10868404,
                    0x5a65c8c4a541e363,
                    0xd432dda6a88e9b9d,
                    0x00598a9f8ffd791e,
                ])),
                Felt::new(BigInteger384([
                    0x8bb35adbb88399f5,
                    0xca01e549927c799c,
                    0x5d220924866c80ba,
                    0x5be1a8d992e6cd3d,
                    0x64e652cdfc5b8570,
                    0x0c879c63e5658810,
                ])),
                Felt::new(BigInteger384([
                    0x3d3f58e17ae8b7b0,
                    0x2591cbcf7e93e5ce,
                    0x96bc68547f894e41,
                    0xc244cee85fbdce9a,
                    0xcb455e1f2d15c143,
                    0x12dd37e6810fa776,
                ])),
                Felt::new(BigInteger384([
                    0x40f79e1198487355,
                    0x471b13cdcaa3c895,
                    0x6829743e0a5dcea5,
                    0x8a6d34c2122f4cef,
                    0x6284013e0592a187,
                    0x0e7566840e03616f,
                ])),
                Felt::new(BigInteger384([
                    0xb5482419ae85b315,
                    0x966e2992006ea72d,
                    0xefd25e2b1c82bfac,
                    0x6bfbfae9c4e1117d,
                    0x94af4d6b3164f834,
                    0x002059b59bdeac2c,
                ])),
                Felt::new(BigInteger384([
                    0x506e7c2038df4191,
                    0x521446dfef994c5b,
                    0xa55985652b176cdf,
                    0x9b3c49f78ff3bff2,
                    0xe2f9910bc143bb62,
                    0x17b1f95be3745378,
                ])),
                Felt::new(BigInteger384([
                    0xc8b21b80d4f669bb,
                    0x222651fb93fb3f5d,
                    0xf085132ae1e6b3b0,
                    0x6c08b7e560e6451f,
                    0x8992c48673c517d1,
                    0x05a00bb15512233c,
                ])),
                Felt::new(BigInteger384([
                    0x42077c7f160642d9,
                    0x3110686bb1320f0a,
                    0x93c024c83540b3bb,
                    0x73b5c06bd86fb8bb,
                    0x78222ad12eca0d02,
                    0x0fb92b5c0a47c309,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x82641a1f2a4d7d87,
                    0x20ec7e2e0575319a,
                    0x2bbfc24dd63a9995,
                    0xd6dbb93d5ebfb77c,
                    0x82f138663f5d9738,
                    0x047afcc94bc12910,
                ])),
                Felt::new(BigInteger384([
                    0xaa0cd7b223caee9e,
                    0xe1e394c3ea146053,
                    0xc07bf7155d1bae7f,
                    0x4e6f7edf7eef7cf3,
                    0xa259cbfe33c4c208,
                    0x08010d96ea8619ce,
                ])),
                Felt::new(BigInteger384([
                    0x660f0eb120aea69c,
                    0x41e9238dea86f789,
                    0xc471e03e88fde915,
                    0xf81148edcdf55b05,
                    0xe81bd3d26b16c6a8,
                    0x01749182088d87ae,
                ])),
                Felt::new(BigInteger384([
                    0x84b4324140ea3a06,
                    0x5d2236f9ee243df7,
                    0xa27e019199053448,
                    0x02d9152a4f6388b5,
                    0xca651346ea075ae7,
                    0x009d7cb25385e8aa,
                ])),
                Felt::new(BigInteger384([
                    0x53a8a17016369dbe,
                    0x4cdbbaf84018794d,
                    0x6c9802ae7ba42c7e,
                    0xed39efa0ca708e5f,
                    0x4963d0034a8aeed4,
                    0x0d85a1aaee2bd3a1,
                ])),
                Felt::new(BigInteger384([
                    0x31b09f0a7f762ed5,
                    0x4a3d984fcf7da05c,
                    0xe20a9d75472bd369,
                    0x20e67fdede889329,
                    0x45308d731909a779,
                    0x0b9c045f42404e7f,
                ])),
                Felt::new(BigInteger384([
                    0x7f2ac2e1e000d193,
                    0x8da63c2be31ab152,
                    0x2f9535c3084c5a0e,
                    0x3394a5c3d7b2b201,
                    0x8b02c964dffd6b25,
                    0x11910628a877bf43,
                ])),
                Felt::new(BigInteger384([
                    0xe17116bf23472c39,
                    0x8ac16b3bfa19845e,
                    0x77e564a1f9ccef1a,
                    0x71dd8e15bbe6d561,
                    0xf96f0d1a00a1806d,
                    0x05b5b4e504fd18c4,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
