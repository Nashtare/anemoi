use super::{sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 8 field elements or 384 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 8;
/// 7 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 7;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 4;

/// 2 elements (96-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 14 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 14;

// HELPER FUNCTIONS
// ================================================================================================

/// The field multiplicative generator: G = 2
const G: Felt = Felt::new(BigInteger384([
    0x321300000006554f,
    0xb93c0018d6c40005,
    0x57605e0db0ddbb51,
    0x8b256521ed1f9bcb,
    0x6cf28d7901622c03,
    0x11ebab9dbb81e28c,
]));

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= y[i].square().double());

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t += y[i].square().double() + sbox::DELTA);

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3]];
    let y: [Felt; NUM_COLUMNS] = [state[5], state[6], state[7], state[4]];

    let g_x0 = G * x[0];
    let g_x1 = G * x[1];
    let g_x2 = G * x[2];
    let g_x3 = G * x[3];
    let g_squared_x0 = G * g_x0;
    let g_squared_x1 = G * g_x1;

    state[0] = x[0] + x[1] + g_x1 + g_x2 + g_x3;
    state[2] = g_squared_x0 + g_squared_x1 + x[2] + x[3] + g_x3;
    state[1] = state[2] + g_x1 + g_x2 + g_x3;
    state[3] = state[0] + g_x0 + g_x1 + x[3];

    let g_y0 = G * y[0];
    let g_y1 = G * y[1];
    let g_y2 = G * y[2];
    let g_y3 = G * y[3];
    let g_squared_y0 = G * g_y0;
    let g_squared_y1 = G * g_y1;

    state[4] = y[0] + y[1] + g_y1 + g_y2 + g_y3;
    state[6] = g_squared_y0 + g_squared_y1 + y[2] + y[3] + g_y3;
    state[5] = state[6] + g_y1 + g_y2 + g_y3;
    state[7] = state[4] + g_y0 + g_y1 + y[3];
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 8],
            [Felt::one(); 8],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xed694f75b4c99cfd,
                    0x684bc0e28f3245c8,
                    0x70852c61c47fe0d3,
                    0x35153df1e85e72a0,
                    0xf8ef66ad04a98e8e,
                    0x072408ef87f94434,
                ])),
                Felt::new(BigInteger384([
                    0x10a1600640ee9319,
                    0xbf82ef1501b3e026,
                    0x481390a60c0502f1,
                    0x74db83bf22ec19a0,
                    0x486a86bff9e18593,
                    0x0dc0e9c4063d33cb,
                ])),
                Felt::new(BigInteger384([
                    0x36644c27885b4880,
                    0xcd8d6cb9b938a4b7,
                    0x00ed4c405c2952ea,
                    0xe9bab45f35d9b721,
                    0x4695ef71e88a4280,
                    0x0d413e4096044a82,
                ])),
                Felt::new(BigInteger384([
                    0x65c42aceefe3b97d,
                    0x91e871d04f229d47,
                    0xc6fba6eb6c513f57,
                    0x23c60917e5383d59,
                    0xad79f49ef6dc2b92,
                    0x0641089f93fa06d6,
                ])),
                Felt::new(BigInteger384([
                    0xb5b46dab68026413,
                    0xddc666aca470bb07,
                    0x0f507ef8b5eed3d6,
                    0x88f20b3c070267e4,
                    0x1f66d94520b2f8da,
                    0x0f5bf23bc547f228,
                ])),
                Felt::new(BigInteger384([
                    0xd6f63978f0b90905,
                    0x6253eb338b22f518,
                    0x6d2169c5ff11fd00,
                    0x028e757257e9f8cc,
                    0x71c4c5958ba31434,
                    0x03355c3be515ce39,
                ])),
                Felt::new(BigInteger384([
                    0x62305c89c4456a31,
                    0x64ba6ea5d1ce1004,
                    0xbfefee5ad8b2e675,
                    0xa4d248e52ea5dffe,
                    0xd75a7c22b6e67279,
                    0x0fdbce440078fcc1,
                ])),
                Felt::new(BigInteger384([
                    0x2c2ef44e528098ca,
                    0x4276fcf902fd2627,
                    0xf5c0b5e7ad16de3f,
                    0xfebc2eae45eddaea,
                    0x74cd74edcedf4358,
                    0x0ffbf26644e352c6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x30ed3b7756729c7d,
                    0x39d8dff5962beff1,
                    0xcb76a27414e8a2bb,
                    0xf53d2488ddebae3c,
                    0x0ea581f0000a9393,
                    0x12cf87dd8962ad1a,
                ])),
                Felt::new(BigInteger384([
                    0x365629b90904ecae,
                    0xd7f541b404241637,
                    0x705f248d51df2f2a,
                    0xd47beb45c0d887ed,
                    0x6e8f63116d384fb8,
                    0x0302d5553d2235d4,
                ])),
                Felt::new(BigInteger384([
                    0xb33259e0990a9fc1,
                    0x544c791eaf3e9c1e,
                    0x0a5089f385bd9e5d,
                    0x56b9f76f1a65f531,
                    0x6c3b9b3716924cac,
                    0x0bb06bce00c193a6,
                ])),
                Felt::new(BigInteger384([
                    0x672cd43d570290ee,
                    0xc176f433171c427e,
                    0x9156c0941a9a8fd5,
                    0x1199044d11f0398d,
                    0x2bb47efba922632d,
                    0x0102786328dc5dcd,
                ])),
                Felt::new(BigInteger384([
                    0x34a8c768446317e1,
                    0x08fbf27d69fa7117,
                    0x3261da235ad31c90,
                    0x27f96cc53501a08b,
                    0x465f0e6bca390e2a,
                    0x065e8b5972d6dcee,
                ])),
                Felt::new(BigInteger384([
                    0x439bf9cc8500e281,
                    0x4d4b334c153b63d0,
                    0xcf407ce9109e12c1,
                    0x7dd73cbd21216ff0,
                    0x61e84d9cc110aeec,
                    0x0d2a1ce3f95417b1,
                ])),
                Felt::new(BigInteger384([
                    0xe9a9c6b795993efa,
                    0x0e720e148fc68dcc,
                    0x0017545e82b47557,
                    0xb2d422e154cd81af,
                    0x92465b15009d035c,
                    0x0ad032a3308b4a0a,
                ])),
                Felt::new(BigInteger384([
                    0xb00440ff02222148,
                    0xb15d705c10243bb4,
                    0xa3e1f6fff89d5461,
                    0x7312de6da53ba193,
                    0x2cc6c7ccdfcc8ea7,
                    0x11f3e92986a34dc6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x63bd69651037039c,
                    0x9f27736f7e06b101,
                    0x84f72c3d93df46d7,
                    0xa57412ee8cc60260,
                    0xb777e60150ca783e,
                    0x0e0caaf4fe8aa983,
                ])),
                Felt::new(BigInteger384([
                    0xcda899b62b7e50e4,
                    0x7a9183365e79c953,
                    0x2bbec5c1e368abb1,
                    0xefe0d914a5717dd6,
                    0x419670209f258bc5,
                    0x18178c6b73880710,
                ])),
                Felt::new(BigInteger384([
                    0x241e339b4763b960,
                    0xcfd75bf7f39cea90,
                    0x3b5ec214d0af4ee9,
                    0x796c54d86ac563fe,
                    0x65f3152a3ba46d99,
                    0x0c2990e623f48819,
                ])),
                Felt::new(BigInteger384([
                    0x056f08a222dc1dc7,
                    0xb752cd51226e2ff0,
                    0xd642b9aea969f9ab,
                    0xc242ae2bbf75a9a1,
                    0xa07dcf88dbd1e25c,
                    0x0eb0ff7121707856,
                ])),
                Felt::new(BigInteger384([
                    0xd95b3795f4d2d255,
                    0xdc4c98cd52846bba,
                    0x0570316e94dc581f,
                    0xc51ff1b7139a7085,
                    0x31e3de57b06b6a16,
                    0x11dc488e4e22f4bd,
                ])),
                Felt::new(BigInteger384([
                    0xf2e8b3faff03fa9f,
                    0xc39c02431110e374,
                    0xc6092d68d1651275,
                    0x7bc980ecc463cbea,
                    0x727c5d75a15faf77,
                    0x183d7ef16bd7712d,
                ])),
                Felt::new(BigInteger384([
                    0x0a06c7fc6f3a2480,
                    0x6c80859788034380,
                    0x39ee958d21ffe6bf,
                    0x26f8292e234f41fc,
                    0x641a09ac507edf8d,
                    0x125c16deb9b55157,
                ])),
                Felt::new(BigInteger384([
                    0xf22869d33271f63c,
                    0x65f91d902a4fd902,
                    0xf889a7accde21958,
                    0x539e7c53c2556652,
                    0x41294ed4588a2d4d,
                    0x19d290587bf2daa2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x929c2cb07c34f404,
                    0x0a8615800e52ccfa,
                    0xa91f13532ae3d8ca,
                    0xcfec957d36519f97,
                    0xa2220e4cba106462,
                    0x05de2b7d8f6227cf,
                ])),
                Felt::new(BigInteger384([
                    0x0d34aea8a4f2f289,
                    0x7bc6c0188ee20797,
                    0x3f53609e29699196,
                    0x18dae336540f8e78,
                    0xd84e603fe9cd5dd3,
                    0x0da8bc3e18c2df45,
                ])),
                Felt::new(BigInteger384([
                    0x72517cba7ce4d8de,
                    0x9b8087faee1b75d2,
                    0x5dba89352aca6a7d,
                    0x7ff66e4fa31b1a62,
                    0x097a16c318bc9e3e,
                    0x0b39b8283e1c562a,
                ])),
                Felt::new(BigInteger384([
                    0xfdf738ab6ee47845,
                    0x377937d6ea576561,
                    0xeaa4d9395972192d,
                    0x05d1ea98d2a03d64,
                    0xcaa09c2300af1484,
                    0x0933356c320aeb6f,
                ])),
                Felt::new(BigInteger384([
                    0x544591dddf591a6d,
                    0x9a10224570fa0f3a,
                    0x340bb3074ac9223d,
                    0xd93f164577ea58c0,
                    0x91dbb64f1c50a215,
                    0x1811cf479e7b7681,
                ])),
                Felt::new(BigInteger384([
                    0xf6825597f73205a1,
                    0x6408758f07598a65,
                    0x775b848047fdcd95,
                    0x021d39fd067b5c6a,
                    0x91a9f55d1047bd12,
                    0x1451b1dea08a2188,
                ])),
                Felt::new(BigInteger384([
                    0x47158119f0a4a024,
                    0xbc4b98a267d7dae5,
                    0x07bcd4f3a268725d,
                    0x768993079bfeb655,
                    0x5bc90505cc6f4c0c,
                    0x1425ff43331b7820,
                ])),
                Felt::new(BigInteger384([
                    0xd440574d141ebdbd,
                    0xe88a35f4a4182f2d,
                    0xa627cc0e8defcc7d,
                    0x6c41c809e1ff6d99,
                    0x18c47310bf7fc035,
                    0x103d399f7866b14f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xce6e355f14d723df,
                    0xbfc6773954ee9326,
                    0x9db78bd60c3deaa6,
                    0xd263a49152ad32b1,
                    0xd308d50565cd93b5,
                    0x12a2eb26b56683ec,
                ])),
                Felt::new(BigInteger384([
                    0xc6b0a1148dee96e4,
                    0xcfe8fd6bf2f087c5,
                    0x0c6edc5c82b21b16,
                    0xa95cf51ea68985fa,
                    0xb8315681184c606f,
                    0x0ea0f08c74e73829,
                ])),
                Felt::new(BigInteger384([
                    0x9f6f2daa0a0ee402,
                    0xef8ea2a623d9d4cf,
                    0x13ede0aa746a4a57,
                    0x150eaf0fb96f401e,
                    0xb355e5cc5e8ee33a,
                    0x0f179c5d3badf0bf,
                ])),
                Felt::new(BigInteger384([
                    0x170ce6c0fdcc7c64,
                    0xca2fb9ad92a35dad,
                    0xd7c37bf240252c1f,
                    0xfb9f607be3ba2372,
                    0xfddc2c975b86122f,
                    0x1675e5052bb39407,
                ])),
                Felt::new(BigInteger384([
                    0x9f2ddd69d83b1a61,
                    0xc2714cf5609e1cc7,
                    0x1b8423db6d547117,
                    0x32af43e07c3d0fbb,
                    0xf22485705464ac1d,
                    0x0f69d7b4df4e4c98,
                ])),
                Felt::new(BigInteger384([
                    0x8f609931124d4efb,
                    0x3530bcf9db8447f9,
                    0x8c61b96a424966ab,
                    0x7e01b931eea88cd9,
                    0xc00132a7e8169977,
                    0x039676e7947ed07e,
                ])),
                Felt::new(BigInteger384([
                    0x2dc874485434e1db,
                    0xb6edc3721c29a56b,
                    0xa48bf1767de0eea8,
                    0xe90bd6a994122481,
                    0x2d09213e080ce71e,
                    0x05f2bfb4fec91718,
                ])),
                Felt::new(BigInteger384([
                    0xe94ed738f9f076d3,
                    0xaadd28c69ecbafaf,
                    0x033f26c7e5dd3cab,
                    0x487fb47377272a98,
                    0xbf1e6b9e0743ce00,
                    0x14994c968af70552,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x94f44a9b2122f970,
                    0xfa0246a6b312aa72,
                    0x9b0c01129c12c15d,
                    0x4a3693039bcf65d1,
                    0xd5493c760e114376,
                    0x0a2874d2e968e2dc,
                ])),
                Felt::new(BigInteger384([
                    0xfa9727687510681d,
                    0xdc415ec9e780138a,
                    0xea59884f8cc7958a,
                    0xff49719d91f02b71,
                    0x74b3fc2a5c6aae4c,
                    0x04e6ea75d1cdbff7,
                ])),
                Felt::new(BigInteger384([
                    0xb6e2a0454d00a09e,
                    0x2852cc737ca5dbc3,
                    0xc6a5abc965bec241,
                    0x39aa2f186672bb69,
                    0x3f5940457c36ebc5,
                    0x0fc077e8f3ac61c2,
                ])),
                Felt::new(BigInteger384([
                    0x4183d8471087b4cb,
                    0xfc0945a3681a4810,
                    0x321ff41d62535ef3,
                    0xe65420550015a659,
                    0x3639c93111086331,
                    0x19839834e86452a4,
                ])),
                Felt::new(BigInteger384([
                    0x52bf2f13c003de64,
                    0x7a844d6af484b8fd,
                    0x7dd30369749bf668,
                    0x8f186410aba59280,
                    0xbcf856bda464d0fa,
                    0x03edf937f9cee0f3,
                ])),
                Felt::new(BigInteger384([
                    0xa343df957f049ce9,
                    0x29b8eeb326d92889,
                    0x949f996438206d4a,
                    0xcfc7b4972c6109ae,
                    0x5d0f1741eac1052d,
                    0x0a3d0c70b2b538e5,
                ])),
                Felt::new(BigInteger384([
                    0xa4eb8b00d0d324d6,
                    0x53c5266a2ffd9f77,
                    0x723643bd2219cae6,
                    0xb15653ac27651785,
                    0xa74d5d33002fc88f,
                    0x18cbeea2ed8fe141,
                ])),
                Felt::new(BigInteger384([
                    0x824e6cf02fdaa4e0,
                    0x60cf3cfacf65aed8,
                    0x69f751662cb147d6,
                    0x9b9a9dadf5860e8e,
                    0x30b0ce0bd7359ead,
                    0x039c7ee521e2b685,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x783c78bf0abc76bc,
                    0xdbf68ca6f0786ecc,
                    0x027bc669cb002066,
                    0x175c62f43eb63c8a,
                    0xc23e5314cce429a4,
                    0x053f69ece85c4db4,
                ])),
                Felt::new(BigInteger384([
                    0xd2ae6ad61e273ede,
                    0x105a7d4d05626730,
                    0x5308fbbb683c793a,
                    0x6fd0e3b18c348f25,
                    0xece056673a1b7c61,
                    0x0f9f3c12938a9100,
                ])),
                Felt::new(BigInteger384([
                    0xc670cfc107d3a71f,
                    0xd0e28216f278c292,
                    0x8800a77d2849dcaa,
                    0x8360a8ebca6c0f1c,
                    0xd86fcb444534abb3,
                    0x096d124a70b44761,
                ])),
                Felt::new(BigInteger384([
                    0xe357b8ffabacdff6,
                    0x58d811d71f39cd4d,
                    0x81c08ca588cade55,
                    0x982a66f0d1315f66,
                    0xe3a7b94d57b2036b,
                    0x180832efbe3b93e1,
                ])),
                Felt::new(BigInteger384([
                    0xf2e3bf6968420364,
                    0xfa8cff73d47bb41f,
                    0xf31ab9ec3d1df0ed,
                    0xa6d9597a54ce928a,
                    0x33f0d3747f61d173,
                    0x07b947e8809e5dc8,
                ])),
                Felt::new(BigInteger384([
                    0x2eec2b3a241ef547,
                    0x8cb48f0d3f75eb72,
                    0x59d77afc3e873548,
                    0x4d72d78235311405,
                    0xa25564e1c534e9df,
                    0x14649c7c9b424bdd,
                ])),
                Felt::new(BigInteger384([
                    0xfda7ad942ea15993,
                    0x5ae9df8ae27f2266,
                    0xf43aefe80a438e25,
                    0x28370585fe1ec284,
                    0x7659ee1fee27a7da,
                    0x0e069633b3f84190,
                ])),
                Felt::new(BigInteger384([
                    0xff4e6f0d7c73f9a7,
                    0x68c35f24ea27e78e,
                    0x92f85290f2d65447,
                    0xf25cc7ec1ca67e9c,
                    0xfcbea2672fedd8a5,
                    0x0c2474616dd07b78,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5b1fce9f746e4bd3,
                    0xe430405846d9cb2f,
                    0x48f23b2d5cc597e6,
                    0xa3e5ebbd57b96893,
                    0x679c627c7c5ee26f,
                    0x19c9ed70659511e7,
                ])),
                Felt::new(BigInteger384([
                    0x187248a19f7d2916,
                    0xbaf54943ad734f35,
                    0x8d2fdb54441622dc,
                    0x182c80e1e142190d,
                    0xc6de23f1dee60ec7,
                    0x08edd504e02bf0c6,
                ])),
                Felt::new(BigInteger384([
                    0x21838cb52ceb2566,
                    0x1a18c434c323581f,
                    0x3dc66db10609a578,
                    0xf84913338323e241,
                    0x1f2610d4a998b73b,
                    0x002d02e0b8927b3b,
                ])),
                Felt::new(BigInteger384([
                    0xb7bb1eeb6358a53c,
                    0x6ca92ef7e2adedaf,
                    0x9a6924d7a4d42535,
                    0x3b697a7160c245f4,
                    0x4406b12661baddca,
                    0x08e4f3f569d70a24,
                ])),
                Felt::new(BigInteger384([
                    0x2a9f7c7ea7afee3c,
                    0x2e45bfaf1b5e45bc,
                    0x0be5e267399665bb,
                    0xac7b289aba077743,
                    0x218cac038a83a219,
                    0x05b2de7f587444ab,
                ])),
                Felt::new(BigInteger384([
                    0x4f3519e474c00942,
                    0x2512d2cc0efdf936,
                    0xa681c6900c85e2dc,
                    0x61ccb2aac1764798,
                    0xfffe0c986f518ecf,
                    0x0e0e5e2143ea847f,
                ])),
                Felt::new(BigInteger384([
                    0x5b5cf3f8a28dac4d,
                    0xc4a2fda759ebf51a,
                    0x51de4423271b2910,
                    0x85bb9819a1689906,
                    0xdfbd4606d01bbf6a,
                    0x0979a18f9eb272df,
                ])),
                Felt::new(BigInteger384([
                    0x844078614ee424d5,
                    0xa8255905123de024,
                    0x9a9e6ccab8a1784a,
                    0x7496ef50a2c3d0f1,
                    0x5b6f26b04664e9bd,
                    0x01a2417f612a8053,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x40534eaea33c9837,
                    0x4c50955a336ef504,
                    0x573056c1a258253f,
                    0xcccf7446d98fc8a5,
                    0xb4048455521cda63,
                    0x1865147916987e18,
                ])),
                Felt::new(BigInteger384([
                    0x47fe661642a78c0e,
                    0x6ca9ac0a5562d8cc,
                    0xeff635cd4fb0719a,
                    0x095f3508226d7698,
                    0x7cc733bf276a0df3,
                    0x0f887ada6aef1ebd,
                ])),
                Felt::new(BigInteger384([
                    0xce3b436ab5e6467b,
                    0xa92f85f5dab9069b,
                    0xb640fec0869da956,
                    0x4a354ba7827e6485,
                    0x106e9680307724b6,
                    0x064773c8d4f6c623,
                ])),
                Felt::new(BigInteger384([
                    0xd122eace42ec4f55,
                    0xecbb0c62e1afb0c1,
                    0x83a3e040bc404f67,
                    0xdc72cc7b9e37e9f7,
                    0xe5385f743b92a0c3,
                    0x12de5e2c45f09b38,
                ])),
                Felt::new(BigInteger384([
                    0x1a68137aac82a8d0,
                    0x1264344a145e2c95,
                    0xd58cad5fccfb26a3,
                    0xd02c7aaa7e2c464b,
                    0x544dfaab1ea91822,
                    0x0247ba0a66e59695,
                ])),
                Felt::new(BigInteger384([
                    0xe4dc7c198eed1512,
                    0x78ec4200ffb65ee3,
                    0x58f57250aaeec5e8,
                    0xc730d0f4d94efc26,
                    0x01f2cea3c5b55650,
                    0x02510e9cbbfbd580,
                ])),
                Felt::new(BigInteger384([
                    0x37501ab214c342b7,
                    0x29368c6b0f126c57,
                    0xbcf68c94dd647cbc,
                    0xc387b302dd869edf,
                    0x70acdcfe7a1cdf4e,
                    0x083a880024857ff6,
                ])),
                Felt::new(BigInteger384([
                    0x8c7dd272ade2486f,
                    0x2eb49f11b4f9fe86,
                    0xd1ba3a023f0aa7cc,
                    0xc8ebf36c9f475c78,
                    0x5ec13f2d7258f5e6,
                    0x0177238dbb4eb4e6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1de95cd3f17eb96f,
                    0x92b3384a16f427cf,
                    0xdffa68012b62004f,
                    0x954a721f66f656a9,
                    0x1b5db9e75969a9f1,
                    0x0b2b57f3fe693255,
                ])),
                Felt::new(BigInteger384([
                    0x75962eadcdf45cba,
                    0x1d46af97e02e0970,
                    0x383967d0e3e3fb9b,
                    0x197f798df97591eb,
                    0xae6a358e7afdb8df,
                    0x04a4a68545e7f8d9,
                ])),
                Felt::new(BigInteger384([
                    0x22c7207c8b2de44b,
                    0x720ed0d3afb982a6,
                    0x20ffb8867d1b7b66,
                    0xc7d78f1ec933dedf,
                    0xb1a122967c4e77af,
                    0x073006f4c830fd9b,
                ])),
                Felt::new(BigInteger384([
                    0xb24cc850ad447078,
                    0x45fc10f6fa22b600,
                    0x0e776819b1cf476e,
                    0x2f1a07d922260b19,
                    0x761983b0ecbeaf95,
                    0x00678ef35ffb7fec,
                ])),
                Felt::new(BigInteger384([
                    0x4cc768987164c3de,
                    0xf57720705fde41d4,
                    0x12a0f8212c39b2d6,
                    0x763c4c3a6a5617a6,
                    0x906bdaafd9d576b6,
                    0x03bbb5c8cf3bc6cb,
                ])),
                Felt::new(BigInteger384([
                    0xdf93c50017e4b4cc,
                    0xd0a41fc39a73bf60,
                    0x7637b1cc19ef23a3,
                    0x63a25bda624cb447,
                    0x355ed9cd8bfdfd49,
                    0x065927a0f6e7e9ef,
                ])),
                Felt::new(BigInteger384([
                    0x03b14fa75a0959b4,
                    0xf475b54ab3822043,
                    0x70d76379dfb35d31,
                    0x31938895d530f033,
                    0xa839ed453be1ad6c,
                    0x0da98921ad7fe80d,
                ])),
                Felt::new(BigInteger384([
                    0x4f3fc19b79cc7ec6,
                    0x81739127ce1fa909,
                    0xe727558a141563f4,
                    0x3322f169d9725c47,
                    0x925d7833e262358b,
                    0x12b29817b71c70f1,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7daa9ceef3e10704,
                    0xfa23fc00fc102136,
                    0x5061408c9e6d03d4,
                    0x96a0020d6084c457,
                    0xd6f2154deb4d133a,
                    0x073498e3f6eb1201,
                ])),
                Felt::new(BigInteger384([
                    0x01c786a3301a869f,
                    0x6f36c339a83f001e,
                    0x460d8b4ecbff4cab,
                    0x2c6c603b684481f6,
                    0xe6dae8bc0f96c758,
                    0x14bfce3730895736,
                ])),
                Felt::new(BigInteger384([
                    0x2a83cdce7795fed7,
                    0x6f9c8128899e4ccf,
                    0x8beb8948bcefcb53,
                    0xf48de8ac1874a69e,
                    0x105353293568d2f3,
                    0x13c8d9d75f96f83e,
                ])),
                Felt::new(BigInteger384([
                    0xe2082f083cf4d054,
                    0x06946439094324d1,
                    0x534a5ee34e295bf8,
                    0x5ddfdf9009e376e0,
                    0x0c412465c312b104,
                    0x140530531502e2af,
                ])),
                Felt::new(BigInteger384([
                    0xe51dc9d721dbf6f3,
                    0x1cca8ce7c53043a7,
                    0x16d1393382813a41,
                    0x2b15e0fe83218ed1,
                    0x403178df6daef3c3,
                    0x06f840553b6fea8b,
                ])),
                Felt::new(BigInteger384([
                    0x9cddc49424e03f55,
                    0x8fe9d3c7799a2e74,
                    0xc6ee54824c9590d0,
                    0x66f51ec310b0cb09,
                    0x214e8f17c196ca5c,
                    0x0d7518b350444267,
                ])),
                Felt::new(BigInteger384([
                    0xbe3d4371abcd97d9,
                    0xdc122157d6879d03,
                    0x69dc05c136e27b41,
                    0xa18ed43b00cf3940,
                    0xe651a20f6a0b678c,
                    0x0fe5eb506391c1a1,
                ])),
                Felt::new(BigInteger384([
                    0x6f61e3a25c3511d4,
                    0xb3e15ad95d211309,
                    0x91a0521de4b0496a,
                    0xfc4bf77d6d124187,
                    0xf03b9a57e7dd419f,
                    0x19231b4c36a27457,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x219d87b3f86534dd,
                    0xf2870dc9dee82054,
                    0x80274221299707d7,
                    0x304b39adad3528eb,
                    0x8207fe12fbd97a72,
                    0x06bb9d4eb32993bd,
                ])),
                Felt::new(BigInteger384([
                    0x60b06418add4c9c9,
                    0xd6c54886398cd9d5,
                    0x072f4828c38c1fbe,
                    0x66bf1379442d7a67,
                    0x117285bde5e57f42,
                    0x09eb930c9eadff3e,
                ])),
                Felt::new(BigInteger384([
                    0xe58386a101d9362f,
                    0x7697ca20a6e976e0,
                    0xdaae4104642d364b,
                    0x3bfb6372f9692a0a,
                    0x9f43f84453084738,
                    0x04d8206ca576056d,
                ])),
                Felt::new(BigInteger384([
                    0x002d96ac37939976,
                    0x586769404ddab23e,
                    0xe7910c49f06e395f,
                    0xf91345a4921aad73,
                    0x7c8310092b7d117d,
                    0x080e39307f87eeb5,
                ])),
                Felt::new(BigInteger384([
                    0x86a752c8420f5c8b,
                    0xe7e1a28b2a5ddfc8,
                    0x1ab1e47380890851,
                    0x51b6cdb6b2736104,
                    0xba775763981c37dd,
                    0x09724b251a792f2f,
                ])),
                Felt::new(BigInteger384([
                    0x8add0c5593719aad,
                    0xba6b5d4eaeba1fb2,
                    0x3ad635f1b2642c00,
                    0x941ebbd5bff10104,
                    0xad6a0b2c13455cc1,
                    0x0915d36304686fdd,
                ])),
                Felt::new(BigInteger384([
                    0xb3c73170ff35de0a,
                    0x3c9e3efc9c0a6fde,
                    0x8d638527453841b8,
                    0x97b9153509e7b07b,
                    0xe221a6a218b1103c,
                    0x0c39e40093839563,
                ])),
                Felt::new(BigInteger384([
                    0xeb30b623159b8b43,
                    0xd15e8fe3e652e242,
                    0xe0af0c9dd65feb2a,
                    0x68f9d05cf30fc19c,
                    0x5e3482dbf5f8b634,
                    0x117183d32112bb2b,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xeef5ab48c6fcda65,
                    0xa0edacdeb87f8221,
                    0xb4f674c0f471b3f9,
                    0x09cd685d1e021cf5,
                    0x95d1c6ed9ee592e9,
                    0x1431d39f7d480cbb,
                ])),
                Felt::new(BigInteger384([
                    0x25487f12650b7fa6,
                    0x79115115b554926d,
                    0x1f4ae072786636c6,
                    0xa28fd6039f30680d,
                    0xe22adff040d4548a,
                    0x058632a8b2f1b39b,
                ])),
                Felt::new(BigInteger384([
                    0x678b0104ee40e031,
                    0x6f7e2a18bc8cb4c1,
                    0x7c6cf863f507a349,
                    0x59a3d156d8ae3748,
                    0x4421d11d12f6f1f3,
                    0x193f35be483014c0,
                ])),
                Felt::new(BigInteger384([
                    0x487453e190b69bc7,
                    0xa0e44310e67d7b15,
                    0x47726126b5878e22,
                    0xbd9722e6d9f4e9fb,
                    0xa6468a4658808342,
                    0x121270e1b5ead679,
                ])),
                Felt::new(BigInteger384([
                    0x042ba320b8721287,
                    0x59e7468f094a1499,
                    0xf5959df1bfc437f7,
                    0x187d4ab3fa16cad1,
                    0x4e17bb05f3dc0251,
                    0x047f53469f8dc541,
                ])),
                Felt::new(BigInteger384([
                    0x1c98f85298304737,
                    0xebb731a4cbd37b6b,
                    0x70b0b2c87e2ebc9b,
                    0xfea075a0dfcbb406,
                    0xb5360b7d285b8324,
                    0x0fbf566abbbc9076,
                ])),
                Felt::new(BigInteger384([
                    0x64b40989380ff2dc,
                    0xdc2fa26b020713f6,
                    0xd5ed223da21730bc,
                    0x2080b6d12dbc69b8,
                    0xcffd5b6a3893c3f9,
                    0x052879c53343c988,
                ])),
                Felt::new(BigInteger384([
                    0xa6d3a09503aaf322,
                    0xfa94138e7e67c6a8,
                    0x8c5ef9f4fe8bd5c4,
                    0x5485bda508974e22,
                    0xf70442d07fc743f6,
                    0x0023520e81f9cb65,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xefc7bbb18ae5b13e,
                    0x8f90427110c0d073,
                    0xd534b9a2a0d0f420,
                    0x3d20a9440e12c22e,
                    0x6e7913a63578c4ff,
                    0x125744114c12d8bf,
                ])),
                Felt::new(BigInteger384([
                    0x905440eb53ebb025,
                    0x3f2e914fb167d3ce,
                    0x33c5feaccbe07b1a,
                    0x51925cba83173470,
                    0x3bd6f0216d282fad,
                    0x066bf5bb020f8684,
                ])),
                Felt::new(BigInteger384([
                    0xac0096c0f18b5c7c,
                    0xe759bb9a5b1138a3,
                    0x6e5721f7770f7efe,
                    0x7732a24b9669c08b,
                    0xa784c00e33124150,
                    0x0a02c2314e2c2524,
                ])),
                Felt::new(BigInteger384([
                    0xd4cb14e8d87075a9,
                    0xea9c503f8150fb7b,
                    0xd601966f7c031ab8,
                    0x3676251d2722525f,
                    0x2a8d3d27592ceda2,
                    0x159ddf0b805cb89d,
                ])),
                Felt::new(BigInteger384([
                    0xf0c7c294fb1a2cd9,
                    0x37e16bb01cf8ff76,
                    0x1b3b6b69db9d71cb,
                    0xbdb5b033f138e778,
                    0x919f58d95689b818,
                    0x0a23b0c3531b2e92,
                ])),
                Felt::new(BigInteger384([
                    0x0767b1443e544d80,
                    0x13efa305f11ee55a,
                    0xadbeab7313581f0d,
                    0xf51e8d61d0322f64,
                    0x330561b60a23e678,
                    0x03bc85950f75e73d,
                ])),
                Felt::new(BigInteger384([
                    0x1e714664f0d0a790,
                    0x3d5e0b029296af1c,
                    0xf1efc06de632f3cf,
                    0x312ef10c41437dac,
                    0x4a83172bc781c3c3,
                    0x10e7c6bd1f6ade6d,
                ])),
                Felt::new(BigInteger384([
                    0x3e75aebcd668b866,
                    0x3d707fbdc7a81648,
                    0xfc5607569efc8e7d,
                    0xe0d445d10376654a,
                    0x893650cf9a040f77,
                    0x176e227d49d9a998,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc2aa72b9baf0db22,
                    0x2852c8a1cad0e434,
                    0xef910da872ddc824,
                    0x1193a7bca6cdc9b1,
                    0x7611764f7e9e768b,
                    0x0c96634119019e87,
                ])),
                Felt::new(BigInteger384([
                    0x2dfb556103aed5c2,
                    0x883238208f222e0a,
                    0x1924f23b2491d178,
                    0x48a09b4c2d768091,
                    0xd61a5d7da3ecdcf7,
                    0x0f12adcca2c3d5ba,
                ])),
                Felt::new(BigInteger384([
                    0xf1dfe3d20adb635c,
                    0x6cf41829b51de172,
                    0xd78bf0af5cfdd5f3,
                    0x242a6ce8dda3b499,
                    0x4480b4385788b7f6,
                    0x0d8c23d65adbced0,
                ])),
                Felt::new(BigInteger384([
                    0x99ca1cca04335553,
                    0xb28bd1657c2759c4,
                    0xe2d1c22f91f25cc4,
                    0x1ba56041e3d91b53,
                    0x6cf5c7be3119c74c,
                    0x115c35b8fc78ca78,
                ])),
                Felt::new(BigInteger384([
                    0x8c070b458dc03c11,
                    0x32359b403750702a,
                    0x4edb20a7968d03d9,
                    0xd2f46c138740e8d6,
                    0x53e9e89afff61b4c,
                    0x0df5201e60d37279,
                ])),
                Felt::new(BigInteger384([
                    0x785a2feca026f068,
                    0x8eba75cb8cdcd64a,
                    0xb74a5fcf1b0d59c7,
                    0x5c057b8ff241bb90,
                    0x31c3aae9e99c657a,
                    0x16d2f174f04103d4,
                ])),
                Felt::new(BigInteger384([
                    0x66f38fad3c8287d5,
                    0xb746ce407d12b423,
                    0x0f6213f30bde8fae,
                    0xf490295ed297faef,
                    0x39d0ce7ad9e72485,
                    0x19e2e7324b961f90,
                ])),
                Felt::new(BigInteger384([
                    0x830edd7c1b9d1bb5,
                    0x9e92fbc22323ff00,
                    0xad28613deaca64a1,
                    0x6f1ef2cf6be8b1d9,
                    0xbcb2577c572ea496,
                    0x0cdcb84cb0b06f76,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1adc84865511d3e9,
                    0x7549271e841f0908,
                    0x7a4bbb459f9d9634,
                    0xbef95a05f9ebf422,
                    0x9ebfac91efbb4a83,
                    0x022e6d850781203c,
                ])),
                Felt::new(BigInteger384([
                    0xcff6827fa3cd38c4,
                    0x43884efdf6604e2b,
                    0x99a6fd1c958c3c36,
                    0x7c01665ffd958a64,
                    0x771f7c6e231370ec,
                    0x024a3c703150beb9,
                ])),
                Felt::new(BigInteger384([
                    0x421c1a5c8b38ab61,
                    0xc4f77d32258344a0,
                    0x53ca24491c27f4e9,
                    0x7eab4c45ccf36d80,
                    0x302aadf81228f62f,
                    0x0a5f3b5eb6bc5c57,
                ])),
                Felt::new(BigInteger384([
                    0x1ea8891da940eab0,
                    0xb5ba9203a45120b9,
                    0x34cd5a8f8ca58d31,
                    0xe2c4f0ab793432d8,
                    0x12a23112333c82e9,
                    0x0d4824619205b0e5,
                ])),
                Felt::new(BigInteger384([
                    0xb4ebdd37dd440f60,
                    0xbe27c37cfcffaf3d,
                    0xeb37e924cba0b888,
                    0x3706bdcff6958376,
                    0xa5c084353814d1c7,
                    0x12142d91efdf4f0d,
                ])),
                Felt::new(BigInteger384([
                    0x417220ff82f10a7f,
                    0xe752b9ecc02dc3e6,
                    0x532789a417c45d65,
                    0x944dc53ba98c5716,
                    0x5b31665243376d98,
                    0x13354a845c4f21a9,
                ])),
                Felt::new(BigInteger384([
                    0x094ddf7b97b924f6,
                    0x0fd7885541ed3386,
                    0xc532f28834fcb2c6,
                    0x1323926cfa45fd97,
                    0x9e1497df2c5c00e1,
                    0x064132646c70b9b2,
                ])),
                Felt::new(BigInteger384([
                    0xddbf8ec78c896f62,
                    0x86f592b28f901242,
                    0xdb2e3014c438321c,
                    0x3c89c489eade7760,
                    0xd5bedda916f5f535,
                    0x125398a7fce36c0b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x579296d3f90d5cd6,
                    0x2e5dcb5250dabfa6,
                    0xca7fce976f14bcc9,
                    0x592500fa98635b6f,
                    0xaefa1080cb3c0fba,
                    0x0ae88e501665daee,
                ])),
                Felt::new(BigInteger384([
                    0x940f0a761db19cd6,
                    0xeb0cf78336619fe2,
                    0xa0273954206fb096,
                    0xee0d2efe05aa5fe3,
                    0xebf735f4a2383a0b,
                    0x13b7a452a2e2a9d6,
                ])),
                Felt::new(BigInteger384([
                    0xc03e2c163947f1a7,
                    0x1c69c4e7fc996119,
                    0x3e0e497036324002,
                    0x9221dd4cbfa618f5,
                    0x1a80341d887ae029,
                    0x08340de40e0afd1c,
                ])),
                Felt::new(BigInteger384([
                    0x827807578023cffb,
                    0x3f8cb785ff459477,
                    0x1410dc6b16a7aed4,
                    0x6739ca65730f9237,
                    0xb9896d9082ef06ff,
                    0x183f27a2e38de21f,
                ])),
                Felt::new(BigInteger384([
                    0x6b84631fedd8bf29,
                    0x20e27fd5e2129ed1,
                    0xbcbaae14e2c6d089,
                    0x403d6fcbd27aa681,
                    0x58c661461eef70d7,
                    0x0b0454bbb684ca08,
                ])),
                Felt::new(BigInteger384([
                    0x5b749444823404b1,
                    0x3bccb9620fa03703,
                    0x307a09782b3bee83,
                    0xb409512e26b9ab2e,
                    0xf98210efe14054ce,
                    0x030a43015a7db6e8,
                ])),
                Felt::new(BigInteger384([
                    0x47bd404e6ba25456,
                    0x873b62d3594ed49c,
                    0xb0aae8278fadb1ea,
                    0xbf6b605d32403fba,
                    0x81225d6577c7fb19,
                    0x086d08f78d16e6f2,
                ])),
                Felt::new(BigInteger384([
                    0xfb3765825987d4c5,
                    0x50c6357a97696948,
                    0xc094b050ce07bba6,
                    0x54150c8e4f70e968,
                    0xc89cbccf08a51bf9,
                    0x1779da404705c969,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x463103da9f3d1487,
                    0x50081fae8e7f9368,
                    0xc779097e5e4f0f67,
                    0xec6a99d88bed9bef,
                    0xa86b8d65e9b4c0ef,
                    0x18110873fc82f5ff,
                ])),
                Felt::new(BigInteger384([
                    0x6aff038f6ddce7d3,
                    0xd94e0e71c9b0a95e,
                    0x37abe4e62195649e,
                    0xb39843ab3453b3ce,
                    0x3af6331ffd79bb87,
                    0x14255f473ed1bf9c,
                ])),
                Felt::new(BigInteger384([
                    0xa4f7a0d2d1c7afc7,
                    0x35f0245efb135724,
                    0x667fb2d472f51b91,
                    0x891206afa7e0a300,
                    0x456f1318c31d22ce,
                    0x17c091f57a4fcf01,
                ])),
                Felt::new(BigInteger384([
                    0x39658b118e1186e4,
                    0xcb1c66849e1bb899,
                    0x1e624055642f4af0,
                    0x48e9c519933ffbd5,
                    0x6e9dc9754815ef3d,
                    0x0daec874bf9c5b9f,
                ])),
                Felt::new(BigInteger384([
                    0xc52674d8c8c939c0,
                    0xe791b0bd1fc7bf63,
                    0xde17b8e3f21c5edc,
                    0x838659c4bb1617c6,
                    0x1cbd68893b0bed94,
                    0x070adc7a28453ab6,
                ])),
                Felt::new(BigInteger384([
                    0xd0c1c8ccbb80b356,
                    0xf97e0168517d8329,
                    0x6b9e8d4b7619e373,
                    0x338984b66c952213,
                    0x092c65735751ea20,
                    0x0999c60ff0f111c0,
                ])),
                Felt::new(BigInteger384([
                    0xce3958c0de3e3c2b,
                    0x42499261142d2cfd,
                    0x56f5ebb96a770894,
                    0x7e4fab2e4e637d0d,
                    0x464759c0a4ee08a6,
                    0x10fa999a0e780b6d,
                ])),
                Felt::new(BigInteger384([
                    0x93f0fae9d0ee3fd1,
                    0xdb459789651afcd8,
                    0x6ecadbda33032c55,
                    0xab7861bfc2645a9c,
                    0xafab499cc0d6a9c7,
                    0x150bc9ad49735aa0,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x544e00000019ffe6,
                    0xa7980065f8680015,
                    0x8f1fd2f4d61500fe,
                    0x63a6fd7dcd7449ae,
                    0x1d92e6777ef1565f,
                    0x13ac8aa27b07bcfd,
                ])),
                Felt::new(BigInteger384([
                    0x66b10000003affc5,
                    0xcb1400e764ec0030,
                    0xa73e5eb56fa5d106,
                    0x8984c913a0fe09a9,
                    0x11e10afb78ad7f13,
                    0x05429d0e3e918f52,
                ])),
                Felt::new(BigInteger384([
                    0x447600000027552e,
                    0xdcb8009a43480020,
                    0x6f7ee9ce4a6e8b59,
                    0xb10330b7c0a95bc6,
                    0x6140b1fcfb1e54b7,
                    0x0381be097f0bb4e1,
                ])),
                Felt::new(BigInteger384([
                    0xba7f0000002a552b,
                    0xc8ac00a607540022,
                    0xcec782259e35e414,
                    0x28d1890b30fbb30b,
                    0xbd47cc949d754125,
                    0x19781ccd798c9974,
                ])),
                Felt::new(BigInteger384([
                    0x544e00000019ffe6,
                    0xa7980065f8680015,
                    0x8f1fd2f4d61500fe,
                    0x63a6fd7dcd7449ae,
                    0x1d92e6777ef1565f,
                    0x13ac8aa27b07bcfd,
                ])),
                Felt::new(BigInteger384([
                    0x66b10000003affc5,
                    0xcb1400e764ec0030,
                    0xa73e5eb56fa5d106,
                    0x8984c913a0fe09a9,
                    0x11e10afb78ad7f13,
                    0x05429d0e3e918f52,
                ])),
                Felt::new(BigInteger384([
                    0x447600000027552e,
                    0xdcb8009a43480020,
                    0x6f7ee9ce4a6e8b59,
                    0xb10330b7c0a95bc6,
                    0x6140b1fcfb1e54b7,
                    0x0381be097f0bb4e1,
                ])),
                Felt::new(BigInteger384([
                    0xba7f0000002a552b,
                    0xc8ac00a607540022,
                    0xcec782259e35e414,
                    0x28d1890b30fbb30b,
                    0xbd47cc949d754125,
                    0x19781ccd798c9974,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x544e00000019ffe6,
                    0xa7980065f8680015,
                    0x8f1fd2f4d61500fe,
                    0x63a6fd7dcd7449ae,
                    0x1d92e6777ef1565f,
                    0x13ac8aa27b07bcfd,
                ])),
                Felt::new(BigInteger384([
                    0x66b10000003affc5,
                    0xcb1400e764ec0030,
                    0xa73e5eb56fa5d106,
                    0x8984c913a0fe09a9,
                    0x11e10afb78ad7f13,
                    0x05429d0e3e918f52,
                ])),
                Felt::new(BigInteger384([
                    0x447600000027552e,
                    0xdcb8009a43480020,
                    0x6f7ee9ce4a6e8b59,
                    0xb10330b7c0a95bc6,
                    0x6140b1fcfb1e54b7,
                    0x0381be097f0bb4e1,
                ])),
                Felt::new(BigInteger384([
                    0xba7f0000002a552b,
                    0xc8ac00a607540022,
                    0xcec782259e35e414,
                    0x28d1890b30fbb30b,
                    0xbd47cc949d754125,
                    0x19781ccd798c9974,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x544e00000019ffe6,
                    0xa7980065f8680015,
                    0x8f1fd2f4d61500fe,
                    0x63a6fd7dcd7449ae,
                    0x1d92e6777ef1565f,
                    0x13ac8aa27b07bcfd,
                ])),
                Felt::new(BigInteger384([
                    0x66b10000003affc5,
                    0xcb1400e764ec0030,
                    0xa73e5eb56fa5d106,
                    0x8984c913a0fe09a9,
                    0x11e10afb78ad7f13,
                    0x05429d0e3e918f52,
                ])),
                Felt::new(BigInteger384([
                    0x447600000027552e,
                    0xdcb8009a43480020,
                    0x6f7ee9ce4a6e8b59,
                    0xb10330b7c0a95bc6,
                    0x6140b1fcfb1e54b7,
                    0x0381be097f0bb4e1,
                ])),
                Felt::new(BigInteger384([
                    0xba7f0000002a552b,
                    0xc8ac00a607540022,
                    0xcec782259e35e414,
                    0x28d1890b30fbb30b,
                    0xbd47cc949d754125,
                    0x19781ccd798c9974,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xd6d1d24cf40fa69b,
                    0xb2367a7859419917,
                    0xfdd27ea9d7fee294,
                    0x8e15a4cf92c54ca6,
                    0xe4b47eac2b22c797,
                    0x13637130ac536399,
                ])),
                Felt::new(BigInteger384([
                    0xf87a4e08188f6840,
                    0x9a5667a8eacafcc7,
                    0x6235aa566bff2bad,
                    0xcacad4df7bcb606d,
                    0xc0f9f4f05302eca1,
                    0x13fba0ef4df1d52f,
                ])),
                Felt::new(BigInteger384([
                    0x7be7a61650887105,
                    0xe372eb264e09783f,
                    0xd173ae3f0a273db4,
                    0x849b22ebb2b38609,
                    0x0926756bc44e5fa6,
                    0x004f241c98584b53,
                ])),
                Felt::new(BigInteger384([
                    0x19c57ae4dcd7f677,
                    0x2b14b976076b3d4c,
                    0xb8351254832363cb,
                    0x770161e90c900869,
                    0x99a15f8b7934133b,
                    0x0ae2b8e4163206f3,
                ])),
                Felt::new(BigInteger384([
                    0xe6b49c59b89a8072,
                    0x0a90cd222ff86dd1,
                    0x8f3076adea637427,
                    0xd5b15f417ad8105a,
                    0x644a71b27611aec7,
                    0x0e7cfc7a5f1727c5,
                ])),
                Felt::new(BigInteger384([
                    0xeff52be4565d5961,
                    0x0e8b30911fd2206a,
                    0x9a9751a7a4fad770,
                    0xa3ac9fc9bfbcdff2,
                    0xf3dd23282a57c885,
                    0x0cd2832de03b9d1e,
                ])),
                Felt::new(BigInteger384([
                    0x8a8d91666e031302,
                    0xcbe1377ebdb441fa,
                    0x5204afffdadd50a1,
                    0xed1c6cfa526ced57,
                    0x14c6185d153560db,
                    0x133d56e37024cf59,
                ])),
                Felt::new(BigInteger384([
                    0x797c4332118db1c9,
                    0xb6edbbd3724fa12e,
                    0x43a01969fd519a87,
                    0x63826bcfa8f4f12c,
                    0x2691ab1aa534e5a6,
                    0x08c9cc4c69a5d3d1,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x745ed5c71aa165f6,
                    0x95040e17c9c0b41f,
                    0xc3a5ae940684b672,
                    0x5fc36bb637e14d17,
                    0xe4cee752cb8cab66,
                    0x16d931fd42d37400,
                ])),
                Felt::new(BigInteger384([
                    0xc31aa11931f44794,
                    0xf06735bac746cbff,
                    0x63cccd026f8c0e73,
                    0xcba5ca3742117823,
                    0x48457be85e428696,
                    0x0ff8d338a37d792a,
                ])),
                Felt::new(BigInteger384([
                    0xced7c7eef6244301,
                    0x2a21fb63bfaebc22,
                    0xa921d6bdd5b8c73c,
                    0xfa95647f9b5a21aa,
                    0x0dc6985d3556cfdc,
                    0x11e2db07aecc646d,
                ])),
                Felt::new(BigInteger384([
                    0x1b64e3e9b0b59e64,
                    0xc11a05dcbb66f821,
                    0x760a3dbf77d7cd34,
                    0x8639ba41a6c85477,
                    0x82a934e6a0187bdb,
                    0x0ffa4ee2b2f53756,
                ])),
                Felt::new(BigInteger384([
                    0xd93a6716b3cd6402,
                    0x3bfd9aeeacd51e2d,
                    0x15ed87b9e061227b,
                    0x33e21e7caf46f6f4,
                    0x1bcb5bb234960d86,
                    0x119338a4c1a09872,
                ])),
                Felt::new(BigInteger384([
                    0xb997448e08f52ccc,
                    0x7b9f67dcdfe4f03e,
                    0x3f0cf7cc2d62703a,
                    0xca6b769af92fbc1f,
                    0x5aeedb23f6ade3c7,
                    0x0353f8cf71ee9dbe,
                ])),
                Felt::new(BigInteger384([
                    0x0635d520844cbdda,
                    0x90ef7af6b6c56687,
                    0xc8cddbf3468c609b,
                    0xbcd6d68c5b5e723c,
                    0xbcabf85393bd807d,
                    0x06650c7cdf2ecaf6,
                ])),
                Felt::new(BigInteger384([
                    0xa1b618fe0d3225a5,
                    0xd92262b26e914691,
                    0xa22425a3c1b2cdb6,
                    0x75443482dc611310,
                    0x124456e2a7d3c068,
                    0x10fd5e37ff7d8525,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7bf47414e41c231a,
                    0x853944271571e4c3,
                    0x12f7ff93e3afc96d,
                    0xd937e5e2e416a043,
                    0x2edee7dc6e7b5897,
                    0x0f9ad81cc9f6b7e0,
                ])),
                Felt::new(BigInteger384([
                    0xb12a069537729919,
                    0x6357d2d024e70a42,
                    0x41f646b6f4adbdac,
                    0x0423778e34f41525,
                    0xdc1e80712d2d53ed,
                    0x083064c9f48ddb42,
                ])),
                Felt::new(BigInteger384([
                    0x25db5a9b11f626e3,
                    0x8ea38f6b696837be,
                    0x37b44706a86d8ddb,
                    0x851fd4b42521bf25,
                    0xf96b6c61e13d4ed7,
                    0x143e9dbae65c97a4,
                ])),
                Felt::new(BigInteger384([
                    0xc90d2114658fda34,
                    0x3ccb171531836306,
                    0xd1a349a7c06e76ff,
                    0x7bdfe9a795e917de,
                    0x52d960121ac8c062,
                    0x0a45fa32917ab70e,
                ])),
                Felt::new(BigInteger384([
                    0x2965b077a86ae21c,
                    0xbcc40e984259d10c,
                    0xd983824e6fe30b14,
                    0xc7883bd98ec38400,
                    0x88e44ff9d520f29d,
                    0x1819fe4ed68ba561,
                ])),
                Felt::new(BigInteger384([
                    0x1e7aee920347c563,
                    0xce9ba8499e9dbfd8,
                    0x8dbc0bc1dd908683,
                    0x7d8b058842d37de1,
                    0x2b348fc35c5f2060,
                    0x10ef119a913ca19f,
                ])),
                Felt::new(BigInteger384([
                    0x1a63fdb43786b0d9,
                    0x392cddbeb4df793a,
                    0x13b42a949de86ec1,
                    0xa221231885649da1,
                    0xc2c9117807760aeb,
                    0x0f89da08bd083907,
                ])),
                Felt::new(BigInteger384([
                    0xd20d3af0ef7fb950,
                    0xe1a031f716e55613,
                    0xb1c36d5582d31325,
                    0x45537831de1e7c19,
                    0x3c6ce4cf0ba3c1b6,
                    0x057576288f8ddda0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xd84b52f9a96d5501,
                    0xf7ee32869840be3e,
                    0x8a0e0b0ac47b62c5,
                    0x2cef6ffe97f1ae82,
                    0xf38090845d2935cd,
                    0x0459be81b9f7a9ac,
                ])),
                Felt::new(BigInteger384([
                    0xc2dc1dc11b069123,
                    0xcb31c81bb78d6aa6,
                    0xe9b6c2e738af8a3c,
                    0x3beb386ecffc0aa1,
                    0x06f7fd46badc8d5c,
                    0x0ff941105e3ae861,
                ])),
                Felt::new(BigInteger384([
                    0xd563d1cd6a7848cf,
                    0x8c150bb199cc039b,
                    0x739b703ea95df9e1,
                    0x49f688d62f8bdaa6,
                    0x295695c2708212ff,
                    0x10182c83dd151daa,
                ])),
                Felt::new(BigInteger384([
                    0x129aea23446cae60,
                    0x009fb0c4803c8d60,
                    0x7f9003bdc4c39ea9,
                    0x213295f10ca3cba9,
                    0xe6c56be072b782c0,
                    0x009224e3842131e3,
                ])),
                Felt::new(BigInteger384([
                    0x9ab697711db8cc39,
                    0x2663ff50d9c4e17a,
                    0x92c9492bfba87272,
                    0x22fc53228d31fa8f,
                    0xffff52d359324ad7,
                    0x06c4267c95272a8a,
                ])),
                Felt::new(BigInteger384([
                    0xd57ebf51920ea2c3,
                    0x33f3a346f000e7bc,
                    0x74ba8c0f37912ff8,
                    0x0499de7d85ae9ca2,
                    0x3b47712116a6a09a,
                    0x19b265019c6894d0,
                ])),
                Felt::new(BigInteger384([
                    0xcb89285b8f005b54,
                    0xe60de6396702fdae,
                    0x931aec6e91f8d78d,
                    0x2497977ea8c9e401,
                    0xe97274c8e9bc1765,
                    0x1263a98396815f06,
                ])),
                Felt::new(BigInteger384([
                    0x7124759f3051e52d,
                    0x9588475478527f91,
                    0xe054856773695f0a,
                    0xdff72939e46201e3,
                    0x021483fee9d69fe2,
                    0x17c32a0ba386631c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf7311d11c4fb6145,
                    0x0e15aabe75198a71,
                    0x4b3fa92598a2dd86,
                    0x1faf63c04d3473b6,
                    0xa368af2b783e2bfb,
                    0x04f08cc2c2c015e7,
                ])),
                Felt::new(BigInteger384([
                    0xa5c2430cc2edafdf,
                    0x7d5ddec0dd40c78e,
                    0x9a50afd3f933ad4c,
                    0x62496b098b1404ce,
                    0xf8b311153e1cf169,
                    0x15bc3dfa4e4ee015,
                ])),
                Felt::new(BigInteger384([
                    0xe033c74514b19d9b,
                    0x6a06f6d93e0f9ca5,
                    0x52873bf8f9644702,
                    0x2554ebbce86839ac,
                    0xa52000a8f007625d,
                    0x156ad1f00b576859,
                ])),
                Felt::new(BigInteger384([
                    0x22ef66fd729e2497,
                    0x2473e7f36edbddfc,
                    0xff0c1d84ea4084ae,
                    0xe7e7ab8821d04455,
                    0xb181b2840c32c000,
                    0x0c6ce3ec6c5f4dc3,
                ])),
                Felt::new(BigInteger384([
                    0xd226e67453dd298e,
                    0x58cc4c80fa88c50d,
                    0x078706d757cf3a35,
                    0xed8a886b26c251f5,
                    0xde5c6e27cdde5936,
                    0x134a86215057ded5,
                ])),
                Felt::new(BigInteger384([
                    0x1184f30f40739c37,
                    0xdaa25622ada72dab,
                    0x04f74bc22424702f,
                    0xcad8caeb2a7ca4a0,
                    0xf4cafaf0313c0411,
                    0x0632fad68baa4581,
                ])),
                Felt::new(BigInteger384([
                    0x9c8ee12dda6c765b,
                    0x638a25d5cd61743c,
                    0x45c6092b7defcc8c,
                    0xb53a3f9050395053,
                    0xdc2ea2d3ffb1a79a,
                    0x1860d2985c66eb21,
                ])),
                Felt::new(BigInteger384([
                    0x1010f2ba1d63456f,
                    0xc26704c44bd17b1f,
                    0xb829f2e9c3075f51,
                    0x4bc2c443c426a8c9,
                    0x96345cac18471030,
                    0x013b4efa63061760,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe7ee6651a8883954,
                    0x260360d2f5f7af00,
                    0x0d1baebea932456f,
                    0x505f374eea0b8489,
                    0xfec1f19c64c20a92,
                    0x03596fa0d3d12277,
                ])),
                Felt::new(BigInteger384([
                    0x36adbe974bd4c828,
                    0x62974329faa2e647,
                    0xf9db2b5a098be2e8,
                    0xd4f41533e3cc8706,
                    0x2c6e0caade9ab69b,
                    0x12c214beac74d6f3,
                ])),
                Felt::new(BigInteger384([
                    0x8bf15fafb06735d8,
                    0x28921079fa33740d,
                    0x1d82c5bdf2dc2537,
                    0x5ba9245ed2f82cbd,
                    0x7ad68c27da6fced2,
                    0x079ce904a0f89ce2,
                ])),
                Felt::new(BigInteger384([
                    0x9bb8003750cf0e40,
                    0xc91c239d7f23e128,
                    0x8d04815932669fdb,
                    0x4771895c2fb9d4dc,
                    0x07b49d446e063f61,
                    0x0170bfe324174ee6,
                ])),
                Felt::new(BigInteger384([
                    0x05a0b29489abb04d,
                    0xcb59491dd27a829d,
                    0x6d822f7024fa3b05,
                    0x7a98cf3684a03304,
                    0x4865382830b27f6e,
                    0x0cb2978419cac44c,
                ])),
                Felt::new(BigInteger384([
                    0x23fb70b18234168a,
                    0x774eae415148ce19,
                    0xba5d83dffe907956,
                    0xcfdb5459e797549a,
                    0xc519b26d46f26a12,
                    0x0496bc0abac9a593,
                ])),
                Felt::new(BigInteger384([
                    0xbd55dfaa924755be,
                    0xe7bcf8ece478fba3,
                    0x0f6fcd74ba272a58,
                    0x071bb5081defc0b7,
                    0xcc283979127fdd6b,
                    0x12788430a067fe74,
                ])),
                Felt::new(BigInteger384([
                    0x94bf6a8885f373b9,
                    0xed2221705aefa250,
                    0x0261351bead685aa,
                    0x98e2f1bace9d638e,
                    0x6dd2cfacdda6f8e1,
                    0x14e40f7dcde26c28,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
