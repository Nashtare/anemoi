use super::{mul_by_generator, sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 1 element (48-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= mul_by_generator(&y2);
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += mul_by_generator(&y2) + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies an Anemoi permutation to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Applies an Anemoi round to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x872258fa0ac3f687,
                    0x9227e5170f26c47f,
                    0x5e72253a09b5e368,
                    0xd5b72596c27869a5,
                    0x0d969d5aef3d96d5,
                    0x11ac43264bc469d8,
                ])),
                Felt::new(BigInteger384([
                    0x25b1229e51677189,
                    0x7f885ebd562009a7,
                    0x8c66be451395f830,
                    0x134f788e47f1f4eb,
                    0x8e68246dad9e4d49,
                    0x08941965a8d45af3,
                ])),
                Felt::new(BigInteger384([
                    0xa0f94f55898cc4a6,
                    0x3f3d6999c24c0931,
                    0x6363a3a14aac3ff3,
                    0xb698a25b58a51d43,
                    0x85fe0c7c64fb0ef5,
                    0x1453817b4663253e,
                ])),
                Felt::new(BigInteger384([
                    0x24a4e26b029e51a2,
                    0xd939a9c2bb6210e5,
                    0x96d7b287e354e8c9,
                    0xcaa0c84c87ba532f,
                    0xae6802528c0c3d34,
                    0x062203fc9ae2b271,
                ])),
                Felt::new(BigInteger384([
                    0x2c6507e7c16724f9,
                    0x34507f1ca81dca3e,
                    0x43ffc0b04ad107f4,
                    0xa59e906fbda2fb9d,
                    0x35350b8529ed8fae,
                    0x0faeec2d8c54a4fe,
                ])),
                Felt::new(BigInteger384([
                    0xcc7de4ef4c421508,
                    0x1f94323ab71d1b76,
                    0xf12f0a4165c7b36f,
                    0x5fa8219cd5d0465e,
                    0x5cc65f0cfa804a7d,
                    0x0ff5172e668d07bf,
                ])),
                Felt::new(BigInteger384([
                    0x9bfa4ab739f7c1e4,
                    0x05a23c99032dfa04,
                    0xd19556fd1eb0ccfd,
                    0x4308405382f87596,
                    0x59f5494caa01ac85,
                    0x042758cd997dd971,
                ])),
                Felt::new(BigInteger384([
                    0xb319d62aee03f892,
                    0x9b5b6559820aea8a,
                    0xc4184c23a0459792,
                    0x9fe2353733a3815b,
                    0xda6e5031582b245d,
                    0x034a44ae2cb6050e,
                ])),
                Felt::new(BigInteger384([
                    0x86ad44fea6d1e46c,
                    0x4e982da2fb1396ea,
                    0x254493a8240c953e,
                    0xbb6e119b2ecf2b7e,
                    0xf018ed4732996529,
                    0x05f0484442eb69dc,
                ])),
                Felt::new(BigInteger384([
                    0xd9b92d736a6f8c92,
                    0x6935795a3a3ff77d,
                    0xde0151033873092b,
                    0xcee017f3a213daa7,
                    0x48aff122179afca4,
                    0x171f755de0554cdc,
                ])),
                Felt::new(BigInteger384([
                    0xdc19d7718836da7b,
                    0x45fcee85a7b8c1e9,
                    0x2a0c302186018dfe,
                    0xad04f9021edbf066,
                    0x7d7e1206e1f4e18b,
                    0x02727c81c00fb6cb,
                ])),
                Felt::new(BigInteger384([
                    0x4b0f45dc272cc2a5,
                    0xde64a793ea520b95,
                    0xd1551e88376b65b8,
                    0xea0cd63c1fb22ad1,
                    0x09fee26bfae024a5,
                    0x07c3f90a9400dd75,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x53328e30de625241,
                    0x73a89279a545a274,
                    0x8eabd2d1170af887,
                    0x2f4028a4d67a9318,
                    0xf9b78158c1dfb14a,
                    0x17731df1d3f15935,
                ])),
                Felt::new(BigInteger384([
                    0x1cf9052550225dee,
                    0x0fd1fe0e29119e50,
                    0x808ad5c2cabbf587,
                    0xda7893e095732869,
                    0x051213fdade074b4,
                    0x121eb587e8ff8634,
                ])),
                Felt::new(BigInteger384([
                    0x6d031a81dba0475a,
                    0xc0d10261ab9b3b5e,
                    0xb7d40eda8bbc7145,
                    0x069037c4393e0fbe,
                    0x2e55d9bc0fbc7d3b,
                    0x0fa54efaae6a94a8,
                ])),
                Felt::new(BigInteger384([
                    0xc9eb2e7ef48db141,
                    0xced51abe66b70299,
                    0x8b360acd9b1c27e4,
                    0x154988079f4de2dd,
                    0x0a4a87f68ce61515,
                    0x136041f57dc98abd,
                ])),
                Felt::new(BigInteger384([
                    0xf48b25123ac4f87d,
                    0xd4f961b8c6cc7d56,
                    0xcd411f1914b45f25,
                    0x5b839f4fadbde8bc,
                    0x4a21795cf9ef5cd3,
                    0x0541828c379acbf1,
                ])),
                Felt::new(BigInteger384([
                    0x1d1fb3a56530726e,
                    0x85a334fb74ec8acc,
                    0x9b201232639da572,
                    0xa715b178a492ae41,
                    0x2e40743f4c6bc08d,
                    0x1489030aa525aeae,
                ])),
                Felt::new(BigInteger384([
                    0xe35ae0cb235f6718,
                    0x8f2b0aa29ada1f12,
                    0x5177082fc847e414,
                    0xb0b39107c3f0845c,
                    0xfab54af5d009d4eb,
                    0x10c2e206ea76bc66,
                ])),
                Felt::new(BigInteger384([
                    0xe53ecfd6b3e0aeb3,
                    0xffe5f3b6088b2c3c,
                    0xf1b7a05396bebbc2,
                    0x9286b659d583c02c,
                    0x8b5d68e85cac24da,
                    0x00e25d7002690a11,
                ])),
                Felt::new(BigInteger384([
                    0x75a9856e7ac25ff0,
                    0xcc3e9e53ab29d6ce,
                    0x0df79c5bf43902d9,
                    0x293c70540f119239,
                    0x3d9c74289ba46449,
                    0x19af6a6dc5825ae4,
                ])),
                Felt::new(BigInteger384([
                    0x096abb9a4e7cf816,
                    0x0b03a954b5355aeb,
                    0x191471eee98618aa,
                    0x8c5465a94935c70c,
                    0x58345bc2d924faf8,
                    0x02b7c9b93153ceac,
                ])),
                Felt::new(BigInteger384([
                    0x29cf1586f9a63e0b,
                    0xa02bd471f9b8fb7e,
                    0xcfb4591f2667216b,
                    0x6d00d55d7c02425d,
                    0x7ca442596ebc4af4,
                    0x14c2376822644c6c,
                ])),
                Felt::new(BigInteger384([
                    0xa55f5bff2c005dab,
                    0xa8c610d88d02eb04,
                    0xc93e9a4a0c132e34,
                    0xbec19f3e71e3c81d,
                    0x870aa526bfb1d7bd,
                    0x1289b526a5ac13f4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb163b52707095045,
                    0x7e9ce98891c9f504,
                    0x9deb40b27d45e463,
                    0x9488640a9cef07ff,
                    0xabae7b99e1fcc4c9,
                    0x10af2a9383c3eb59,
                ])),
                Felt::new(BigInteger384([
                    0x931d5928f55c1f21,
                    0xde15335460ae5f3d,
                    0xe9d92569fc953eda,
                    0x538a456739a0c8dc,
                    0xc722eccbe22e71b2,
                    0x0d9c023f1b238bd0,
                ])),
                Felt::new(BigInteger384([
                    0x4ccc73331301c44c,
                    0x1c8fffeec493c921,
                    0x024209664a749085,
                    0xfb1e05e387d8316d,
                    0xc91222c517d8c072,
                    0x0beeba21af95c10b,
                ])),
                Felt::new(BigInteger384([
                    0xb45ead3754a3902b,
                    0x03660e45784a525e,
                    0x4795fbf6c9de5752,
                    0x266d7cabbc7e18e2,
                    0x8c5da66d56997cde,
                    0x024c637c33bea61d,
                ])),
                Felt::new(BigInteger384([
                    0x7212ef008168d7fb,
                    0x3907ffebc1804669,
                    0xfaa8250f20557209,
                    0xb5b9b8676ad174f5,
                    0xcc28c38b348f60d8,
                    0x02edcb13bc7fd7b3,
                ])),
                Felt::new(BigInteger384([
                    0x86dc47978dbeef79,
                    0x6d5391bcfade07f6,
                    0xbf696f8f8e1a899c,
                    0x8a60fc563f15add0,
                    0x8ccb9a8021023687,
                    0x15f5263a9aabaab7,
                ])),
                Felt::new(BigInteger384([
                    0x19531323d67802f4,
                    0x2e33c2116f965666,
                    0x25126fda49c3f8b0,
                    0x226ee48cdea5670e,
                    0xb35fa2f95785f425,
                    0x15924000d0964d8f,
                ])),
                Felt::new(BigInteger384([
                    0x3f7be748a3062acf,
                    0xeba72f9208b81a46,
                    0x2eb24f32a755c189,
                    0xb0aadb1b77f6f07a,
                    0x8f5a949a5fcbf20d,
                    0x19e45e8a99ef7ed3,
                ])),
                Felt::new(BigInteger384([
                    0x7f4a89822d953b49,
                    0x9d3faa5064deb180,
                    0x042955f7de2db05d,
                    0xa626bf652e365a5c,
                    0x6d0d4c91701393f3,
                    0x03e6142ca9411b91,
                ])),
                Felt::new(BigInteger384([
                    0xfe9d8f748f55227d,
                    0x9956e2b9ad3d920b,
                    0x7562b4b253857957,
                    0x23b34d5b6bfe1c21,
                    0xebc014eef02a908e,
                    0x002d4ac42e9124c1,
                ])),
                Felt::new(BigInteger384([
                    0xef99459360c125d5,
                    0x76e04cabbb6fe13a,
                    0x3c8ba8049c707bd7,
                    0xd68a73240dfa3bf9,
                    0x3db998b9861f7e95,
                    0x025aa6e1d0e7c9f8,
                ])),
                Felt::new(BigInteger384([
                    0xa1de86d09e5a2ede,
                    0xbbd4d19636945b63,
                    0x2d480acfe43d82c9,
                    0xe3b422f3c28a9f2a,
                    0x845225a9a13b5a73,
                    0x091032b02f7b064e,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf242cc37fb23512a,
                    0x5ab0ae5129cf40b8,
                    0x08a360958ef19ac1,
                    0x17616afb3ce87873,
                    0x3dc1071fa8e65b8e,
                    0x01f880cdbdb13a74,
                ])),
                Felt::new(BigInteger384([
                    0x1e3202d5fbe8b337,
                    0x3c11aec516acb553,
                    0xd10099f6267f170d,
                    0x1d5b5aae21020b0a,
                    0xdc71c9537a38d5da,
                    0x05559239c0ed838b,
                ])),
                Felt::new(BigInteger384([
                    0x1090678ac1770194,
                    0xc6996b03afef5b87,
                    0xf533c274bc8d8767,
                    0xb34d4c64edea9888,
                    0x1b4c6509be658462,
                    0x181555a77d8bcdff,
                ])),
                Felt::new(BigInteger384([
                    0x9e8f454231504924,
                    0xf6dcbae3fa72d6c0,
                    0x7ef2ba6c1a7423ea,
                    0x096ca91e4fd98195,
                    0x5c753c0f4f25c62b,
                    0x103f64fdf03986b2,
                ])),
                Felt::new(BigInteger384([
                    0xd7c6b6fac995d9fe,
                    0xa60281c5c6089bec,
                    0x2cd851c07192694f,
                    0x34b97b4678f25bc6,
                    0x7d3e2ed855f79b23,
                    0x032c15b9897be888,
                ])),
                Felt::new(BigInteger384([
                    0xcf909a605c24516d,
                    0x440642be3059f4fa,
                    0x3e48d5cd1b2cc85f,
                    0xf6586ed0e8d018ef,
                    0x601104f482091c0c,
                    0x00693bb1511a34c5,
                ])),
                Felt::new(BigInteger384([
                    0xb87042adcdb30aa8,
                    0xb139ce9763bb385c,
                    0x3b8c0f39fc3e0a7d,
                    0xcfc4d81f1c144f94,
                    0xfba46f7ec50fcc85,
                    0x0e600746fb899b8f,
                ])),
                Felt::new(BigInteger384([
                    0xb8482c2217c47cbb,
                    0x6ede7a61bbd039f6,
                    0xa7784f05baf67813,
                    0x2cde8f6c9a66bc72,
                    0x11bde229286e0dd0,
                    0x0d9210601732ebf2,
                ])),
                Felt::new(BigInteger384([
                    0x73eb89f61a6cb3c3,
                    0xc8d0d9f83a72f0b5,
                    0x99d0bf1b7cf3b61b,
                    0x154a607120bcc2b4,
                    0xb65f807a2894fcd8,
                    0x1195944996ecede3,
                ])),
                Felt::new(BigInteger384([
                    0x189b88f121e2f4b5,
                    0x1196cba0114c90c2,
                    0xe598f4ee2dcf1ea9,
                    0xca02580f0f2d67ba,
                    0x683b5c6768c55c0e,
                    0x187298a843a6f9b5,
                ])),
                Felt::new(BigInteger384([
                    0xd9cb823e676bc9f6,
                    0x11bf5f569c4fc096,
                    0x05dd2d61bc42b1d5,
                    0x3920d8621c2baf18,
                    0xa09722fd34ef3f4a,
                    0x112d1f354b9e2a1f,
                ])),
                Felt::new(BigInteger384([
                    0x1a7be7e93fa5ca46,
                    0x30bdfac8046ef345,
                    0x75876aee0a2d82e7,
                    0xe04ccaf70c725bc9,
                    0xafd6364830f56e6b,
                    0x137b576fbadd08f2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x70fe603ccf8eb61d,
                    0xa8d82814158c8a02,
                    0x603aa14b55b88348,
                    0xce2bf568ee08307a,
                    0x912e9e433bfdefc5,
                    0x126015c6d5d2be57,
                ])),
                Felt::new(BigInteger384([
                    0x4f0dc6c2d58db028,
                    0xa98169adae734aeb,
                    0x90afa8dbc10e71af,
                    0x137a30e892e3d073,
                    0xc7e954f16d6f944f,
                    0x08f6e13744fdf436,
                ])),
                Felt::new(BigInteger384([
                    0x84c673cf783d6a1e,
                    0xb1b1575a90f612ef,
                    0x36a4cdefce3b7425,
                    0x9a5d48fc40794794,
                    0xc225e6b2be0ec137,
                    0x18b45ef7ea3df107,
                ])),
                Felt::new(BigInteger384([
                    0xb2a33d92d2c24613,
                    0x1e7231560fb56dc7,
                    0xbddb79f4f57648a7,
                    0x0bf3540d028848ef,
                    0x3ceb7888df54190b,
                    0x0b9760a6bb670fd4,
                ])),
                Felt::new(BigInteger384([
                    0x8e2370587b2ed7ba,
                    0xe51070eef582bd7b,
                    0x2a17d58958d52d19,
                    0x2995164bbe18b2a4,
                    0x4ae388b8b7ddee6e,
                    0x01eab3a7c8f08738,
                ])),
                Felt::new(BigInteger384([
                    0x846edb40e7a8918e,
                    0x34adffb992b66d1b,
                    0x74efdc7f084d09cc,
                    0x5be86a28a167e1aa,
                    0xa5a27bfe7c21e5b5,
                    0x13a805f4b4470af4,
                ])),
                Felt::new(BigInteger384([
                    0x255c1e4ca7d36239,
                    0x445538674fcdaf6c,
                    0x8107f33030567e05,
                    0xc2a5081dfd7ebb6b,
                    0xfea511e137e41ade,
                    0x1297fcbacb3e7e16,
                ])),
                Felt::new(BigInteger384([
                    0x7fe396da77634f41,
                    0x55cfc8689e8574e9,
                    0xd8a0f4a6de0f98cc,
                    0xd54b1b34744910ff,
                    0xda5753074e67fae1,
                    0x05fe02b9b729312a,
                ])),
                Felt::new(BigInteger384([
                    0x59179e1451bed792,
                    0xc1b521776a44d5b6,
                    0xa8c992624479fe03,
                    0x3a7256c74adc6096,
                    0xfca96a786f46a115,
                    0x0be3480115695ef2,
                ])),
                Felt::new(BigInteger384([
                    0x0274cf8140527c33,
                    0x36ed0956968d87cb,
                    0xe44522afdab3d93e,
                    0xec143f4778421f6a,
                    0x68d250a1601f927d,
                    0x126b95abffbe3ce1,
                ])),
                Felt::new(BigInteger384([
                    0x5ed8c445455909ef,
                    0x116e61136c4bcc74,
                    0xfde12fe24273ff5f,
                    0xd2d9baa1981077e8,
                    0xa17429effefe00f2,
                    0x15831198d710c984,
                ])),
                Felt::new(BigInteger384([
                    0xca4b1fbf620fa957,
                    0x2fae9696a3ad3bc2,
                    0x469eace55c54b159,
                    0x6db00ccb09549722,
                    0x76ca25c68c3e062f,
                    0x04ad24222bf6c0e1,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xa2213236bac71c40,
                    0x1e5a6a77540ef0a9,
                    0x352a9e58b63dce8d,
                    0x41b6b0ec3c6aecb4,
                    0xbf9f22560495769b,
                    0x05b15804da2c1bc4,
                ])),
                Felt::new(BigInteger384([
                    0xa2168a79dddff141,
                    0x5c5ac5643d361409,
                    0xa7b3959fdebf6a47,
                    0xac743fcf75da7433,
                    0x8bad5cffd41b5fbe,
                    0x124ee06ca0bafb9d,
                ])),
                Felt::new(BigInteger384([
                    0xb8abedd1a3de11c6,
                    0xa2a450559d6eab97,
                    0x3ee312b6658db3c3,
                    0x4b309b6e6c679089,
                    0x8fc80f1caee1f91c,
                    0x09332c5e286b739b,
                ])),
                Felt::new(BigInteger384([
                    0x58887850a216bf93,
                    0x87a5af6f6c4cd806,
                    0xbecab3138d32f875,
                    0x8ef3c38bad74295d,
                    0x1fce02a1967d7b78,
                    0x07f0d42715b9fbdc,
                ])),
                Felt::new(BigInteger384([
                    0xa8ceee64ad1fa755,
                    0x88dd22ffed6cd197,
                    0x09f360db05fe06b0,
                    0x00b852b79cc04166,
                    0x89d6fdf50dfbeba7,
                    0x0119d8fe86daa8c2,
                ])),
                Felt::new(BigInteger384([
                    0xe48c902588e90a3c,
                    0x946554c454fbf90d,
                    0xfdc7a97903112085,
                    0xc2ef380739356ec7,
                    0xfc6dcb7f6c4918b3,
                    0x1716e1010e0c919d,
                ])),
                Felt::new(BigInteger384([
                    0x31b4e634396d1694,
                    0x98bc9c19043291d6,
                    0x738922c23b10acd5,
                    0x4bd6a4be1d538b69,
                    0xc6dace6fd6a6a0a8,
                    0x04194a085141e5e0,
                ])),
                Felt::new(BigInteger384([
                    0xe47ff2d0ac4bd170,
                    0x5f1655c911666bc0,
                    0x82c9687c8151067b,
                    0x1f3d64a9ee35ca0c,
                    0xb15818c99acee301,
                    0x13d3c48237346982,
                ])),
                Felt::new(BigInteger384([
                    0xb81f99628614fdb9,
                    0xca6514d7bc7b70a3,
                    0x07081ff84b826ce1,
                    0xc14afe8bf64ac29f,
                    0x4cde800f36695eac,
                    0x1043bcf88c7f0bf9,
                ])),
                Felt::new(BigInteger384([
                    0x7e529d69a083b4a0,
                    0x555cdd2d95115d1f,
                    0xc0a494020db1d29e,
                    0x71731bebd2f6c78c,
                    0x8a0d5aa7cba8ab3f,
                    0x09a2544b128dcfd6,
                ])),
                Felt::new(BigInteger384([
                    0x1ca3bf6b004553f3,
                    0x55d74c06a27b7f8e,
                    0xc59bf43bd84e89a3,
                    0x763a69e1b4b1df4f,
                    0xef3e3e5528915020,
                    0x166ef8be6229a2b5,
                ])),
                Felt::new(BigInteger384([
                    0x85c0f23436d1186c,
                    0xb3d1bebfddc3e92b,
                    0xd2aee164c7cbd93d,
                    0x8279ca1ac8f24916,
                    0x3b38f3ddf10f0374,
                    0x086542b67cfaefe9,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x6125e5558a6ed925,
                    0xb20f63739ac11c11,
                    0xe3b5108de2f969fb,
                    0x56117a8a2688a878,
                    0x7b2bdb822815843a,
                    0x1557521e4c1e4a13,
                ])),
                Felt::new(BigInteger384([
                    0x2978bdaf794ef9ad,
                    0x362a58d6a00ab125,
                    0xd6eac561ed25c9ea,
                    0x7aa72779c53e8080,
                    0x7cd4084cd70ddbaa,
                    0x03105e2ab759059c,
                ])),
                Felt::new(BigInteger384([
                    0xea59fe7d9594b27b,
                    0x11b1c3a3f6514130,
                    0xf9fa5584a9fb57c0,
                    0xefcdfd3a07c005e0,
                    0x2e64c53e7c197d34,
                    0x11ed6258495f6e34,
                ])),
                Felt::new(BigInteger384([
                    0x4dd8d15a0c0e0e79,
                    0xd2bc721e676c3e66,
                    0xaee6565741e12ecc,
                    0xf710933c87807d4d,
                    0x58b0061d0b488365,
                    0x179c95938ff249ec,
                ])),
                Felt::new(BigInteger384([
                    0xb8a3032d85b7f611,
                    0x6c6974020b749d74,
                    0x2427768bfb230f73,
                    0x6d4da06641c6997f,
                    0xb536be779886b7e0,
                    0x06d6fc1206462cbf,
                ])),
                Felt::new(BigInteger384([
                    0x5645a633d1e05955,
                    0x31540062e040ab39,
                    0x65a1d6ef217d72a3,
                    0xc3752f7b960d1119,
                    0x626c182f209dc11a,
                    0x0700a8c5abbbb47c,
                ])),
                Felt::new(BigInteger384([
                    0xfebeaff074a5b3e0,
                    0x7e4b7b17c926b82a,
                    0xbec45c52ff8154b1,
                    0x8a57e49cc427a6bb,
                    0x360b394f8e95f246,
                    0x04ed40ddd4dde85e,
                ])),
                Felt::new(BigInteger384([
                    0xb65c479d95f53018,
                    0x318552af82ad072f,
                    0x6d9100f092981266,
                    0xf202ccce76f3af4b,
                    0x44d921627c9b83e6,
                    0x0d24a84e9f6cb3ea,
                ])),
                Felt::new(BigInteger384([
                    0x6a2f76546d338260,
                    0xe01a3e9074a3f0b5,
                    0x10f0e9bd58b35c83,
                    0x5d1ec9a2a40efe15,
                    0x018b7bfacaaf8a2b,
                    0x0e98ffd2e0e53e55,
                ])),
                Felt::new(BigInteger384([
                    0x9ee508b34b00b811,
                    0x6b0b34e11e8d9702,
                    0x868c232a44154b94,
                    0x8bc9dead4ebe6fb1,
                    0x92c626a23fbd6fe1,
                    0x1734791b42b0cefc,
                ])),
                Felt::new(BigInteger384([
                    0xe049f9c1ab183d48,
                    0xc5171d5c66effe09,
                    0x91eaf29e4d8caabb,
                    0x75240dc4200ffeae,
                    0xf56b426eed302fd5,
                    0x08edba0b05fef9c7,
                ])),
                Felt::new(BigInteger384([
                    0xcd2916975f1ac54f,
                    0x6c22533b238f7887,
                    0x887d01f854d2b683,
                    0xed54e64f2dfba00e,
                    0x37393e7601c810ec,
                    0x193f6a358244e2fd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x14bea5cf63ee3d47,
                    0x089c085e9c5637b9,
                    0x21fa9bd8e4771ad1,
                    0x141da7e087039d46,
                    0x6e4b03472b8586eb,
                    0x0f650707c8036d80,
                ])),
                Felt::new(BigInteger384([
                    0x291727726a4bfe73,
                    0xee29067b8806ad1b,
                    0x74c0978956ef2ee4,
                    0xd2d1c7107a1428e0,
                    0x87deb05a3c35ecc8,
                    0x0a7a90a3efdb875b,
                ])),
                Felt::new(BigInteger384([
                    0xb42112674d6bcd1d,
                    0x5cc767f23e598f69,
                    0x9cd86bd548372b11,
                    0x60aaafc97a6a74e7,
                    0xbb153ed0bbb9f688,
                    0x19ada18d90b7f968,
                ])),
                Felt::new(BigInteger384([
                    0x913c95e31e816a65,
                    0x4110d894abc27424,
                    0x7cf9431795d8cdfc,
                    0x8d561c612794098a,
                    0xab0b6195183e7473,
                    0x1926ce4f931d194b,
                ])),
                Felt::new(BigInteger384([
                    0x7349efc4abd1841f,
                    0x5603777bffcb49e7,
                    0xcbfd0be39147e4a2,
                    0x987ca3d2a2217d4b,
                    0x044a2fcd4c784315,
                    0x05b5bfba0cade155,
                ])),
                Felt::new(BigInteger384([
                    0x11f144a988a61477,
                    0x5fb759f78d4de799,
                    0xe2f3de57ae2b5f05,
                    0x3015070ac1225a3e,
                    0x363ded7cc8d67195,
                    0x1587b520603b6878,
                ])),
                Felt::new(BigInteger384([
                    0xc40da28552161ff2,
                    0xe3b86e0f0d3f5ec2,
                    0x49ae22ff95405a2f,
                    0x894c302f4f1b0347,
                    0xaa97bf9b85fb38d3,
                    0x0c73e206dfd7c8a7,
                ])),
                Felt::new(BigInteger384([
                    0x6aba23270455df07,
                    0x6f0bc83c508e6512,
                    0xb2ef285c2e17a6c9,
                    0xfb83fec735cb059c,
                    0x4ac2b736a134e590,
                    0x058c734e33b3238f,
                ])),
                Felt::new(BigInteger384([
                    0x655108a080724448,
                    0x0cbb3d2f4ff127fe,
                    0x094b55e6edc93dbd,
                    0x2e0af92efa894227,
                    0x8b4c51063cd3d910,
                    0x07bcc35fdd452d84,
                ])),
                Felt::new(BigInteger384([
                    0x31553b21276fbf6d,
                    0xc371b934bc8f8691,
                    0xa1fb07dc56bd1a92,
                    0x5127c142ac948217,
                    0x5c76c6341631fe98,
                    0x0dc5361da93e162d,
                ])),
                Felt::new(BigInteger384([
                    0x52e8bcb82de59251,
                    0x049c531628273bfb,
                    0x362c111fb88629a1,
                    0x613287298c02afeb,
                    0xaeabfd30b4336f5c,
                    0x0e418b21c98683fa,
                ])),
                Felt::new(BigInteger384([
                    0xc2c9cdc4b4a57956,
                    0x02fa0d323bb62469,
                    0xf2082bfa3f0ae068,
                    0x91b4387063feff16,
                    0x27ce161dee13dddb,
                    0x00c88de7f576c7ea,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xbb79c0cad0cf3183,
                    0x4759830d1a9ae0d6,
                    0x5eb641a58bd638aa,
                    0x8bbe7cfb4a5e406f,
                    0xd3420c5284555dec,
                    0x18f8174c4b80b0cf,
                ])),
                Felt::new(BigInteger384([
                    0x1eca83041d6df1a2,
                    0x48642687af7542ad,
                    0x69556654d455c04f,
                    0xe4c9da0d1f49d4a6,
                    0xe3fc679cae55c6e9,
                    0x12783146a4049823,
                ])),
                Felt::new(BigInteger384([
                    0x7e057c06be23b238,
                    0x10dec6bd576b07c4,
                    0xb927f39261fe80b4,
                    0xd473d16f8ea617d0,
                    0x513ba9e90fab9748,
                    0x0cf3110a4d65bcbd,
                ])),
                Felt::new(BigInteger384([
                    0x5765c26d4356c5b3,
                    0x34c9e5bac009fe03,
                    0x5ed47ce5cd04bd5d,
                    0x9cff32e38b0db5d9,
                    0x6dc686468a5ce12f,
                    0x08ad27964efb5adb,
                ])),
                Felt::new(BigInteger384([
                    0x7c8901415e828a74,
                    0x004ccc3e0ddfe397,
                    0x16f7e605a97769bd,
                    0x0bf4a1b5b9d009df,
                    0x25463b450498c05e,
                    0x0d69af313e9a96a3,
                ])),
                Felt::new(BigInteger384([
                    0x274d5c7805beec63,
                    0xcad9042dae719658,
                    0x777d8dbd4d05bb56,
                    0xc527eb96fb797399,
                    0x144f87ca3eaa3c5b,
                    0x05ec0bf5c099372a,
                ])),
                Felt::new(BigInteger384([
                    0xabaa26060a1f4936,
                    0x6b5c5b9eb5c0c68a,
                    0xa6d78604a7bad447,
                    0x611667e7809f976f,
                    0xce4262c81ddfbb14,
                    0x0eb30aada7476897,
                ])),
                Felt::new(BigInteger384([
                    0x66632fed718e7904,
                    0x445e0917f61311f2,
                    0xcbd3ce6529ed9bac,
                    0xf68da228715472b6,
                    0x1223932ba1732610,
                    0x160816f0fa8200df,
                ])),
                Felt::new(BigInteger384([
                    0xa2bbba19b0d52497,
                    0xdb799bfce20dfac5,
                    0x6517cae2654a537b,
                    0x0c5234d8667643c0,
                    0x7c61b3f6e2c5b467,
                    0x15d1cbce6124c76b,
                ])),
                Felt::new(BigInteger384([
                    0x68450b93a4c479ca,
                    0x916a0c176a3db2a5,
                    0x4c87dc3eb6c9153d,
                    0x64bd053b8ab54833,
                    0x451c8e8a282d0420,
                    0x066ab5531ca65947,
                ])),
                Felt::new(BigInteger384([
                    0x9f211205569335b4,
                    0xd26b1b98d34da882,
                    0xff6a6791d8651065,
                    0x7a8ec85c6a81a428,
                    0x7248f23fc8ec06ab,
                    0x01fa01a03e606c84,
                ])),
                Felt::new(BigInteger384([
                    0x753123e99357af25,
                    0xd9bf12d0aef6ef24,
                    0x1c40d7ecba30b384,
                    0xb7f4e9431960f76f,
                    0x3fba03c2ca897225,
                    0x0aa37e9f3f4fb02a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x77e97cb96069c758,
                    0x1eb334b9ed182691,
                    0xb2c8cf2a15f0b284,
                    0x39c7ad8c7179a2b5,
                    0x1fd3e4185d25a69f,
                    0x127b134978ca1c1f,
                ])),
                Felt::new(BigInteger384([
                    0x49854441f0a6dfe3,
                    0x3cdac01f9f6faad1,
                    0x41c9ef6c15765a40,
                    0x1fd6065f8bc999ab,
                    0x0a9a6597e453aaae,
                    0x0f455ed7e8983052,
                ])),
                Felt::new(BigInteger384([
                    0x67123f5382e00a4a,
                    0x230233fafb02c3bb,
                    0x6fb6fbad291dd110,
                    0x804b6335c3288b20,
                    0x5399226c7a41258b,
                    0x01c54a6be86d6cd5,
                ])),
                Felt::new(BigInteger384([
                    0x837d08edb546228f,
                    0x52c0ad2023fd3d0d,
                    0xbae0fb879679e0ab,
                    0x2160ea785f5495a9,
                    0x659ec7c89474af63,
                    0x0a0c804da4346ea1,
                ])),
                Felt::new(BigInteger384([
                    0xf5e5afd59f509ee0,
                    0x4ba289c52059c2c8,
                    0xe9e9bd885f14fb33,
                    0x36823e9fa0b17339,
                    0xa12009113e8fd8e6,
                    0x0945df7b4266caae,
                ])),
                Felt::new(BigInteger384([
                    0x6061eec35435ae42,
                    0x242467fbabf6417d,
                    0x41709f55269d7c78,
                    0x25e3ee2844519ab6,
                    0x3ae4da5f80bc438b,
                    0x0c5f6236d65aa679,
                ])),
                Felt::new(BigInteger384([
                    0x1bf56210e9b048bf,
                    0x7b931a5fdc1b3d3f,
                    0xecf918c0bd4bef04,
                    0x5323b051fdfafa00,
                    0x41b470b803621026,
                    0x011f44534725f631,
                ])),
                Felt::new(BigInteger384([
                    0x74ba33f0829ffc9b,
                    0x817cce620d06ac45,
                    0x6cf8cd909fbdf2f3,
                    0x5747e4acc67a43bb,
                    0x4381dac797b0a11b,
                    0x016836894e6a18ed,
                ])),
                Felt::new(BigInteger384([
                    0x4ffe02cd3f185e93,
                    0x1d26f5a12516c789,
                    0x39c7f02d4eb8e370,
                    0xcabc254c6d74f3db,
                    0x9f906a07e639cd40,
                    0x09ccca34e7fa5d28,
                ])),
                Felt::new(BigInteger384([
                    0x2a3a380aa6d244a3,
                    0x7a7e68643a4e3e2d,
                    0xe9c4367f8fec241d,
                    0x696667835d4127eb,
                    0x55374fa5a59b4089,
                    0x13050d788c68701a,
                ])),
                Felt::new(BigInteger384([
                    0x6cc7a836cc65b946,
                    0xc2f64d5a124ebf6e,
                    0xcc071394ff864b41,
                    0x53b2701e74048b33,
                    0xcfa9126177e2ac61,
                    0x13e1d9df9753252a,
                ])),
                Felt::new(BigInteger384([
                    0x3708e66a75894879,
                    0x096cb7410b5ac57c,
                    0x8bb7dba40689b24f,
                    0xd38c6c4cd7744d14,
                    0x2b3ad05ced6eac86,
                    0x1016bea843ae29b9,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe1341a318048cdb4,
                    0x1eaef817d07c18bf,
                    0xc4ff46409fa0ae5d,
                    0x0814003592bae07f,
                    0x4d7639b8f7b1df85,
                    0x1748adde7dda3141,
                ])),
                Felt::new(BigInteger384([
                    0x008c99ae5c858c45,
                    0x90fcaf5287938623,
                    0x614a50324f19c722,
                    0x038e7091dc7cf9f0,
                    0xc3148d454befffdf,
                    0x1112f6b07b7b8a3c,
                ])),
                Felt::new(BigInteger384([
                    0xa69605b95a867a09,
                    0xec170481348a5c5b,
                    0xc1e2ada01a335491,
                    0x26544be85ad5d531,
                    0x32c92be388c82c97,
                    0x090b778f1c5d0e98,
                ])),
                Felt::new(BigInteger384([
                    0xda36b3162d3cecbc,
                    0xbf02aab51f580aa8,
                    0x126b18c998768459,
                    0x9c8a81e1e4dad579,
                    0x7e57c9c958470ffc,
                    0x008664bbf7d36fc5,
                ])),
                Felt::new(BigInteger384([
                    0x7c985eed849e6c87,
                    0xf4530b0eec9cbc4b,
                    0xe993a93323aa1db8,
                    0x5a48bc499bedf4db,
                    0x63cab3eaed26ef13,
                    0x11e77d3397feeffd,
                ])),
                Felt::new(BigInteger384([
                    0x9d037b296494cf4d,
                    0x05d4378551c3479f,
                    0xf4954a70e77c745a,
                    0xdfa4b57e9e15c18a,
                    0x2517ba8a19db7d2b,
                    0x088bcd698792bfa8,
                ])),
                Felt::new(BigInteger384([
                    0xc3c78aeb6074088c,
                    0x182aa568342d3d6e,
                    0x847f96543df9d499,
                    0x2b2d6cb0003ce158,
                    0x880bee2e365de912,
                    0x17163d32a6072b74,
                ])),
                Felt::new(BigInteger384([
                    0x9af470269b3aad71,
                    0x541cfa4d7ab36e27,
                    0xbee594d9659a410e,
                    0x968bbe18e8e50c6f,
                    0x4db9f03fe15db0a7,
                    0x026800bcf83619ab,
                ])),
                Felt::new(BigInteger384([
                    0x402e3b943c038593,
                    0x60e998baddf7bfd8,
                    0xe7d8d15bfca7182c,
                    0xd3dc254f91360c5f,
                    0xd50c44dc65d227ee,
                    0x1959a330fbf8208b,
                ])),
                Felt::new(BigInteger384([
                    0x8347809dbaecbda9,
                    0x3a115daa4cf3b8a5,
                    0xc78985d7de081aff,
                    0x000ea09816dc3691,
                    0xfd248770ff203abc,
                    0x0cce253beee4e3f9,
                ])),
                Felt::new(BigInteger384([
                    0x51f9dcbae290df44,
                    0xa0901be6044cd1d2,
                    0xe25ab00aee2815fa,
                    0x52a35bc104f3ddfb,
                    0xb5f4cee1726c163a,
                    0x170b4eed264a8fad,
                ])),
                Felt::new(BigInteger384([
                    0x9178ee53b1fc0575,
                    0x20889c4fee61b738,
                    0x099953ca4485a80e,
                    0x305294c5291d6117,
                    0x65b1116573d00e4d,
                    0x0305b645f6b0cf96,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xd461f9da53445904,
                    0xa27505aacd4127fd,
                    0xfcfbce8b37d8a81a,
                    0xf04f472325c4f370,
                    0x708e7f7f92986d79,
                    0x070b4e7957bbe4f8,
                ])),
                Felt::new(BigInteger384([
                    0x30f65cdd609c7d6c,
                    0xb1cfb412bb5c87e8,
                    0xc07630e201854596,
                    0x663b406533c52c3f,
                    0x0da1c03e69e47fdd,
                    0x027937b8ab6bcff7,
                ])),
                Felt::new(BigInteger384([
                    0x0c569854f950a037,
                    0x61967b66efeffdbe,
                    0x74c42020d5edcd71,
                    0x10c5445bedaa9e68,
                    0x0d11348449ea2b48,
                    0x02f900fe392d2509,
                ])),
                Felt::new(BigInteger384([
                    0x5d96bfc78d69e968,
                    0x3d25e80c6dcca3de,
                    0xd94c7e935739ec56,
                    0x783bf817926ae267,
                    0x101d02d809b5d78a,
                    0x1584304f3364665b,
                ])),
                Felt::new(BigInteger384([
                    0x483bb48e2367311d,
                    0xd5d262026a459915,
                    0x84364d783def583b,
                    0x203c916f40ae9eed,
                    0xd1eb18d566e67445,
                    0x11e47191e9bc77be,
                ])),
                Felt::new(BigInteger384([
                    0x594338abbe1e5880,
                    0x331096097a971e26,
                    0x84d151a9f4f151a9,
                    0x3387838a7a383395,
                    0xd13bb10cc65bc4a0,
                    0x07ce4c1e11a92ffd,
                ])),
                Felt::new(BigInteger384([
                    0x035096464ed117e6,
                    0xdc0e4bcfc55dfb1f,
                    0x416b4f5ae794bb5d,
                    0x63e4617bcd94d627,
                    0x25d9028ae42e362d,
                    0x0bfb4ae36f019ff6,
                ])),
                Felt::new(BigInteger384([
                    0x983d90c5668a12c1,
                    0x4325983c0ab10739,
                    0x74bb5a1c3902e724,
                    0xc1f3eae7c4fe12f7,
                    0x6b6dccf5805d4dcb,
                    0x112ea479bc588ac1,
                ])),
                Felt::new(BigInteger384([
                    0x3d442a55ac3cd13d,
                    0x41de17174ad428e2,
                    0x534b0c32ddeb40d4,
                    0x761b340299da0402,
                    0x24ab6e514d6dc1eb,
                    0x0962b72db09ddadd,
                ])),
                Felt::new(BigInteger384([
                    0xa1a4509cd6487aee,
                    0xe58a452f9ae69d60,
                    0x33e3ba62b6f30e73,
                    0x270f8c56ceb5a448,
                    0xa483d7d9fb015d41,
                    0x0454cb0d2b81c131,
                ])),
                Felt::new(BigInteger384([
                    0xebe3fe5b0efe2e35,
                    0x290f0c66cd9f3a42,
                    0x84dd6d854b3755b3,
                    0x36632758cbf798d0,
                    0x6dd462cf424923dd,
                    0x0d7f361668f47ee6,
                ])),
                Felt::new(BigInteger384([
                    0x3c8a94ebeacdb6fe,
                    0xa383ca784fa18a73,
                    0xaef1edf44a795636,
                    0xe9bfc400e8d7762f,
                    0xfffadbe149cb161f,
                    0x059e65c492756e31,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x9ec1ead039b8aab2,
                    0x70eb58f375031a01,
                    0xb724941111947e9d,
                    0x6f3b85b5e7b5dacb,
                    0x017c5f0535e2c3a6,
                    0x0c0a2ff21392b575,
                ])),
                Felt::new(BigInteger384([
                    0x0f0ab1f9cc0804df,
                    0x86dbdadbc873f3b2,
                    0xab23c15758a3ff93,
                    0x86bf3d60cf93f581,
                    0xac450a8daa417210,
                    0x155017fb2d21038f,
                ])),
                Felt::new(BigInteger384([
                    0x5ce7a9991762922a,
                    0x8ce0e63a06a18d7b,
                    0xd7f307ee43e62f0f,
                    0x0a7d798cc7e7cf27,
                    0x9eb40caa3b697e33,
                    0x0602d980b5bd23c9,
                ])),
                Felt::new(BigInteger384([
                    0xcea2e49f42b83230,
                    0x2ddb0deb8352e817,
                    0xe7f2b39d6ee29f6c,
                    0x090f7fbf61a740eb,
                    0x30a232a24cf838cc,
                    0x0e1a72eff0e049fd,
                ])),
                Felt::new(BigInteger384([
                    0x4e841a205386aeff,
                    0xdf4763783e0d05ab,
                    0x8ca3ca48c9658b20,
                    0x836618f2dda07760,
                    0xa3b78db2646e2384,
                    0x166d59482e351991,
                ])),
                Felt::new(BigInteger384([
                    0x364626fcdaedea0f,
                    0x18fe57787c10e52b,
                    0xddca6eb6d044c5c6,
                    0x86bf38cb406a06d0,
                    0xfb73d1e1f2de534f,
                    0x00caa76533f765db,
                ])),
                Felt::new(BigInteger384([
                    0x4047cac2afe545e5,
                    0x5c6fc269fc1b84c1,
                    0x00e27571facccbee,
                    0x5decfe4682376dc3,
                    0xc4a1e3ecd655c976,
                    0x11f4c63db53d69f3,
                ])),
                Felt::new(BigInteger384([
                    0xbbac67e3302face3,
                    0x903b595f2a4a5ed3,
                    0x4d1d8a8109e1e76e,
                    0x72600f9c3da54b05,
                    0x2201e5db66634381,
                    0x0b08864146e27e95,
                ])),
                Felt::new(BigInteger384([
                    0xa5eb87d07e99afe8,
                    0xf4108334fce827a2,
                    0x79100d2b78d29216,
                    0x43c7dd74783b8863,
                    0xf7f31f94682668ee,
                    0x16e71dd4870d4882,
                ])),
                Felt::new(BigInteger384([
                    0xaec9c9e399f051f5,
                    0x8e67a7b32892519d,
                    0x7ed62e7674a6a669,
                    0x6dafdbb6f1104bf2,
                    0x22f5244896bf821e,
                    0x14e6767a7439606c,
                ])),
                Felt::new(BigInteger384([
                    0x2c231097ae936bc7,
                    0x264827f00949e06b,
                    0xc9b4d845c5005f69,
                    0x6c6c87b93d274d89,
                    0xa6b4304c6515820f,
                    0x126cc8f08cda8d75,
                ])),
                Felt::new(BigInteger384([
                    0x0c3806f49771027d,
                    0x666e452fab9e92fa,
                    0x10fcfaefcc3c3411,
                    0x933ff788072816eb,
                    0xb7d3b7d4946bebf9,
                    0x109cdce1488e2043,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x274c67b2728cadd2,
                    0x14e85ac89dc46b71,
                    0xc8f035f20cff78fb,
                    0x888251a49dbd1ec7,
                    0x9af44d0f9e6abe6d,
                    0x0512865d7f2a82d3,
                ])),
                Felt::new(BigInteger384([
                    0x1a3713d7831312c1,
                    0x565f1a0658abbfc0,
                    0x223a94d047a701f6,
                    0xf716e8cce83934e5,
                    0x9e46ea0d6c2f2ecd,
                    0x0eeb704a98c1c627,
                ])),
                Felt::new(BigInteger384([
                    0x286d8333ff154d6a,
                    0xc7e5ad4ffa336e7f,
                    0xaa8a6078ec966df3,
                    0xaf7fdc808f524c26,
                    0x9c1d7352cf5096ae,
                    0x0214ff1a06637e5a,
                ])),
                Felt::new(BigInteger384([
                    0xa64b6964c65c85c6,
                    0x8c6ac13a7413ea3c,
                    0xe19bf72a4f657cf9,
                    0xef4ef7696ce47c2f,
                    0x855d2ac6e0a3aa2d,
                    0x03278bd89b28cd28,
                ])),
                Felt::new(BigInteger384([
                    0xe6ec5ea8588f6cf0,
                    0x36e2efcec08c141b,
                    0x3a4e4f8b02831282,
                    0x7d0dea1466b01a6d,
                    0x7b7a5a059651dd2c,
                    0x051cf43de1763456,
                ])),
                Felt::new(BigInteger384([
                    0x31d7cdea793b4da0,
                    0xeacf5f87a5a2ea12,
                    0x9134aabe91960534,
                    0xf4ab765e1e952d66,
                    0x142f04108586797a,
                    0x07d6e887e8c7b7fa,
                ])),
                Felt::new(BigInteger384([
                    0x9b8878933fc56ece,
                    0x8600134f2dd6c775,
                    0xf3c75c2776cc2710,
                    0x3ffae14174cf3a8e,
                    0x666a614622a19423,
                    0x19e22012cbe2af6d,
                ])),
                Felt::new(BigInteger384([
                    0x5aab8f39a74c6c35,
                    0x47c87a0cd563f14a,
                    0x79c3e356a5b6afa6,
                    0x627f037e9aad100a,
                    0x2e8d895a4692f5e2,
                    0x140b37d99022c3dc,
                ])),
                Felt::new(BigInteger384([
                    0xbb7f77c025c274f2,
                    0x5b90df70645c2fd1,
                    0x19491ee2f73ef94d,
                    0x7e35865696602dc6,
                    0xc3a79164bb71470e,
                    0x1189783a91c30a6d,
                ])),
                Felt::new(BigInteger384([
                    0x446910d84239f2ca,
                    0x76f690b8c64f2dbd,
                    0xec67b0c362a1ab8e,
                    0x5822ddaf145f2cb2,
                    0xe577732addef9155,
                    0x01a215efcafc6f04,
                ])),
                Felt::new(BigInteger384([
                    0xe096fa151303e3cb,
                    0xac901514ef9c6383,
                    0xebf9eb65e53ae223,
                    0x11285de15aa4df5a,
                    0xbc71e2da5781750e,
                    0x109d83e9052459c0,
                ])),
                Felt::new(BigInteger384([
                    0xaba785c6997b06c7,
                    0xf293c0683b3a43b6,
                    0x118f779f57fe25be,
                    0x17b9d7d4e09e0b58,
                    0x4da55f89f6fd62e1,
                    0x17cb998f919317b3,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xfbf0eb72b260da87,
                    0x8ea1348c09a2f801,
                    0xc97f828e5434d777,
                    0x796f57e2d897b86d,
                    0xf0d828dce465d022,
                    0x10b446f14905ac8f,
                ])),
                Felt::new(BigInteger384([
                    0x685c9a53d7b1a28d,
                    0xf61ed9bf4dbaec1a,
                    0x175fe6809ec4846d,
                    0xae3bbad26b59eb55,
                    0xc2a1374c0eace567,
                    0x12d96b908a804c60,
                ])),
                Felt::new(BigInteger384([
                    0xcfbf42186b030463,
                    0x520b893917c4d570,
                    0x0049a523d302957d,
                    0xb1eaf243c469e1c2,
                    0x4e4f3b1d0c6bd109,
                    0x1340dd5ae57af387,
                ])),
                Felt::new(BigInteger384([
                    0x3a07221234cac863,
                    0x0df941c480cecd99,
                    0x9cf7138654159563,
                    0x1f56a12d796a38f2,
                    0xfcf3d6569764e43d,
                    0x06dbe310d277da6b,
                ])),
                Felt::new(BigInteger384([
                    0xb2e69e009d67342f,
                    0xf66a891b8701c311,
                    0x6cd1dfdc883ac3c9,
                    0x8d740546be3e8d0c,
                    0x12f0a41e9b80976f,
                    0x13a2443c133e9b0b,
                ])),
                Felt::new(BigInteger384([
                    0x634af2c7195d8b50,
                    0xe6c24e79cc1d33e1,
                    0x678dd7a7e41ec28d,
                    0xe8b1ec6eb91de02f,
                    0xd8db83458819632f,
                    0x0da9795a9a596d18,
                ])),
                Felt::new(BigInteger384([
                    0x95f2af1482bb3e34,
                    0x251529c4e441b746,
                    0xaca9e4577bc053f3,
                    0x1f4a1041043b82c1,
                    0x4a1fee6f76b21a57,
                    0x033b8d5268c57862,
                ])),
                Felt::new(BigInteger384([
                    0xb7a65c306e938da2,
                    0x6d4f1af25af64baa,
                    0xc3b4b204add747d8,
                    0x15d2295a10ed5f66,
                    0x169081d92dee256b,
                    0x0a02b5e82d93e79d,
                ])),
                Felt::new(BigInteger384([
                    0x00bcbbf2b64ff45e,
                    0x9efa7be7d7d14b63,
                    0x648689a1a8239a33,
                    0x4e767ec3df72a283,
                    0x5155ba30728a9b99,
                    0x01ac8a0b48b96cc6,
                ])),
                Felt::new(BigInteger384([
                    0x7e634c3eb11630cb,
                    0x67fd077c498656cb,
                    0x7a93bc001c272893,
                    0x46fa996d9774f14e,
                    0x6a35ff5514f153ab,
                    0x0f3db00ec9490311,
                ])),
                Felt::new(BigInteger384([
                    0x42669b4451041519,
                    0x481a0309066c71c8,
                    0x0879aabe52653549,
                    0x87614cb37722e750,
                    0x55a6b3e9025de0d3,
                    0x12e5051221a37363,
                ])),
                Felt::new(BigInteger384([
                    0xdd144ded59d5f9f5,
                    0x7bba36f16d69568b,
                    0xd994cd8f901bf559,
                    0xf1d6b43850cc141e,
                    0x3c1e942103853bf1,
                    0x05079388a53593ad,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x266f845d7be329ed,
                    0xafa10df81b134f8f,
                    0x60a8294e4add12c0,
                    0x9ef4b85f13715baa,
                    0x75f3a0aef4f4e14e,
                    0x09822d528c31c883,
                ])),
                Felt::new(BigInteger384([
                    0x45e5f802c358b278,
                    0x25b29f95bbad13d0,
                    0x350d00a926a05e4b,
                    0xc7513706cab849ad,
                    0x8a63fbc538e624a0,
                    0x18f120556fe39bab,
                ])),
                Felt::new(BigInteger384([
                    0xe03c4e22671501ed,
                    0x7347a7efe24f9389,
                    0xaddce423aad894f6,
                    0x8906145005ae2c67,
                    0xd07d9e4567fe161e,
                    0x0258fb9a6be60f06,
                ])),
                Felt::new(BigInteger384([
                    0x60a973200dfb08c5,
                    0xf8bd3be9fa800916,
                    0x92e72d68cf369024,
                    0xdb9a3c1528d66a34,
                    0x7671d5e2f1bcbb34,
                    0x165fcbbc1dee375e,
                ])),
                Felt::new(BigInteger384([
                    0x018d08b8ff613a2d,
                    0x944b0fbd946b36f6,
                    0x0d05b2986a07db0e,
                    0x1a2a66fc131d5bcd,
                    0x2d2f772dc9695b18,
                    0x0aeab3fd8b087e54,
                ])),
                Felt::new(BigInteger384([
                    0xb7cff135b3e3d5b7,
                    0xcf909d42ddae9dd1,
                    0xefdd4fa4c112a680,
                    0x47b70548c8ff3a1e,
                    0x94ae09854de74406,
                    0x0e5a9cd2d11cb408,
                ])),
                Felt::new(BigInteger384([
                    0xad9b5d16c2b3a1fc,
                    0x2c8eb9c6430fc0d9,
                    0x2ef6da0ddad35e80,
                    0xb6bf246c75fdbcd2,
                    0xd829fc8691f01ff9,
                    0x0faf847af076ca1e,
                ])),
                Felt::new(BigInteger384([
                    0xa6e6682f873369d8,
                    0x2e78994de7c67ef4,
                    0xf00e0e7a1fcd2457,
                    0x0360c3a2895c7c3c,
                    0xcb375d6b0a45843d,
                    0x1520b55965884bde,
                ])),
                Felt::new(BigInteger384([
                    0xd2aab6f30268ec1f,
                    0xa1e4294511406d13,
                    0x907a92e2fc29d8ed,
                    0xc4f464a50610deae,
                    0xa23f141264fb6f93,
                    0x112cc31fb8b1e0a5,
                ])),
                Felt::new(BigInteger384([
                    0x54269b2e26ee2d5c,
                    0x482683a3fbc13b0b,
                    0x8f8767cf1d2f3c53,
                    0x6cfdbe434bdd0094,
                    0x4f6b811eee2dfb9e,
                    0x03ec3f60824c3994,
                ])),
                Felt::new(BigInteger384([
                    0xc03a081a4127f8f6,
                    0x798ce670391b94b1,
                    0x2e5f161f08f8e6f4,
                    0x796d5dc4f6326555,
                    0x96984eac61e52611,
                    0x12e10a9558e75c7a,
                ])),
                Felt::new(BigInteger384([
                    0xeb46db792919c85a,
                    0xef971cb361e8d2f7,
                    0xda48a0fc434c71ad,
                    0xe2c5f351994d40f3,
                    0x2895f3e91f742fee,
                    0x04d3a15b4aa0858d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x65167fac507420bd,
                    0x520883d9f68a7f6f,
                    0xb3267698265fc2b8,
                    0xa16c36aedb8140d1,
                    0x6f0ff3d9151bb025,
                    0x05a21efa4924131e,
                ])),
                Felt::new(BigInteger384([
                    0x8650264a0d0f1e6e,
                    0x755a2a16ca4ec636,
                    0xef6a9e82d4901e55,
                    0x20f70dafa8265801,
                    0x2867f9fea152d68e,
                    0x05bf81821f0f3557,
                ])),
                Felt::new(BigInteger384([
                    0x1bd449df3c26474e,
                    0x9d0910a10c7bc16a,
                    0xdcee0037c6a1e16f,
                    0x2b75e78a543515ae,
                    0x4963811542e0b9d4,
                    0x0256d4304ad14136,
                ])),
                Felt::new(BigInteger384([
                    0xbfc595d6c35b788a,
                    0x953d6cf73254f042,
                    0x21bd03be0d88eef2,
                    0xbc7b10cb96881717,
                    0x944a01ccef9d5f86,
                    0x0bb6ed82f2dd4d01,
                ])),
                Felt::new(BigInteger384([
                    0x34951fd2b059ef04,
                    0x120808caa02ab5ac,
                    0xdc861df89d865154,
                    0x9799021933a5cdad,
                    0x7dc18ec23c8bf25f,
                    0x09c685b490fda6b5,
                ])),
                Felt::new(BigInteger384([
                    0xfabbf185c3d82434,
                    0x0a5b0935ef88cc1b,
                    0xd7af5fe704e64770,
                    0x308661dfb91cd21c,
                    0x25346aa4eda2e15c,
                    0x031acb4ad636b100,
                ])),
                Felt::new(BigInteger384([
                    0x8b99fc47cb4c281d,
                    0xdcf1fe1de1e8620c,
                    0xed8bb6f839036f86,
                    0x0a2ccd97f6f37f10,
                    0xb72a905bbdca2ec9,
                    0x00c402711a6b834c,
                ])),
                Felt::new(BigInteger384([
                    0xb3b8afae62c5b4a0,
                    0xd382c55bb18744d9,
                    0x8e34d806314c2c88,
                    0xd41a832f9144b998,
                    0x50ba5126deb510ec,
                    0x09f17a3394c2f4c4,
                ])),
                Felt::new(BigInteger384([
                    0x4b94cc93305aba92,
                    0x0a63f5bfa6815ac0,
                    0xbbdf0e0831c20b62,
                    0xb71dab38489bc54a,
                    0x8933155d8eab687b,
                    0x0451d59d1898cd9a,
                ])),
                Felt::new(BigInteger384([
                    0xfba591663a1905a1,
                    0x27ecc488467140c0,
                    0x6a857f9109be9c32,
                    0x9fa3123ae40f441c,
                    0x9388ab606174bda8,
                    0x0c6a5845b76f9294,
                ])),
                Felt::new(BigInteger384([
                    0xba92ca04bd58b8a5,
                    0xc4570e07119b4a21,
                    0x3c98c4199c1c3119,
                    0x27b6102ce937fe22,
                    0x28d83f577314aa3a,
                    0x0e477c58105d5146,
                ])),
                Felt::new(BigInteger384([
                    0xd5137d53a9c4071f,
                    0xa0cc7c802a87a3f2,
                    0x48ce0598295d094e,
                    0x04acbf10296a35ee,
                    0x37d6881be38297c9,
                    0x053b98b4ff80fdc6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x06e0298aeaea03b8,
                    0xb2eeffb38ea1add6,
                    0xfe0c548563cef153,
                    0xeb8cb7accbd758b6,
                    0xe18d4274847b70d5,
                    0x1897253c4f442bd6,
                ])),
                Felt::new(BigInteger384([
                    0xed3efc1e82c70368,
                    0xd8a99ff1e149648f,
                    0xa32621657241d29b,
                    0xf1aee643a9c0256a,
                    0x3ce24c36243b4bc9,
                    0x14bf64cb42343448,
                ])),
                Felt::new(BigInteger384([
                    0xcda4a27ee3f820c7,
                    0x518524d9e5990fc0,
                    0x7926ee65d7b30dd1,
                    0xb36e2b7282922331,
                    0x9ca9741be5b972a2,
                    0x003b653ffc2d4afb,
                ])),
                Felt::new(BigInteger384([
                    0x77ad080e9d5feae7,
                    0xb807ce64baedc02d,
                    0xc5135e1fe6a730e5,
                    0x67a23f8d7804b50f,
                    0x7e19d48b02241505,
                    0x08b329910a0feffa,
                ])),
                Felt::new(BigInteger384([
                    0xd94abf1292a8c0f4,
                    0xe0ed170d4eb1b016,
                    0x02294117788eb13f,
                    0x49457a3441a6051d,
                    0xb023d028e5d03e1e,
                    0x0233df215b3e40cd,
                ])),
                Felt::new(BigInteger384([
                    0x04b6098ad72257fd,
                    0x85b1d92e09f5e1e0,
                    0xe3d31477ae780e94,
                    0x309234e3c6af2331,
                    0x31f7e86ad145bd58,
                    0x131111fda410d1f3,
                ])),
                Felt::new(BigInteger384([
                    0x8ac732f0f37ae4d7,
                    0x42624b14c8adc4d8,
                    0x81b32e5fe925a84a,
                    0x287367cdae51f53c,
                    0x59d526d7ebb2a27f,
                    0x0cb7b828532ac4b9,
                ])),
                Felt::new(BigInteger384([
                    0x11f0e62bb20605bd,
                    0x9185e3c5fb49e725,
                    0x68f7c0f28b780b65,
                    0x1dd7a1ff49a43cd0,
                    0xc20bf8c0b8d45e18,
                    0x0191ab37979bd921,
                ])),
                Felt::new(BigInteger384([
                    0xd70b845e8658fd35,
                    0x688bda7a1e61aec4,
                    0x09d55585c20c54ee,
                    0xde5d9b2342372a57,
                    0xd484e702d69bc4bb,
                    0x0a78e9c748e304e8,
                ])),
                Felt::new(BigInteger384([
                    0xda280d5cc3f6ea4e,
                    0x8f073a2f52e9aada,
                    0x35554fb577a1377c,
                    0xcfe332f1977732fb,
                    0x5fb25bb2a7926d44,
                    0x13ac2851239bae19,
                ])),
                Felt::new(BigInteger384([
                    0x3682e796b8849770,
                    0x7ba7020259b96bfc,
                    0x58abccd23276793f,
                    0xf901d0aca89be3db,
                    0xd0c59c9c49e98cb1,
                    0x02fc85893eb70c66,
                ])),
                Felt::new(BigInteger384([
                    0xbb8589861af15385,
                    0x04b20f412bcee915,
                    0xa93026a55b59644e,
                    0x53ec4c98980303a7,
                    0x96dde4cef703fc4e,
                    0x0b99b13252638542,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::new(BigInteger384([
                    0x98c4000000415514,
                    0x845001003bb00035,
                    0xfe9ebcc320838c58,
                    0x14aa2e358e1da574,
                    0x7ed398747a0fab17,
                    0x172e48abfa1371de,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xfd5098a11a00c0cc,
                    0x52d11c61f2add1e2,
                    0x425732560c863238,
                    0xcf70a414d0142941,
                    0x0ad5cc305340d238,
                    0x10a6bba57842fa84,
                ])),
                Felt::new(BigInteger384([
                    0x4fdeb5c39aaa7c09,
                    0x28db43d43fb56606,
                    0x6c964790dd6266b5,
                    0x6ef33086539aff0f,
                    0xb9f25409024b4b9b,
                    0x018072d6e2198e34,
                ])),
                Felt::new(BigInteger384([
                    0x20433a78a9354199,
                    0xe7935a6542de5379,
                    0x6ba0075918e16015,
                    0x20b840f2a4eadd03,
                    0xca43bd38eb272d04,
                    0x1298c25532bef08b,
                ])),
                Felt::new(BigInteger384([
                    0xe3ac926e96657a23,
                    0x15fb874c910c18ab,
                    0x18667b918c79dd73,
                    0x9a9409f4c087486a,
                    0x895af51efeef2da2,
                    0x15a983ca615b1eac,
                ])),
                Felt::new(BigInteger384([
                    0xbb9b752e10ffb48f,
                    0x25f203ed341c3b9d,
                    0x4322f03f718dcb9f,
                    0x55738ef2b540cd2f,
                    0xee0d30933b32423e,
                    0x193a40577ddd017d,
                ])),
                Felt::new(BigInteger384([
                    0x5818e1fd190dab97,
                    0x21907460cb46baae,
                    0x5aa199644491cbb1,
                    0xa4c0328e59ca4166,
                    0x0bd79dbe0c58e9c9,
                    0x13d9169bf702d7e1,
                ])),
                Felt::new(BigInteger384([
                    0x6b5573144b8106e6,
                    0x64ad5be9078af869,
                    0x864879554ba7367e,
                    0xaaa894a95101fed8,
                    0x802b9deda864c8be,
                    0x1715383b1cbe8566,
                ])),
                Felt::new(BigInteger384([
                    0xf97c046e12a4b9ed,
                    0x4e8c9bd38a2a3729,
                    0x95cc5ae6fe6b058f,
                    0x1206f945d01a1e95,
                    0x0c3cae4dee4a8b61,
                    0x0975906745920c65,
                ])),
                Felt::new(BigInteger384([
                    0x1ca450b6b6f8b1f7,
                    0x54897b04e4c6c5f2,
                    0x99851eb108eb439d,
                    0xc410ec29f46b4b00,
                    0xad00c248186eee20,
                    0x0f84586250f16ca1,
                ])),
                Felt::new(BigInteger384([
                    0x124679c92b19f96b,
                    0x504b982883c32cdb,
                    0xc37931624381dff2,
                    0x497410d06fcf44fb,
                    0xc27076f6f9297e08,
                    0x08e572c64846f690,
                ])),
                Felt::new(BigInteger384([
                    0x5e047da2eb76d9c4,
                    0x442156bd6a38ad5c,
                    0x6d38b9b82f8f0534,
                    0x87e0f219f633cdcb,
                    0x3dc776e2e0a046da,
                    0x0a45b86d5be7be71,
                ])),
                Felt::new(BigInteger384([
                    0xa2eb6e57b92f1ecb,
                    0x7b11ab1540f874eb,
                    0x6653777d667ea2c4,
                    0x657c67a4f83e8878,
                    0xcf49ce2995f9ee9b,
                    0x090a9f11b0c82c34,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x19aa57819e8407ad,
                    0x0d3e6de59498009b,
                    0x5f3a0c80f34f5beb,
                    0xe6c1d81fd25a726c,
                    0xd91777d6feabd161,
                    0x077114148db7b3d0,
                ])),
                Felt::new(BigInteger384([
                    0xce3dc19e44f1919d,
                    0x37dfc89fdac45467,
                    0x49b767d577a1483a,
                    0xd1455f79d63db002,
                    0x929b89a27ba45b52,
                    0x0c884d15975e8bc4,
                ])),
                Felt::new(BigInteger384([
                    0x50abbdc50341261e,
                    0x5af31e2e475bd510,
                    0xcecf8c14b09edb1c,
                    0x02efb3867b863401,
                    0xde6ecbc5966e8239,
                    0x0ac9dfe1a06d93e0,
                ])),
                Felt::new(BigInteger384([
                    0x939a4703deb16bc8,
                    0x9d3eccc8be85c010,
                    0x99b82c7b5afd51d8,
                    0x6685c895c9bb0d94,
                    0xf1bec4e12988ff6a,
                    0x092525a2363e889d,
                ])),
                Felt::new(BigInteger384([
                    0xbf71bb68d7540a14,
                    0x7134b1bd7853e56a,
                    0xb0d652377a40c58d,
                    0x5f17e57b8b4392a2,
                    0xd9f58fe8eb0f8847,
                    0x0d2b2bf587ab39b8,
                ])),
                Felt::new(BigInteger384([
                    0x0a86c4dd6482e92f,
                    0xaf2322a538945a98,
                    0x941c8796e92e433e,
                    0x297317e16cc9dbf9,
                    0x4daf2fbe81afeda0,
                    0x086ee932b6572817,
                ])),
                Felt::new(BigInteger384([
                    0x3948922b5dd8ae0e,
                    0xedf895f1d3b337ba,
                    0x71f9bc575cd86551,
                    0xa5baf7d3a768d2ef,
                    0x6398f907ee71b89a,
                    0x1328c6f7119d78fc,
                ])),
                Felt::new(BigInteger384([
                    0x940a442c319ee178,
                    0x2325edf568072403,
                    0xa17c39b42970575d,
                    0x149beb71e07491bc,
                    0xc5d07614df054a72,
                    0x17d062e1b03866c3,
                ])),
                Felt::new(BigInteger384([
                    0xda7e192f47d680d2,
                    0xd37dd33940264f9d,
                    0xc8db4639beb47522,
                    0xaf2312cb2af161f3,
                    0x3c953d2d7906d6b7,
                    0x088bc2b891265c6a,
                ])),
                Felt::new(BigInteger384([
                    0x0f84e24e532c8bed,
                    0x927db93306f6c450,
                    0x59b1b6eec2e28bf9,
                    0xa98b7a89f7c8fd60,
                    0xf06ee0c3c942c9e9,
                    0x09ac74ca5d2574cd,
                ])),
                Felt::new(BigInteger384([
                    0xe0d2bbbf236c4d57,
                    0xcafe11c75947d81e,
                    0x8e8fe4a04fd95408,
                    0x468825e98df67a85,
                    0xfa26fe9159931ca3,
                    0x01c5022df2339967,
                ])),
                Felt::new(BigInteger384([
                    0xeb42b77f593aa09e,
                    0x5a8c5a7a0b078708,
                    0x99f9e66286963453,
                    0xac3348a8c2c94695,
                    0x709a3a6e6b3224fa,
                    0x12de6e4b0e69ce62,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8ff59b06497f9f3b,
                    0x9a06357b6f03a177,
                    0x73ec06e7249b40a1,
                    0xa115d47a0e0c60f4,
                    0xcbde7e3fcbc494a7,
                    0x0ed83f1153a8ea61,
                ])),
                Felt::new(BigInteger384([
                    0x8bf2fd3903ce5336,
                    0xd3ef106b9bbb0a13,
                    0xf17f7e5c632f2f41,
                    0x06f0147dcf689166,
                    0xfab8d69b6deb2464,
                    0x13b4466a75bf7f92,
                ])),
                Felt::new(BigInteger384([
                    0x5592407d678baa80,
                    0xfc1cc17f10ae1c70,
                    0x2760cb1f1d9b46ad,
                    0xdb60e321b1dc7fc2,
                    0xa63746733d365f56,
                    0x183a83a95533ad50,
                ])),
                Felt::new(BigInteger384([
                    0x7ce9d668a05ca502,
                    0x1f5300a1a4b3a983,
                    0x9f8f31c15e6995f5,
                    0xc53b493e1adc37c1,
                    0x30719aa285d88016,
                    0x0602103102bdec3b,
                ])),
                Felt::new(BigInteger384([
                    0x1868d35680814c30,
                    0xfe3914fd84088c31,
                    0xce7f7b2061fdf6ad,
                    0x7fe12854e6623419,
                    0x03ec77eef1b70203,
                    0x0a2e20c7a46136e2,
                ])),
                Felt::new(BigInteger384([
                    0x72e613f5b744820f,
                    0x3c3bb4b37c28dc61,
                    0x3fc86386a62c753e,
                    0x6c51f9284fb86bb3,
                    0x27ef6a583ca50f66,
                    0x03f9aa2af69be40b,
                ])),
                Felt::new(BigInteger384([
                    0xb6430a0e4dc9bfc4,
                    0xf5c2c6cf7dad5ef5,
                    0x9a9b88b4e2ed2e84,
                    0x70dfc8b68b8d77bd,
                    0x23d596a92ec4fc0c,
                    0x15812a84ae637837,
                ])),
                Felt::new(BigInteger384([
                    0x9a4ea63ce6e9d516,
                    0x5f6adad35958ac19,
                    0xe9432e26b191c602,
                    0xb7835370e51bf3f1,
                    0xe456eac36df3d8b0,
                    0x0deb3202d01678b2,
                ])),
                Felt::new(BigInteger384([
                    0x6281c23f894c0045,
                    0x1954c49d399ce7fa,
                    0x535eca288927b995,
                    0xd30cdd13d528811a,
                    0xc91e70e6845eff02,
                    0x123c27282fdf8b53,
                ])),
                Felt::new(BigInteger384([
                    0x5df5dc66a370eac8,
                    0xbb1abb8b54b89e88,
                    0x61d115ca3696777b,
                    0x05c3245e4d33653a,
                    0x1bb1cb684848f46d,
                    0x11747f4681ced956,
                ])),
                Felt::new(BigInteger384([
                    0x194e22315d162511,
                    0x0927d8dc1c097b0c,
                    0x5a7c334984daecf8,
                    0x936c5f433606b8d0,
                    0x80443f94e76d08aa,
                    0x0086583b6c5f1e3e,
                ])),
                Felt::new(BigInteger384([
                    0xadde4bfd88b206aa,
                    0x87732f3ec40f807a,
                    0xf9c887efd06a1c3e,
                    0xcd15c3cda12808f9,
                    0x04c1028599e87324,
                    0x15d9b2be8a9d1b60,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xa25b0626e0a77fbd,
                    0xa242935792970811,
                    0xc34cac92a48f0167,
                    0xb4364c1a24e93fa1,
                    0xba84ceb64e4dd452,
                    0x0ba7ed2616581c8e,
                ])),
                Felt::new(BigInteger384([
                    0x880992a6bcad34db,
                    0xcd3fa065e8be90eb,
                    0xbb11832ccade2389,
                    0x7f7614fb75d0b105,
                    0x2efc5f003e0cb44b,
                    0x06dbbc0181717f57,
                ])),
                Felt::new(BigInteger384([
                    0xd06a0628424b1082,
                    0x476d8b88ae4abd79,
                    0x72975adb8a395a1f,
                    0xe312f445432535e9,
                    0x28042d45e4351ae9,
                    0x0008243d19b052df,
                ])),
                Felt::new(BigInteger384([
                    0x38550dcc53d0f3ae,
                    0x165d68e8508f300d,
                    0x6ddc68a3bde757b2,
                    0xdb4579bd6cb7b51d,
                    0x2c66a76ea7798fe2,
                    0x1324f189fe6b3cf0,
                ])),
                Felt::new(BigInteger384([
                    0xeb74a07e8ba04071,
                    0xccfb04795dfa2af0,
                    0x5ab1f9093e1ae91e,
                    0xdda000d5dc075ca8,
                    0xec3737aca7ea3a21,
                    0x0d80457a16dda94c,
                ])),
                Felt::new(BigInteger384([
                    0xd98a0a1b5856fcf9,
                    0xe024b3cc26c2ee2f,
                    0xcbdde3d210897da3,
                    0x5b10571d0effa2ca,
                    0x5c0581fc5db9f5e0,
                    0x19689906f56c9474,
                ])),
                Felt::new(BigInteger384([
                    0x96fc88fc60c0778a,
                    0x3443d17210af93e5,
                    0xa5180ade5ca21632,
                    0x232acd9b7e94faf3,
                    0xee0af8d86c9c1ae4,
                    0x09cc015e1b288839,
                ])),
                Felt::new(BigInteger384([
                    0x64151ae389f07568,
                    0xb9470bc85f517013,
                    0x304f4d37accaafd4,
                    0x7e3216b4a921de61,
                    0x19b93b2929bae92f,
                    0x1030b91c0b3b1710,
                ])),
                Felt::new(BigInteger384([
                    0xc12dfcaea0ac4be9,
                    0xa5039d79b69d554c,
                    0xaca875e449bd2a0a,
                    0xc73777034269f31c,
                    0x4bccb451a32ff6c9,
                    0x16aa9860544625cc,
                ])),
                Felt::new(BigInteger384([
                    0x2233d169c4cf50b9,
                    0x505679ec52cf29b3,
                    0x7d6d922d54f70eae,
                    0x08034681793a6f1d,
                    0x8d358bcc4d481a11,
                    0x04a4a78275512a8e,
                ])),
                Felt::new(BigInteger384([
                    0xba67856ed4a5663c,
                    0x3e764059f5716864,
                    0xf74b438093069adc,
                    0xc454ebf680f094a2,
                    0x10f92980b572a905,
                    0x19711b9db061fe9d,
                ])),
                Felt::new(BigInteger384([
                    0x91efa432293fbf33,
                    0x693909e32bfb4c81,
                    0xda9adfea6efa7aa6,
                    0x49003ba60ba3c1d2,
                    0x536c9dc70fb558a1,
                    0x1359ee72398e5921,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8350232f28382632,
                    0xf261f6eff7069ff5,
                    0x1915dcdae489b5b6,
                    0x59801a4f71b7c992,
                    0xa1427b64ad98d61d,
                    0x02bdd9cdced926a7,
                ])),
                Felt::new(BigInteger384([
                    0x5601669f0aa2af85,
                    0xa0d9e9f7ecbb2843,
                    0x0907abc6672f38ba,
                    0xa516e7e08f892b6b,
                    0x028b414377959fee,
                    0x01a28dce4cd95f1c,
                ])),
                Felt::new(BigInteger384([
                    0x9b9e695f0090cd4d,
                    0x71624c9fa6b12596,
                    0x72779b01a0d28d28,
                    0xcbdfbb94d679e769,
                    0xdd14da18c2fa3a9d,
                    0x0e6fdc438b924b92,
                ])),
                Felt::new(BigInteger384([
                    0x91760399ab409b17,
                    0xab6dd707a5b86f8e,
                    0xf701bdc63dca1f54,
                    0xe788e25ccaf86046,
                    0xdef2913837803bca,
                    0x12199beedac3315b,
                ])),
                Felt::new(BigInteger384([
                    0xdfa11dea5ab0d192,
                    0xdf2726e092528194,
                    0xa2735619c8b68c6b,
                    0x7e1bafa48a805b7f,
                    0x02e906958a66bc7d,
                    0x04bc1066c6a3f983,
                ])),
                Felt::new(BigInteger384([
                    0xba73b7af1ef95ce6,
                    0xed9da372bcf3972f,
                    0x9caf5c4be6dbaee7,
                    0x285846bf42d75979,
                    0x937b6bcdbb1a2827,
                    0x168b2bc3ac925142,
                ])),
                Felt::new(BigInteger384([
                    0xa98bb4d84b6d219b,
                    0x1f57a40b1b3e0a6e,
                    0x755fbdcd442bcde6,
                    0x6711b914021cee11,
                    0x228e2a25f1e10ab9,
                    0x095cfa9e91aa46dd,
                ])),
                Felt::new(BigInteger384([
                    0x199bbcd392aeb598,
                    0xaef66d1fe7f4910c,
                    0xf46a762028aeca3e,
                    0x15c087b706c052b1,
                    0x77471158741f733c,
                    0x0df89596e0501730,
                ])),
                Felt::new(BigInteger384([
                    0xc3f6fe6031ecaff7,
                    0x27a6ddd4f8a177b0,
                    0xc93672204c44f1bb,
                    0xdb6bfb23e13dd50a,
                    0xdef63b951a98fe8a,
                    0x1112c588c561e96b,
                ])),
                Felt::new(BigInteger384([
                    0x0526622ea275d139,
                    0xb57d0247672f71ea,
                    0x4634a27ca0d0585e,
                    0x91ee45204ad79a49,
                    0x29a53df289198163,
                    0x01a5d76520c6b7e6,
                ])),
                Felt::new(BigInteger384([
                    0xddde4e0ef15ffcba,
                    0xaccccc8cab99401e,
                    0x7e4ed0cbd7d8a490,
                    0xb4d06ea93993bd13,
                    0xcef7a0553acb930b,
                    0x12d4863a9f770c1d,
                ])),
                Felt::new(BigInteger384([
                    0x5800395654dbe8e8,
                    0x51c9e805cff70486,
                    0xd21ebda66325977e,
                    0x09fba17fc3bf62bf,
                    0x4a3b4e33cf054498,
                    0x1418f50bcc904c99,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x808221fe77353f16,
                    0x105fd225f85cfe12,
                    0xb05fb778aa89c3b8,
                    0x6894ae3725162575,
                    0x7b942a7bf0155562,
                    0x1837aa3cbc5ce27b,
                ])),
                Felt::new(BigInteger384([
                    0xc9efdc0b3ead619c,
                    0x52a9c8591d6df19b,
                    0x6c7c831505bc956d,
                    0x2820d0f8ccb87249,
                    0x1d5f6292f4a2e071,
                    0x0cb8379160f88a92,
                ])),
                Felt::new(BigInteger384([
                    0x23f1c65e3d1c2ad7,
                    0xc7045b5cc4102844,
                    0x5faa1e79fb7fb33c,
                    0xe2f3d36172391cba,
                    0xf7b6ec16e35a6b5c,
                    0x0130a237d64aa439,
                ])),
                Felt::new(BigInteger384([
                    0xaabb457f46ceedb6,
                    0xe77d6cac3cc52293,
                    0x69a731c8a06ba5bb,
                    0xf127c7f01a105962,
                    0x37aa105de43fb8db,
                    0x0b8d77ee83a71b45,
                ])),
                Felt::new(BigInteger384([
                    0xa9ea928a59c001ae,
                    0xd47afdc5dca1fd8f,
                    0x2f6a206a045d9796,
                    0xce736992d3aa2079,
                    0x2559b2e5448fd1b2,
                    0x175b5855532f495d,
                ])),
                Felt::new(BigInteger384([
                    0x1c0d54255d180542,
                    0x2e5fde6e29aeddd7,
                    0x2b20f42b544f0624,
                    0x21e4a304c6ecb06f,
                    0x1183f9583328acdb,
                    0x078499bba76c93aa,
                ])),
                Felt::new(BigInteger384([
                    0x6bcf123fa1f0c8e7,
                    0x462b83a47dcb70ed,
                    0x94197b54085b21ea,
                    0xc27daa4f6682cb3c,
                    0xad3588b4ecb3f331,
                    0x09475bb309211bc4,
                ])),
                Felt::new(BigInteger384([
                    0x0861d252cd2f9686,
                    0x7a5725c8d4db8506,
                    0x8118241048dd525d,
                    0x0b7a805f9fe2de17,
                    0x8ccb543c93ac1d50,
                    0x027b981746af740c,
                ])),
                Felt::new(BigInteger384([
                    0x7657f65b3b711b96,
                    0xb52a280ac98a81d2,
                    0x6d102010de36f088,
                    0xd713905109c5b45f,
                    0x5f1999aa9558deb1,
                    0x16fc0956f88650ad,
                ])),
                Felt::new(BigInteger384([
                    0x5a5388a3ad87caf3,
                    0xfd1e2322cb7bab2b,
                    0x62787737599e4874,
                    0x5113b9ddaddc2a15,
                    0x893c4481eb72e96b,
                    0x1560ff8c5f203cae,
                ])),
                Felt::new(BigInteger384([
                    0x4c2e30cc64d2b3e0,
                    0x782f9e943f7dfca2,
                    0xd97b8705b52eb471,
                    0x7594d9126c762b81,
                    0x3e46721f91e680a5,
                    0x052a7f8427c34bb4,
                ])),
                Felt::new(BigInteger384([
                    0x30329ac184a92061,
                    0xdab80ca3a79bf629,
                    0x567581ad0428975d,
                    0xd1c929c85b6d703a,
                    0x5c6b71a0e7ee4672,
                    0x00e4f584afc78dba,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
