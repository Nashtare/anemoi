//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 47 == 0 {
            bytes.len() / 47
        } else {
            bytes.len() / 47 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 47-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 48];
        for chunk in bytes.chunks(47) {
            if num_hashed + i < num_elements - 1 {
                buf[..47].copy_from_slice(chunk);
            } else {
                // If we are dealing with the last chunk, it may be smaller than 47 bytes long, so
                // we need to handle it slightly differently. We also append a byte set to 1 to the
                // end of the string if needed. This pads the string in such a way that adding
                // trailing zeros results in a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 48];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 47 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn merge(digests: &[Self::Digest; 2]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        // 2*DIGEST_SIZE < RATE_SIZE so we can safely store
        // the digests into the rate registers at once
        state[0..DIGEST_SIZE].copy_from_slice(digests[0].as_elements());
        state[DIGEST_SIZE..2 * DIGEST_SIZE].copy_from_slice(digests[0].as_elements());

        // Apply internal Anemoi permutation
        apply_permutation(&mut state);

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        assert!(k % 2 == 0);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger384;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger384([
                0xf870570d84b5a8bb,
                0x768e7f420813dd2b,
                0x44a46b9190a27394,
                0xd4ddba4d7de7441f,
                0xb30595b64f7816bf,
                0x0ad6405228b39eee,
            ]))],
            vec![
                Felt::new(BigInteger384([
                    0x2fce7be6e3a7bfc0,
                    0xc91aade9c543ce1e,
                    0x484770ec27420f81,
                    0x72e022cf1555dfdf,
                    0x39443ddcec2d33cf,
                    0x09688f3db1088d0c,
                ])),
                Felt::new(BigInteger384([
                    0x8f93ebbb94107e4f,
                    0xd91efbf900d2f247,
                    0x6e818017164cf990,
                    0xc6a4d12643d4d3e4,
                    0x4e8a6ec5bc78453e,
                    0x02ab57e5a5f4daf7,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x399b51ff04675a99,
                    0x1bd71414bcd471e5,
                    0x2886e3510569b85f,
                    0x143c0a36ddd23ca0,
                    0xe06500b518c024ba,
                    0x19e31f78756e8c49,
                ])),
                Felt::new(BigInteger384([
                    0x30f2511cf4d6094c,
                    0xe650b4191e46a4e0,
                    0xa89ed9499422ff89,
                    0x1c8c2eb9eba084e4,
                    0x0faf09c9b086b855,
                    0x129ec0f18619f70d,
                ])),
                Felt::new(BigInteger384([
                    0xab096372306d41a0,
                    0x4805d304fe3533e7,
                    0xdbb90fbe13883110,
                    0xcfdd67ad68efc25a,
                    0x0139a09e7c83a7b8,
                    0x090257155ee1376b,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x970723f0ceeef830,
                    0x9895cb7a571d2e81,
                    0x34801bd076636ee2,
                    0xe4ecfb7afefaa5e7,
                    0x2fbe4318828844c3,
                    0x0f585ab96a833790,
                ])),
                Felt::new(BigInteger384([
                    0xa99bdef086f370bc,
                    0x4d9170aa93d175b1,
                    0x55d48ee32f700968,
                    0x336c28cc41553d75,
                    0xf51db9bd2f967fc4,
                    0x11750d1ea71698ab,
                ])),
                Felt::new(BigInteger384([
                    0xdae59d6b57e5e789,
                    0x674edb909e40ae7d,
                    0x6dd6620df6e371cd,
                    0x3cb30f64bf194a51,
                    0x52c93f135085200f,
                    0x0697f2044a9c2c8f,
                ])),
                Felt::new(BigInteger384([
                    0x14b5fa00c3d06d81,
                    0xbc1295754ed1abca,
                    0x6861211aa57439d9,
                    0xe9237efd399795e1,
                    0xe7fa6407d737f4aa,
                    0x06c1df6e80f50801,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x8043d79382265e30,
                    0x91b66273c7fa2396,
                    0xf6d6425a4b612704,
                    0xa3011cfb6fa2a7bf,
                    0xd7f0b0b88e6efb64,
                    0x041213784ff60b99,
                ])),
                Felt::new(BigInteger384([
                    0xec4b99b65d8ba899,
                    0x72328be33b009960,
                    0xd00f214241cd52d8,
                    0x1e26b1d1497f880b,
                    0x98a0e6eb42c3c67b,
                    0x0730e5f09949e972,
                ])),
                Felt::new(BigInteger384([
                    0xd8a89c1e99f840cc,
                    0x5a724c258795663b,
                    0xb38e75f76bd3234c,
                    0x613a7683f65a01f5,
                    0x194fa9b4bac67b0d,
                    0x1267800a661b7373,
                ])),
                Felt::new(BigInteger384([
                    0xb8265d95cbe83b28,
                    0x9410b18208161381,
                    0x46b8eea4447fc7f3,
                    0x3ec25c62545129c6,
                    0x33a65d3c6cdbf326,
                    0x17d40ce681386ed1,
                ])),
                Felt::new(BigInteger384([
                    0x5667ec3b4264afdd,
                    0xfbd261bda10b8757,
                    0x8ee1cdf2adf87c25,
                    0xcff799b66444f025,
                    0x5bea673a3f9ac0b2,
                    0x0d4042996e635de7,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x3cb19360f0ef1cb7,
                    0x6341831211a99ca9,
                    0x6c1bed4cae94743a,
                    0x8458377f915c551c,
                    0x753cea6115d6b60f,
                    0x05375adad2eb6390,
                ])),
                Felt::new(BigInteger384([
                    0x3de89320111d4ce4,
                    0x2b4d4462924e84b7,
                    0x14b8ed7b0c9230cc,
                    0x874c66529c2cd3e5,
                    0xf27e5168a2890819,
                    0x13244f42f5a84515,
                ])),
                Felt::new(BigInteger384([
                    0xd4fe491e8ceaff69,
                    0xb7707cc7c1d4cecb,
                    0x87c4b7680c3e3a0f,
                    0x5fdd61f83f303550,
                    0x6d79d63bf00da982,
                    0x0dd37622deaac0f9,
                ])),
                Felt::new(BigInteger384([
                    0x11d7e7995c6c60dc,
                    0x15e65d1702fa3ea5,
                    0xefbeec26bd33b067,
                    0x86e9fe1b3006c974,
                    0x13295c04069b5451,
                    0x190eda1c3e36b361,
                ])),
                Felt::new(BigInteger384([
                    0x3b8b54a60533faa0,
                    0x55139b6e826da903,
                    0x2c6bae396a6a98e6,
                    0x2bf843feb55a17b4,
                    0xea4c778bd9432eca,
                    0x0b0436c10033ceb8,
                ])),
                Felt::new(BigInteger384([
                    0xcdd4e2d34df28a99,
                    0xfe13b879c5b5b180,
                    0xe8d6650856bf10e2,
                    0x2d8a9e9d4743d70a,
                    0x584a20619ec52aa0,
                    0x19c74f17f9ad33a1,
                ])),
            ],
        ];

        let output_data = [
            [Felt::new(BigInteger384([
                0x598d1f80d8237a85,
                0x585c318289628a2c,
                0x6cafb29c7e107291,
                0x6cb437031e6ebdd2,
                0x6233c5e9c4e787ab,
                0x03ffab40e67cc11c,
            ]))],
            [Felt::new(BigInteger384([
                0xde4afc682a1b77d9,
                0xfc4fc7068e6f4900,
                0xef391bceb301c98e,
                0x80f8d92b219a58a4,
                0xfad1d56c245a486d,
                0x1179dda487763fe2,
            ]))],
            [Felt::new(BigInteger384([
                0x0f7467dc0ef17e01,
                0x93d4967c7ac96dae,
                0xb8c9f1b3d1048f41,
                0x2641469b88d3812e,
                0xd9184c6ccafda5cf,
                0x15fba5041858ba15,
            ]))],
            [Felt::new(BigInteger384([
                0xfff7dba77567ae49,
                0xca5df3ad05ccd46a,
                0x783d9fe2a9d3b661,
                0x89bfa6058cf09974,
                0xa993ff53d86538b6,
                0x04a30e47c4dbe0bc,
            ]))],
            [Felt::new(BigInteger384([
                0x1e997d03a34b7a90,
                0x071197f5f5934ee6,
                0x05cfda23d568cf41,
                0x10daa2e63bbec900,
                0x01fdd6656570c0df,
                0x08d458e0efeb861a,
            ]))],
            [Felt::new(BigInteger384([
                0xc8a60e2cacff80eb,
                0x1030a735024bc897,
                0xd8b5232175983778,
                0x869943d00c319974,
                0xe52810efee79da9e,
                0x183a5daad3fd37ee,
            ]))],
            [Felt::new(BigInteger384([
                0x2a98c24aadaf7538,
                0x87ed2b26ae504b79,
                0x55224145875b7c7c,
                0x7917d26270feb413,
                0x2788a955ca2c40cc,
                0x02bc42bbee1eb0c1,
            ]))],
            [Felt::new(BigInteger384([
                0x4b1acfeb838cf780,
                0x4e3645eff769a23f,
                0x0a6815d5f682383a,
                0xc81ee9f2d046854e,
                0x5a18341c91464b41,
                0x0f8e85e5c38b2e18,
            ]))],
            [Felt::new(BigInteger384([
                0x71a8f1b41f2d9323,
                0x302b610c746d3720,
                0xd3d6d2cb5b6fcc2e,
                0xd55b98eb518dd2f0,
                0xf4724f684f2aaa6d,
                0x12403f4f1e9ea0e6,
            ]))],
            [Felt::new(BigInteger384([
                0x93a62492f0595ae1,
                0xd2b601ccd178107e,
                0xa10e3100eb83d182,
                0xffc1012725941475,
                0x99341ae6a9252026,
                0x0dc8ddb0c02c5d19,
            ]))],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x6a92adff9309448f,
                    0x45e776ff625dde28,
                    0xb23158fb16d8ebe0,
                    0xb6ac90e7ac7eb95d,
                    0xdf6e613c7231c3f3,
                    0x03a3a96afe7e7f0a,
                ])),
                Felt::new(BigInteger384([
                    0xb8eceb6f3c542ade,
                    0x120403f91f411a45,
                    0x89e781cd0ee4c064,
                    0xa3401da2eb89d2cc,
                    0x675af01980b8eff5,
                    0x011499ff5ec04782,
                ])),
                Felt::new(BigInteger384([
                    0xfcc1e79798c9cf68,
                    0xc4644c3fdee6edf5,
                    0x22419b019c63277d,
                    0x18288321fcbf5a6a,
                    0xb5e7ae8e8fd25938,
                    0x04e9a6ad8dc5571c,
                ])),
                Felt::new(BigInteger384([
                    0xc9ca37747e45bf79,
                    0xa76bd09ab16e87cb,
                    0x77b474cff5bad85c,
                    0x64521473716b52c3,
                    0xcd9a431cf712af13,
                    0x18d294383d223a92,
                ])),
                Felt::new(BigInteger384([
                    0x5181743e32eebc41,
                    0x96bdd8b35ba59080,
                    0xa5d64fdc3e791e40,
                    0xe5f31027ee060b09,
                    0x5d889f2ac714c5fa,
                    0x17ae3ee3ffcc44c3,
                ])),
                Felt::new(BigInteger384([
                    0x3c71069fae791539,
                    0xb1c4eb6f4a71eedc,
                    0x1e75af82ebe8dcf0,
                    0x22b58f66ff2a40ec,
                    0x524fff730ea44e80,
                    0x16353654bd89ba1e,
                ])),
                Felt::new(BigInteger384([
                    0xb4842cd26c3bdfc7,
                    0x7de1b571cd9736e2,
                    0xa449573687bd354c,
                    0x6418a6425543eb3e,
                    0x50329613d2114b1c,
                    0x18f756c1f07e3ab7,
                ])),
                Felt::new(BigInteger384([
                    0x8900857785cf099f,
                    0xb6c5d89a04a1ee53,
                    0x9921001be75ad1e6,
                    0x16a7c65a660410eb,
                    0x9f3ff5f7dd7299ef,
                    0x07d2475e61b9268a,
                ])),
                Felt::new(BigInteger384([
                    0xfae06c1e7d8016de,
                    0x80fba503827e63fb,
                    0xe3b23b08cb35b195,
                    0x8c6e0b9277ba73d2,
                    0xc60f393e43400323,
                    0x0f57fac3f2802a69,
                ])),
                Felt::new(BigInteger384([
                    0x5c417abfca6af2e5,
                    0x64c1f95c9b8139e4,
                    0xfe47f3559faabc73,
                    0xc3517a00ebe6917f,
                    0xec92c4cf16fb4f1e,
                    0x0970075c94ba3ec3,
                ])),
                Felt::new(BigInteger384([
                    0x155a5dcfeb2d4793,
                    0xfdf1beb3b33482ec,
                    0xf25fc85ee0a7634f,
                    0x2cbb177f474785bd,
                    0xa884c9e8455e9ad3,
                    0x18bd1f2419916c96,
                ])),
                Felt::new(BigInteger384([
                    0xaeffe976e61c2c64,
                    0x192a73439d7c416e,
                    0x0bb16055d1382487,
                    0x34a11f98ac66fc3c,
                    0xf850c728356ee914,
                    0x1313461ec11290ec,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xce45c6ee63cc9dfb,
                    0xc8a5840ec419324b,
                    0xeff9da43c244b38b,
                    0x854222c703b467a1,
                    0x8820875995a4d713,
                    0x177f9e15f060b890,
                ])),
                Felt::new(BigInteger384([
                    0xcd9cc93d81f637c7,
                    0x27d913fd2f419ad6,
                    0xeef0293a5364b251,
                    0x46d8c14077d58b19,
                    0xfa26ebde175dbae5,
                    0x09c3d60ec388494a,
                ])),
                Felt::new(BigInteger384([
                    0xcf79696dd8a1cefd,
                    0xfa4b9b5a9ffbaab7,
                    0x576da6a3cbe56b0a,
                    0x9b3f3cf3124a3198,
                    0x68bf46478122a17e,
                    0x129bf3de994968f5,
                ])),
                Felt::new(BigInteger384([
                    0x5fc46ae44cb0e507,
                    0x70a43ae3878dd540,
                    0x3643093805f9ce3f,
                    0x8d9626f9524b014f,
                    0xa83cb8a2898e15b2,
                    0x0440d094e74fb2ee,
                ])),
                Felt::new(BigInteger384([
                    0x9a4de9e985fb2249,
                    0x325e50d236a4f3f0,
                    0xeaf18b4c1ae6a068,
                    0x321ce415e32eb5f3,
                    0x83466a46f0290edb,
                    0x01294e409e1bae98,
                ])),
                Felt::new(BigInteger384([
                    0xf1d6a338a424c738,
                    0x22df60448de8e5f7,
                    0x7777f6894a834e17,
                    0x90dbfa066bfd2b8e,
                    0x4dff1be8dfd784b3,
                    0x124c9dbaa94e8d53,
                ])),
                Felt::new(BigInteger384([
                    0x9da29ded3363072d,
                    0x3e122ea9f11e3047,
                    0xa2f15c0170605362,
                    0x05aa0d05381db67a,
                    0x7ca9d4dc8a04622c,
                    0x10a1a64e4593531c,
                ])),
                Felt::new(BigInteger384([
                    0xd2b83796d3a9471a,
                    0xb2fcacb931362991,
                    0x51fe5a290c79a329,
                    0xacecd0891f91cf91,
                    0x5485dbfbef180247,
                    0x0a90e8f7370dee25,
                ])),
                Felt::new(BigInteger384([
                    0x134bac590c87fe25,
                    0xae83541c13bfd8c0,
                    0x5eccadfc9e04d47f,
                    0x48ca0c4bb8fd7fbf,
                    0xd39425e4dd1d81cc,
                    0x0572d9182c0ecc7c,
                ])),
                Felt::new(BigInteger384([
                    0xb79feeec10f04698,
                    0x2ec78a6e8f340f4b,
                    0xfdafc406d32f4c91,
                    0x27402acb45a349aa,
                    0x41c5cbc64b81d0fb,
                    0x126fffc6243407e8,
                ])),
                Felt::new(BigInteger384([
                    0x8c47ab6fbdc2813a,
                    0x95cb3bf4a4150518,
                    0x07aeab095f6cc516,
                    0x862ba432d5b82d0a,
                    0x7b4206208fc9e89a,
                    0x0f92074c930c1e9c,
                ])),
                Felt::new(BigInteger384([
                    0x12c53441d9069e41,
                    0x2c426233a80a5182,
                    0x39bd9b7e80c3e77e,
                    0x9a4a856ad29a5e73,
                    0x014ff72383908205,
                    0x17a73f979cd61172,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xec0dd3b107c3b5a6,
                    0x7e2e875633eeedce,
                    0x11f7c9286bd0afb1,
                    0x8b9418bb1c663cb2,
                    0x942f590cf3a97860,
                    0x082fec0e2c0a8e31,
                ])),
                Felt::new(BigInteger384([
                    0x0bca2438de6bf7d5,
                    0xa1407016bc8b6eda,
                    0xe6b1bc13e9150a06,
                    0x1de015e8b61f778b,
                    0x0b1922ae729934b8,
                    0x10be8e925caa471f,
                ])),
                Felt::new(BigInteger384([
                    0xf8fada19c72a96dc,
                    0x06e069b731e628b7,
                    0x79bb9dfd557a540b,
                    0x5731005378b3aab8,
                    0x825f71c0723657c3,
                    0x143b3004a9447c36,
                ])),
                Felt::new(BigInteger384([
                    0x9dae7b98ba10e56d,
                    0x2b773fd1f18c47d5,
                    0xfb44613eac7db642,
                    0x20329c060c737e33,
                    0x663891b1b850ce96,
                    0x1701d5d9df84159f,
                ])),
                Felt::new(BigInteger384([
                    0x67b1bfdce39c8b57,
                    0x732f7b66b21777a1,
                    0xd4f4788c8cc54c7b,
                    0xf8634bfa46fbbe93,
                    0x4174c2d143c23372,
                    0x1767de3486280592,
                ])),
                Felt::new(BigInteger384([
                    0x7b010c86af902016,
                    0x1b53aeebcf810701,
                    0x7634867699b79a40,
                    0xa9023bbed33a7a46,
                    0xf47152b5c299594e,
                    0x0680c8865dc5cd47,
                ])),
                Felt::new(BigInteger384([
                    0x81f7b291c3f7db30,
                    0x4084fe70fb375b27,
                    0xc9ab9b6ca2abab56,
                    0x082ab0e19271cbf2,
                    0xc533bc22898c1bb1,
                    0x083f83d2a223ca91,
                ])),
                Felt::new(BigInteger384([
                    0x9deddcf5f4c2d776,
                    0x853e92e084a69042,
                    0x8952e9a1261a6ecb,
                    0x9c1e04b2f7a94c5e,
                    0x2af7364ced8c479e,
                    0x0faceb86267a724b,
                ])),
                Felt::new(BigInteger384([
                    0x8786dff0a948c82d,
                    0x1a13106fb9d075f3,
                    0x424f66c0c8f21395,
                    0xb5e27cace7e31766,
                    0x78c2f690b22ca0ae,
                    0x15ee00115cb270f4,
                ])),
                Felt::new(BigInteger384([
                    0xc32959d8d387c88e,
                    0x9ac0f1dd3b4ca63b,
                    0xf384bb571d5a32ec,
                    0x80f862ba7b09e6e3,
                    0x8e409e7a0774562c,
                    0x097280a46639a865,
                ])),
                Felt::new(BigInteger384([
                    0xad36a608fc380fca,
                    0x2cd2ecd2572faede,
                    0x67c527ecf9726bb9,
                    0xc084e228e51cf964,
                    0x534a6b9b5ff7832d,
                    0x02e3bc438edfdb47,
                ])),
                Felt::new(BigInteger384([
                    0x4dc0f3a2609909da,
                    0x22cf75c8d28d228f,
                    0xa666ca8be922e251,
                    0xaef1e0f606933b32,
                    0xb788f88632556ea1,
                    0x08d7f1cc41c517eb,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x859655c410879213,
                    0xa3e5f7269435f6e4,
                    0x91b5d51799e54099,
                    0x0c9e9c7f5d69beb9,
                    0xcf56dd372f896d37,
                    0x04d6436116c7c262,
                ])),
                Felt::new(BigInteger384([
                    0x1744341bfcc86274,
                    0x0d03f0e78dae731d,
                    0x9ad3454452adee59,
                    0x0314bc21ae05a947,
                    0xc4a25817bf102ccc,
                    0x0ce994ff817de21f,
                ])),
                Felt::new(BigInteger384([
                    0xa4e20ac90edbe85b,
                    0x1995ef5fd21821e9,
                    0x0f67a94647d2ff20,
                    0x900e5c797824fc3d,
                    0xab6d903c1452979f,
                    0x142180337087ec42,
                ])),
                Felt::new(BigInteger384([
                    0xf68f6f6f7af02949,
                    0x8245e999eb8c90cf,
                    0xdf4f9fa8d3bd5363,
                    0x05790026d7abe230,
                    0x81e4b0d6353dac90,
                    0x0206d1337d0945ff,
                ])),
                Felt::new(BigInteger384([
                    0xb8ae0b510f30f07e,
                    0x520890bbd52ffab3,
                    0xb2dad895d555dbb2,
                    0x5de91736cacb0879,
                    0xc28af0de779c1608,
                    0x10bef6d73c163333,
                ])),
                Felt::new(BigInteger384([
                    0xc5119f0ef60f3e4e,
                    0x68b2645df394d5af,
                    0x58132d47365b3df3,
                    0x4089dba2e5433d0c,
                    0x0923ded060222092,
                    0x0252b9b1bc8e9592,
                ])),
                Felt::new(BigInteger384([
                    0x2203d7f7afbb760e,
                    0x47194eefae91994d,
                    0xca3f0ac0bc29487d,
                    0x4fc7e46b4fbeea02,
                    0x7bcd9abd49ee69a7,
                    0x041ffc60079b8e5c,
                ])),
                Felt::new(BigInteger384([
                    0xa11da5766fb66b50,
                    0x3f88243e174f3297,
                    0xe04eeaedf3366e21,
                    0x11ca2f8251321387,
                    0x5af2c01c5575e0e5,
                    0x07f1281b5af89f20,
                ])),
                Felt::new(BigInteger384([
                    0x4b313c389acbf973,
                    0xc1218633ccdae501,
                    0x670d9a02d6e50874,
                    0x8af13ae3facda2f0,
                    0xcbef2dd9ca0002d1,
                    0x00a9f4724d38a654,
                ])),
                Felt::new(BigInteger384([
                    0x8a9f127d2336df8f,
                    0xfb8ce183f47533a3,
                    0x5b9598f0b73b54cf,
                    0xc7271fa9526d375d,
                    0x86af193e65f2ea5d,
                    0x0c3cf040a2ef7f29,
                ])),
                Felt::new(BigInteger384([
                    0x8803b79f9026a60e,
                    0x099c88125c7dd824,
                    0xdee177b6b6707466,
                    0xa063d71b23b88058,
                    0x101bae45f1ed195f,
                    0x0f6a97a2d0e8455c,
                ])),
                Felt::new(BigInteger384([
                    0xb79ff5200c3be5ba,
                    0x038a45d1fdadcd23,
                    0x83af3314ef4d04d0,
                    0x4b17a1da11b64ab0,
                    0x035bf70e18f1a444,
                    0x0e4588b8e30702cb,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xd17088bfee778f37,
                    0x4e654442df30f672,
                    0x8c33badc6fac5342,
                    0x4591658a89705b77,
                    0x6ac307aef87f1cc0,
                    0x0ed1fbc9368881b1,
                ])),
                Felt::new(BigInteger384([
                    0x67ef9961236f400a,
                    0xca72dfd26bb632f4,
                    0xba1fb9b243e305fc,
                    0xc652678ae7aeffe1,
                    0xc9107584cc9cbd18,
                    0x1198961ab844362c,
                ])),
                Felt::new(BigInteger384([
                    0xd52625e0f216b3b9,
                    0xfd1a1b3c65ec60a5,
                    0x1b8976132dea30fb,
                    0x9fdb7ff5f0c7efb7,
                    0x56a56a9b03d5367f,
                    0x1485ed0f0f707e9c,
                ])),
                Felt::new(BigInteger384([
                    0xc91ebf773888aae6,
                    0xc460b4d39762b923,
                    0x0b7b37f03808dd35,
                    0x594d2472bbfedc4e,
                    0x535d3e14350b7ebd,
                    0x16ebb45ff7961ce1,
                ])),
                Felt::new(BigInteger384([
                    0x6ed8abeb8884e295,
                    0xde8355f9231e048c,
                    0x98cbbcba0024cf44,
                    0x55a171dc516616c0,
                    0xe887403bb6093340,
                    0x01d224aa9472688f,
                ])),
                Felt::new(BigInteger384([
                    0x832b67933a362182,
                    0xdc464fd94196d1c7,
                    0xd0d54bd3735794ae,
                    0x3cdf39a3aaf6330a,
                    0x23a1e83e168f4e13,
                    0x033c63ab4fea2f48,
                ])),
                Felt::new(BigInteger384([
                    0xc43d44a548564d1a,
                    0x9650086977fd3642,
                    0x449f73edde63ba38,
                    0x98e4d1a42d2dac6b,
                    0x93d57f3c18ae5c48,
                    0x0c000c8889fc58ab,
                ])),
                Felt::new(BigInteger384([
                    0x5e5cd69b3b3526ac,
                    0xb6face8854e67e86,
                    0xb0b238a32996f6a0,
                    0x2515ede751d085d5,
                    0x127902a89cd8a443,
                    0x12aabfd93363c247,
                ])),
                Felt::new(BigInteger384([
                    0x87bc5bb853ebfaa3,
                    0x22f97ab81005895f,
                    0x952d2335e838618e,
                    0x9e5907940edddb47,
                    0xfc3e97d5954ea2e1,
                    0x0647731fb3dd0bac,
                ])),
                Felt::new(BigInteger384([
                    0x314b5619c7ca2ac1,
                    0x1b86df5977860ddd,
                    0xc76addac89aa2059,
                    0xa35590b4213cafbd,
                    0x852b007bd76f1c5d,
                    0x035bf11defa6b904,
                ])),
                Felt::new(BigInteger384([
                    0xcb3321da2d9c9fb4,
                    0x34ae126ac5e5ff99,
                    0xdc04d5b7bf8f6581,
                    0x8eb264c5660d5689,
                    0xcc6b33e6e996cd2b,
                    0x018554c8c7aaad36,
                ])),
                Felt::new(BigInteger384([
                    0x0937ca9d0f761e05,
                    0x2d8414ba6adde860,
                    0x5afab7f8dd703a67,
                    0x11c62ec048132b68,
                    0x5edf65c865deb7fd,
                    0x138c90657068833d,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x923f04fc50b58385,
                    0x5b658a3efefcc039,
                    0xec5d081726586120,
                    0x8e17dfd6fa42f669,
                    0x8265ffb792aeced6,
                    0x04002f1650b1f0d4,
                ])),
                Felt::new(BigInteger384([
                    0xf8ebb2cc29df8b20,
                    0xd9b870706c123b08,
                    0xf6dea102d2cadbfe,
                    0xdd59e012669dcc9c,
                    0x230dde2de21cb681,
                    0x14d3d5442c736dd7,
                ])),
                Felt::new(BigInteger384([
                    0x6d95620231290907,
                    0x6d9604760b57248f,
                    0xc1061ec8b5d259ef,
                    0xab96e1b27681a799,
                    0x3725f4b447d83d88,
                    0x0273451f96c66435,
                ])),
                Felt::new(BigInteger384([
                    0x2c7d7f435650cddf,
                    0xdd3d5ebc5a1c19fc,
                    0xed441ca7b03f68f2,
                    0x4c6e3dc8bcc63abe,
                    0x144ece36d110009a,
                    0x07580bd63947d723,
                ])),
                Felt::new(BigInteger384([
                    0x66003de26ef4689e,
                    0xc2d6abba783955be,
                    0xabffb81a8ae4453f,
                    0x2c690955e2703745,
                    0xe29debb2ad285ad2,
                    0x0093d5b44760610e,
                ])),
                Felt::new(BigInteger384([
                    0x9a4b9fd47860515b,
                    0x3b21ed33e2cef3cb,
                    0x98626400f94a0e67,
                    0x38bb26437c96eacb,
                    0x54003eb28ed3ccb6,
                    0x0ee647a40adbc29e,
                ])),
                Felt::new(BigInteger384([
                    0x8570d959a48ea2f4,
                    0xb9872057357043db,
                    0xdda29b3214483a08,
                    0xbcea8c4b04ddc506,
                    0xa95da5582b3b16ab,
                    0x18c5bfba53e499fe,
                ])),
                Felt::new(BigInteger384([
                    0x17974d026d451fb5,
                    0x00b6f39d01d81848,
                    0xbaacc122c37e8553,
                    0x416e28db0c406579,
                    0x7352dc48b58adde7,
                    0x17eb56b8477cdae6,
                ])),
                Felt::new(BigInteger384([
                    0xbf667ad39837b22d,
                    0x44ee388c2260b37e,
                    0xf8488d920614d584,
                    0xa5efb8e453abd087,
                    0x6de166078cdaad5c,
                    0x065e68b80a1eecdc,
                ])),
                Felt::new(BigInteger384([
                    0x339bd5c0b996a8dc,
                    0x35d58f5d42276a7a,
                    0x444972037a85726f,
                    0x4ada5cb2fa3e4842,
                    0x8ca946ed80dec9fb,
                    0x09ccbf713e58c7d0,
                ])),
                Felt::new(BigInteger384([
                    0x8a62ec0c4b3fd504,
                    0xcef4e98c0cf86a82,
                    0x56cb9a1a1415bc4c,
                    0x373dc5546867a50c,
                    0x5a8a554c59ec5f98,
                    0x17c2e39a712c3c7a,
                ])),
                Felt::new(BigInteger384([
                    0xb03aa22af5bdbadf,
                    0x6c71744abb46205e,
                    0x6ba19aa7a7b0e8da,
                    0x85c4fd7768a5d7da,
                    0xd66148a3fb8ccd16,
                    0x16b55c2603e90b7a,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0xed5140fe48f44ebe,
                    0x590856c78dd41353,
                    0xf669cc637158bb9a,
                    0x1f9583a33ace92ba,
                    0xdb8f4d6bd1bbe651,
                    0x0fb72aaa76a84ab3,
                ])),
                Felt::new(BigInteger384([
                    0x2aa5c1fb6d94e0ac,
                    0xad208950b128104e,
                    0x029c27f3853b5e83,
                    0x14eaea87506b494b,
                    0xfc5e668b74bdbe18,
                    0x043cc7c903d4811a,
                ])),
                Felt::new(BigInteger384([
                    0xdb4559e5fe10a3a8,
                    0xeab7745c8b4164fd,
                    0x37589ae02643b49d,
                    0x2d7d3aa1805732cd,
                    0xc300554fa095466e,
                    0x12fead722d275024,
                ])),
                Felt::new(BigInteger384([
                    0x650f788fea3f1a6e,
                    0x85ba41cdc8421d7b,
                    0xba28ecd62473558a,
                    0x67550624adb4a304,
                    0x88da0da8771633c1,
                    0x14d83e9fde568828,
                ])),
                Felt::new(BigInteger384([
                    0xc74eca951d6f7df6,
                    0xce83156ba62e447f,
                    0xe5fbc4f86a332e59,
                    0xadda747d10c4b64f,
                    0x36e4ea79042c67bc,
                    0x008890b5767d7514,
                ])),
                Felt::new(BigInteger384([
                    0x65e9f0c2c40f60d4,
                    0xa394c033744b6fc5,
                    0x9fc52c3f5e8b9e54,
                    0x2e749f92b80dbe53,
                    0x3979f27a4378fded,
                    0x06abb0ff21650b53,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xcca5cdbb39c93027,
                    0xafc8a0ef05be5266,
                    0x88d528990237f466,
                    0xd588476c25b16a18,
                    0x806ac7e261e82ca8,
                    0x05fa2575754c4386,
                ])),
                Felt::new(BigInteger384([
                    0x9476aacd4d7275f7,
                    0x48dba53282d12e9d,
                    0x36b0d39dabe12f6b,
                    0x61b74cdead558b54,
                    0xf996e66edff0d102,
                    0x08f7a79ce22f2c10,
                ])),
                Felt::new(BigInteger384([
                    0xf81b59aa287565f4,
                    0x234ab7a87fa2b889,
                    0xbc921cf7753a586d,
                    0x6617a8b22cd622f2,
                    0x4c0af9c8177d41b1,
                    0x084ac2532b9b4f2f,
                ])),
                Felt::new(BigInteger384([
                    0xfab19b9e2eb5deb0,
                    0x0aa5a1ce07ef10a5,
                    0xa1d8e5bc5e241118,
                    0xf69a666685c1e86c,
                    0x95078f000b76c659,
                    0x00ff726bb4a6ce7b,
                ])),
                Felt::new(BigInteger384([
                    0x5a54072da937cd75,
                    0x929f71d2ab325824,
                    0xc152ae0f864f4468,
                    0x8538c04175d8a51a,
                    0x607e0aa45c8df20d,
                    0x138ddcbd43a990ba,
                ])),
                Felt::new(BigInteger384([
                    0x917bce554c16b1ee,
                    0x0e47e2f273b22fe2,
                    0xfd2895d8328bb1e3,
                    0x07354bc22c736d50,
                    0xdecda800c9e9d3de,
                    0x13e5c6c2ac4d2b58,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe81231f2c2e98bdc,
                    0xb9aac2c6dea85e7d,
                    0x1c093e203e0df872,
                    0x726a5f33e9bc50e0,
                    0xdff84675f1a5dc10,
                    0x11207532233370f6,
                ])),
                Felt::new(BigInteger384([
                    0x262648682378105f,
                    0x4f7748f96b2f2a29,
                    0x74955f4ae4ee4e73,
                    0x9d747ad10a56615c,
                    0xab7609ac622cbc48,
                    0x18a9886d92f337bd,
                ])),
                Felt::new(BigInteger384([
                    0x1d6f4c8e5740cf91,
                    0x4c985e7c7faf6398,
                    0x3fde43d7baec1b27,
                    0xcf63fbf84bfb8590,
                    0x845ea166bb808ebf,
                    0x0ee08ab681783a2b,
                ])),
                Felt::new(BigInteger384([
                    0x8e2e3e2b588ea333,
                    0xbf25b8702277395c,
                    0x55f5a15f553e4689,
                    0x57f597cc8b119a11,
                    0xa5557c38fe571f29,
                    0x0e6db95abffd9763,
                ])),
                Felt::new(BigInteger384([
                    0x9b0be9795743b865,
                    0x4b8863fd2b9928a1,
                    0xfd6458c8576f0be0,
                    0xc4b9e2163594fa72,
                    0xf439c08a88fd643b,
                    0x0ce754bb6bfa5740,
                ])),
                Felt::new(BigInteger384([
                    0x6496033e3cbb7203,
                    0x7e22b7df2a767803,
                    0xe04ccaf2012c8600,
                    0xbfb332becc3f1d36,
                    0x442df24e15cc2a67,
                    0x0ab6a7df628ea418,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x6865c43f05b3f376,
                    0x5a1d89da329f0555,
                    0x52eba3f74b1460a7,
                    0x5a0cc12e8cb9123b,
                    0xf6fe7a4929ad0fff,
                    0x073926e0e7bb496b,
                ])),
                Felt::new(BigInteger384([
                    0xbfff7869543bc52b,
                    0x20e831a9ffb2c004,
                    0x81cc3ff5c8baf6d1,
                    0x10ad66aed83a8f18,
                    0xb734e0c34eef8612,
                    0x15b7c6640909469c,
                ])),
                Felt::new(BigInteger384([
                    0x162c535ee939abe6,
                    0xe8ffde31a8fc8679,
                    0x447f8508f7ef81c1,
                    0x1eab56f895853d2e,
                    0x1780d70ac0d028bb,
                    0x00ace340967f71a5,
                ])),
                Felt::new(BigInteger384([
                    0xa3a5d423374696bd,
                    0x2d5a07ce9db7b328,
                    0x5d27714e446b92a7,
                    0xfdfab52d43a7a098,
                    0x4296cb12cb2da268,
                    0x015e1f993c0daae5,
                ])),
                Felt::new(BigInteger384([
                    0x6795b4fd393567ad,
                    0x0941c6d144a93b35,
                    0x08c0ea4088090010,
                    0x4b2d568d8ce3e794,
                    0x0b3180a83ffcba25,
                    0x18d67199a2c73582,
                ])),
                Felt::new(BigInteger384([
                    0xd4c4f6823e05dbfc,
                    0x4898f0646eaa5f23,
                    0xd5ebac61d43f191b,
                    0x6e462b5105586baa,
                    0x787d0a6376ffd503,
                    0x07c7d73e1aa965f7,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xd70c281f199b15c0,
                    0xde49e0569f2071c8,
                    0x584b241ac88304cd,
                    0x921a016fedf055d8,
                    0x873bcd717d39f1df,
                    0x0d8351598702211f,
                ])),
                Felt::new(BigInteger384([
                    0x125de8b4139f274f,
                    0x12f966e7cbf78f14,
                    0x8b2e5b1d91c2e65f,
                    0x5c9f46b899c493d4,
                    0x481fe6b6c63d86d5,
                    0x0cf98b8af26de20f,
                ])),
                Felt::new(BigInteger384([
                    0x568e9eefd4402042,
                    0x969e6f8cb32b9e6f,
                    0xfcd0370e6ddd71ba,
                    0xfe68332cfce248ce,
                    0x5d385381de743ddb,
                    0x0c703de954076e14,
                ])),
                Felt::new(BigInteger384([
                    0x632fcca1d8574590,
                    0x3fbc41327524095c,
                    0xdee17d5d49c939b5,
                    0x83ece186c8135718,
                    0x014c7f977645b334,
                    0x173afe84efea31cc,
                ])),
                Felt::new(BigInteger384([
                    0xca58f460f53a1253,
                    0x4e5d82f86b796f19,
                    0xb4d32fdb7c083995,
                    0xf8f60240af1a9882,
                    0x3ee3b93adfc55b26,
                    0x11fa75458c25221d,
                ])),
                Felt::new(BigInteger384([
                    0x96cdbfee0667aba5,
                    0x45b44fb0565efb80,
                    0xbd2cebb56d23a04f,
                    0x41ff0b2409e3ec94,
                    0xec7924340faa7160,
                    0x11d136a354f969d4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1c1ecf4050f7300f,
                    0xf8836b8a0e76ec16,
                    0xdc4927dd082dc65e,
                    0x8667e8cd0a2a20be,
                    0xfc38a5df5d4f1d0b,
                    0x046e2a764974955f,
                ])),
                Felt::new(BigInteger384([
                    0xe7277885a51cf5d7,
                    0xab7a1f857db15102,
                    0x9958c7cc9ba1a944,
                    0x7cbcdf54592f24fa,
                    0x6beb5a9bd2673aec,
                    0x054a50fff5546b98,
                ])),
                Felt::new(BigInteger384([
                    0xf2d153ce6f47752b,
                    0x3703af78c7af34c3,
                    0xa30fb0f974a12316,
                    0x38456e8e3b610543,
                    0x70e4229b104a0e71,
                    0x075d6e739c61c784,
                ])),
                Felt::new(BigInteger384([
                    0xe794e57d48c063cf,
                    0xa79e8a8302ad676f,
                    0xd8a661746bea9803,
                    0x6ed7a732f2c93a9f,
                    0x6cb0952c479e70e3,
                    0x114bf2353105fca5,
                ])),
                Felt::new(BigInteger384([
                    0xf03a5ed08eb6920b,
                    0x2c92c36dc5584288,
                    0x43609fdd7561f622,
                    0x5e9819a0fe1374c4,
                    0x0a7ff03e26bf6413,
                    0x043f9256c53707cf,
                ])),
                Felt::new(BigInteger384([
                    0x1420aadcdb67bda6,
                    0xfbd39bc0eb3850e2,
                    0x03b8558d8d130f9f,
                    0xe7bb20c681cd8ffd,
                    0x22f5ed55ddfc293a,
                    0x0bd457954f58acd5,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf9ecb31c0094c5a4,
                    0x866213faa8689cd5,
                    0xc3cfb8bcf785d0ed,
                    0xe244729fd793e5b3,
                    0x453715188adff785,
                    0x01f43da9e95a1714,
                ])),
                Felt::new(BigInteger384([
                    0xd7d0520f7efb8e49,
                    0x81d24d33eb26fb6a,
                    0xd5c85213ec2c18a9,
                    0x6d75986a482c648a,
                    0x5a92d22549d38477,
                    0x199b859912cfbd6b,
                ])),
                Felt::new(BigInteger384([
                    0xcb5cc5ddb08221ca,
                    0x8d945a25d133c80b,
                    0xd026c4787f528b76,
                    0xe5b98c832212181e,
                    0x7597928feaf380bf,
                    0x00c59e8d43c4512c,
                ])),
                Felt::new(BigInteger384([
                    0xefcd65681163d067,
                    0xe897fc073dedb2a5,
                    0xb3b471ce307ebe18,
                    0x34307458c8117663,
                    0x3180d34db78c1099,
                    0x0f1def20b21e9fde,
                ])),
                Felt::new(BigInteger384([
                    0xafb46dbcd9eabfd4,
                    0xab8204ee60a86822,
                    0x0b97010af2c5d8f4,
                    0x798a079d2dfd2029,
                    0x6444fa6fa4ce432a,
                    0x15cd6c69f97d6725,
                ])),
                Felt::new(BigInteger384([
                    0x1d946d4f8a7577a2,
                    0x53b2cd95aa0d3efa,
                    0xd2acf27b44db670a,
                    0x841d7423d9e97ac0,
                    0x1d1f34ad719579d9,
                    0x0114964674d1e8c0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x197fd5dc4f7f9a87,
                    0x10a3975d88056926,
                    0x0b9c891e3aba020e,
                    0x95bbb717ffc1008b,
                    0xaabb77c104be8aba,
                    0x16d47f0e611e0618,
                ])),
                Felt::new(BigInteger384([
                    0x855fb317c9f31812,
                    0x9672bc9e84637c3b,
                    0x2e17ffe4145c3e5c,
                    0xcc6c06cdfb2ec4e4,
                    0xcecbf54545d49a0e,
                    0x04655c1157126a67,
                ])),
                Felt::new(BigInteger384([
                    0x9088a00a06f42f82,
                    0x793413522052635e,
                    0x011d96546c854f59,
                    0x7a317b6c0f16d929,
                    0x728f7de54095f40c,
                    0x0417d6add41f0a86,
                ])),
                Felt::new(BigInteger384([
                    0x2a141683a415ecca,
                    0x94da0b429e51d41b,
                    0x62c14e6c3ae50902,
                    0x5c7b463847ba5459,
                    0x12d66f0a17458a25,
                    0x11be1d99bbed9622,
                ])),
                Felt::new(BigInteger384([
                    0x950338a82f3c2c8f,
                    0x243e78129a16ee18,
                    0xcedae175f272bfe7,
                    0xd350ddc6bda71ec7,
                    0x176ae1b2b69df6dd,
                    0x0e982c2603962940,
                ])),
                Felt::new(BigInteger384([
                    0x6eab629c916f62a4,
                    0x49a4f37653097c34,
                    0x39abef67735ff4b9,
                    0xf91bc850d637936a,
                    0x873b4ee6e9e40e8b,
                    0x0b901f781d74aca9,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x084be93255233f14,
                    0x9e27437475c1356f,
                    0x5e5c5617989d26eb,
                    0x1fd4800859f723d7,
                    0x21e931d8f435a5da,
                    0x147528e274f253d8,
                ])),
                Felt::new(BigInteger384([
                    0xdf63b7775610b4be,
                    0x056eb0b543029c1f,
                    0xccac8def2b47259d,
                    0x2c5118d0c6d37ebf,
                    0xdec5aba8f93a7d1f,
                    0x0bee4782ac79adda,
                ])),
                Felt::new(BigInteger384([
                    0xec7e36fddfe09e42,
                    0x8617a7ac37436cb6,
                    0x90998d7a06019483,
                    0x7ae10df2d47f1981,
                    0x1ad8171655a0c40b,
                    0x056911f6663af86f,
                ])),
                Felt::new(BigInteger384([
                    0x3ae43f2d2296a600,
                    0x5eac34b90867bfe8,
                    0xf4b6ab5d238b0edd,
                    0x7b66c36fe4e55d0a,
                    0xecfe120a08d90d03,
                    0x0d14edf79e877dcc,
                ])),
                Felt::new(BigInteger384([
                    0xbc469cf711c0229e,
                    0x402cf381c72af0f7,
                    0xc9aae4fc61dae506,
                    0x069da39d876722b9,
                    0x31bc46c20afbc4c8,
                    0x1338d342d78453ba,
                ])),
                Felt::new(BigInteger384([
                    0xdfbd79abe375aaf7,
                    0x24d31ffca1f90ca9,
                    0x769d9067fb97a3e5,
                    0x312269bbf19568de,
                    0xa987d4113b73b937,
                    0x11aa463fceab1861,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xa9d6cf1fd3ffa65b,
                    0xddc56f31bca9c119,
                    0xb9c638f490c1ead9,
                    0x88e3677c1b1d1dc0,
                    0x7c87d9b894e29e43,
                    0x08e010fb8cb95aca,
                ])),
                Felt::new(BigInteger384([
                    0x53d1b0b10408129b,
                    0xd710964ee6f51702,
                    0x969cbea79818b58d,
                    0x9c9285a929670bdf,
                    0x8c26a76bca031448,
                    0x16841a54a9416a99,
                ])),
                Felt::new(BigInteger384([
                    0xc4adfa43db861dc2,
                    0x0815745dcff959e1,
                    0xf546a296136fe4bf,
                    0x7799a2b5b960fb56,
                    0x93a61e8b9bc4f6b3,
                    0x1789397812919a57,
                ])),
                Felt::new(BigInteger384([
                    0x48051a7c12a68039,
                    0x9dae8cc49dc811bd,
                    0x714fb169119d8c57,
                    0x18ebc9fda2ff593a,
                    0x4a4884add73336b5,
                    0x0dbfa6b5e2112dbc,
                ])),
                Felt::new(BigInteger384([
                    0x13d3ae1745109e2c,
                    0x800fd35a3a1df539,
                    0xf31613f5958abc14,
                    0x04f7c8a2e5b514a4,
                    0x43d855938f353aaf,
                    0x07c779f60104b3f4,
                ])),
                Felt::new(BigInteger384([
                    0xb5b2284258a82202,
                    0xf74d9be252d17f92,
                    0x1f2e4e073fb10bbf,
                    0x0e11dcc905e76205,
                    0x8cfaebf44fff3603,
                    0x18ce7558b9360f80,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x288ce2b9fd0c8d6a,
                    0x30770ba569fde463,
                    0x9fc6f0804d6b0d5a,
                    0x478329e5b0954748,
                    0x7cd84b7792ddb17c,
                    0x03dbf5339b312e71,
                ])),
                Felt::new(BigInteger384([
                    0xd1b0f7a39a97ec49,
                    0xc9a302eb1fb4408b,
                    0x362e64f303d37cb7,
                    0x962bd988b7f55cc9,
                    0x112016d84736b874,
                    0x153fb686e0d08d27,
                ])),
                Felt::new(BigInteger384([
                    0xb9582dee970c2603,
                    0x5d53bf2686e41052,
                    0x0563070d5e66185b,
                    0x59f32d11afe7d16d,
                    0x8ccf777c317709cd,
                    0x094d43685c768f1a,
                ])),
                Felt::new(BigInteger384([
                    0x9c6ca603eb1c9e30,
                    0x8c345044247191c1,
                    0x5790e79297690239,
                    0x955dae1140397ace,
                    0x488492adef38e637,
                    0x028297438d39b569,
                ])),
                Felt::new(BigInteger384([
                    0xa677130edd6968da,
                    0x0b6d9acbeacf5485,
                    0x5b9843369bc7308f,
                    0x5dc724c361df5bd8,
                    0x2d2b1a5b49d3658f,
                    0x101db50e133f4b46,
                ])),
                Felt::new(BigInteger384([
                    0xdec14b1a8583babd,
                    0x8b3eed2bdb863e5c,
                    0x0c08751197248377,
                    0xe142107ebec417d7,
                    0xa02fafec4f0295f0,
                    0x00aa425fa4db02c7,
                ])),
                Felt::new(BigInteger384([
                    0x913883f92be91570,
                    0x650f14e95ffc8de9,
                    0xaddb4be10dc6a888,
                    0x14c05a46af817bb9,
                    0x5187a2cfb58c77bf,
                    0x1649967588ec9cd5,
                ])),
                Felt::new(BigInteger384([
                    0xb08e697f4db04d13,
                    0xa8aaba1808755756,
                    0x875f210d32183e2b,
                    0x003fdf54be40d666,
                    0xfb33ad913c4f2f6b,
                    0x00333b23ad7c2d4c,
                ])),
                Felt::new(BigInteger384([
                    0x192326b22ed3a918,
                    0xc3e52f39643289a6,
                    0x83c7081a19d65812,
                    0x79a47ffa2a54494f,
                    0x4c8795e958cc4371,
                    0x12129931a04a1c4a,
                ])),
                Felt::new(BigInteger384([
                    0x0234e9bca9c9fc70,
                    0xfa91aeef8fb70117,
                    0xdf85579a11f12d29,
                    0xfa3f999d954ab870,
                    0xd12d690aeaf514ab,
                    0x1723636c28379abc,
                ])),
                Felt::new(BigInteger384([
                    0x347440e6b2cce7c4,
                    0xc867f9e3c67cbced,
                    0x52f65aae78c064f2,
                    0x6003feff61b6e6b2,
                    0x2c60030e617ddc0c,
                    0x0f9bb420b3b1a757,
                ])),
                Felt::new(BigInteger384([
                    0x2086866004b21111,
                    0x2554899c70b1f434,
                    0xd19e72f1323f4910,
                    0xd8663672f8d62236,
                    0xfcf5a4b494949bfc,
                    0x06b682b243056cd5,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x024978ec4de6f328,
                    0x5481ef3ed46bb7c2,
                    0x0c1e8f9930f5dd25,
                    0x590e3c747b76a27b,
                    0xa5909364f23f8143,
                    0x01addc7d78afddbd,
                ])),
                Felt::new(BigInteger384([
                    0xb2c1fb07cc8e489d,
                    0x15380269268a39c9,
                    0x92f5bcddf1ba6bfd,
                    0x29f8b64d71384978,
                    0x5f2afc7d8757bd27,
                    0x13bc668298fdada1,
                ])),
                Felt::new(BigInteger384([
                    0x859640b55717476f,
                    0xf9db478d38eb5f59,
                    0xe1b7d46dd5bbb92f,
                    0xb26c6b3381bf0cbd,
                    0x09f438bb7b2d9a1c,
                    0x1850ead64791ff39,
                ])),
                Felt::new(BigInteger384([
                    0xaa8d504ebdacc9b6,
                    0x0bb3420f230ff302,
                    0xdd67d52ed8f31b81,
                    0xd359719e6a8e9a1f,
                    0x1191dc81a9910e1b,
                    0x04a08342a9d322b2,
                ])),
                Felt::new(BigInteger384([
                    0xe8733beca8c3d8eb,
                    0x12e12bff99e27955,
                    0x7d30411a4a2bf99c,
                    0x106dd6b116296ad8,
                    0xcc4f4f787e4e33b4,
                    0x13d97d4ad8aa501a,
                ])),
                Felt::new(BigInteger384([
                    0xa2d376effecece26,
                    0xb279047016c2c285,
                    0xf442ab6f767c47dd,
                    0xd6badfa9c7d633e2,
                    0x10837c8833febed2,
                    0x02aad65be70bbb3f,
                ])),
                Felt::new(BigInteger384([
                    0x2f0bd051b087bd84,
                    0x44e1c781c576de0b,
                    0x9104a215500b4f42,
                    0xb7fdd37cb18af70b,
                    0xdb834b1fa3fb05f2,
                    0x0b6ce383182cf627,
                ])),
                Felt::new(BigInteger384([
                    0x6a16e85af6fa4aa6,
                    0x53bafcfe0f556048,
                    0x3c16a2a7725f1d36,
                    0xa0b6a4c04a3c52c0,
                    0x5735cc2ef10425bc,
                    0x176209fd552fd317,
                ])),
                Felt::new(BigInteger384([
                    0x0d270f506a672710,
                    0xef73699e1a7645e4,
                    0x5c55f3153a6decc0,
                    0xe1f83922b6d112be,
                    0x3d70969cbddce6a0,
                    0x0439ff2e31973b78,
                ])),
                Felt::new(BigInteger384([
                    0xdd91b8443aea2936,
                    0x40c8e20520051355,
                    0x2323c907482f6cae,
                    0x7409cd9eb1bb4b23,
                    0x6779d305706723d1,
                    0x04526249ab18b848,
                ])),
                Felt::new(BigInteger384([
                    0x48ccf225ffdc6185,
                    0xadc212d86fbff43c,
                    0xcb3944100be3e3c1,
                    0x433da30bb142150f,
                    0x2fe133905bc04010,
                    0x084afe604ec8e256,
                ])),
                Felt::new(BigInteger384([
                    0x184768fde60dc25f,
                    0xadc027ae7a40e083,
                    0xf214b25ddf858d85,
                    0xc35be8e53dfd62da,
                    0xc89f18206e6a34d2,
                    0x06e7b4a51dd89fb8,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x19e41e99b813153e,
                    0x9864ff26d78d316c,
                    0x274677dc74753d63,
                    0x68f98cf843440b86,
                    0x9dfc4aa8494719c8,
                    0x0afe8a2544c7bea2,
                ])),
                Felt::new(BigInteger384([
                    0x478efbd30d99e152,
                    0xf2bcfbec1c32e91d,
                    0x24feb995774946e1,
                    0x9d19b0df9de70d1e,
                    0x0179c0e2798575d7,
                    0x11eff25742ed01ba,
                ])),
                Felt::new(BigInteger384([
                    0x5a1162db419e196e,
                    0xbafe6bbb42c951ec,
                    0x68b63cb46c075de3,
                    0x6938c0cf9d6f1b87,
                    0x08181db34d519cca,
                    0x04f661e1e4883c6f,
                ])),
                Felt::new(BigInteger384([
                    0xa513438e1e13256e,
                    0x87e4c42e664fb3e0,
                    0xab1c1d221085c153,
                    0x2c33c7c2cf583ff4,
                    0x3313b6368fa24b62,
                    0x0af159d6b10846f5,
                ])),
                Felt::new(BigInteger384([
                    0x7fd5f8c5021d5e92,
                    0x9a8b3cec7a236391,
                    0x6dd2a2a87e824247,
                    0x142ebd60b980e87e,
                    0x4b3797e6dbbb4740,
                    0x005973fdfda07fae,
                ])),
                Felt::new(BigInteger384([
                    0xf759593e8dc6fe8e,
                    0x03e8325c66c1560d,
                    0x9045d8718a573150,
                    0x6e95f0570e5cc7a3,
                    0x5534430835e5e9dc,
                    0x0a32047fd76bcbb4,
                ])),
                Felt::new(BigInteger384([
                    0xdc0e391de6467b7c,
                    0xb3f07d3987de94e0,
                    0xfbac913b87a71be7,
                    0xd559cd87455e1fb8,
                    0xfcf91e3acb3c08de,
                    0x19d545ab7cc7c0c0,
                ])),
                Felt::new(BigInteger384([
                    0x82bb2f50dfcfd389,
                    0x2882fcefb8009a41,
                    0xa723f1537809cb0e,
                    0x735214c72b366ace,
                    0xfa355edcbfb1fe7b,
                    0x175c2e357b29a6f0,
                ])),
                Felt::new(BigInteger384([
                    0x2ffeb5397f396466,
                    0x56e4a612d8bafd8e,
                    0xff7c13fb109e5367,
                    0x67be8ea9e847be27,
                    0x9a3106d9e3b469ef,
                    0x1265ef009f7fe115,
                ])),
                Felt::new(BigInteger384([
                    0x928ea21ecc63c2a5,
                    0x351f2a90fc316de6,
                    0xcab6b66db308f744,
                    0x643e48fd0ee28b34,
                    0xd988910d07326714,
                    0x07683eb53a210aae,
                ])),
                Felt::new(BigInteger384([
                    0x6e9ebb4186e79e6e,
                    0x4df013a118d38b05,
                    0x7559d3d3337119d4,
                    0x8c3a333357537755,
                    0x50a9bea6ea78df55,
                    0x00d614b61b43c371,
                ])),
                Felt::new(BigInteger384([
                    0xf0298d00e9f010b5,
                    0xd5e4f1b5c74a5ce8,
                    0xe093af5a4a0b8a5a,
                    0x4265459571d519b5,
                    0xfed9a7a94276d8ea,
                    0x12d125e51e5ed433,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x0a6defc91045b20e,
                    0x951313c117dc151e,
                    0x654fa39b1d3e82f2,
                    0x5f922d0a76843dd3,
                    0x20e75e04138a88ac,
                    0x02a0bc825af85ec5,
                ])),
                Felt::new(BigInteger384([
                    0x11da14cc9b6f47e3,
                    0xf0dc1497515ce1f2,
                    0x2bd8a9c94b3f2aaf,
                    0xc0c5ef47da1e31a4,
                    0xf8bc0ae2f28916f6,
                    0x0330b613f4f5862e,
                ])),
                Felt::new(BigInteger384([
                    0xa7b8ed8afa440475,
                    0x56b61dd56ab621a5,
                    0x7573c3c05a341acc,
                    0xde69d819bf9a3516,
                    0x5237dcf9721c3eb2,
                    0x0cc570a965e73f2e,
                ])),
                Felt::new(BigInteger384([
                    0xa44aaf9b56b8ffb9,
                    0x093a57bdeeda9d31,
                    0xcac46bfed5eecbbd,
                    0x791b8a021c72763d,
                    0x110f7b5d63046c3f,
                    0x16a6ae23eef894c6,
                ])),
                Felt::new(BigInteger384([
                    0x57cb31ac05698d6d,
                    0xbc98bcf0642604f8,
                    0x703f988b7eaf7c20,
                    0x9eb749b0cc03e969,
                    0x2270fcd783c9a94c,
                    0x12312d146599993f,
                ])),
                Felt::new(BigInteger384([
                    0xb826dad10d8fc800,
                    0x65e213eadfd920e2,
                    0xfa6ae2ac8f319160,
                    0x02336f06f1520c13,
                    0x0e14832df67e3751,
                    0x06622531066632bb,
                ])),
                Felt::new(BigInteger384([
                    0xea38f7a19ad4c72b,
                    0x413f046ac880403f,
                    0x7ce4cb2b3b5b407c,
                    0xde96de3c880f2e7f,
                    0xe1d59019ae2706c4,
                    0x0f4b91aa2efbff9a,
                ])),
                Felt::new(BigInteger384([
                    0xcee80c34d23027c3,
                    0xc108e474bdefe3ca,
                    0x1816d18e64cfb605,
                    0x4474388b24c4c249,
                    0x430ba17f663e7a46,
                    0x0493a59b1319fce3,
                ])),
                Felt::new(BigInteger384([
                    0xf1fc283b8f44eeaa,
                    0x6a445bf793b5b627,
                    0xb0cd8c663ea9094f,
                    0x04faa4ba18b4ba70,
                    0xf426f773a16dfabf,
                    0x0ca794c41815557f,
                ])),
                Felt::new(BigInteger384([
                    0x4cd0921cc91023fb,
                    0xfe85c3452df2c122,
                    0x6268d23423a2079c,
                    0xfa80ff978b050806,
                    0xb978659c57f4c23d,
                    0x0ee50e0586f40ea5,
                ])),
                Felt::new(BigInteger384([
                    0x1000eb4e88890b5f,
                    0xb2318a9164915e3d,
                    0xcc69ea11d9ac3ba2,
                    0x3f38c0b5a13b7006,
                    0x973a49243494f86e,
                    0x100941cdb907b13c,
                ])),
                Felt::new(BigInteger384([
                    0x2b562449692d3e4d,
                    0x26c816c1e11f5c08,
                    0xa0cb98582faa7429,
                    0xe89504c0d846dd4e,
                    0x6b9add234c71f76d,
                    0x1108ed3e9ac9f50b,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x54e2f112f877c84f,
                    0xff8c57e5ece3c93f,
                    0x831794b651245c38,
                    0x197960999a9f153a,
                    0x63241c8305a03b8b,
                    0x19632dd1b3e75f95,
                ])),
                Felt::new(BigInteger384([
                    0xf6a8bc9f06b55826,
                    0x135e89c2e6bbc510,
                    0x6fa33be7847002d2,
                    0xbbb3525cb81a67a1,
                    0xb773b101c1418f6d,
                    0x139d009c4f9f2abf,
                ])),
                Felt::new(BigInteger384([
                    0x801f5483fef64fb3,
                    0xad8aeb4531243fae,
                    0xc34a58c63dc54460,
                    0xfce9ebd710dd2b8a,
                    0x33c9e7c727ab42fb,
                    0x080e7c000654d21a,
                ])),
                Felt::new(BigInteger384([
                    0x3a68f7469c89a7ef,
                    0xdaff5070baef8765,
                    0x2df7381f1dec233c,
                    0x9d85378fcb851573,
                    0x4bf85c3dc58cbba0,
                    0x0209930c56f66e1f,
                ])),
                Felt::new(BigInteger384([
                    0xea061ca2fb261d6f,
                    0xce42beb484f88f16,
                    0xa077d7adf40e8b83,
                    0x39e65b4720a3349d,
                    0x01f207debfa895f2,
                    0x0e58cc021d5987d8,
                ])),
                Felt::new(BigInteger384([
                    0xb0d13b1180b353b4,
                    0x1126e1ceed90b203,
                    0xd6573325bc47bcbd,
                    0x0f98202a29397855,
                    0x4a3c2f412059edb5,
                    0x112f80b199da54e8,
                ])),
                Felt::new(BigInteger384([
                    0x2645832b1f95779f,
                    0x544e44cc3fe89ce5,
                    0x67d31d5374eb4dce,
                    0x70936c8754676a43,
                    0xe47b8b745ce061b7,
                    0x0bb45ebf1ba93be5,
                ])),
                Felt::new(BigInteger384([
                    0x43d8f544374e2f7d,
                    0xd59e30f8ada68030,
                    0xb0320439b5eab587,
                    0xf0f56a440e2d8646,
                    0xc88a5d8d475c281f,
                    0x0d17df9445368f27,
                ])),
                Felt::new(BigInteger384([
                    0x3d5e047b225cc55b,
                    0x6955bdbf3eb03ddc,
                    0x0a9a62a0a7332652,
                    0xb78381b53c8b8f98,
                    0x9cdba08aa8da9d9e,
                    0x0a71c1e975e137c2,
                ])),
                Felt::new(BigInteger384([
                    0x3f78a24835abdab1,
                    0xe7a48589960f6c93,
                    0xd11767221b1c4f2f,
                    0x946fb7604a7e8a2f,
                    0xb1416eaaacd8a1de,
                    0x0d54f69cdfd3e383,
                ])),
                Felt::new(BigInteger384([
                    0x566122b9db686a0c,
                    0xe88d4bc08071ec80,
                    0xd40eed6278610209,
                    0x7f3db98eddcc4232,
                    0xa7a6f73be08d5ade,
                    0x018c880967f45fe0,
                ])),
                Felt::new(BigInteger384([
                    0x96c1961aaeb8e8fb,
                    0x4814d24dd25c2cdd,
                    0x089207b5468e884d,
                    0x2119ad34e149d4ed,
                    0x38293507c848685b,
                    0x02d423944bc66bcf,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xd909f956ce82ecdc,
                    0x99734dfbfc9e49c2,
                    0xfeba3fd89b59aefb,
                    0x7d51031343adab19,
                    0x92ca30a2e2d046db,
                    0x07d9ed1ff81c08a8,
                ])),
                Felt::new(BigInteger384([
                    0x2132e71344776d02,
                    0x060793c44eb8eea0,
                    0x65a86a6319c3b977,
                    0x666b8f6ffb06f36d,
                    0x4ecd5a453439f121,
                    0x1286f576335296d6,
                ])),
                Felt::new(BigInteger384([
                    0x3d9bd24f826a3978,
                    0x836fab6470574276,
                    0x46aeb5ebd9b2b318,
                    0x9a89cbca023de375,
                    0xe9b1e0fc79403502,
                    0x0546a10ff251d888,
                ])),
                Felt::new(BigInteger384([
                    0xab38249c4d2e2d7f,
                    0x197ae6d418453880,
                    0xc14f0b8d0c845249,
                    0xff460bfcfeb829d9,
                    0x59dce5297d4c3087,
                    0x0371436cbb8fa03d,
                ])),
                Felt::new(BigInteger384([
                    0x07e031741f42f030,
                    0x33261c19cc75ca1a,
                    0x37e15ae3219c7be3,
                    0xaf88257e53d68526,
                    0x25ce047355e2d732,
                    0x0a426dc7f11076be,
                ])),
                Felt::new(BigInteger384([
                    0x795fd1eb5a808d7a,
                    0xe25f55af3b3e6469,
                    0x747b549a3883037d,
                    0x88e8393803d5226a,
                    0x36476f77b3546dc4,
                    0x05b2c9687facc2fb,
                ])),
                Felt::new(BigInteger384([
                    0xac78fecf87807db1,
                    0x232053a3755ef8c1,
                    0x4455df7f0e607365,
                    0x1ec4c5425a8f7724,
                    0x94ff5ca17c3b56b0,
                    0x13635970e2f805d3,
                ])),
                Felt::new(BigInteger384([
                    0x2b84b0c147195da7,
                    0x94b021aaf610c2c9,
                    0x691894a0a713a6e5,
                    0xc7cdf40599e90fd9,
                    0xd555e5c5cf7a00fd,
                    0x17f55c938ac2f0b7,
                ])),
                Felt::new(BigInteger384([
                    0x535baa6b9f49da6c,
                    0xd80e25d87fcc5f1a,
                    0xc658e006b4fc85d4,
                    0x2fa50143f3d842d1,
                    0xdd60157ba3d3c7ac,
                    0x0c23354fea6dcd45,
                ])),
                Felt::new(BigInteger384([
                    0x7e9a4a0b50cd6aaa,
                    0x0901ca8ecd6231c6,
                    0xb62972f5b5301209,
                    0xf96ec341d795b94e,
                    0x4e036ed3e6bf6cb5,
                    0x10364ec6369327f7,
                ])),
                Felt::new(BigInteger384([
                    0x08eb8fd143034432,
                    0xb4580af1256029ca,
                    0x1e4f5fc66268b3b0,
                    0x2def7b50a6875167,
                    0x0d228ca155cea331,
                    0x0637b39ecdea3076,
                ])),
                Felt::new(BigInteger384([
                    0x7bce7247c714484b,
                    0xe88ee359b6ea352f,
                    0x1d0c97eef4649510,
                    0x03aa9bd29bb030b5,
                    0xf5c5de562d620dae,
                    0x0b02412d4f06ffb1,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0xd5e665796474c5b1,
                    0xf396e0910defbcd1,
                    0xac8d599b0b1ea86d,
                    0x9675e73cd8656918,
                    0x8a58e57e3331e7a4,
                    0x093d56e7e0cd2952,
                ])),
                Felt::new(BigInteger384([
                    0x3ba02b4e1be3b143,
                    0xb7c38b533c619d8f,
                    0xf5596e6811895c3e,
                    0x463d44b9c2a897e3,
                    0x7396bef7ec0142ef,
                    0x05bfa57dca102dfc,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x65162e930b76b8e5,
                    0x4706ca6b7f3f6315,
                    0x9f8920ff07109b18,
                    0x5c6164dad4db1f66,
                    0xe1d8249892a7b390,
                    0x07d1b29bab113cd5,
                ])),
                Felt::new(BigInteger384([
                    0x66a514c0c83f5bea,
                    0x431d29f44d1e6f26,
                    0x6e817c9145dffc42,
                    0xfb0fb3826c05ce52,
                    0x225075b97205be62,
                    0x03dbcee109a33f4b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe68e67fa716e6927,
                    0x331f8541d89ceab7,
                    0xf21b081f59b82956,
                    0xa210f1bd77c7be23,
                    0x0d7500b0f2d82234,
                    0x12e742b9d7261bc9,
                ])),
                Felt::new(BigInteger384([
                    0x5eeb89d1b8c27aea,
                    0x6e13b94a06c8db89,
                    0x43a6f8fb44a824d9,
                    0x50a5f9d76e2205e5,
                    0x49ddd07d33045902,
                    0x17ccd7bd7bff8c9f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2c28cc9b28235c5e,
                    0x2db32ede6ef0c704,
                    0x38fb409fd45bec55,
                    0x5f6e232fbb9d243e,
                    0xce952a45e72e4608,
                    0x06bb69d0e78209f8,
                ])),
                Felt::new(BigInteger384([
                    0x7e6b430ec9888d39,
                    0x782f29de5ac0d251,
                    0x4dae8b04eab4ac6f,
                    0x1876fba82db5889c,
                    0x272d0e834dd150a7,
                    0x04dcab51264070df,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x09ea075213b20088,
                    0x17bc7fb43d22e3bf,
                    0x0ac374e6b96d52eb,
                    0xd94586b1a24815a7,
                    0x2825b4ccf215bc30,
                    0x16dec472483b07d4,
                ])),
                Felt::new(BigInteger384([
                    0xbaa8d39d96def525,
                    0xf42206084a771c7c,
                    0x309a916dc0de78ab,
                    0x3a85d404911b5bbe,
                    0x00dc2eec77979293,
                    0x04a66d8c7d6e513c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x12de44e6271207c9,
                    0x57b1d3fd1b9057bc,
                    0x9d93de3d71485c53,
                    0x6eb7e3395a298588,
                    0x513cefb94b1e2136,
                    0x16642304f5280733,
                ])),
                Felt::new(BigInteger384([
                    0x50fc96289882991a,
                    0x1fd68ac0ff7fc6bc,
                    0xc762aef1ba8ecd4b,
                    0xb4c85b91f82ae623,
                    0xbb854d10a47ba06d,
                    0x15f44dd9d3a14c90,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x24e99c2f4f49400d,
                    0xcc64133a2c98df75,
                    0xd92e03c8c885c1e5,
                    0x80a521fdde363436,
                    0x4e0b212063db76b8,
                    0x162b3cd33290c902,
                ])),
                Felt::new(BigInteger384([
                    0xf72807e4347c5321,
                    0xdb55019e40e81f5e,
                    0x620e53b295c63a34,
                    0xbc8174ae9a2dba70,
                    0x55952f42f843bb74,
                    0x11ca466a5ae6a81c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x27f49623876216ce,
                    0xa2e1ba52926c7bc6,
                    0x3ab9422c5b932d88,
                    0x4fe02b1f9bebaa07,
                    0x0e2b365eda0fed38,
                    0x03042f03d11abf57,
                ])),
                Felt::new(BigInteger384([
                    0x84775a58aa2f0b65,
                    0x6700ff12440ad051,
                    0x02c9c614993005b7,
                    0x172dde8ad367ba7d,
                    0x8087830486ac9a66,
                    0x11909e51495951eb,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x40a402165f3a49fe,
                    0x37bde56a4cffb660,
                    0x15573ced405ff6b7,
                    0xe732747ff042efa9,
                    0x3f892ddd7d604d02,
                    0x06090b74f167f902,
                ])),
                Felt::new(BigInteger384([
                    0x6471b1fcdaca23ad,
                    0xea1c0c0d700c6385,
                    0x6347dfefb93277c1,
                    0xffb3a37206a38865,
                    0xccef2ec1c5097cc8,
                    0x02dbde8696ca6b80,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x022845dc793dcc85,
                    0x77d82548678f71e2,
                    0x9018c226ae6239fc,
                    0x4f115cf6b83faebd,
                    0xe1c55443abf7d337,
                    0x04b1db81feb83693,
                ])),
                Felt::new(BigInteger384([
                    0x8854c8dbb8fdca37,
                    0x3f311cb9375866fa,
                    0xb5e9d84ed286726f,
                    0x1a9d753d22eef207,
                    0x7afc1751e7f402d1,
                    0x19c28e5a45fbee60,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 6));
        }
    }
}
