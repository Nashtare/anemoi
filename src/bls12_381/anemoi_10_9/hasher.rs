//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 47 == 0 {
            bytes.len() / 47
        } else {
            bytes.len() / 47 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 47-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 48];
        for chunk in bytes.chunks(47) {
            if num_hashed + i < num_elements - 1 {
                buf[..47].copy_from_slice(chunk);
            } else {
                // If we are dealing with the last chunk, it may be smaller than 47 bytes long, so
                // we need to handle it slightly differently. We also append a byte set to 1 to the
                // end of the string if needed. This pads the string in such a way that adding
                // trailing zeros results in a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 48];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 47 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn merge(digests: &[Self::Digest; 2]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        // 2*DIGEST_SIZE < RATE_SIZE so we can safely store
        // the digests into the rate registers at once
        state[0..DIGEST_SIZE].copy_from_slice(digests[0].as_elements());
        state[DIGEST_SIZE..2 * DIGEST_SIZE].copy_from_slice(digests[0].as_elements());

        // Apply internal Anemoi permutation
        apply_permutation(&mut state);

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        assert!(k % 2 == 0);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger384;
    use super::*;
    use ark_ff::to_bytes;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 10],
            vec![Felt::one(); 10],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger384([
                0xcaf85e906eae881f,
                0x885ffcb4b051957a,
                0x8d285be8bef98745,
                0xc1b506f9f5231852,
                0x4b27da6d01d3429e,
                0x0d9354ef1ff9adb1,
            ]))],
            vec![
                Felt::new(BigInteger384([
                    0xd3d3edbf72f8dad5,
                    0x4f4ddb6a6c2aa363,
                    0xd68731699f3f8bbf,
                    0x75c2b135a8821678,
                    0x48f8b185eea82125,
                    0x00d006a3c6066d5d,
                ])),
                Felt::new(BigInteger384([
                    0xbc5a44b168df3cdc,
                    0xc835a2d86a47c146,
                    0xfe990882d5245d8f,
                    0x67374e29a73088d2,
                    0x887e878b108444d1,
                    0x05e00fad78937f8b,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x25bcd780ac34af30,
                    0x1f7d32abcb914042,
                    0x23892542734f948f,
                    0x6cc2da6a24323ee5,
                    0xd73471f00cde7402,
                    0x14216630d02ba502,
                ])),
                Felt::new(BigInteger384([
                    0xfc1bcc6db668c830,
                    0xe03a9bb9ec02f0b8,
                    0x9d59c253780b788e,
                    0xff9ddf8b1b18cdb8,
                    0x41248174fa3b4e9d,
                    0x0293ec2914fec20b,
                ])),
                Felt::new(BigInteger384([
                    0x8d93a3d8c1205760,
                    0x646bf9fab45bd62a,
                    0x6626633c39a8ce79,
                    0x430b874ba0cb85d1,
                    0xd5688027a62ddc5d,
                    0x12f0c1a2c9826128,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xa2f7ea6242f92847,
                    0x4a4ea8746d04e6fb,
                    0x3724589f471ad3b3,
                    0x23d88ff728092715,
                    0x749a0d8bfc0045b3,
                    0x15cc9b2de7f4e12e,
                ])),
                Felt::new(BigInteger384([
                    0xd5b11802df25e0ef,
                    0x31686c74721a9784,
                    0x1522ff4b558d47cd,
                    0xfbd0bc1eff277e60,
                    0xe8158750ac78d5f6,
                    0x0a96025e4925f1ae,
                ])),
                Felt::new(BigInteger384([
                    0x3ebc722c158b5da7,
                    0x95c15476ca13e092,
                    0x5d5f433d61427cfc,
                    0x5ece97d50a22bfe3,
                    0x555a1e38df56d236,
                    0x014eeb7db8f79ab0,
                ])),
                Felt::new(BigInteger384([
                    0x9d83556b7ebde88c,
                    0x14521431f666dea9,
                    0xfb61b681e8e53276,
                    0xd168adec7e64d6df,
                    0x3143b2b2394f5538,
                    0x0d09136a6e4f8f51,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xc9ef083a78f5dc5b,
                    0xcd616fec2db3ce99,
                    0x164afb975fdfd237,
                    0x83eb4ae297222309,
                    0x2fa700e5ca552930,
                    0x0def70123d707f54,
                ])),
                Felt::new(BigInteger384([
                    0x8ae060586366ddca,
                    0xa8447f3d9b59bdc6,
                    0xfb0def687a0347d0,
                    0x6e8ca60ee0f0fa2f,
                    0xd1b615e99b5e1a60,
                    0x112112c89d9a5190,
                ])),
                Felt::new(BigInteger384([
                    0xd0f4a527af60413a,
                    0xc09e9545a0425137,
                    0x05cd9997b0e5e0ed,
                    0x6530d38c6a89f1a1,
                    0x44180f71e5118af2,
                    0x03dc7cd30904edca,
                ])),
                Felt::new(BigInteger384([
                    0xb32bb2ccdc6d9a77,
                    0x45ccf8e72a9c4fa0,
                    0xa8efd2efe9eabae3,
                    0x86217fdb742b6ef5,
                    0x2df06b523d335ed1,
                    0x17b4d5eb94bacb9d,
                ])),
                Felt::new(BigInteger384([
                    0x5a2aa3d8a442081c,
                    0xe47f25648f1581ab,
                    0xacba49aac9f677be,
                    0x8eb1a7601963155f,
                    0x528b84c6485f4db2,
                    0x150c18efae8fa6e7,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xeb40df44d02b9309,
                    0x63f25fa06151bf8b,
                    0x5efaea9c82abc817,
                    0xc07a21cecd188214,
                    0x48badaa5bb3c4048,
                    0x0ccccbe0f9e47c7f,
                ])),
                Felt::new(BigInteger384([
                    0x4bfe1c46da1b0537,
                    0x18c5bb3881006dc4,
                    0xa6c8f3dec7414b50,
                    0xeb797d752438ec7c,
                    0x148f2ff86bdac2ad,
                    0x15da6eda880b308c,
                ])),
                Felt::new(BigInteger384([
                    0x7aef1a35a7e22b9c,
                    0xfe51df071bd775bd,
                    0x95882929cc75bbc4,
                    0xa49d226f1e2220fb,
                    0x230dc80bd8a6bb74,
                    0x12240b18883be92d,
                ])),
                Felt::new(BigInteger384([
                    0x9449db2e9a91737f,
                    0x9270d4c82436172a,
                    0x241ec063cb5988dc,
                    0xb902ff6eaab656cc,
                    0x2f1c339aa7756ead,
                    0x0d08b1630c4afc58,
                ])),
                Felt::new(BigInteger384([
                    0x1e9f5b278a9a1735,
                    0x910b9b2fe5e6bad0,
                    0xc59ef96af6123662,
                    0x56d06291f10d2ea6,
                    0xce84ead16e27d742,
                    0x15630b5f188ca796,
                ])),
                Felt::new(BigInteger384([
                    0x0dbd81886e00bff8,
                    0x6c21ff15ac960e4f,
                    0xc24e50a1eda4d085,
                    0x23db1dc7008361b8,
                    0x0c9795f843f31cbf,
                    0x0f07856fb61779f1,
                ])),
            ],
        ];

        let output_data = [
            [Felt::new(BigInteger384([
                0x2b8a4ffcba446690,
                0x0eb57c1662233a68,
                0x0a2e16bd237d72bf,
                0x91d33a4c28f28fde,
                0x51eb5dd5cb89c839,
                0x1576d0dbcddafa9a,
            ]))],
            [Felt::new(BigInteger384([
                0xdabb0f3249cf9840,
                0xb23c409ffd1f1a72,
                0xe112017b3bf4b8ad,
                0xcb3770359ec330e3,
                0xe9f6f456536d0ec0,
                0x101d88b86d0fb054,
            ]))],
            [Felt::new(BigInteger384([
                0x330a40da44a29eae,
                0xeedef43690aa3c06,
                0x2cabf2fdbf811f82,
                0xa0129031391a227c,
                0xaf6ac001f72afa41,
                0x13e0ff31ce5a7faf,
            ]))],
            [Felt::new(BigInteger384([
                0x4c3323c8a90bc0ff,
                0xaf7d5c0c424f5b29,
                0x2ca332582a5308da,
                0x44e53c16fd721b6f,
                0xe9072667bcbcf024,
                0x17c513b593ba11d6,
            ]))],
            [Felt::new(BigInteger384([
                0x68cc7c616da6fec1,
                0x4bcae03c07767e0a,
                0xcd17254b531213bd,
                0xb48c34c31e5bf666,
                0x4d55de2939cecb9d,
                0x0514c2cccffa7487,
            ]))],
            [Felt::new(BigInteger384([
                0xbc2b9a9c652fad7e,
                0xcf98af624351c677,
                0x28d5122be0783458,
                0x5e76ed79184201fa,
                0x351acee8adad6a13,
                0x0379fcf076354526,
            ]))],
            [Felt::new(BigInteger384([
                0x0c3581467ef4b1be,
                0xcb3caef30fc637d7,
                0xd5113c735627d9e9,
                0xa4886918b52f4353,
                0xfc6a25b0d77f0182,
                0x0493bf229e7b35ff,
            ]))],
            [Felt::new(BigInteger384([
                0x8c59020e94807767,
                0x4096f5fb577201a2,
                0xe2a1db147817729a,
                0x38d2d973680f55b1,
                0xc8ff72ab1fe924c9,
                0x0b379603a40943d3,
            ]))],
            [Felt::new(BigInteger384([
                0x261d2d06350c56b0,
                0x8da4ea702fcda774,
                0xd21aba05211b4407,
                0x02f6055468557426,
                0xa71741491484f34d,
                0x0dd86cc2b30a4b26,
            ]))],
            [Felt::new(BigInteger384([
                0x641fe7b17c7583ba,
                0x5014438c37673108,
                0xa685209348b93030,
                0x2c6b34c015bc50a7,
                0x8720f5e8ddd90e4a,
                0x0b673ab844356fee,
            ]))],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_hash_bytes() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 10],
            vec![Felt::one(); 10],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
        ];

        let output_data = [
            [Felt::new(BigInteger384([
                0x2b8a4ffcba446690,
                0x0eb57c1662233a68,
                0x0a2e16bd237d72bf,
                0x91d33a4c28f28fde,
                0x51eb5dd5cb89c839,
                0x1576d0dbcddafa9a,
            ]))],
            [Felt::new(BigInteger384([
                0xdabb0f3249cf9840,
                0xb23c409ffd1f1a72,
                0xe112017b3bf4b8ad,
                0xcb3770359ec330e3,
                0xe9f6f456536d0ec0,
                0x101d88b86d0fb054,
            ]))],
            [Felt::new(BigInteger384([
                0x330a40da44a29eae,
                0xeedef43690aa3c06,
                0x2cabf2fdbf811f82,
                0xa0129031391a227c,
                0xaf6ac001f72afa41,
                0x13e0ff31ce5a7faf,
            ]))],
            [Felt::new(BigInteger384([
                0x4c3323c8a90bc0ff,
                0xaf7d5c0c424f5b29,
                0x2ca332582a5308da,
                0x44e53c16fd721b6f,
                0xe9072667bcbcf024,
                0x17c513b593ba11d6,
            ]))],
        ];

        // The inputs can all be represented with at least 1 byte less than the field size,
        // hence computing the Anemoi hash digest from the byte sequence yields the same
        // result as treating the inputs as field elements.
        for (input, expected) in input_data.iter().zip(output_data) {
            let mut bytes = [0u8; 470];
            bytes[0..47].copy_from_slice(&to_bytes!(input[0]).unwrap()[0..47]);
            bytes[47..94].copy_from_slice(&to_bytes!(input[1]).unwrap()[0..47]);
            bytes[94..141].copy_from_slice(&to_bytes!(input[2]).unwrap()[0..47]);
            bytes[141..188].copy_from_slice(&to_bytes!(input[3]).unwrap()[0..47]);
            bytes[188..235].copy_from_slice(&to_bytes!(input[4]).unwrap()[0..47]);
            bytes[235..282].copy_from_slice(&to_bytes!(input[5]).unwrap()[0..47]);
            bytes[282..329].copy_from_slice(&to_bytes!(input[6]).unwrap()[0..47]);
            bytes[329..376].copy_from_slice(&to_bytes!(input[7]).unwrap()[0..47]);
            bytes[376..423].copy_from_slice(&to_bytes!(input[8]).unwrap()[0..47]);
            bytes[423..470].copy_from_slice(&to_bytes!(input[9]).unwrap()[0..47]);
            assert_eq!(expected, AnemoiHash::hash(&bytes).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 10],
            vec![Felt::one(); 10],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x7532a4c30c2ee78f,
                    0x32a72494d3a70a12,
                    0x64f40a89724b956e,
                    0xd588a84b97b2b442,
                    0xb552f835b7078d41,
                    0x015d6f177e0ebd26,
                ])),
                Felt::new(BigInteger384([
                    0xb0e326f22e0ee3b7,
                    0x9c3d87a4bdc13b02,
                    0xc30f3633d391de94,
                    0xc3466eacaa4cd1b6,
                    0x946e4678cf246835,
                    0x175a06c71f25c2c5,
                ])),
                Felt::new(BigInteger384([
                    0x3f87eff2d620ff73,
                    0x5793f7ac9661ae40,
                    0x3ee2ff06ce72155d,
                    0xd48c1b287d8f407a,
                    0x619ff6c4ea89d7fc,
                    0x106d94c26df1fa1b,
                ])),
                Felt::new(BigInteger384([
                    0x10f9551fed18298e,
                    0xbb8b25e9e9ed0580,
                    0xa2f4f6dd0cdd115d,
                    0x2c76d63175e3d288,
                    0x196def5f30d5346d,
                    0x0a33f00ae638df4e,
                ])),
                Felt::new(BigInteger384([
                    0xdcd8dbc3e00fc59b,
                    0x12575220b692af56,
                    0x7806083a979493aa,
                    0x90dc9e666f07e806,
                    0x64037f7eb5271c7e,
                    0x0e34e6c531ed5e15,
                ])),
                Felt::new(BigInteger384([
                    0xeb0ed0b9fbdd6b72,
                    0xf5bc0436b85bd8cb,
                    0x514ee1f273a9ad7a,
                    0x000635c1fc39c530,
                    0x789e71fe5c2a829c,
                    0x11b7ea151f56e1e7,
                ])),
                Felt::new(BigInteger384([
                    0xae568e44386e392a,
                    0x4fb943d7c3badbcf,
                    0x4a4532358c217655,
                    0x1d493bccc933fa60,
                    0x17732e7369fcf134,
                    0x181c573112410e62,
                ])),
                Felt::new(BigInteger384([
                    0x6ffbb54e6c636295,
                    0x5541df417e7ff6d7,
                    0xca6495953b2ba614,
                    0x1f499141b9fcc9b2,
                    0x667410e8f579e8b7,
                    0x05e8de31da0eb3dd,
                ])),
                Felt::new(BigInteger384([
                    0x1e1e159d4e413507,
                    0x21bfc5fb8f48d130,
                    0x8fe6ca9681e467ac,
                    0xf627ce9adc14fc1a,
                    0xcde9f30a3f385142,
                    0x01ac621af5ee82f8,
                ])),
                Felt::new(BigInteger384([
                    0x78408d13633312fe,
                    0x0561a21acfa6f244,
                    0xc01780e306965239,
                    0x480e920d4fa3f8a3,
                    0x71922d77dfcfb2ca,
                    0x0ad6594fc299fabc,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x8e38ea268fe091d5,
                    0x74e985172ce8349d,
                    0xf2622ed140ca3233,
                    0xbdf74de1ef2af93e,
                    0x1812ec686f71a3b8,
                    0x10d43ae933a3c92b,
                ])),
                Felt::new(BigInteger384([
                    0x58c5dca298d2eda1,
                    0x1816d76a52d840d8,
                    0x9e9072255009057f,
                    0x4d089c037fc70287,
                    0x38c9ea12d236a9d9,
                    0x128df46f5da44034,
                ])),
                Felt::new(BigInteger384([
                    0x73c7efe2fb5b67a7,
                    0xb1dea1bd20fc2592,
                    0x33bdbc6fe6545d1f,
                    0x60c37a5ad0131571,
                    0x79fea5be5e4c0e90,
                    0x142531d231095d9c,
                ])),
                Felt::new(BigInteger384([
                    0x69db110de4487787,
                    0xe8d59d63521f723f,
                    0x474a4350fe116914,
                    0x11a0b23c0a293344,
                    0xdc4e9e8a806d9329,
                    0x0acb7d678744c675,
                ])),
                Felt::new(BigInteger384([
                    0xf5fcd93b5b85d1e1,
                    0x20d8b3ef2b52b055,
                    0x217ed6b1f67a769b,
                    0x01b401ca3508123b,
                    0x47a815c5acd72645,
                    0x0fbf63a54d48efe3,
                ])),
                Felt::new(BigInteger384([
                    0x5e7a1d220547f12c,
                    0x13ae5053fbfcc1f0,
                    0x99a9f09cdfd71a7d,
                    0xe93cf46f9ac628c5,
                    0xd4800a33acf1a2ba,
                    0x1185d9f3238e4aea,
                ])),
                Felt::new(BigInteger384([
                    0xb029d69c4815259a,
                    0xf203465bb60bdd3a,
                    0xf02d4b7e66756674,
                    0x1a09822d078ab6a5,
                    0x096dc4452f140e36,
                    0x0a6397082f8e7dd1,
                ])),
                Felt::new(BigInteger384([
                    0xbd01bbecf97cfe4a,
                    0x5bb0d805bcb6c225,
                    0xb6aea532b7fce28f,
                    0x9f5f31374d65af3b,
                    0x261ebc8750ccebdf,
                    0x066549ba4341fb81,
                ])),
                Felt::new(BigInteger384([
                    0x8f14d105fecfe1d7,
                    0xd939ea1447f7af43,
                    0x244d90eeb382b870,
                    0x3d8063f4b47406c3,
                    0x302714e174b15653,
                    0x0047422a765abe65,
                ])),
                Felt::new(BigInteger384([
                    0x8a335105ba3feed5,
                    0xd82c9ec970ba7cb7,
                    0xfbf644b40008c935,
                    0xb9b1114ebde1c006,
                    0xcc5116ae49a26978,
                    0x15ec483e576fbc1e,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x381b89b0174483f7,
                    0x844aa52e02cd82b3,
                    0x16d84f238d2ee5f1,
                    0x216cfaebf5f21521,
                    0xf59991f77f2cbdf7,
                    0x1874956879361ef0,
                ])),
                Felt::new(BigInteger384([
                    0x1d674d3c52ad851f,
                    0xc75f018084485ec7,
                    0x102057bd65337dad,
                    0x196611d0ea9cca97,
                    0xbe12a54b18f27965,
                    0x199de78003018817,
                ])),
                Felt::new(BigInteger384([
                    0xc30af7bc1d9ce4e8,
                    0x09f8fcc311d61483,
                    0x2a0148dfe6efb8b9,
                    0x38bed13eb0504f15,
                    0xa3d898495f07b616,
                    0x19c1402689858149,
                ])),
                Felt::new(BigInteger384([
                    0x8487377ae528e0cc,
                    0x7ae843efcc658fde,
                    0xfe2a575184bb26bf,
                    0x8fb04651de5142c3,
                    0x962c5e44a2ea41d1,
                    0x043ef2694f287633,
                ])),
                Felt::new(BigInteger384([
                    0xa24f6dee58719267,
                    0x05e24aefc1160b55,
                    0x82fa7f6a2a65fdff,
                    0x174d45f96f12610b,
                    0xd108ab7c7597fc2b,
                    0x0359fbde228a1f9e,
                ])),
                Felt::new(BigInteger384([
                    0xbb68c44d44c78691,
                    0x3cbdb22ab4f97aff,
                    0xbea5a1e3d5858751,
                    0x3bd2e34cdb263ad7,
                    0x7e3179d7dea57988,
                    0x04a6e1dcee4d5775,
                ])),
                Felt::new(BigInteger384([
                    0x1123d79f2628deb8,
                    0xaf5a9ba6b7da6d8e,
                    0x4f6d208da6f21431,
                    0xca4bb6ef97a18a8f,
                    0x1f56bc38d8651e5f,
                    0x075013a2b2e0e620,
                ])),
                Felt::new(BigInteger384([
                    0xc49bcc736baa397d,
                    0x0da81583b59e9e4a,
                    0x0cfe066e47cd69dd,
                    0x6271d464a8de8aa1,
                    0xbf455fc97270dacc,
                    0x1120525219fac843,
                ])),
                Felt::new(BigInteger384([
                    0x3056efa36ad968f0,
                    0xee704fa24c878d59,
                    0x629fc2b146552a35,
                    0xce5381680feb2f7a,
                    0xe4cc387702055783,
                    0x1091587126940c8b,
                ])),
                Felt::new(BigInteger384([
                    0x8396efc4a616be22,
                    0x6f0b92b62c3a6605,
                    0x247cc26cbf5141fe,
                    0x3d3f8ff41b11a5c0,
                    0x04dd591a08220db7,
                    0x05f9bbdb54890588,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xf32ed4718247a9ac,
                    0x3fc9f0d25d8d1bf8,
                    0x20a0b67f3c53028a,
                    0x1bf74adbf0d797b1,
                    0xbbbb944701ca6433,
                    0x120a4d2ddba55ada,
                ])),
                Felt::new(BigInteger384([
                    0xe00a7b494495cb0e,
                    0x16c1a7871684b51c,
                    0x254b0c01a7d89323,
                    0xd23323950e849e73,
                    0xeba4c1aa87e68e52,
                    0x09b3e5e1701c0b32,
                ])),
                Felt::new(BigInteger384([
                    0x5b9de33cb4ed49fc,
                    0x3b2e64ee022323f5,
                    0x98de2642a888a8c8,
                    0x2ba8f77e903d6222,
                    0x9226fa52266be35b,
                    0x12bd2a3e8b142ca1,
                ])),
                Felt::new(BigInteger384([
                    0xcfb2759eacfd52ac,
                    0xd0f4bcaa71bbd326,
                    0x100cd9b85b447bf1,
                    0x056f56f70bb2afef,
                    0x9697bd695520b11c,
                    0x00e1423c62c75c20,
                ])),
                Felt::new(BigInteger384([
                    0x21fc629fffd1e616,
                    0x1e5b200a4d1026f6,
                    0x6effbf0301361ade,
                    0xc78d878571d401bd,
                    0xd7c9aafcb1dd917c,
                    0x05e4648e9599de10,
                ])),
                Felt::new(BigInteger384([
                    0x3d99b299ea618c47,
                    0x5dbfc7bba745513c,
                    0x6e38a2c2956c81ea,
                    0x552166152aec4c19,
                    0x752eecc0b7f6e411,
                    0x1478599b2ea959f8,
                ])),
                Felt::new(BigInteger384([
                    0xa9e984a183b92d76,
                    0x46d951f3e0269db3,
                    0x3d69cbf6f2f44a98,
                    0x31d56c284165d0e9,
                    0x8e8e55f44eda8800,
                    0x128f5b3f9bf729bd,
                ])),
                Felt::new(BigInteger384([
                    0x07d5fe1f008ed7b9,
                    0x5a4a90c96ddb81ef,
                    0x4e72db30ad37641d,
                    0x60300345e539bf3b,
                    0x0d31dd3be1881fa1,
                    0x089d71448c8c7212,
                ])),
                Felt::new(BigInteger384([
                    0x17c339f3ad7e928c,
                    0x08a15b7237127cb5,
                    0xfe7ec55666985002,
                    0xd5a372c1ae090779,
                    0x7a00cff4a3552411,
                    0x036a4c76a6373af8,
                ])),
                Felt::new(BigInteger384([
                    0x3f5cf12da915749c,
                    0x12491bf2711e0d63,
                    0x1cee9718dc48e380,
                    0xbc8fa6ab15bc9460,
                    0x5fdd085db0fd5793,
                    0x0605ca7318377a17,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x6d4fc7cf6f64d880,
                    0xe60d5b5b98b86d91,
                    0xc8eba690c28f2b0f,
                    0x45c4da2e4fe33076,
                    0xc0fa79c2291a2b7f,
                    0x1732aad9d54b3f19,
                ])),
                Felt::new(BigInteger384([
                    0x9e3cf6e6683e4b21,
                    0x61c5228a1afadaf4,
                    0xcd3f994821fa5548,
                    0xa00373a7e74a6a38,
                    0x9f9513cdb50362dd,
                    0x165f7d622da417c5,
                ])),
                Felt::new(BigInteger384([
                    0x4e0b93ce8ae75334,
                    0x7d7e087e09bec0fd,
                    0x1e9132e997414eb3,
                    0x7a8bd4d88393c2f1,
                    0xc67bc174f8c55ac6,
                    0x0acabcb5aff2abb5,
                ])),
                Felt::new(BigInteger384([
                    0x346107dc1a555e3d,
                    0xd8b8aa717f714e3b,
                    0x3c13c194a62bdb48,
                    0xe3750279e0fef855,
                    0xbf5f8d0c0340c04f,
                    0x13fa169ff92b2849,
                ])),
                Felt::new(BigInteger384([
                    0xf40d1b6b98a15cd2,
                    0xfaab26d4fbe69eca,
                    0x6fdbf104fd0f75d5,
                    0x0360d3a550dacee0,
                    0xf99592b7a0e59d3f,
                    0x06b0d4a88ca0f512,
                ])),
                Felt::new(BigInteger384([
                    0xa55f305408abd8e7,
                    0x7ec6b79d7f68f2c3,
                    0xe2cf2c0bc35bdf3c,
                    0x3acd120894817d14,
                    0x9abe76c5182f8393,
                    0x0b4ca3f5dc4c9cfc,
                ])),
                Felt::new(BigInteger384([
                    0x1c80ccfaa3422a19,
                    0x205b9a5820aa1404,
                    0xdff38352a14b3c8d,
                    0x6d1c25eb2cc57777,
                    0x129e8293d1bde1c7,
                    0x09abcbc7146607e7,
                ])),
                Felt::new(BigInteger384([
                    0x49c782b15d75e0dd,
                    0x045e84d25ee718ad,
                    0x8326331d03cdc12d,
                    0x125860a1545e7774,
                    0xca35589af13a4039,
                    0x0859ba2434085992,
                ])),
                Felt::new(BigInteger384([
                    0x522d897977775c75,
                    0x3d8f5863a1e275a6,
                    0xa27f29c927a2a867,
                    0xb67dddda75d49a30,
                    0x6f6f6a6e69d5e753,
                    0x05d6b2fa3ce0e210,
                ])),
                Felt::new(BigInteger384([
                    0xe7a6751c396d9ec1,
                    0x1ac6047ed6a5f990,
                    0xa80208eae304210a,
                    0xfe7116b67d43aec8,
                    0x097d46480f378410,
                    0x097cd8f9c7c32833,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x36a1ebbee19c5906,
                    0x9b105824300d56f1,
                    0x8a2cece455b268b9,
                    0xb72a0e54c6ee05ae,
                    0x2bee8892aa8a2eb2,
                    0x0ca042a797a123fd,
                ])),
                Felt::new(BigInteger384([
                    0xaa6847e70844e546,
                    0xa0c615d5ecd2b6ea,
                    0x76af2e9f68ee7119,
                    0x5294637819975785,
                    0x10cf7f1d78ed2f80,
                    0x06aec5fa735d466f,
                ])),
                Felt::new(BigInteger384([
                    0xd3aaef58897ba2cb,
                    0xbecce42b19e3d208,
                    0xe104baf9f6f0ed89,
                    0x304d8cfcfa6c56ff,
                    0x187b11f06b3dd201,
                    0x12f02949db018143,
                ])),
                Felt::new(BigInteger384([
                    0x428bf50a812c532a,
                    0x1c680ce86c2b8e84,
                    0x1288896b49c21657,
                    0x83d4c00f306fe8cf,
                    0xa945e368851f905d,
                    0x1939d1b38162d5e4,
                ])),
                Felt::new(BigInteger384([
                    0x82ee87406259199d,
                    0x499bfddf89220325,
                    0x77daf97b0c182da4,
                    0xa7600f79d0795db3,
                    0x324d076b5be38e27,
                    0x0e8bc62f9de19dc9,
                ])),
                Felt::new(BigInteger384([
                    0xc4991630d7f2c7b6,
                    0x726e2378fb70670f,
                    0x761bae127a32b064,
                    0xddbf56dd38cf8f3a,
                    0xfbab7c20b8f30587,
                    0x17e1624eb388889a,
                ])),
                Felt::new(BigInteger384([
                    0x8becbe0f4df4d5b0,
                    0x81d8de0551ebbb26,
                    0xb5c62fa5c5c5f041,
                    0x60e85d687bed7006,
                    0xffe52b49d9a63d76,
                    0x18181f0a7e6bf7f2,
                ])),
                Felt::new(BigInteger384([
                    0xf33d5c094ec2f25d,
                    0x439d130babc74656,
                    0xc3d236f5bbf81fe2,
                    0x62d5958fe52ffa20,
                    0xc96edc4873647ab2,
                    0x021a03b50e3d4187,
                ])),
                Felt::new(BigInteger384([
                    0x3e18e9b419a15720,
                    0xe1b21c46c53202c7,
                    0x02f187d0f7df5a39,
                    0x7d5d72ad2f0a48d1,
                    0x6ffe3b33375abbf2,
                    0x11657c6a33b1a1cc,
                ])),
                Felt::new(BigInteger384([
                    0x78c6dfee87eaeabc,
                    0xa29b709e4d9ecb3e,
                    0x0febe79b9356c192,
                    0x32c32ed163d784fd,
                    0x17bfd1add3d7bc45,
                    0x048be55da29bc015,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x02a5967c309fb371,
                    0xdcd72c707275981f,
                    0xee268d7acd99f105,
                    0xd7f2d131e585e964,
                    0xce500b7c190f3d0f,
                    0x07f8f19d639b850e,
                ])),
                Felt::new(BigInteger384([
                    0xfff9de3158221625,
                    0x5715683d87677a3d,
                    0x6609fb19add6101f,
                    0x83b258c255cdc216,
                    0xadd17d6934a94a0d,
                    0x197b3c12bec883ae,
                ])),
                Felt::new(BigInteger384([
                    0x138e9b541c7153e8,
                    0x239e26313a2fd32d,
                    0xb482ea042912935c,
                    0x8204f5a1fdee22f3,
                    0xcb06c50189e77d09,
                    0x0194b52e276cc36a,
                ])),
                Felt::new(BigInteger384([
                    0x0e09ee17e6a5eca4,
                    0x486d29eef00c913f,
                    0x1b5e259853fc65dc,
                    0xfe14a41e14116666,
                    0xe0719ce806db7fdf,
                    0x06af86a667d3981a,
                ])),
                Felt::new(BigInteger384([
                    0x212c55de715b7e6a,
                    0xb9e19e9b3db29255,
                    0xe926b2c91dc83fb2,
                    0x505b5ff343ed2c06,
                    0xd310d88f0c618323,
                    0x03173085f9b76e48,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x307cc8070a5ee846,
                    0x776deaf70be777ae,
                    0x8f99e9c0db170859,
                    0x661c9a5f684ca79b,
                    0x4e3c0174e350f6ff,
                    0x0dcbceaf8941111e,
                ])),
                Felt::new(BigInteger384([
                    0xc685b2b96b8b2ac5,
                    0x42f88af8f623562f,
                    0x18e90004c3761fa4,
                    0x44c64f8a14b00f86,
                    0x3546c0238d5ef920,
                    0x17e98e4a9a2c227f,
                ])),
                Felt::new(BigInteger384([
                    0x43856a28e812f1ff,
                    0xf9027dd187bc088c,
                    0xfe163a9381996aed,
                    0x239d3c62e25f94ab,
                    0x70a9d17402560fec,
                    0x0a549219e633259a,
                ])),
                Felt::new(BigInteger384([
                    0x6013e9d445f848da,
                    0xdc6febed6651c990,
                    0x87a311084cb9a652,
                    0xf526884c7b486838,
                    0x7871a9723cdfb10f,
                    0x15ca973ab606295c,
                ])),
                Felt::new(BigInteger384([
                    0xab8abe59e3db31f1,
                    0xb6f7cea148380683,
                    0x256141f68d666a40,
                    0xe9508d737cf86193,
                    0xc2f8761f9e6c613c,
                    0x02caff3ed96ba408,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf8bf5ffb4c79eb2a,
                    0xdc06a5fafb2de012,
                    0x0b77cd4323a2634e,
                    0xd0c6da78e9461c20,
                    0xc039d3e20afda597,
                    0x0f2e9c04d7fc4c5b,
                ])),
                Felt::new(BigInteger384([
                    0x00390dddde37084a,
                    0x7de031e875d5121f,
                    0xb26a20149cf35826,
                    0x548dedd58f92bd4a,
                    0x22b9f2d414a7a1a9,
                    0x062e5a82abc4bd0e,
                ])),
                Felt::new(BigInteger384([
                    0xf7d88f6a32dab45b,
                    0x20aed3fc4f7899cc,
                    0xb6943d4d56cf132a,
                    0x4a3a15140aebf76f,
                    0xd173284200ab4bfd,
                    0x0dff8b277062a767,
                ])),
                Felt::new(BigInteger384([
                    0xf17cb896711017de,
                    0x46fdb3563ee2c8b8,
                    0xf0ab3d255f268452,
                    0xb65547af7f5a7eb9,
                    0x72fcc39da3b5558a,
                    0x06aa8ae55b1674fe,
                ])),
                Felt::new(BigInteger384([
                    0xdd33650555aeffb1,
                    0x6f86481db55c37bc,
                    0x6a9c5175b931620c,
                    0x0c3910fa32927981,
                    0x8d614c72cb0cbeaf,
                    0x07f0de5711bef1b0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8677198ee834693e,
                    0x9581507929939203,
                    0x889fba28349f5f4e,
                    0xfa7515e599145604,
                    0x2feed945a722c36f,
                    0x140fd0c407d71e82,
                ])),
                Felt::new(BigInteger384([
                    0xccd7fae7c98976d1,
                    0x4d5e5197857d9e72,
                    0x8511caa49b0e08e0,
                    0x972c4eb46003b082,
                    0x42b29cfa2c95064e,
                    0x192ed4c028533105,
                ])),
                Felt::new(BigInteger384([
                    0x0dfa55451860bfad,
                    0xed4391052557bbdb,
                    0x1654f101d786593c,
                    0xc1eb010e9ca5870c,
                    0x9f0d157c97386e17,
                    0x053ba26c2ba073cf,
                ])),
                Felt::new(BigInteger384([
                    0x2e6058c4a857e09a,
                    0xff48ea94f01bc6a9,
                    0x340fee8b74c50040,
                    0x6cf890d07d20fe1c,
                    0x986c574392cc6d6f,
                    0x1624aa349bdf2d88,
                ])),
                Felt::new(BigInteger384([
                    0xc52b09c0bef081db,
                    0xd6e13d6d2e07fa87,
                    0x4481e13fbd72d7e5,
                    0x5fab8fe73b8cf71e,
                    0x14423dcea8cb7fd1,
                    0x19f59f806d4128e9,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x48f2c38be84822c0,
                    0x6e3100abd221ef7d,
                    0x527ec2aec2c527b6,
                    0x621197be1daf70f1,
                    0xea2735ad401bff5f,
                    0x0354d807cb7a2025,
                ])),
                Felt::new(BigInteger384([
                    0xb86dc87e92b4971e,
                    0x3b39e0c1419af12b,
                    0xdaab6ddc7637da36,
                    0x7296eb63292248a0,
                    0x2f3dbf37526832e5,
                    0x0656869be59dac61,
                ])),
                Felt::new(BigInteger384([
                    0x6fcb1229d3e74c7f,
                    0xedc5f492f4b5437d,
                    0xceb2f160a46665f8,
                    0x162a1a85173a6d40,
                    0xe39e6455ea3599f3,
                    0x048f66b5929d0be9,
                ])),
                Felt::new(BigInteger384([
                    0x1b0821a80aa30614,
                    0xebb3d90acc3f1365,
                    0x4d847ab361b9ba75,
                    0x69a6e7e21a5244a7,
                    0xa1a1df10673f6477,
                    0x02a82af1c0989bbe,
                ])),
                Felt::new(BigInteger384([
                    0x34e5a47c48f1ad0c,
                    0x5044b2693e7a44a4,
                    0xe054239e83ff2ac9,
                    0xf166e32f4f7f15d3,
                    0xe1dcd896a02a0471,
                    0x024971b59d344c4c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x188e68a9e3e8c0f6,
                    0x8b274af70d9c374c,
                    0x8b512ef4f0ae121f,
                    0xed4f6dac526162f5,
                    0x05a1e5f9a0a98b3e,
                    0x1773ac96b4a27b6f,
                ])),
                Felt::new(BigInteger384([
                    0x746c739cd59c3d27,
                    0x029e3ef5f53eb64f,
                    0x5f9ee4b0da112951,
                    0xd026159c34aca4d2,
                    0x273d3d4513a9de27,
                    0x03346595014d01d7,
                ])),
                Felt::new(BigInteger384([
                    0xed88366b78344560,
                    0x78547e3333c209de,
                    0xb66402c51b78433a,
                    0x2dfd17b318ec029e,
                    0xd277c73509727df0,
                    0x14346526ba41383d,
                ])),
                Felt::new(BigInteger384([
                    0x9f245fd108b76a91,
                    0x64cceb7f0a6e44b2,
                    0x14e3dfc9c2c261ac,
                    0xa58dadcf49440871,
                    0x1c3b2e93b9634f4f,
                    0x0a6012c7f3c8b499,
                ])),
                Felt::new(BigInteger384([
                    0x512886dd7310ad9d,
                    0x6442fbd0f41321f0,
                    0xb7ddc0d17bac50d3,
                    0x48988cf61388b597,
                    0xbd91162f02951c17,
                    0x118f5d71e6fb9593,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc5ef7d64fb5323b7,
                    0x0eb4564310b00084,
                    0x9d95bfa1ff2b4329,
                    0x1321374ca27c8430,
                    0x0ff0ebba6bcd85ae,
                    0x17196082fc6a5350,
                ])),
                Felt::new(BigInteger384([
                    0x16eadc655272df7b,
                    0x4c29c4934c7a7ad8,
                    0x6752d2ce3235f18a,
                    0xcea2a67d63ef3133,
                    0x6b2d98d8f369084c,
                    0x0aa59bfe65bafb22,
                ])),
                Felt::new(BigInteger384([
                    0xe6a3a5c223e9df7d,
                    0xbbf808e3786498dd,
                    0xee427fa5a80f944e,
                    0x58bbf6affa25b7c2,
                    0x00683dc96077226e,
                    0x00723598890faa68,
                ])),
                Felt::new(BigInteger384([
                    0xad25c751663235c8,
                    0x08e9e001ef2073c6,
                    0x2587bc2af90cc7c1,
                    0x81714da8a6beb897,
                    0x7caf3bd4bd8ee304,
                    0x086d0c3b029e67c0,
                ])),
                Felt::new(BigInteger384([
                    0x69ef2c3b60256ef9,
                    0x2408cef8ca70b134,
                    0x8b4e77e67bca0f2e,
                    0x831241da5d78f745,
                    0x72ffccc38eae96ce,
                    0x1558720be358dd30,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8b4ca007a2eb32e7,
                    0x7583c37772eab2e5,
                    0xc35e535526f85068,
                    0xa774904fda403322,
                    0x47ace4d27d853ac9,
                    0x10f3dee975c01305,
                ])),
                Felt::new(BigInteger384([
                    0xf6968eaf3cc22f9e,
                    0x3c6d1ebf17ed2991,
                    0x0f703d13e44ee8b7,
                    0xcd828aecabcd9ff8,
                    0xcd762707b245a323,
                    0x0f5e6e3a2e9cc44c,
                ])),
                Felt::new(BigInteger384([
                    0xef79b2e7e78ae5b9,
                    0xd65162a5dc72ec29,
                    0xfb224c59585b0e4c,
                    0xf6c8b6c3581b9900,
                    0x422bee77e409c6df,
                    0x1584c2f5698b7e0f,
                ])),
                Felt::new(BigInteger384([
                    0x2be856c1dfb4a191,
                    0x1fa6d5390ab06f26,
                    0x0c8d564a764cc10a,
                    0xb3bc3019e6a41376,
                    0x4ecf78a65b417dd8,
                    0x183e400d9aba4a4d,
                ])),
                Felt::new(BigInteger384([
                    0x4589efe386b90e8f,
                    0x29deb9341b392e7e,
                    0x718215bc98fe0bc9,
                    0x06c4127d2e18d4a6,
                    0xca60191d43c5af21,
                    0x13c058a46e60e872,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5f1162a36272379e,
                    0x8e3804e0edb704e8,
                    0x8206c317a14db995,
                    0x84b0aceabcf646f5,
                    0x48bdf60251236c68,
                    0x01b60ee3fc53167f,
                ])),
                Felt::new(BigInteger384([
                    0x69562926ff1ca0fc,
                    0x59696e7c35ebe7e1,
                    0x541405b867fe19dd,
                    0x047441fbdf8feac5,
                    0x173df5adff402539,
                    0x025a2235a1208ae8,
                ])),
                Felt::new(BigInteger384([
                    0xe59cb7b0a4c69350,
                    0xa92afb3719b99fe8,
                    0x5e40a96952a408e1,
                    0x8beceb894ff475dc,
                    0x96b6284457ed68e2,
                    0x00cd6e12b63e8fbe,
                ])),
                Felt::new(BigInteger384([
                    0xf708d290407a9d0a,
                    0xcf8ef8158644fc57,
                    0x674f18704102c2b5,
                    0x4c1059314c0f8d8f,
                    0xe5b5676c249b82eb,
                    0x058ef2243b5bfb3c,
                ])),
                Felt::new(BigInteger384([
                    0x56e586cc70c50e4e,
                    0xf613fa696409edc7,
                    0xc80bab6fe2b17cbb,
                    0xdf47d987c930153a,
                    0xa869e6838d2e4885,
                    0x056282376b7b0f15,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x34e3c7ef6d0f8310,
                    0x23c775408ac8c804,
                    0xd8574247a6c5d82a,
                    0x71eaa7b9e2ec8cf2,
                    0xb744f6b0dfacb257,
                    0x07833c97f6f6d674,
                ])),
                Felt::new(BigInteger384([
                    0xecda838128cd9c50,
                    0x2b97ba041729b203,
                    0x00b9fdda23c4b229,
                    0x01b8d96ffd271bdd,
                    0x03d66f503f8ab20c,
                    0x0cc4650f58e34ed6,
                ])),
                Felt::new(BigInteger384([
                    0x12fa0695ccad0a22,
                    0x283864505e31c04c,
                    0x012ee204f944ace5,
                    0xdd777d6e48a7f32c,
                    0x8988dd13b8ae27f7,
                    0x07a2a96dcf5dbb6d,
                ])),
                Felt::new(BigInteger384([
                    0x3871e57aa8bdc674,
                    0xfa54055958099baf,
                    0x44490783c40aff82,
                    0x180991e5b1f32c48,
                    0x6a7d292bcc7052ed,
                    0x0df45833ba4e5297,
                ])),
                Felt::new(BigInteger384([
                    0x515098467114c39b,
                    0xe1e3b3bf28b6553e,
                    0x8d2df166f14ec288,
                    0x510af1bfc7684e7f,
                    0xc8178e549791284d,
                    0x0c7d54dfff250c66,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![Felt::zero(); 10],
            vec![Felt::one(); 10],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x8d8053cb5e7753d3,
                    0xecfb11e68e05c473,
                    0x5a60aa9972d602e8,
                    0xd9ae5dc7abd607ad,
                    0x351c9298f4893561,
                    0x1767f64c04d699c4,
                ])),
                Felt::new(BigInteger384([
                    0x9547dc556a2b061c,
                    0x9ab38c67f3af1240,
                    0x421c7b38f307e409,
                    0xac6871c14842ed9a,
                    0xdbe49d02bf759794,
                    0x0918e01684e66345,
                ])),
                Felt::new(BigInteger384([
                    0x3afc500d61326726,
                    0x1e26180ed7ed7c33,
                    0x8dd0b6d8110a6fef,
                    0x825d1b3c028d4675,
                    0x1a797b5ecaf38990,
                    0x18446f2f0c37378c,
                ])),
                Felt::new(BigInteger384([
                    0x96bc9fc0ae9f3004,
                    0x57879449eafb008e,
                    0x32f9e7a90bd69dfc,
                    0x4af819055f513050,
                    0x57473b93e7bc4620,
                    0x0339bca4d7232b89,
                ])),
                Felt::new(BigInteger384([
                    0xc44abd3128a2af69,
                    0x57c34310a5559b0c,
                    0xb1a6729c34fce5c4,
                    0x6abeb89cbd15bd6c,
                    0x52ed3b1e86e43d6a,
                    0x03996a7d6c2e1994,
                ])),
                Felt::new(BigInteger384([
                    0xf9f5f1986eb18a0b,
                    0x9f0cf342f03d2a05,
                    0xd91e976149528a7c,
                    0xbce803f6d2a1575c,
                    0xb19be27e5aa41760,
                    0x0d803425f7164749,
                ])),
                Felt::new(BigInteger384([
                    0x34246ff12cac9271,
                    0x69a4ccace910ff2a,
                    0xaf8b1ef187e5f22a,
                    0xd7dcfdf67f83aa0f,
                    0xb11df9fda9f8997b,
                    0x1267987347368249,
                ])),
                Felt::new(BigInteger384([
                    0x8a9e06a7f16e354f,
                    0x372028f4b3234c81,
                    0x2af44433e4f0cee8,
                    0xc71fac2093e3f327,
                    0x69ba8cf0cc145b0d,
                    0x0468affdb5ec44a3,
                ])),
                Felt::new(BigInteger384([
                    0x01eb3a7021382f9d,
                    0xda3cb0efc6a12b26,
                    0x92f3775e03b04d80,
                    0x4157ed64cdc98461,
                    0x9ca0a4cbd8c33541,
                    0x193e56c5319a217a,
                ])),
                Felt::new(BigInteger384([
                    0xf020109f7ce4e30a,
                    0x4563bb2ae36d6f25,
                    0xe6b75b51800f7fff,
                    0xaa2574e721ae5b7f,
                    0x9432666170104867,
                    0x19f3084e8b5e2cd9,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xb412dcb3b31d9c5c,
                    0x0378fd58cbdd0448,
                    0xdd290dfe36a58ed0,
                    0x309a64015d815751,
                    0xf4f36d7501d88aaa,
                    0x12f1c6a818ea042f,
                ])),
                Felt::new(BigInteger384([
                    0xf5ddab046460a9f9,
                    0x98d6292dda2f6c35,
                    0x45590abcf77e0800,
                    0x947b1d32362de13f,
                    0x7c5d6b0bb2cd8a57,
                    0x191637d46c2786e4,
                ])),
                Felt::new(BigInteger384([
                    0x5fada6765eadf741,
                    0x810e66cd67cc610a,
                    0x68373e0f1fae6983,
                    0xa1aa85c3d1efb8d5,
                    0x3d7477f7e5019d8f,
                    0x0b5c7ca0f4662a42,
                ])),
                Felt::new(BigInteger384([
                    0xf4f1deead12cd2cd,
                    0x8a75fa3487df956b,
                    0x319113b0be0ef97b,
                    0x107463611aa122a6,
                    0xbdb80a3f11801fac,
                    0x0259744d052b914b,
                ])),
                Felt::new(BigInteger384([
                    0x2e7b69b460a8bb07,
                    0x3b02cd79d2eb690e,
                    0xef57e411f510f09a,
                    0xfd34c7b2ca4afffb,
                    0x050b43ff25a83bc7,
                    0x12c35ca5a2e0a942,
                ])),
                Felt::new(BigInteger384([
                    0x14657955698975ad,
                    0x1f788564367d36ab,
                    0xf970730b02ac3657,
                    0x058b8e4097584e6c,
                    0x40420064d95c4a2d,
                    0x09858e3e7b11712f,
                ])),
                Felt::new(BigInteger384([
                    0x69e03e2e45df115c,
                    0x4732729dcc32a52e,
                    0x0707369a0c8c6e41,
                    0x4909206880d72d02,
                    0x0319e7fc0a8192fb,
                    0x0ab87b9fef8032b7,
                ])),
                Felt::new(BigInteger384([
                    0x1ddc6f8ae460b82b,
                    0x02cbdf7ca53eac33,
                    0xf1a7698b0944dfe4,
                    0xc9afb7978ea3e2e3,
                    0x1572438fd4efd8dc,
                    0x0ae147d67c784cb4,
                ])),
                Felt::new(BigInteger384([
                    0x5b38772ca0b4a7ec,
                    0x13ae2be601e26ca4,
                    0xacb232deabffec6f,
                    0x135f601d2a5c6f5f,
                    0x327132488f28a47c,
                    0x017a265399aae7db,
                ])),
                Felt::new(BigInteger384([
                    0x1c2460ca1673074e,
                    0x2287b37767e3f70d,
                    0x54b623288cb7cd49,
                    0xfcece8732798ac15,
                    0x44b230ddc95269ec,
                    0x044fbdf7873a1db8,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x6c738806fbcc08f5,
                    0x338509ce287ad98a,
                    0xba53c50bc8e2a5cc,
                    0xbc412f7c05821809,
                    0x3ab33685c1fc9f51,
                    0x19425ec60e92fe4e,
                ])),
                Felt::new(BigInteger384([
                    0x3811c3d6a6c59851,
                    0x54e2e5059a53b223,
                    0xfe232c68ecb70528,
                    0x938b581e9cba58b3,
                    0x3d82c7cf918a231d,
                    0x17dbf6534238a552,
                ])),
                Felt::new(BigInteger384([
                    0xf3737bcb4bdf116b,
                    0x5f06081aa73bab88,
                    0x663bc56012bc76da,
                    0x8d3de490e70db15d,
                    0x46329d8b4cc71a0a,
                    0x134bf59aef5c8c3c,
                ])),
                Felt::new(BigInteger384([
                    0x0bfb3335394a220c,
                    0x6449cc7ba19b083a,
                    0xa7799b69951d0581,
                    0xebff04569b319b03,
                    0x1ef555f6d7fc51dd,
                    0x01de7fcdef3476a8,
                ])),
                Felt::new(BigInteger384([
                    0x0039cb4b4c5b10fb,
                    0x43fab2d8d31dcd10,
                    0xec9330df1fe17492,
                    0x1ff309862301916e,
                    0xa3356e08f24b38af,
                    0x0225ddef14b54071,
                ])),
                Felt::new(BigInteger384([
                    0x7911abb3d43ade08,
                    0x3e36ef7c60831260,
                    0x7dfaf8523e1322c2,
                    0x039b5d37404bdcab,
                    0x5d9cdad9d5eecd9f,
                    0x0b9f5023feaae92a,
                ])),
                Felt::new(BigInteger384([
                    0xfff2e1b600681c56,
                    0x7980b1f5fb9452ec,
                    0x36942631968002ef,
                    0xd15275876ea0de63,
                    0xa6385abbf2187fa7,
                    0x128dbe7500ca4924,
                ])),
                Felt::new(BigInteger384([
                    0xd1fab04c19ba9458,
                    0x1cd96091994862cf,
                    0x823889ea5897fdb3,
                    0xa88e07406a752577,
                    0xecaf6294f67c86fc,
                    0x095ccd588c585ea3,
                ])),
                Felt::new(BigInteger384([
                    0x71f38a38992a7dce,
                    0xdd8bdafe526bc684,
                    0xe5aeaa6760036035,
                    0x833a52049b6d8be8,
                    0xbf8d7859e1b2018a,
                    0x02b900652af850f2,
                ])),
                Felt::new(BigInteger384([
                    0x5a7e6fef855618b5,
                    0x0ffc60eeb7617872,
                    0x39aa72d3e5e6068f,
                    0x9e9d4b5c052a8cbe,
                    0xaf4c96962c325aa6,
                    0x19e02bb6c1576690,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xb60bcea717cb821d,
                    0x24aff72358919c95,
                    0x6b467c623ba25335,
                    0xfd0d83d991b467e1,
                    0x3208f06884ed2c69,
                    0x16679104a73501cb,
                ])),
                Felt::new(BigInteger384([
                    0x2a921c4cc170d35d,
                    0xed5f8a8ad81200c2,
                    0xa39c149a6b3cf405,
                    0x52983109db7ecb67,
                    0x3df1ceb952c4dbdb,
                    0x175a21c022db2022,
                ])),
                Felt::new(BigInteger384([
                    0xb4f874049b4757c6,
                    0xa2a7108131e812fb,
                    0x3c0b5223566c7836,
                    0x5866bb7b6c15f617,
                    0x2d65feb1ec5eb006,
                    0x15b9eec4eb069a32,
                ])),
                Felt::new(BigInteger384([
                    0x19d98d9112f97723,
                    0x90b48bc06ff0bcc7,
                    0xb243fb76f7651e69,
                    0xaa88b1d77fcc7fbd,
                    0xbd32f37ce0107b63,
                    0x06dc0ae660e0b84b,
                ])),
                Felt::new(BigInteger384([
                    0x1cc872949aac3dbc,
                    0x15018890c3bab4a2,
                    0x865571694966bed3,
                    0x86407a7ac7ec10ae,
                    0x00227fd10c59b73c,
                    0x0220fe814bd1e8e5,
                ])),
                Felt::new(BigInteger384([
                    0xa13569c02adbb636,
                    0xada3e5a56d9ae757,
                    0x2b151a3ac6cf1f32,
                    0xd15e51cdc91dce87,
                    0x2c14e9a5595becfe,
                    0x0e1c51cd9b2005c7,
                ])),
                Felt::new(BigInteger384([
                    0xe1da563406fd9bca,
                    0x501759d27b6bd0e1,
                    0x82a93e9966b87fa7,
                    0x36fbbacc5d8620b2,
                    0xd2e7d6f060060efd,
                    0x0c4ed391134c7fbf,
                ])),
                Felt::new(BigInteger384([
                    0x865a64c69057a7f6,
                    0x6d77d9e8e0fc6e08,
                    0x657312e77c204808,
                    0x7dc75b39f7e623de,
                    0x4ea75fa77ac4ee79,
                    0x064a767de50f5c35,
                ])),
                Felt::new(BigInteger384([
                    0x075b2539388e2f58,
                    0x19d7c1205cb6dbbe,
                    0x81797dc00d658c27,
                    0xbe1dc877b8a05416,
                    0xb3ad55fef1886042,
                    0x06312ebd5430a5df,
                ])),
                Felt::new(BigInteger384([
                    0x6ef0e3bb57ec0c48,
                    0x6c1fec7d1f0a381a,
                    0x8e0cfea8a1e26f2f,
                    0x1e3f2ba594909e06,
                    0x81b5a296e5995128,
                    0x163a4373b008c74d,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xc1b1d92338038480,
                    0x6318bce034811583,
                    0xcfe3e1efadd07a69,
                    0xe00aa73c5f13a789,
                    0x0babe81a47d663df,
                    0x15193d50f0e96806,
                ])),
                Felt::new(BigInteger384([
                    0xf6d9295506ff293d,
                    0x78193d9e89feb98c,
                    0xb44689fc6b4620c1,
                    0x0e69bfbec114be1e,
                    0x3942f1581c9c8d30,
                    0x05827af08f390273,
                ])),
                Felt::new(BigInteger384([
                    0x3df98e495bd363df,
                    0xc463873d5eb58139,
                    0x8ce7d68533593889,
                    0xdf9b5eb1a451c523,
                    0xf26b495f7587e063,
                    0x02942b6b2fb6ac2c,
                ])),
                Felt::new(BigInteger384([
                    0xdce42c7bc0f72c1b,
                    0x81e07e21ed45cbca,
                    0xc1befda3867cedcf,
                    0xf0953f1e13c46c46,
                    0xb913d5de5f62bd6a,
                    0x00f14ccd57befbf0,
                ])),
                Felt::new(BigInteger384([
                    0xf24b65efb8d7d9c9,
                    0xdb87f149690d7f89,
                    0xcef47c720259bf2e,
                    0xd8965ded5f8210d1,
                    0x97fe443e3ef77396,
                    0x18e3b69d39ae102b,
                ])),
                Felt::new(BigInteger384([
                    0xba30065c74c64c58,
                    0x434e02b78556c83c,
                    0x171245412692b57b,
                    0x3b7a6ccf1ca21c05,
                    0xdc935aa98b44b1b0,
                    0x07014104212f9db1,
                ])),
                Felt::new(BigInteger384([
                    0xfcbde885d1499f95,
                    0x6232aadc24262e3b,
                    0xaab71e809ceef5b3,
                    0xf88f9db8cd256a4c,
                    0xe41e8ea5fa0192fc,
                    0x0f354590860e8775,
                ])),
                Felt::new(BigInteger384([
                    0x8b56c70866ecebc8,
                    0xcfa8f6ed5f2ae161,
                    0xf6363014157823ea,
                    0xaa74bad7e0e5e008,
                    0x54e7e5c951590063,
                    0x19c1e3484e10a429,
                ])),
                Felt::new(BigInteger384([
                    0xd7c161095bb0d90c,
                    0xf2f7120ae70ae1eb,
                    0x383a43653b140c82,
                    0x6ba4ef03d0ed0853,
                    0xee02af7c4df5e197,
                    0x08b896f0a3751e77,
                ])),
                Felt::new(BigInteger384([
                    0xda594c246f13b399,
                    0x8df467122ed76307,
                    0xf3b340332ed157de,
                    0x6d7a1eed92808d2f,
                    0x0beb62de242903c7,
                    0x0c0016a190faebfa,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xabf8e7263476b5d3,
                    0x563b44377c70c08e,
                    0x86cd3c411cd57b57,
                    0x56272d1139ae4aeb,
                    0x27ec843a96977bfe,
                    0x02978eb9accf86ac,
                ])),
                Felt::new(BigInteger384([
                    0xfecea79123c66ae2,
                    0xa98c502911b0338a,
                    0x4bb857f309f353ac,
                    0x04f25c5efd471f2e,
                    0xee4882f62d47a38e,
                    0x17c37a02d25d2382,
                ])),
                Felt::new(BigInteger384([
                    0x44c68015e5830492,
                    0x186c78fd71dae7fa,
                    0xaba5119abaf4c9a2,
                    0x7d035f1ccedc7d2e,
                    0x657ddd8238f66abe,
                    0x199dcee6c96c04b5,
                ])),
                Felt::new(BigInteger384([
                    0x3e2bb617f708a395,
                    0xf1c92e311de86b87,
                    0x84ecf8abe5dd57cf,
                    0x3a38b2b33bd7228f,
                    0x21f4acf5775d8efd,
                    0x12667afc46048819,
                ])),
                Felt::new(BigInteger384([
                    0xe2860660effd9cb1,
                    0xbd8e609b3f90983a,
                    0x4c7bfa4f4c4a3782,
                    0x1f0c2c69035b9579,
                    0x1095468618c3d107,
                    0x073b3cf17832cb0f,
                ])),
                Felt::new(BigInteger384([
                    0x5bff818e90b9e89d,
                    0x765fac87c265e487,
                    0x75a081ff2a4cb4e1,
                    0x7121cb0695cb2eda,
                    0x10e3786aa71adf83,
                    0x091928afb4e68167,
                ])),
                Felt::new(BigInteger384([
                    0x5c3a90d58b8097ab,
                    0xc55a69ddf11fb1c0,
                    0x02ec1285e24d9924,
                    0xd2915a96c794bda5,
                    0x6e0c413f9f43bc03,
                    0x12e6ac13f7bf9bf5,
                ])),
                Felt::new(BigInteger384([
                    0xd0149c4cc76a2431,
                    0x415b4045dbba0ac6,
                    0xee8803c293911b6d,
                    0x0cc7d181c448b931,
                    0x52174d950aff2517,
                    0x0f03d141f4fb4d0f,
                ])),
                Felt::new(BigInteger384([
                    0xd3718b714cbec9ef,
                    0x06087b7b6987380f,
                    0xdab027c9489f6323,
                    0x531af77a1f1b6eb3,
                    0x38ad5c3269067b2b,
                    0x0b86554e1611b568,
                ])),
                Felt::new(BigInteger384([
                    0xb1fa45fd787cf279,
                    0xc35e44e3d4271d5f,
                    0xe99fdc23392295cb,
                    0x703c078ade6b7006,
                    0x99b07a36cb336a87,
                    0x03510e8a0c514161,
                ])),
            ],
        ];

        let output_data = [
            [Felt::new(BigInteger384([
                0x8b6553f7fd34dde1,
                0x3b2d836ab078091e,
                0xa60778591f9643ec,
                0xc7a2d8229dbb4e1c,
                0xaf8f1ba7a7915a52,
                0x12ce882071dbebf1,
            ]))],
            [Felt::new(BigInteger384([
                0xd2288d1787d12a7f,
                0x0978ae52d5a8a67e,
                0x853bd2160ce4b737,
                0xe408a5027092f01a,
                0x995f6331c7bab8a9,
                0x149d61b926125968,
            ]))],
            [Felt::new(BigInteger384([
                0x05821adf244b14b3,
                0x126da75503668c75,
                0x688ce69f390bbeda,
                0xcda5ea87422cb656,
                0x69a957524bc6faa0,
                0x17f6d901277930e6,
            ]))],
            [Felt::new(BigInteger384([
                0x26d7cc4131680230,
                0x4a495b1bde90ad83,
                0x6705cdb6f558b726,
                0xf2caa3d173dc4a8f,
                0xdd0a29abdca51e90,
                0x14915be6b86b65f9,
            ]))],
            [Felt::new(BigInteger384([
                0x75d40d4313357331,
                0x5d0908e67f983023,
                0xa1273610c4820040,
                0xdbad70936c43962c,
                0x2ad37ec74fe00d60,
                0x011961d9663aa9ea,
            ]))],
            [Felt::new(BigInteger384([
                0xf7132fd16d422be1,
                0x22ccc795fa93346a,
                0xdf35a706d03c37a6,
                0xad7e617aecb3f82b,
                0x8c80a947d435f665,
                0x17de3641095228cb,
            ]))],
            [Felt::new(BigInteger384([
                0x026eb25134baa105,
                0x4ce0f23b68dee81e,
                0xc80746d5da9b36e9,
                0xe9d37414b7a6a176,
                0x52bc27a5c2075465,
                0x00eae69d42d603f8,
            ]))],
            [Felt::new(BigInteger384([
                0x6d05371b5292bb30,
                0x823ef6bf387ea74c,
                0x6f25d6d2d052b0c4,
                0x9deed01f056e1799,
                0x6584baaf3ead7f3a,
                0x11d5300436b54ab3,
            ]))],
            [Felt::new(BigInteger384([
                0x9217a0bfc5202db9,
                0x1bc9cf1755d20d3a,
                0x65fc9bbe3c51ec8f,
                0x5303fee89994d8d4,
                0xe3c2fbcb6087d576,
                0x0914b9f0e2755c92,
            ]))],
            [Felt::new(BigInteger384([
                0xb187755b782b31c6,
                0x1645d72b87c8ab34,
                0xe1c962bab11a55c2,
                0x79e63b92f738bc43,
                0xf728dc34a147ed22,
                0x068a5c9e59654a8f,
            ]))],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 10));
        }
    }
}
