//! Implementation of the Anemoi permutation

use super::{mul_by_generator, sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 10 field elements or 480 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 10;
/// 9 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 9;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 5;

/// 1 element (48-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= mul_by_generator(&y2);
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += mul_by_generator(&y2) + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4]];
    let y: [Felt; NUM_COLUMNS] = [state[6], state[7], state[8], state[9], state[5]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4];
    state[0] = sum_coeffs + x[3] + (x[2] + x[3] + x[4].double()).double();
    state[1] = sum_coeffs + x[4] + (x[3] + x[4] + x[0].double()).double();
    state[2] = sum_coeffs + x[0] + (x[4] + x[0] + x[1].double()).double();
    state[3] = sum_coeffs + x[1] + (x[0] + x[1] + x[2].double()).double();
    state[4] = sum_coeffs + x[2] + (x[1] + x[2] + x[3].double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4];
    state[5] = sum_coeffs + y[3] + (y[2] + y[3] + y[4].double()).double();
    state[6] = sum_coeffs + y[4] + (y[3] + y[4] + y[0].double()).double();
    state[7] = sum_coeffs + y[0] + (y[4] + y[0] + y[1].double()).double();
    state[8] = sum_coeffs + y[1] + (y[0] + y[1] + y[2].double()).double();
    state[9] = sum_coeffs + y[2] + (y[1] + y[2] + y[3].double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies an Anemoi permutation to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Applies an Anemoi round to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let mut input = [
            [Felt::zero(); 10],
            [Felt::one(); 10],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x5be2bf7c22741690,
                    0x0873102bf800360f,
                    0xed4b38099ff33a86,
                    0xcd6c8ec798ae763f,
                    0x1f851bbd796ca4e7,
                    0x0aa7041b1a80c962,
                ])),
                Felt::new(BigInteger384([
                    0x13db3c86a613a6d1,
                    0xc85a7f9a153f6f6d,
                    0x1a35ba84d028ec03,
                    0x255c1315fc33d9c1,
                    0xd95220e9801c583d,
                    0x0bd2c20dc13b8754,
                ])),
                Felt::new(BigInteger384([
                    0x0e958102049ae725,
                    0x5b4da880b89de29d,
                    0x6647ee2adb01c027,
                    0x44ba1e2d4f0c6f82,
                    0xcfa6f367dd006415,
                    0x193d0a35138a5870,
                ])),
                Felt::new(BigInteger384([
                    0x308df6690dd76d7c,
                    0x5eaade99f222809d,
                    0x7523d4b98156f819,
                    0xbbe3874f2db7f467,
                    0x6ef0d5a7984165c0,
                    0x13a19145ddc25ae4,
                ])),
                Felt::new(BigInteger384([
                    0xcbff9a02d49436dc,
                    0x405c5c7df1c80336,
                    0xc7a5fc3fe8f509a3,
                    0x5507441fa123bbcb,
                    0x11014864d9c18ffb,
                    0x13589cd2180300e7,
                ])),
                Felt::new(BigInteger384([
                    0xe4d5016237265387,
                    0xc872f5adfcbf3b71,
                    0x0ab45fba0cfc6af7,
                    0xbd48418cebf9a05d,
                    0xf776aba048389556,
                    0x03912daaabe86397,
                ])),
                Felt::new(BigInteger384([
                    0x439626e6b51e867b,
                    0xab32690b9c06ba43,
                    0xce4a777a04781dce,
                    0x9dfa9fbba0ab1c26,
                    0xd1b915e9d5f75bbe,
                    0x16af4e6f8edee1c3,
                ])),
                Felt::new(BigInteger384([
                    0x9b8d3995cc9f0866,
                    0x77ee7e68ab54da52,
                    0x0fffd37e740184c8,
                    0x0ee044ed4ffad6db,
                    0x3c56dc54cf08637c,
                    0x1992ca8edcd8748f,
                ])),
                Felt::new(BigInteger384([
                    0x820e9ae8d056033c,
                    0x22148ea3eaa68acc,
                    0x9eece390942f6252,
                    0xb0245ecf6250f2a7,
                    0xe10c77343eb9051b,
                    0x04a19d9324e2d57c,
                ])),
                Felt::new(BigInteger384([
                    0xe7090dcd21a5d3a3,
                    0xb73ebb733f42ed7c,
                    0x05ab26aec05095c0,
                    0xeefd4f4471fca3ea,
                    0xb17ac15d20516573,
                    0x1269612dad6087d8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xbb9d496a853ae371,
                    0x27a8c918d118c769,
                    0x01f51c62b389478c,
                    0xb191429a4f2c1026,
                    0xb54588c1440c72a6,
                    0x0a2014bdeb700f56,
                ])),
                Felt::new(BigInteger384([
                    0x4e37cfb07a0fd31e,
                    0xdcf806243a346df6,
                    0xe1a24b4394ff0d61,
                    0x09c83b0c0aa3db5a,
                    0x24933a5749d7c6d7,
                    0x11efcaa6d8823440,
                ])),
                Felt::new(BigInteger384([
                    0x101881b1bf460da2,
                    0x987461bb06f80f24,
                    0x9ff33692613e1662,
                    0xcd3fdd28bbc0e472,
                    0x8ef47e619ed9cc24,
                    0x110345a6716dbb0f,
                ])),
                Felt::new(BigInteger384([
                    0x88cbfdaa4501d422,
                    0xed014637bedb12bf,
                    0x5c2f41e2b1a63f26,
                    0xf0903d6d4970f34d,
                    0x8172a03bd6b64934,
                    0x1662039a2d66648b,
                ])),
                Felt::new(BigInteger384([
                    0x0095173e501ac487,
                    0x3c3dbe66e8f36327,
                    0xf53e85eba87418e0,
                    0x7014f006cc6e7b08,
                    0x1301cb663fbc734c,
                    0x10fd277161d06da3,
                ])),
                Felt::new(BigInteger384([
                    0xb39eba61bb12d7d1,
                    0xee32f232d46a979f,
                    0xe1feb295bcd3e68d,
                    0x105127d8eecc856d,
                    0x7abe3d13f85ab64c,
                    0x1065e72f55edc009,
                ])),
                Felt::new(BigInteger384([
                    0x77d5b08268d46456,
                    0x71618263f582423e,
                    0x2d8ebf712378308a,
                    0xae4deea87c603eda,
                    0x57c23a04183b3dc9,
                    0x17faa151e72e285e,
                ])),
                Felt::new(BigInteger384([
                    0x551552864d500d41,
                    0xd5e039944aefed0a,
                    0x9ba745248107dddc,
                    0x7bb4453deb539a5e,
                    0x0052dbc2e95bd1b5,
                    0x043615470ae62748,
                ])),
                Felt::new(BigInteger384([
                    0x03bc9a552cc97571,
                    0xbe13529a00e3744e,
                    0x5f4de411b1d764b8,
                    0xccb1175a72aae7f7,
                    0x978243d3b892f5ba,
                    0x0c44ec5f19b13d69,
                ])),
                Felt::new(BigInteger384([
                    0x1d32a615b9cbfd23,
                    0x9502caa283766a6f,
                    0x318862d0e5aceb65,
                    0x2720d53df324af26,
                    0x5696bfd6f428cbce,
                    0x009274ca488ccfda,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2a34270628b0eb5b,
                    0xf672cd70ac64743c,
                    0xa40d1b7509f69a34,
                    0x4304611e44ef77fd,
                    0x6d44e795a3007325,
                    0x04a4ef5d020ece61,
                ])),
                Felt::new(BigInteger384([
                    0xc3cece18b0812d22,
                    0x5f67052765dfc1bd,
                    0x41ad41d54a0b81de,
                    0x9f733fe0848630c3,
                    0x2b6f6726355c8182,
                    0x03bc8d7a6ff55507,
                ])),
                Felt::new(BigInteger384([
                    0xd30d5c208e57ef56,
                    0x76b93d6c8ddcac4f,
                    0xebc528803b4ffd6d,
                    0xb44c45c2a908710e,
                    0x421e7e4d92fed1e1,
                    0x020cf915c86c9399,
                ])),
                Felt::new(BigInteger384([
                    0x323d671d262a3d9a,
                    0x4632403bb3ebd47f,
                    0xc7fd021b50ea8e5f,
                    0x029ec63c55e69f48,
                    0x1babe1b893125fa2,
                    0x0b934c045e09c97a,
                ])),
                Felt::new(BigInteger384([
                    0x1ffceb386dc19a57,
                    0x3e5462bfc4060792,
                    0xa0f2d7f69af31871,
                    0x60806b4923e5e4c7,
                    0x05fa00c4c5870821,
                    0x16bf96df19ef2e58,
                ])),
                Felt::new(BigInteger384([
                    0xe6e4f6b2f5095479,
                    0x1dc6fd73004fcbf0,
                    0x83f43f2a85c348aa,
                    0x4298d9f19ab00130,
                    0x036573cf2a2b2c09,
                    0x01a3b547e26435bd,
                ])),
                Felt::new(BigInteger384([
                    0xe316289f41e23f59,
                    0xe4ffcd5b8b27e565,
                    0xe60b5697e54562d0,
                    0x1ad77440a0ddb057,
                    0x8f879f266305b423,
                    0x04d444916e53c15d,
                ])),
                Felt::new(BigInteger384([
                    0xe2f1455aeae718e4,
                    0x25812236f9bcc2b5,
                    0xba9b35f8c552163d,
                    0x77eb2335ca0bf3b9,
                    0x5974fe1644af2168,
                    0x1011d3a1651cabd1,
                ])),
                Felt::new(BigInteger384([
                    0xd524b7e652a4d217,
                    0xf1e888094edf8a2c,
                    0x17b26a7b08d46b0b,
                    0x29ee290533a08c49,
                    0x56d37730a13db554,
                    0x12d044a4da4dc4f0,
                ])),
                Felt::new(BigInteger384([
                    0x4ba22d81b6c966d5,
                    0x451f1a5368dc08b4,
                    0x6cd8f56e9ee31c91,
                    0x0d88046e53543479,
                    0xb58766411c4caafa,
                    0x054aa17f9877b7ff,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x89d7951ff6335059,
                    0xdc7b21253661e982,
                    0x1e8f8e22c66947a7,
                    0xb4bd5acaea1c837c,
                    0xc99a7211403496d7,
                    0x14ee19ad9fcc6212,
                ])),
                Felt::new(BigInteger384([
                    0x877b89e287239720,
                    0x4e63272bb8623933,
                    0x8a6fb7590674cf07,
                    0xf53ab925bb373e2e,
                    0x618d20bc9f977a60,
                    0x164f4197fa0c6cdb,
                ])),
                Felt::new(BigInteger384([
                    0x55e631f807067fd9,
                    0xe86e059e42e50d1d,
                    0x5de90cc9843b93fc,
                    0xad24b881f6123432,
                    0xe5f368d6524ee111,
                    0x11683655f139c450,
                ])),
                Felt::new(BigInteger384([
                    0x96e9a9a461066604,
                    0x2906ef9b49b3c240,
                    0x01f39808c55c6e05,
                    0xb4dce70605cb1f8b,
                    0xaca0458b6a9c3ef6,
                    0x14bed2682b6a706c,
                ])),
                Felt::new(BigInteger384([
                    0x0a074edef57b80cc,
                    0x498c03be6ecb841d,
                    0x400139c1bce399f8,
                    0xbdb2e27310a35139,
                    0x31caf858c3d6c32c,
                    0x19e263ede77001ae,
                ])),
                Felt::new(BigInteger384([
                    0xafe5cbdabdeb0200,
                    0xa968fb78bc25e8fe,
                    0xf2b267ca643e7f0e,
                    0x764f33a1221d5306,
                    0x91b448652bea9cbf,
                    0x1497841afaae84c5,
                ])),
                Felt::new(BigInteger384([
                    0xcad6eab1a8b4bc41,
                    0x34516df43e44965b,
                    0x3f630dcc66600159,
                    0x76fdce4336aa900d,
                    0xb902c44862284640,
                    0x1522b4a63ad3c746,
                ])),
                Felt::new(BigInteger384([
                    0x6638e07c5c881151,
                    0x413ac221a8581bc7,
                    0x5fa8a45a113a83cb,
                    0x45f495a5d9f2f3ad,
                    0x6ce8f071b64de8f7,
                    0x172b20fe05e8c35e,
                ])),
                Felt::new(BigInteger384([
                    0x26855bf5efee8ae0,
                    0x8c0c5b724884ae44,
                    0xf0c9875ea4910213,
                    0xdceb0dc85cca67d3,
                    0xd2ec104548951391,
                    0x07d7c0d7315fdb46,
                ])),
                Felt::new(BigInteger384([
                    0x416cf19d624e3b3c,
                    0xd4e84696ed880d84,
                    0xa6fc3f1ac35c32f3,
                    0x5c0552c901311827,
                    0x1d8a812aa876f94c,
                    0x1659e88372d8e394,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x00af8a24ff9c15dc,
                    0x89d66243b093b512,
                    0xce4cdb9bcccde590,
                    0xf9d2febe82347eeb,
                    0x72df36f975fd7e79,
                    0x03e3cc7802af9913,
                ])),
                Felt::new(BigInteger384([
                    0x23591391f7ef4858,
                    0x3c945ab7f7dfac9b,
                    0x15e3f97438bfbc49,
                    0x38e08b7cc8f4b103,
                    0x70c180cb7305b9d1,
                    0x0f6c210ecc94a6f6,
                ])),
                Felt::new(BigInteger384([
                    0xe4fcad07ab33ec97,
                    0xe770fa4c1c5ce1e1,
                    0x1238149c252a7d6c,
                    0x10505e8252ea87cc,
                    0x15be6213674db328,
                    0x05a57e8a2c86a260,
                ])),
                Felt::new(BigInteger384([
                    0xf0fd501c8f92a45a,
                    0xb80b1fef59e519a6,
                    0x55e43a4f5a482cd2,
                    0xa203921868e9a9aa,
                    0x7b1a35268deced3c,
                    0x0f9aeee91488666e,
                ])),
                Felt::new(BigInteger384([
                    0x7f8e89743202a271,
                    0xc89e4f329bf9bebd,
                    0x9142ed3eaad75148,
                    0xb67149c96bbddef1,
                    0xe1d6ac0ecdf86206,
                    0x14568310221808fa,
                ])),
                Felt::new(BigInteger384([
                    0x5da287051639afbf,
                    0x505ddd0f31a820de,
                    0xae388484d961ede1,
                    0x0d3e19f26dbed83d,
                    0x2d018342cd936431,
                    0x07d11d0813b3db59,
                ])),
                Felt::new(BigInteger384([
                    0x12af98a53bbb9587,
                    0x09ed1a0a69516bed,
                    0x218a4a7b5d3b42b0,
                    0x037b87808f146ef9,
                    0xc33a32d78d31d519,
                    0x0b31da86f3ec10d8,
                ])),
                Felt::new(BigInteger384([
                    0xd9a62bc29921d57a,
                    0x22195f644a25c309,
                    0xd6d3c82228f9fba5,
                    0x78c04a975a32e6af,
                    0xbea1ae641a3e8e72,
                    0x03d479247641b58a,
                ])),
                Felt::new(BigInteger384([
                    0x4e5fa7989ae2729c,
                    0x94052594cec76e95,
                    0x1be619a2810fc1ce,
                    0xfd55504bca4192e4,
                    0x8c38b274ff7dd756,
                    0x0c6e7193af822cb5,
                ])),
                Felt::new(BigInteger384([
                    0xb35dde43ddfc9c7e,
                    0xe28ca6fac0cbf378,
                    0x26874347a54b2dfc,
                    0x88b0c57ef3bb68bf,
                    0xedf759b0497e65fb,
                    0x07c347e738981410,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xfecf24b43204509c,
                    0x45d2a10bcadcba57,
                    0xb75eed719fed56e9,
                    0x90129b3b7bf70f56,
                    0xff0ee1b60a2f7504,
                    0x0be579f7588d6537,
                ])),
                Felt::new(BigInteger384([
                    0x4d2cba9efb5105f8,
                    0xec71447dae5cef87,
                    0x968ab0c4a65af92c,
                    0x079c7f7e21f1f4be,
                    0x975f96303e2b6136,
                    0x14c3ae775d3090be,
                ])),
                Felt::new(BigInteger384([
                    0x302a04435121b29b,
                    0xb1aa58869263bb3d,
                    0x4cee0d91cdfb9efb,
                    0x451a6b301e024e4d,
                    0x58fcb90b56478a92,
                    0x0c2ae1c251776981,
                ])),
                Felt::new(BigInteger384([
                    0x71d16fac76e33239,
                    0x7a535cd2de46384c,
                    0x81876613596c5ed1,
                    0xb9b6f181efec6531,
                    0x108678d067f63fb3,
                    0x03b4e0742d9574b0,
                ])),
                Felt::new(BigInteger384([
                    0x5a9020e8405a4e0b,
                    0x7f6ed7e9ca193b0b,
                    0xe085980271c267ea,
                    0x2e21ec6ceccd19b5,
                    0x47cab01933734702,
                    0x19354fe7b7a70f27,
                ])),
                Felt::new(BigInteger384([
                    0xa492ce85cb75256f,
                    0x11927a90ada94bcf,
                    0xde157ea2b68f9592,
                    0xfa33e5c3beb70b5b,
                    0x8ba2a062d7b259f9,
                    0x0748a77442ba614c,
                ])),
                Felt::new(BigInteger384([
                    0xd8f25ef275f6fb8f,
                    0x060e3084996d90e0,
                    0x4badcd439a83f76e,
                    0x12098b1293db4062,
                    0x723e8d7ec2384d73,
                    0x14f5114786f75b68,
                ])),
                Felt::new(BigInteger384([
                    0x8edb68464171b0b1,
                    0x923edc811ca9141d,
                    0x7703eb6d26700bdc,
                    0xe68df6afa795e4c7,
                    0xde7e2a1d14f2dc4b,
                    0x110772154d6c40b5,
                ])),
                Felt::new(BigInteger384([
                    0x166ec281c39bfc70,
                    0xb76fb3f1e78891f4,
                    0x59f6209d023a4bf7,
                    0x6399b7bb8b69cc52,
                    0xbc0ad6f947f2c793,
                    0x04b01415179128f7,
                ])),
                Felt::new(BigInteger384([
                    0x71e173e2b289b5b0,
                    0xe12b23b32b2b5cc8,
                    0x8cadc328386466e3,
                    0x7c685758ccd257dd,
                    0x9fdb1084d5a1ba1a,
                    0x16d036a1dd35b135,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::new(BigInteger384([
                    0x1804000000015554,
                    0x855000053ab00001,
                    0x633cb57c253c276f,
                    0x6e22d1ec31ebb502,
                    0xd3916126f2d14ca2,
                    0x17fbb8571a006596,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0xf64900000018553d,
                    0x40f4005f6f0c0013,
                    0x9313f019a789cfb3,
                    0x59fb77168f0da76b,
                    0x951d2d06cf6bb694,
                    0x15b1e4359a873e00,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
                Felt::new(BigInteger384([
                    0x321300000006554f,
                    0xb93c0018d6c40005,
                    0x57605e0db0ddbb51,
                    0x8b256521ed1f9bcb,
                    0x6cf28d7901622c03,
                    0x11ebab9dbb81e28c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x221a96dee879506e,
                    0xf474857d61fd8d8e,
                    0x0cb62c7142732926,
                    0xdab2c2b279e8e05a,
                    0x66bfd291dacd2598,
                    0x14a7b8b22c4d8158,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
                Felt::new(BigInteger384([
                    0x8501827008bb463c,
                    0xe000d5f0f9385e8d,
                    0x651c1aea973d56a5,
                    0xc16f501811680aeb,
                    0xbd0d7da3633e27ed,
                    0x100d54ca211c6624,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x4c220000000b554a,
                    0xed28002c72d80009,
                    0x4b84069f3c7f4f33,
                    0xa827f857a8538294,
                    0x0653b9cb0ff30b64,
                    0x0bdb9ee45d035f82,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
                Felt::new(BigInteger384([
                    0x43f5fffffffcaaae,
                    0x32b7fff2ed47fffd,
                    0x07e83a49a2e99d69,
                    0xeca8f3318332bb7a,
                    0xef148d1ea0f4c069,
                    0x040ab3263eff0206,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xaea0f733cdfe0b1f,
                    0x0eeec1a220f3e192,
                    0x180ac8893c5bccf5,
                    0x59aa030121006faf,
                    0xe65e555f2ebec634,
                    0x01f1f264dadca600,
                ])),
                Felt::new(BigInteger384([
                    0x8a8cc02e82e836b8,
                    0xb7312aab57016493,
                    0xe2e573c8c507d275,
                    0x41b136d184a98ce7,
                    0xa3edac544fc98279,
                    0x03726ae1582f9a82,
                ])),
                Felt::new(BigInteger384([
                    0x7781214ab13d9091,
                    0xd3d10d01960e5f34,
                    0xd23307556f2f7562,
                    0xb2616c85faebb304,
                    0xfeae7a01a6d77406,
                    0x0e62cb54f8b59338,
                ])),
                Felt::new(BigInteger384([
                    0x235f425b4e631a00,
                    0xd5c79a4306477e08,
                    0x32236d5cf042e6a4,
                    0x25934f777ba1732b,
                    0xe16af70821fc9d3e,
                    0x17db857a1b69f328,
                ])),
                Felt::new(BigInteger384([
                    0x6f2ce0e017d2cf70,
                    0x1483b83384b0c7cb,
                    0x293fdc3b32841d82,
                    0x249def875d01f2b0,
                    0xc8b68c40e112c02b,
                    0x0d6c130356ebb92c,
                ])),
                Felt::new(BigInteger384([
                    0x90fe93f479a5b1b2,
                    0x20f1f4a3016a3331,
                    0x11b9deb0301a32dd,
                    0x02da596aa9ae40e8,
                    0x466b67b49f82b63f,
                    0x13009f985512ad97,
                ])),
                Felt::new(BigInteger384([
                    0xe5d511502c138012,
                    0xc8a81c3b06614cd7,
                    0x067f88ab28466f7e,
                    0xb5c5e2d3df1c194f,
                    0xac729cf81bac05ad,
                    0x0dd83a2c694cc5da,
                ])),
                Felt::new(BigInteger384([
                    0xb20bc8ea35abcf54,
                    0xbbe05458c1e6433d,
                    0x904163cf38e0db6a,
                    0x67a314ffbe6b7177,
                    0xe9c616b7c20f8d3f,
                    0x007e2c59e0b7144b,
                ])),
                Felt::new(BigInteger384([
                    0x7222ba88fab896bd,
                    0x499ce343ff8e212e,
                    0xa27c4bfecef62945,
                    0xb1dda3f19640de47,
                    0x05a550b27d898ada,
                    0x023e2f173ee9a724,
                ])),
                Felt::new(BigInteger384([
                    0x400ad307f2f54292,
                    0x10122d3ac1447499,
                    0x17cb439566bc530a,
                    0xf5d8d68019bd33ed,
                    0xb82076070691213e,
                    0x0e0d91143420f97a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x6ab29b8eb7d6bdbf,
                    0x22bd962a5ef438c6,
                    0x4b41cb08b965e750,
                    0x36618bdeb0a9c8b8,
                    0xec3c689ed415b619,
                    0x024e7253eb52a987,
                ])),
                Felt::new(BigInteger384([
                    0xfe69274329891e1f,
                    0x253aabf230295895,
                    0x67c8b85a3f89c999,
                    0xd3952a4a838f9eae,
                    0x22a17ca12daae7bf,
                    0x0d758dcedb13ead7,
                ])),
                Felt::new(BigInteger384([
                    0x08cf311bff7c7734,
                    0xc95535fe9911682a,
                    0xb364988f598ce7e7,
                    0x2b194dbfa81e581e,
                    0x7ae38a550757191b,
                    0x0f52b21e8ee898b5,
                ])),
                Felt::new(BigInteger384([
                    0x11f576b5522ed20c,
                    0x425d602c0b87f03d,
                    0x1ef58a0cc6c4a9ed,
                    0xeab844bdc64839a3,
                    0xaeed1dfab285b422,
                    0x070a0ed498d11c15,
                ])),
                Felt::new(BigInteger384([
                    0xbfa25d8f045afdae,
                    0xc80ebf1d9b0c3847,
                    0x1889bcd54e0fe32c,
                    0x2e4de571a32f0997,
                    0xb0fa418ddb58bd89,
                    0x00de2887a8c61d29,
                ])),
                Felt::new(BigInteger384([
                    0x8b3b03cd88076eaf,
                    0xee1b4259a52f5ae2,
                    0x75fedafe4e3005c4,
                    0xb0ae83c974ecb1e2,
                    0x3babd2dd65a24ac8,
                    0x113cace29deaba99,
                ])),
                Felt::new(BigInteger384([
                    0x72523831eaf21c7c,
                    0xfe1181550100d73d,
                    0xe67e94122fd0d0b3,
                    0x11e9fb120b7cda77,
                    0xd9b7434b2c3e191f,
                    0x196e9236ae3a4bd0,
                ])),
                Felt::new(BigInteger384([
                    0x8f1ba46042e73228,
                    0x006b6388d6fd4e89,
                    0x0f0b4a56b8e46638,
                    0x8fb16811be6cbfe6,
                    0xcf26109a3d3c09df,
                    0x0fe7b444a8acb3fa,
                ])),
                Felt::new(BigInteger384([
                    0xe646f2d7511a1aa0,
                    0xf8063863da4be287,
                    0x52aaa96049fd48d4,
                    0x42db15dbd5c99311,
                    0xfdc62c437e067ed6,
                    0x15716568c91c6e13,
                ])),
                Felt::new(BigInteger384([
                    0xc0adc44aafd62841,
                    0xcf33c59c2eeb934e,
                    0xc8dbd7e33c5bbdaf,
                    0x6099e75ed43e2cd5,
                    0x3cb870e8e6b645b2,
                    0x03f747f22806bfc2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x59cbd329f94d7c29,
                    0xa5cebe08e35e1d91,
                    0x77fef9024243f6d0,
                    0xf944127ffa70edca,
                    0x18c3080a7d449052,
                    0x19f463f57cc2cdfb,
                ])),
                Felt::new(BigInteger384([
                    0x482bf9582c1d398b,
                    0x1ea1b551d8f95c79,
                    0x797581cc4857889c,
                    0xf651879caad33637,
                    0x8f71619e9d0f40f7,
                    0x098c5d05ea188188,
                ])),
                Felt::new(BigInteger384([
                    0x326802d12bd30461,
                    0x00243bd2473d65e1,
                    0xa6e753c75c7d98fd,
                    0x98d6954bc050e91c,
                    0xd06173bc6ff17786,
                    0x0af1f87fbad91dcb,
                ])),
                Felt::new(BigInteger384([
                    0xba68b7966dda3101,
                    0x22749448750d8b66,
                    0x30a801be3b896113,
                    0x216050e37b9136c5,
                    0x04538edd576aef2e,
                    0x04c4faba8d0afa12,
                ])),
                Felt::new(BigInteger384([
                    0xd5b8082503dde223,
                    0xdae97b9ef069dfa4,
                    0x1ee02b88ecf7185f,
                    0xd28b385c374fcffd,
                    0xc29d7e741b444e63,
                    0x05ff51adb027d2bd,
                ])),
                Felt::new(BigInteger384([
                    0x70fc847448459005,
                    0xbdc1a881f58e9104,
                    0x04af207f550749cf,
                    0x4ee17d4f260f3391,
                    0x210a13c0b6864e4b,
                    0x003c4e6bf9be606a,
                ])),
                Felt::new(BigInteger384([
                    0xd51a34e25c3a3969,
                    0xa0e57e024e6b0335,
                    0xefe6f4d5f0e949e8,
                    0xb973860265f871a2,
                    0x58890beff87268b3,
                    0x191f7ff9ab9648b9,
                ])),
                Felt::new(BigInteger384([
                    0x0880d3084c8254df,
                    0x4a1cbe60ced503bf,
                    0x98e702a17a5ee494,
                    0x7bff74892ff17a44,
                    0x69c4c32ea33ba54a,
                    0x19be087814fb3533,
                ])),
                Felt::new(BigInteger384([
                    0x1e40293a8c2d4d2f,
                    0x13d6a0f131c7549a,
                    0xe93a001ddf070ffc,
                    0x6f75e68174c327ae,
                    0x8999850005faef71,
                    0x0257881d087d41ee,
                ])),
                Felt::new(BigInteger384([
                    0x9820de383d1a4094,
                    0xe99971694fcad934,
                    0xeebfa02fbb17e328,
                    0x7c43724ba8c1a2a1,
                    0x976ab1e51d76197d,
                    0x1455897432b733ed,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8701d3c6160b7758,
                    0x36c7f22392a8b80a,
                    0x229debe892bfdd7d,
                    0x73a94e19ece4f18a,
                    0xa66ae7adfb75492f,
                    0x0249c256edf851f0,
                ])),
                Felt::new(BigInteger384([
                    0x3aafe3af26b760d1,
                    0xfa916a2750dfd8c7,
                    0xf6ebdd258c8a2f47,
                    0x025ca83f23995935,
                    0xa418da20b0d137dd,
                    0x02581fe2ac307f90,
                ])),
                Felt::new(BigInteger384([
                    0x2fb7ac32264905ee,
                    0x3aeb1d29ee0dc11d,
                    0xe311afec109cbf59,
                    0x70649ce5b1663104,
                    0xe408b7f9661ea8d2,
                    0x1646ae95d4ee332b,
                ])),
                Felt::new(BigInteger384([
                    0x27e2fb6914a39d6b,
                    0xc034165405d03855,
                    0x813a9b59ab84c3f5,
                    0x64563904bde4160a,
                    0xa8974a78e4db6ba9,
                    0x194a1bf7912167b0,
                ])),
                Felt::new(BigInteger384([
                    0x0167551d7e528132,
                    0x48bcf3bbeea146b3,
                    0x630c1d31fe2d8fec,
                    0x50137821108a2bc8,
                    0x69dcc6841c7f2c05,
                    0x0f8dadd8b15102da,
                ])),
                Felt::new(BigInteger384([
                    0xe3999af9779b868b,
                    0x3026bfff06c7a49e,
                    0x8400e968db086954,
                    0xbb2c7a15c0770c42,
                    0xd69594158ab20591,
                    0x07065811910ea30d,
                ])),
                Felt::new(BigInteger384([
                    0x6c621f71bbf9fba0,
                    0x980cb14c75ac3923,
                    0x2f6984a35652497e,
                    0xee8642cdedc8d820,
                    0xd08d0267cec4c088,
                    0x11051d4d2ed9cef1,
                ])),
                Felt::new(BigInteger384([
                    0xc027a1fd883d84f8,
                    0xdef2237de830fa1d,
                    0xa89f145c971e7017,
                    0x31a9fa4a899b1d83,
                    0xdba35583013e37ae,
                    0x02abc22329ad4d6f,
                ])),
                Felt::new(BigInteger384([
                    0x1f44605333823f5a,
                    0x8ecee9080508e81e,
                    0x22eb977c10a14eb0,
                    0x09b46a11c49ed006,
                    0x5b450a3aec39bb84,
                    0x0f627ef0915f023c,
                ])),
                Felt::new(BigInteger384([
                    0x1364278882d2c06e,
                    0x8e8b8a8a8faf27d0,
                    0xc7e215a96091583a,
                    0x35cd17af0a7779f5,
                    0x8ec9d3ae79371e50,
                    0x09069bb1647cb77d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf878eb4ee9f43ce3,
                    0x148d93bd7ddf15e8,
                    0x8c46efeabc151893,
                    0xeb21c13700e4ec67,
                    0xd3c9a608cfa1b52a,
                    0x177bedcbc791f0ed,
                ])),
                Felt::new(BigInteger384([
                    0x63c07126ee22cfac,
                    0x9b97bf36b2603e75,
                    0x3b3126bffb91e93b,
                    0x59038c039472f73c,
                    0x034c83adb773599a,
                    0x169db5cf4cc82a63,
                ])),
                Felt::new(BigInteger384([
                    0x8fac599103196a90,
                    0xdf4864b98aa97bcd,
                    0x8781a645487b3b10,
                    0x14916bc1d2a62094,
                    0x81a9716e1cbba6a7,
                    0x128d55534e063b0c,
                ])),
                Felt::new(BigInteger384([
                    0xfee0281ac83a601a,
                    0x87aaacedca0f464d,
                    0xd5a3a6a95024ba70,
                    0x5aeaa2ecb6b83c51,
                    0xb8e463aeccc70d2c,
                    0x0d401b51066d726c,
                ])),
                Felt::new(BigInteger384([
                    0xe8a7ae60911ea177,
                    0x7a969cf4335beba7,
                    0xeb1f8bf338b0ee2a,
                    0x5f8f779a0abaca14,
                    0xe02193eb630fd99a,
                    0x0bda02120730228b,
                ])),
                Felt::new(BigInteger384([
                    0x1c92fc5c3d599f73,
                    0x0f692e056cdf2322,
                    0xcbb798185096660b,
                    0xb44353e41dce9a5a,
                    0x5dde8560b023432c,
                    0x152a5199646cb6da,
                ])),
                Felt::new(BigInteger384([
                    0xa6a7047db1396482,
                    0x587ec4aeb800490b,
                    0xfe2768e1018adfe7,
                    0xe6a643619b886f89,
                    0x3eac1a225c869274,
                    0x0f5f023b9dad1b12,
                ])),
                Felt::new(BigInteger384([
                    0xc92e014a7456b746,
                    0xbb920afacc04d8ee,
                    0x33435a6d22b59e48,
                    0x5f16003e44720de2,
                    0xe44b52f680e82b42,
                    0x15fb935b6324dbb3,
                ])),
                Felt::new(BigInteger384([
                    0xa68d826609c221f2,
                    0x0eb69598857fbf0d,
                    0xbc050fcf3d87b24c,
                    0xe46a760b9810046b,
                    0x00d5ad784658ee78,
                    0x0389408517059167,
                ])),
                Felt::new(BigInteger384([
                    0x97563b303be5a208,
                    0x340bceb8184d51ad,
                    0x014bedbb88f9d125,
                    0xde19776719ca6532,
                    0x92c52c3c1d74fd6f,
                    0x060ec9a7d79a7b3c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe429855e4dbeb5e5,
                    0x1fd562a1096eb360,
                    0x70a0a3068d66dfba,
                    0x492ac107cd752edd,
                    0xf843680c29bcee81,
                    0x13d1af3f45bafc4e,
                ])),
                Felt::new(BigInteger384([
                    0xd0d5e17b263a3d8c,
                    0xb268b5552ef34e01,
                    0xda6d0cac472f257d,
                    0xead60587ce1e75e8,
                    0x0619996b7c9aed62,
                    0x0ec5fb920575d84b,
                ])),
                Felt::new(BigInteger384([
                    0xb2546f702d84e1c0,
                    0xe7b592707b020ae7,
                    0xc4d6008f9236e60a,
                    0x5eee30acfeb161fa,
                    0x9f8b26de1033ab1f,
                    0x05352c1c97e9a127,
                ])),
                Felt::new(BigInteger384([
                    0xb6c51283843bd8f6,
                    0x88a71c78120a95e4,
                    0x34bc29b832c38532,
                    0x62986a5ef6afed62,
                    0x87af4b28f3748601,
                    0x18ee9f3c0f7fcad1,
                ])),
                Felt::new(BigInteger384([
                    0x6b9417c66722a182,
                    0x0bbf4057c1bc6e11,
                    0xe5c96159cfc03ff9,
                    0x3a685958781bfcc5,
                    0x7c943ce6c41c05d4,
                    0x074b4d3d1a2bb4ad,
                ])),
                Felt::new(BigInteger384([
                    0xd251b490379af1ca,
                    0xa2cc5bad9459cd4f,
                    0x05845b4bf8c6451f,
                    0x54887e61bf983f35,
                    0xfdeb823492eeba9f,
                    0x17189fcf793cf322,
                ])),
                Felt::new(BigInteger384([
                    0x4071ed782424b27e,
                    0x1ef0963cc77a1616,
                    0x0e88e929016ad8bb,
                    0xd29bcddd9b7c561b,
                    0xb573300d23435edd,
                    0x0bdcfd5421aeb66f,
                ])),
                Felt::new(BigInteger384([
                    0x4e1def9577549c81,
                    0xefc21b0d76d3a905,
                    0x114a49d075a70ec4,
                    0x0ca8485b80850ccc,
                    0xf63a2ff99f381c5a,
                    0x0fc97638ca6b6284,
                ])),
                Felt::new(BigInteger384([
                    0xbcfc9a95098e68e5,
                    0x3db3d1b2e5cd546a,
                    0x220cd33a79eeeff7,
                    0xe2d778b6ac0bf497,
                    0xb020a7bd3824e792,
                    0x013255e11f944ea6,
                ])),
                Felt::new(BigInteger384([
                    0xa7ed117eab2965d0,
                    0x30ed0bb7dc3350e5,
                    0xe8cbc53e6805322e,
                    0x1ed15963e3957995,
                    0xed1a45165f3ef6b6,
                    0x03bdac2d7b46839c,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let mut input = [
            [Felt::zero(); 10],
            [Felt::one(); 10],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x69beb03fe5ab908b,
                    0xbfd41ccee2d9ce69,
                    0x6770e3c3dab8a273,
                    0x415ca953128e3232,
                    0xbccd74c83109a980,
                    0x16f2dba13514e4cc,
                ])),
                Felt::new(BigInteger384([
                    0x2861852fd583b314,
                    0xa80c3daa472d1257,
                    0xc9687d618accd182,
                    0x7698ea1af3cae8fc,
                    0x0ea11f619b5437a6,
                    0x0580414ea68c0a20,
                ])),
                Felt::new(BigInteger384([
                    0x64cb33d95429547f,
                    0xad12a268b04586f3,
                    0x4ab9dffc244a2d2e,
                    0x989070ab0cb03713,
                    0x00aa9691b59ecd3f,
                    0x04776aec1f2958b6,
                ])),
                Felt::new(BigInteger384([
                    0x74399840ecd3e6d9,
                    0x872d5dc7b26c35ea,
                    0x1b9857a8b0fa00eb,
                    0xc2a2e2f38aac4dde,
                    0x92d8c8321c882ba3,
                    0x129b5f6230dc2747,
                ])),
                Felt::new(BigInteger384([
                    0xd3eadaa29e46bd5e,
                    0x8ea77af300d9b92f,
                    0x6a89412ad036867c,
                    0xc9591bd72a5e4cc0,
                    0x0cef7527ef7ae3f3,
                    0x01e06bed4adaea15,
                ])),
                Felt::new(BigInteger384([
                    0xec56116d3c181718,
                    0x507b09158f95e084,
                    0x40ba46367009b59b,
                    0xfd62ec42adc8d8e6,
                    0x6877ba97ccbb899a,
                    0x0403f0a737ea703f,
                ])),
                Felt::new(BigInteger384([
                    0x5a14877aa96713f1,
                    0x731ab36f390fca2d,
                    0x6d04427c6f54c390,
                    0x6e83f23426e3fe91,
                    0x8f941239ec2ee726,
                    0x0a6ccb34c2b1b56a,
                ])),
                Felt::new(BigInteger384([
                    0xdb198de8f8430f3a,
                    0xd11f37cda27a81b9,
                    0x7045b8f9042fdb28,
                    0xbd76ec64db0bfa21,
                    0x885479779e1761fb,
                    0x0852991182a0c4b2,
                ])),
                Felt::new(BigInteger384([
                    0x1059fc22002388ed,
                    0xeb21c3be082f987a,
                    0x766e6957d1eca2ac,
                    0x890155abfd1d29a7,
                    0x8980dad0f0c88e32,
                    0x0668a83c258a4ff2,
                ])),
                Felt::new(BigInteger384([
                    0xf6a252885ae835a9,
                    0xde205666e0f2dcbe,
                    0xca9f70f6b797dfc9,
                    0x44b79f15664f15b7,
                    0xae428fb265d1f3a2,
                    0x18b9257774bc8266,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xd97a3f2b18deb3de,
                    0xfc47161440bfb22d,
                    0x5eea7a25ce9cbd7c,
                    0x87588fb7d32f484c,
                    0x9d5a8e1d3d91344f,
                    0x0c7c414204d8b39f,
                ])),
                Felt::new(BigInteger384([
                    0x06bd17c0ebfa57b8,
                    0x706e2201a53ca02d,
                    0x85a1a86451ed4be6,
                    0x38fa09f9f9fc4eb0,
                    0xc2cf3d2317d2af09,
                    0x0000b3004fb9c9df,
                ])),
                Felt::new(BigInteger384([
                    0x49af6d55f58cc727,
                    0x3514773050ddf020,
                    0x093ce190987d2635,
                    0xad233ea3cad5a000,
                    0x617b110f21183d81,
                    0x05073ecab8c65313,
                ])),
                Felt::new(BigInteger384([
                    0xacc9240f6a3f1b6b,
                    0xeac74841db33cf66,
                    0xb74bd88ff9c6af10,
                    0xd4e286ecd92dd281,
                    0x4bed3d3343ad26b2,
                    0x14842b5d233f5683,
                ])),
                Felt::new(BigInteger384([
                    0x440cb4e2068679ac,
                    0x2bd8e1cd1e89e179,
                    0xa29acf6c900309bc,
                    0x0ac2cb00b32673e8,
                    0xed56c17c3014267d,
                    0x0f8ae8fc6eb7cb03,
                ])),
                Felt::new(BigInteger384([
                    0x53cbfe5b86b11958,
                    0x85112fe0d36d7d88,
                    0xcc4fb5c8079f7a9b,
                    0xb0e7146d7bce22da,
                    0xf5c5dba0b2261b8e,
                    0x1165fca4724e9f13,
                ])),
                Felt::new(BigInteger384([
                    0x51e53a143e5be4e3,
                    0x20d9889d5885c97a,
                    0xc17bcbcfbf30677f,
                    0x19f6e144c809f99a,
                    0x0d8af2d7c639631c,
                    0x0fcc94dc1599ddd4,
                ])),
                Felt::new(BigInteger384([
                    0x84cf4aba9d4cd659,
                    0x71ed84737bc7b64c,
                    0xdf03dcf167fdc944,
                    0x0f4ee5cfa694d77b,
                    0x8a6af2015e8c01c5,
                    0x117338b7a44ddae3,
                ])),
                Felt::new(BigInteger384([
                    0x0f91fd3200d23dab,
                    0x06208184be465082,
                    0x8a7298a68ba9f129,
                    0x87e3a59cde987369,
                    0xec5272190ad3e074,
                    0x0957a69df33c286d,
                ])),
                Felt::new(BigInteger384([
                    0xa035672adf86558b,
                    0xd9c3ac3a5dd3c55b,
                    0xcce4989aefafc368,
                    0x962e8c0661697e72,
                    0xa26506b187e53760,
                    0x06119d4793931748,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xcf6d705e96cd984d,
                    0x5f43f24e9dfabc87,
                    0xb83eb9bbb6c1e1a8,
                    0xd8b0b8603ee51993,
                    0x82354fd1a1bc9a64,
                    0x125a089d4afb46f2,
                ])),
                Felt::new(BigInteger384([
                    0xe35da3cbab7b7c1e,
                    0x5994a4a77c081e4f,
                    0xcff98c237db199e3,
                    0xd31f7b4196843a24,
                    0x6e22db2aa51aab82,
                    0x08bf2baf1a43dbd4,
                ])),
                Felt::new(BigInteger384([
                    0x9f227699fe2b4cb1,
                    0x49cd5ff61c06fd47,
                    0xc02acae047f08b7b,
                    0xfb9ae4b2d0cb568d,
                    0x36894e52c6bed586,
                    0x0d24cf782c780ace,
                ])),
                Felt::new(BigInteger384([
                    0x32290de4a8da9253,
                    0x9e7e920d928205ea,
                    0xf5c707d19068a928,
                    0x296cb85081132cd4,
                    0x85e08cea24621f5f,
                    0x11af8415f3ac5d80,
                ])),
                Felt::new(BigInteger384([
                    0x922c0944346c397d,
                    0x30c7202aff0fa799,
                    0x715a39e3cc354341,
                    0x0437671602cf9d06,
                    0xcfade68a3f165783,
                    0x0b6663a52c68841f,
                ])),
                Felt::new(BigInteger384([
                    0x8bdceb5043b6bbc1,
                    0xcf512f11f5ea5ac8,
                    0xaf4d6f64df0eea7a,
                    0x4e6fb60d61416d7a,
                    0xfb028b8e80ae791c,
                    0x0df2184c15d62d5c,
                ])),
                Felt::new(BigInteger384([
                    0xc0f1a357353fbfe7,
                    0x63dc3419a7e5fbb3,
                    0x2053a0a1ad51b192,
                    0xe7427af2cdd80df3,
                    0xed892a6f754c3435,
                    0x0c82f4fd1ac6e518,
                ])),
                Felt::new(BigInteger384([
                    0x6d2a0763d8099187,
                    0xb10ef7a4ed7b975a,
                    0x2e5d3fe0d259d205,
                    0x021617c7095db1ca,
                    0xac8f7a45d81baf74,
                    0x06c393c22b7f3010,
                ])),
                Felt::new(BigInteger384([
                    0x7bd26060bc83c046,
                    0xe9918bdaed823d8a,
                    0xed7ccb1c38f39f0b,
                    0x1a9ee7ff1f821465,
                    0x6e5a117fffa74fd0,
                    0x028ab665d8e5a67b,
                ])),
                Felt::new(BigInteger384([
                    0x286dc3176367a33c,
                    0x2c37058ee64c3fe3,
                    0xf0a2a03253fcdd8b,
                    0xab3d73b83bf57df4,
                    0x731c446cf87de383,
                    0x017cfcaaf1658f67,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdeeac8c5454cb83e,
                    0xd05c1256cce8851d,
                    0xa78b8d27a14e7a69,
                    0x2bf4dcc9499e6fc0,
                    0x212467cfc7141e57,
                    0x0681d8e30ca7d6a6,
                ])),
                Felt::new(BigInteger384([
                    0x5893dd519fb1f9b0,
                    0xd24c3517a504f4c7,
                    0x7f1e358ba8214735,
                    0x043cf91b803274c0,
                    0x64cb7a50bec084b4,
                    0x15ab9682eeb0f1d3,
                ])),
                Felt::new(BigInteger384([
                    0x39f8e674f1ae3db2,
                    0xb5d98f185e59f5a8,
                    0x439292e59e7cff3f,
                    0x871833caf125385d,
                    0xf64fccbb0c07b39c,
                    0x0bb291054ad94eb0,
                ])),
                Felt::new(BigInteger384([
                    0x5fc7733f73894d5a,
                    0x77e0d0d3db13d768,
                    0x2c053dfd2fc51973,
                    0x372232877d014568,
                    0x7daadac4c9eab3f7,
                    0x191ce90dd7efb0a2,
                ])),
                Felt::new(BigInteger384([
                    0x9a1e3723475e3a3e,
                    0xece29b928aaf6674,
                    0x5a44006f2fe31ca7,
                    0xf2a91032c7966d40,
                    0x48f9412a5590f410,
                    0x0a7e39230db6a226,
                ])),
                Felt::new(BigInteger384([
                    0xfdd99a6019a9f89a,
                    0xa1795614de768ddb,
                    0x74149bf3e9e85862,
                    0xfdffb779c2f84e3f,
                    0x96be04afb72755f8,
                    0x0a38ce6b9c6f2037,
                ])),
                Felt::new(BigInteger384([
                    0x033b9b2488ac2c1f,
                    0xe787c34dffb472ae,
                    0xcaf86c8912bd9ebd,
                    0x737c2ef4b1575ed3,
                    0xe5071adbb7447834,
                    0x12aea017e0c6235a,
                ])),
                Felt::new(BigInteger384([
                    0xf16ead79dc1ccf19,
                    0xf2e313611947649f,
                    0xd4aff237b98bf7b4,
                    0xcc7956c315245a0e,
                    0xf53bf6ee96c3a4ca,
                    0x02a93586cc22a749,
                ])),
                Felt::new(BigInteger384([
                    0x7e15c211fdce7a11,
                    0x7b2e64f15ce20cc0,
                    0xd9fbebdb30054216,
                    0x5f1dd00de101cdc3,
                    0x21ddf7514c2fe7c3,
                    0x134f4dea4f23d9cb,
                ])),
                Felt::new(BigInteger384([
                    0x3bd3d065ce522ebd,
                    0xaf654ebebf2e8429,
                    0x58f124c7c2a7c019,
                    0xc2ab14c0a0824de5,
                    0x3be6be86e8af2945,
                    0x1073a28b773d7eae,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x44d47c4ad58b1b81,
                    0x78aeee0d002b8926,
                    0x529464a9c51199cd,
                    0x548187c24da0d9d6,
                    0x7b6104641924f804,
                    0x0680222311dc1255,
                ])),
                Felt::new(BigInteger384([
                    0x933f018068fd008d,
                    0xcadede2b1cc12ecc,
                    0x8d9fb128fc438a89,
                    0x113e720fe42eb4b4,
                    0x8b84271d43347ed7,
                    0x07a4fdfebf729682,
                ])),
                Felt::new(BigInteger384([
                    0x6048ca6527499e6f,
                    0x6eff9247b3385306,
                    0x7c39806320a9fa97,
                    0xce4d069bc8c6c749,
                    0x7549c5008abf62c4,
                    0x072c36a1edcaad45,
                ])),
                Felt::new(BigInteger384([
                    0x55368c34445b5895,
                    0xda0482c8abf2254a,
                    0x31b78a480d0b3135,
                    0x9664994fcaf4c2ac,
                    0xe59d3fceb7872828,
                    0x02b34e0048929c14,
                ])),
                Felt::new(BigInteger384([
                    0xc1d8180fb99364a8,
                    0x15045b1805db1a64,
                    0xde48e5e24f27049a,
                    0x9513c08e7ffdf72c,
                    0xed5c89fddd61b59d,
                    0x1255a940231fff60,
                ])),
                Felt::new(BigInteger384([
                    0xd7af28fe353183da,
                    0xf982d7d14f322573,
                    0x21eeba4995088102,
                    0x46df325560bb8d5f,
                    0x9a58d85bfc661f4f,
                    0x19f2284c7bf5a96c,
                ])),
                Felt::new(BigInteger384([
                    0x9c90784127e4af19,
                    0x2e55e8820180ca11,
                    0x458cbff103e4a86b,
                    0x9f3f80ec3fea0733,
                    0xe33c7dece2441fe9,
                    0x047078def70dcb7c,
                ])),
                Felt::new(BigInteger384([
                    0x29e6de3a9abb0c48,
                    0x15b3813ac44226e5,
                    0xddd12c76f40568d1,
                    0x586fbf6f418da7f6,
                    0xaff6e498e015ab96,
                    0x04bab98f75ed1281,
                ])),
                Felt::new(BigInteger384([
                    0x85c24de70a978ad5,
                    0xf5983f6f364d8215,
                    0x98792bde2b8b82ce,
                    0x96dd587efb80c620,
                    0x5bf55da248fc5eab,
                    0x138525ccff940ebb,
                ])),
                Felt::new(BigInteger384([
                    0x35f73de4f6272057,
                    0x6309869b9ce91f6f,
                    0xe1b1dd160a560da8,
                    0xe44a0a64d7dc5faa,
                    0xba23653b9b779e42,
                    0x0fab461f4b4e4eca,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xebdd0e8196dfa482,
                    0x62e2e32a500bf65c,
                    0xe0b0f80b2afcbdab,
                    0xfb86792054fc8462,
                    0xa9bb5bcc935cb20d,
                    0x180549e4ba2d9484,
                ])),
                Felt::new(BigInteger384([
                    0xb8abaef15bf87d24,
                    0xce2d0d86199dfff0,
                    0x01a7c87f71ec94e9,
                    0xb12a62844db8039d,
                    0x20d2a6db6a91bf71,
                    0x0a28620436a2cde6,
                ])),
                Felt::new(BigInteger384([
                    0xe37df202d3d1c624,
                    0x199a160cbcfefca2,
                    0xef8b88525ce73d0c,
                    0xf63b0b5c72a493d5,
                    0x323ac0cd51628138,
                    0x1549df9e18e3b3eb,
                ])),
                Felt::new(BigInteger384([
                    0xeb7afe7753a4e8d7,
                    0x230c9da5c881ade6,
                    0x997fdabd3537b286,
                    0x9f169e3ec303fb41,
                    0xd3b538b640de789e,
                    0x0f0899ea4c83af83,
                ])),
                Felt::new(BigInteger384([
                    0x18af5dc03f288f85,
                    0x23b3d1535a01e9fb,
                    0xec90366e6156d102,
                    0x67bb07da2525fc86,
                    0x63faf5e1d94e13a7,
                    0x174a917a4997aa9e,
                ])),
                Felt::new(BigInteger384([
                    0xb5ea6c1834331b08,
                    0xe72e49c186de0cf5,
                    0xa65a22d56bbe8412,
                    0x2a959b37b6140fb4,
                    0x0a8870c5300fdf38,
                    0x0c02554017ec9839,
                ])),
                Felt::new(BigInteger384([
                    0x8c1307262d653c51,
                    0xf565883f76db153a,
                    0x48b972707ab63ca9,
                    0xdf0e07e137b91203,
                    0xffd25f9e2dc4b087,
                    0x00bb1ad8667a3416,
                ])),
                Felt::new(BigInteger384([
                    0x06e95fe86b33cfb7,
                    0xc3491fc74c97138c,
                    0x8ba9e5742ca066ca,
                    0xf378b0113046bb7e,
                    0x76bdda4615d1fca6,
                    0x072a39eb118e7397,
                ])),
                Felt::new(BigInteger384([
                    0xe4cb81da241816f0,
                    0x9eea2b4a7bca82c7,
                    0x89bcb369d89f721b,
                    0xd28402b0e8529a93,
                    0xf3c52382d747fb4d,
                    0x0f581698b019fb30,
                ])),
                Felt::new(BigInteger384([
                    0x8cc43bb9f6709f25,
                    0xba53a9a77b3b9b4c,
                    0x1095a2a7fa422365,
                    0x8bc30a18c4a43b85,
                    0xdaa85234e30bc946,
                    0x193b0ca04de8c2e8,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 10],
            [
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::new(BigInteger384([
                    0x76890000002daa7d,
                    0x95f400b31a0c0025,
                    0xc6df47dbfb4c46ab,
                    0x3c2895d9adc8f791,
                    0xce333f75fc8080bb,
                    0x156d69a73a8d976d,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xcd02772c825de4aa,
                    0xda631f964378eb34,
                    0xf7535b0ecc98c70e,
                    0xe912ce5d5cde2ca5,
                    0x2d102395ff92b7d9,
                    0x15a4af368cd48e2d,
                ])),
                Felt::new(BigInteger384([
                    0x34455d95e59fd9a0,
                    0x0db57549a71327da,
                    0x43ef196f89a38cac,
                    0x0402b0f9fe1cb46c,
                    0x9dd595168295ad3e,
                    0x060246d4fa9eaac8,
                ])),
                Felt::new(BigInteger384([
                    0x23acb6f0de13dfab,
                    0x8e68189edde37dc8,
                    0x2ec7dff795559437,
                    0x1759655e620d632f,
                    0x7f22e7b51ce900cb,
                    0x11fb69912626830c,
                ])),
                Felt::new(BigInteger384([
                    0x7ce39ba136fc734c,
                    0xbd8351e2733f4675,
                    0x53c37c6d208bc802,
                    0x2ef35cee39b88acc,
                    0x9c7fc38248108cbb,
                    0x03a52077317522cd,
                ])),
                Felt::new(BigInteger384([
                    0xed1fe31bf547e607,
                    0x0571af507fc9e801,
                    0xdf20b62a7feb8818,
                    0xa79c3b503ed23dcf,
                    0x5efc44c7072ae363,
                    0x16353a82c506937c,
                ])),
                Felt::new(BigInteger384([
                    0x8279ab0d3a30080c,
                    0x587fbd861dd9eaeb,
                    0x43916aa22fb4cd17,
                    0x720034224251988b,
                    0xb526119f5fcb653d,
                    0x00eb3a9f47783d2e,
                ])),
                Felt::new(BigInteger384([
                    0xe71f6cbe4884f935,
                    0x200ba44a81312568,
                    0xff6beab7218d009a,
                    0xd7f2c642cf8f50e3,
                    0xc9ba5a9afc686834,
                    0x011000db5a83804d,
                ])),
                Felt::new(BigInteger384([
                    0x93d466698e40f518,
                    0x220a1a2be337c81f,
                    0x4be7093cd12020c6,
                    0xa166f23e817e5c01,
                    0x2cb2a3af76cef1cc,
                    0x1679822af3f135d5,
                ])),
                Felt::new(BigInteger384([
                    0xc7621eb374f4c771,
                    0xe9612bbc09401d16,
                    0xc6e226b9c53aa189,
                    0x9eab91d01871581f,
                    0x69de0e121633ce3e,
                    0x1554dd86d4f31b03,
                ])),
                Felt::new(BigInteger384([
                    0xd451cfd49561de0b,
                    0x636822f15c45e184,
                    0xfb10cb680ac1394e,
                    0x60a4051db12d55d4,
                    0x1097dcfc7c5ad7c6,
                    0x06a165eecdd6f155,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xaeb0b795af1e8466,
                    0xbb9827b904cac7b6,
                    0x38227433e254adf6,
                    0x91d157b169808153,
                    0x494024abe0b43d36,
                    0x05526d9da2fa79a2,
                ])),
                Felt::new(BigInteger384([
                    0x906500a4b6ba3079,
                    0x2beb679a6c4fff4d,
                    0x476bf1ad62039eb3,
                    0x7547c75b943e1c1a,
                    0xc2703c5321074641,
                    0x0925e0b6b2d98072,
                ])),
                Felt::new(BigInteger384([
                    0x623d237c72bf2afa,
                    0x4bf96737ff8d4d8c,
                    0x2368106f3b9e8b5e,
                    0x4ab569401e0d2de2,
                    0x8c745e02553560ba,
                    0x121c617de4313016,
                ])),
                Felt::new(BigInteger384([
                    0xdaa91824370bf353,
                    0x7a904847d148f8bf,
                    0x85caa7ef53b3fd7b,
                    0x8de17fa1097041d3,
                    0x22a4fbbc6755d345,
                    0x14a7a857cec84f77,
                ])),
                Felt::new(BigInteger384([
                    0x166ea4f4ccc4850e,
                    0x4a44a3f763d641b2,
                    0x47e4e6acc5c8e061,
                    0x23ae9c3d1bece712,
                    0x5d2336b03b65bf38,
                    0x14b5bda8d694581d,
                ])),
                Felt::new(BigInteger384([
                    0xcd4210d9fdb0491f,
                    0xed8531f47f9afa66,
                    0x05d37242e6e2b212,
                    0x3362890a45f662e8,
                    0xf0b8b1c84bce607e,
                    0x1084ba44c47242e9,
                ])),
                Felt::new(BigInteger384([
                    0x47b299408f4447c7,
                    0xe729754682903c68,
                    0xf6784f30de503994,
                    0xdfe9d6ead830ae72,
                    0x6af90eecd1b52c3e,
                    0x0b8f14a2f4ffcc67,
                ])),
                Felt::new(BigInteger384([
                    0xbad4bd65805e4d2f,
                    0x36c17622d8c043e0,
                    0xe3c23d87e166ff96,
                    0xc17314e57853e047,
                    0x016e5360806f990f,
                    0x0a0519879da8a5e2,
                ])),
                Felt::new(BigInteger384([
                    0x34cf30a79a9c009a,
                    0xd1060f6208050b11,
                    0x3b9e5e71d0529463,
                    0xba6506ee7fffa9e1,
                    0x7a52276065f92bba,
                    0x0558ff0d05943754,
                ])),
                Felt::new(BigInteger384([
                    0xf177113dfdddce52,
                    0xbbaba915f6e286bb,
                    0x512458e80a6b04e3,
                    0x10ed801bd76e8b10,
                    0x084a47c91652ba7a,
                    0x173d8ef20422a2b2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1db9dddfe654b88e,
                    0x2d6a9feeda223059,
                    0x044224d28c1b57e9,
                    0x9a25b5c7b182989a,
                    0xac1a345490fa3fa4,
                    0x0c3e27df04e3ff9a,
                ])),
                Felt::new(BigInteger384([
                    0x9ed69afd67ee09e5,
                    0x28edf705d7197a65,
                    0x969561aa83f2e506,
                    0x739762f794187532,
                    0xa732bbcae3aada70,
                    0x0445b1be7e4c3d8d,
                ])),
                Felt::new(BigInteger384([
                    0x206094bff8ecae98,
                    0xe0e4530db67f83af,
                    0x28856196cda1cb7c,
                    0xf4cb0b6b9dd36041,
                    0x4d357ffb91ca04ac,
                    0x0023fdf6c21f0d66,
                ])),
                Felt::new(BigInteger384([
                    0xc5c74875467859f7,
                    0xedb2fb9a0e794ec2,
                    0xbe43d3712085f75b,
                    0x2ef79c6905f82cb2,
                    0x97a6c135e7c165db,
                    0x02d14040b5ef0d98,
                ])),
                Felt::new(BigInteger384([
                    0x6d1084e512a0a9da,
                    0x05c35a95847cd1c4,
                    0x94be283c2f02b34f,
                    0x548eacf6252b1c2c,
                    0x06122bbdc9f72d84,
                    0x0ef74436a7ee0f13,
                ])),
                Felt::new(BigInteger384([
                    0xd09d70cc2305c9f4,
                    0x330dd0e8b0b11125,
                    0x10a277b5f1b188e2,
                    0x40f3c54c3149dfea,
                    0xb751ad8ee7dab830,
                    0x1891e25a573c753b,
                ])),
                Felt::new(BigInteger384([
                    0xb4768effd7df94b1,
                    0xb67b54fb3665ea34,
                    0x48a5af2b14a35cc5,
                    0xe6242049a564ddfc,
                    0x8c6c14e4bdf93318,
                    0x021710b7965132af,
                ])),
                Felt::new(BigInteger384([
                    0x857397b8f83fc358,
                    0x0dc7c544333f715b,
                    0xb86530e4206143dd,
                    0xc6c6b27a175c408c,
                    0xbb0166da7abd2966,
                    0x19b76b0b6a65a847,
                ])),
                Felt::new(BigInteger384([
                    0xe8e697e05597a62b,
                    0x1f2c6acc19661ee5,
                    0x283d70a9bd175da3,
                    0x0f819f26ef310a31,
                    0x2f6798be6de13f9c,
                    0x0eb89d359589b8ec,
                ])),
                Felt::new(BigInteger384([
                    0xd9bcf5cae4290c2b,
                    0x8c5b955339215225,
                    0xf57777d39dcaf5bd,
                    0x35b4c3e10dfc32ad,
                    0x50f87183d0c912d2,
                    0x0c596da95aad3c66,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x97263a23ed086e4a,
                    0x4ec541ee2417b8c8,
                    0x2b43e07d1de30353,
                    0x3b963039db0d2f80,
                    0x738bbb86630deb57,
                    0x0827550ab4356d03,
                ])),
                Felt::new(BigInteger384([
                    0x5ef8e5ec63f6f6f1,
                    0xde6b00b0e696a412,
                    0x23348384fd2bae83,
                    0x17e54493ce29dddf,
                    0x8ff54d168b1f024a,
                    0x012f8645a4fbbe0b,
                ])),
                Felt::new(BigInteger384([
                    0x88b074cb6f015081,
                    0x7a9b857e6ceadccc,
                    0xc5d350226cf50162,
                    0x9bf6d6f6c3bc490f,
                    0xbdafd7d5d5a69ac3,
                    0x14a3fc2f9581ab47,
                ])),
                Felt::new(BigInteger384([
                    0x04d8fa41c1ff20df,
                    0xd594434c5f066c9f,
                    0xf8ebd8273db30371,
                    0xa2d3afd82f536b82,
                    0x7f0ca64cd4cede08,
                    0x12445e98aa20d945,
                ])),
                Felt::new(BigInteger384([
                    0xbf9671ee742b5913,
                    0x4ee19dc0cb7dd595,
                    0xc8d74819862a41ae,
                    0xd32efc7337b9cf05,
                    0x421cab481cf1df37,
                    0x145405ad4405e0ca,
                ])),
                Felt::new(BigInteger384([
                    0x3d81d44c17d154b4,
                    0x5a35eeefab60d382,
                    0x0371fece39ab5c0d,
                    0x9eb6cda211c05dc5,
                    0x136c734c92076d59,
                    0x0e28d43df2f6a59d,
                ])),
                Felt::new(BigInteger384([
                    0x149751f456e8e9b7,
                    0xb1198d7152c972b4,
                    0xae56188078073a5b,
                    0xedc11d1eb19fa167,
                    0x91282ce236e2ff65,
                    0x179847d1c41ae08c,
                ])),
                Felt::new(BigInteger384([
                    0xd593318b8860f93e,
                    0xd2322412be06fc56,
                    0xde883494c9a38e23,
                    0xf1c2ff4537e6e643,
                    0x08bcbb6fd8becb86,
                    0x18708e26fbf509fa,
                ])),
                Felt::new(BigInteger384([
                    0x698ebc74e77e9fc0,
                    0x64363501f8fe3c53,
                    0xf044a816fc3c62fd,
                    0x6956b3c78877a272,
                    0xf23e2e1ec69047f4,
                    0x07e22f85dfbd98dd,
                ])),
                Felt::new(BigInteger384([
                    0xe2e258373583b94c,
                    0xe4aa710e8025f63b,
                    0x0f6c8410f7ceec1c,
                    0x6173820fb1abf48e,
                    0x00b1044317d07014,
                    0x0e5af612dfe0cbcc,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7505861a65b4fba0,
                    0xc85855b08d01ca28,
                    0x6f37206311ce2142,
                    0x1d47bc147653653b,
                    0x287be523dd226bab,
                    0x081df0b64d199cdd,
                ])),
                Felt::new(BigInteger384([
                    0x6ab63e376f5f1a34,
                    0xfcb80b7326c60905,
                    0x184614ba7f3f539d,
                    0x0bb2bf8cc3db96e8,
                    0xa38e4a9cda9a5544,
                    0x18be26a886c1d6cc,
                ])),
                Felt::new(BigInteger384([
                    0x06989775fb7deb15,
                    0xe67735693bdfd618,
                    0xba787a4241fe7cf1,
                    0x3a4e0cdbf10e135e,
                    0x9da6d91281d752ad,
                    0x1915b73fbe6ae6f6,
                ])),
                Felt::new(BigInteger384([
                    0x2bf8131fe6f57f73,
                    0x34defc1fe01e3575,
                    0x0e989a37650339c4,
                    0xe39aac5be25db3a0,
                    0x912fad9795b7fba9,
                    0x02f61f255e06f472,
                ])),
                Felt::new(BigInteger384([
                    0xbda07f75bd05b674,
                    0x9060bab470ea367e,
                    0x8da59b18e8d03c03,
                    0x1915d4efb97ea165,
                    0x7b305fa2b6e2777f,
                    0x0bf2f029e8dbe2ed,
                ])),
                Felt::new(BigInteger384([
                    0x221104bbc4fdc5d0,
                    0x5dce799c7b02b03a,
                    0x15524d80ea25b7f0,
                    0xc3227be533e28799,
                    0xa448bd0858373cb0,
                    0x0017d2aac5bd9273,
                ])),
                Felt::new(BigInteger384([
                    0xa924e30f2407c85a,
                    0x2b6d3e553c4b8f71,
                    0x2c84d60be755a7c0,
                    0x14a2746cde806359,
                    0x0626b302815447f4,
                    0x0f3531df88085e88,
                ])),
                Felt::new(BigInteger384([
                    0xe4903ef0458edb2f,
                    0xd1a775b32576fca1,
                    0x474bf8c2f733f28d,
                    0x909d41287b62d4cb,
                    0x6a5d741272a8d43d,
                    0x18690e87c91c6344,
                ])),
                Felt::new(BigInteger384([
                    0xcbc4ce1442ea98c3,
                    0x524d5a11e931c919,
                    0xdac4749f8cb5f463,
                    0x022db29932f210a5,
                    0xc7322fa7982897f6,
                    0x0f6d10ca290686bf,
                ])),
                Felt::new(BigInteger384([
                    0x00d8a904266b7a25,
                    0x57cfe2d3adf109b9,
                    0xf8f73e1f9802f86a,
                    0x011276e0e1fc0013,
                    0x923edecad5211a15,
                    0x12f84642b9232319,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x34656219f8af3a59,
                    0x89dbc01b976f35bc,
                    0xade39a54cc464b73,
                    0x25baaac63d3d63b0,
                    0xb4e5683393217980,
                    0x0e97d6a99e818f4c,
                ])),
                Felt::new(BigInteger384([
                    0x5eb45be319bd1d12,
                    0x7cc6b1b389c97e08,
                    0x644f8610312b4e5c,
                    0xbc1586f0d0374308,
                    0x74917f7ce0570628,
                    0x03c501b185d538cc,
                ])),
                Felt::new(BigInteger384([
                    0xd9deae780c4c6143,
                    0x2622f80017d841a4,
                    0x390f695bef7c9a92,
                    0xa83eea93edf6ff8e,
                    0xd8f2a73c22cda6ab,
                    0x13079e6336939f6e,
                ])),
                Felt::new(BigInteger384([
                    0x91eefd8fea6a3923,
                    0x1413bcdbee2669ec,
                    0x3bc45d3e03829a29,
                    0x05042caccb88cdd8,
                    0x0f59bc05b7cd12c1,
                    0x176c4dfe1622b774,
                ])),
                Felt::new(BigInteger384([
                    0xcbf73975db745033,
                    0xf2b9498b9978383a,
                    0xef2e874ab39416f4,
                    0xe2ec45866d431aa5,
                    0xb7aa7f9cd8995074,
                    0x0411e03b844fcaa8,
                ])),
                Felt::new(BigInteger384([
                    0x320bf7fde3a5ff3c,
                    0x0d4341563b765f1f,
                    0xba2c15e57f6e6a9c,
                    0x2a50945725c443dc,
                    0x984de3682b8fb990,
                    0x06dce5fd6b99692f,
                ])),
                Felt::new(BigInteger384([
                    0x840f691026660874,
                    0x5f87185231300636,
                    0x483b2b39371ab400,
                    0x788debb893da43c7,
                    0xac2f4f03ead9e31b,
                    0x13def80bebf89bd6,
                ])),
                Felt::new(BigInteger384([
                    0xfe2dfdff84bb5c58,
                    0x3a1c721e20affb9c,
                    0xcdd4b91505543dc7,
                    0x89be4037d164abbe,
                    0x1296eb0561816041,
                    0x0b5568495179fead,
                ])),
                Felt::new(BigInteger384([
                    0xd88bc629141ccb55,
                    0x100de3bf8d57c40a,
                    0x6c7f168bf24d6477,
                    0x47a51114ab021662,
                    0x0aeeb5ebd79f3502,
                    0x0ecab17e30802cb6,
                ])),
                Felt::new(BigInteger384([
                    0xd9c4c50203c9e89f,
                    0x505a2ed0b0327074,
                    0xd269ab89fc96bd67,
                    0xc53294645af8521f,
                    0x2a154a975147fa91,
                    0x0dbb280c2d06ad94,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
