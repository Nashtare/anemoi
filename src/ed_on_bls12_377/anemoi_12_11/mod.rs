//! Implementation of the Anemoi permutation

use super::{mul_by_generator, sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 1 element (32-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= mul_by_generator(&y2);
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += mul_by_generator(&y2) + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies an Anemoi permutation to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Applies an Anemoi round to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x25ed8c869a22cbe8,
                    0xf7eb4b49840ff2a9,
                    0x70982ecbdaddc0af,
                    0x0d0f7d06f75dd348,
                ])),
                Felt::new(BigInteger256([
                    0x9c0986de30382db4,
                    0x0a12f5f9c9c7083e,
                    0x61f8733b2439d2f2,
                    0x10c9e0b7b03e1ed0,
                ])),
                Felt::new(BigInteger256([
                    0xadec5f1105aec5bf,
                    0xbfa0838398e69308,
                    0x7d360ec787fc57ce,
                    0x0432198817776ca3,
                ])),
                Felt::new(BigInteger256([
                    0xa6248a613c20424a,
                    0x6be766e75926884e,
                    0x49339f63dbd9ced9,
                    0x0f1691ee9599d7b7,
                ])),
                Felt::new(BigInteger256([
                    0x7d8ffb14adf04921,
                    0x7e6d29030bbc3d64,
                    0x753fc62a9e89d138,
                    0x06dfcb09cdeb76ff,
                ])),
                Felt::new(BigInteger256([
                    0x7b80227325d058e6,
                    0xad50addbcf7ffef6,
                    0xb510809023e78550,
                    0x0cad6a99dd6379a5,
                ])),
                Felt::new(BigInteger256([
                    0xeb8d02b2482aadc5,
                    0x2071b720efc26209,
                    0xdbd75f571dc3ab75,
                    0x0b9ab10a88791ae5,
                ])),
                Felt::new(BigInteger256([
                    0x51b84929a7fff94b,
                    0xaaa1125ef70290e5,
                    0x260e80e2f0217b91,
                    0x06f155c7f0d57da3,
                ])),
                Felt::new(BigInteger256([
                    0x89a1dd825be1dacc,
                    0xd66024858898b964,
                    0x581c6d3a2bfcb1bd,
                    0x0b7dd32399707d28,
                ])),
                Felt::new(BigInteger256([
                    0xb5304ba7b25ab2e5,
                    0x0b64c0e893cef3d6,
                    0x7afa835e28c2b5f2,
                    0x0aac9201c9c2bf24,
                ])),
                Felt::new(BigInteger256([
                    0x4d18b4b73c2e0da0,
                    0xbaedb28194be5758,
                    0xbcae1648317c252e,
                    0x01762d1c6b9ab766,
                ])),
                Felt::new(BigInteger256([
                    0x1d8451eb0f0c41f2,
                    0x343ee1cf5bfd9c30,
                    0x99b1d8748f839ae6,
                    0x02099c3cd3be5df4,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xed472122715d8b56,
                    0x8163b35cab802ea6,
                    0xf48814bffca8ed54,
                    0x0bc5e704295ddaf0,
                ])),
                Felt::new(BigInteger256([
                    0x42cf3e9f53d2ebd0,
                    0x4b73b316d69780ed,
                    0x0716671b772777bf,
                    0x089924a40c8aaa58,
                ])),
                Felt::new(BigInteger256([
                    0x9c26cd22a69b945c,
                    0x08cede439b0ecb09,
                    0x4648059ed289c4b2,
                    0x0110069d5f31a6b1,
                ])),
                Felt::new(BigInteger256([
                    0x81114db7d6517952,
                    0xde9cb4d07860d012,
                    0xa87ceeeaf2ecbaeb,
                    0x0e0d06b148d4148b,
                ])),
                Felt::new(BigInteger256([
                    0x298791ed5c8373a7,
                    0x2f79c856376f9505,
                    0x7d285c8beb5ad83a,
                    0x0bf2dff756e6c110,
                ])),
                Felt::new(BigInteger256([
                    0x94f8b784d13f43ca,
                    0x7ba273fa5fd98829,
                    0x9f383d3a6d9a37b4,
                    0x044e078e03af3c46,
                ])),
                Felt::new(BigInteger256([
                    0x1894bfcce1c1b930,
                    0xba094a101362b8b8,
                    0x06349bbffe950b16,
                    0x0bf58c1cde8acaba,
                ])),
                Felt::new(BigInteger256([
                    0x42426d553d994103,
                    0x0a76cc7c839fc285,
                    0x5ba74881e7c0d438,
                    0x04aee3e305304245,
                ])),
                Felt::new(BigInteger256([
                    0x231f788f24757fe8,
                    0xb5fa9636edee70d2,
                    0xb8ac5d983fb6813f,
                    0x121e7222cd91972d,
                ])),
                Felt::new(BigInteger256([
                    0x7a715d00cde282eb,
                    0x060531b8cd524566,
                    0x7cb9053494c665ae,
                    0x08f35285e6f064b3,
                ])),
                Felt::new(BigInteger256([
                    0x709491e8aa1042f4,
                    0xf7114c6650fcfce0,
                    0x5e434786845dd941,
                    0x0ae1acf95b3b1006,
                ])),
                Felt::new(BigInteger256([
                    0xeaf616c4dee7ba9c,
                    0xe179fb104ad7c1ee,
                    0xfbba108f82ab60f9,
                    0x02ea254daaca5e6e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x182e2e2098d78e13,
                    0x6b8f5317b493bc4a,
                    0x3138032b4db6dbad,
                    0x0674088ebe448718,
                ])),
                Felt::new(BigInteger256([
                    0xd859adab8a1ad395,
                    0x140933076002d7a9,
                    0x80f33722c0ad7084,
                    0x0a633a14a77c1c60,
                ])),
                Felt::new(BigInteger256([
                    0x39dfab8964f5383c,
                    0x6ef8179c986a1307,
                    0x452128237be192d0,
                    0x042160be67b714e0,
                ])),
                Felt::new(BigInteger256([
                    0x290bd82f8649e6ad,
                    0xa2dcb4206ce95edf,
                    0xcd0506b0145d1e4f,
                    0x066b6dd90f14aafc,
                ])),
                Felt::new(BigInteger256([
                    0x73a4d6153e4c84d1,
                    0xc2a4c330fe4bb273,
                    0x7dccb1359da08cc2,
                    0x04c0e15e21b59308,
                ])),
                Felt::new(BigInteger256([
                    0xce2ca7d80b4a1617,
                    0x7bf5ced29c2803c9,
                    0x478aa5141533efa6,
                    0x0bb064dc26c37e87,
                ])),
                Felt::new(BigInteger256([
                    0xa3b3cab37adf9631,
                    0xf8e3eef123f116c9,
                    0x08b831bf5d396b71,
                    0x074e48688993fc7d,
                ])),
                Felt::new(BigInteger256([
                    0x0b4b2c6ded6d8a32,
                    0xb0917281ac531e6b,
                    0x3c59b7f148d5a7ea,
                    0x081d20fdd8189ce8,
                ])),
                Felt::new(BigInteger256([
                    0x8e62ba7106f10a52,
                    0x601d0fbe4505dd3f,
                    0x901443fe45b05052,
                    0x08ce6366c6692393,
                ])),
                Felt::new(BigInteger256([
                    0xce32c649c5a13912,
                    0x92b065f2f9fad6ed,
                    0x329afb2f50cb37b2,
                    0x08646cb248915db5,
                ])),
                Felt::new(BigInteger256([
                    0x42690163ca317273,
                    0x2a173d2ce069d1b6,
                    0xde792e0a0462bbf8,
                    0x01afc763c1be9174,
                ])),
                Felt::new(BigInteger256([
                    0x1d7c8960cb9904fa,
                    0xbf07304e2aea4555,
                    0x97815b5300b20938,
                    0x04f688154b4c0875,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xfd3effc98c07940a,
                    0x07f237a44b8e836c,
                    0x20947fa4d3724fbf,
                    0x10710839b169b710,
                ])),
                Felt::new(BigInteger256([
                    0xcba3597744fe2d3a,
                    0xb80c1e87fd1e019c,
                    0xb9f79105ee7122a7,
                    0x0a3a5ac43b1aac8c,
                ])),
                Felt::new(BigInteger256([
                    0x18b2e4c2e98f35d8,
                    0xeb2e6fcf29896143,
                    0x12243a8ba925cf4b,
                    0x07db64a79bef4ef9,
                ])),
                Felt::new(BigInteger256([
                    0xc0379794a1f1ddac,
                    0x60d0121d968ced0a,
                    0x4f3db58862f2884a,
                    0x0deebce650ec547a,
                ])),
                Felt::new(BigInteger256([
                    0x467b7273107acabe,
                    0xa2477d26c945b893,
                    0x7e449d850d980521,
                    0x04bdb1ba10fb400a,
                ])),
                Felt::new(BigInteger256([
                    0x32e05d5e429e7ad5,
                    0xffabf6067eaeda39,
                    0x393cd24a03ddca05,
                    0x0206ef80580b0618,
                ])),
                Felt::new(BigInteger256([
                    0xe649315690d3e147,
                    0x18232fbbd2e20410,
                    0xf7fd7d0ea8ad885b,
                    0x10428e6cfba3011c,
                ])),
                Felt::new(BigInteger256([
                    0xe1adf1ecc54bf83e,
                    0x7f31a19a12fe9bbf,
                    0x8fe626e76658d39c,
                    0x06fd7278d97c5009,
                ])),
                Felt::new(BigInteger256([
                    0x161dcd3bdf91d70c,
                    0xbf6f309e2d5e87d5,
                    0x0343e5c28be9f5ae,
                    0x0265ffcb269e1dd8,
                ])),
                Felt::new(BigInteger256([
                    0x3851045d1cb17782,
                    0x1857e90d9d00d70f,
                    0x64feea9effec548e,
                    0x0b1cd0c43cbaad88,
                ])),
                Felt::new(BigInteger256([
                    0xcf6ea8088c17241d,
                    0x309d92e15541a316,
                    0xde6ba9b9fd4b0cf3,
                    0x0687ba2637fbbe42,
                ])),
                Felt::new(BigInteger256([
                    0xb685d6ffebc04037,
                    0xe22d2de07b0d2c14,
                    0x0fd5622f48be805c,
                    0x10d8976133759312,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x8dadded8636c3383,
                    0x55173e2fc2ca92b9,
                    0x37dc1ce741557acc,
                    0x11494c225e6f9dde,
                ])),
                Felt::new(BigInteger256([
                    0x2d6cea9ef75e1a4f,
                    0x7695fe31fe56eb9f,
                    0x65807f1e933b1313,
                    0x106b6465e645ee52,
                ])),
                Felt::new(BigInteger256([
                    0x87fecbd1a75e8b1b,
                    0xf994d8638bec529a,
                    0x9083d68149dd802a,
                    0x0b29047ccd2bcdf3,
                ])),
                Felt::new(BigInteger256([
                    0x91de4acc434ba749,
                    0x8028822c38bd2cff,
                    0x33445727830603dd,
                    0x0f46e5761f94180f,
                ])),
                Felt::new(BigInteger256([
                    0xadc4ee73df966dd2,
                    0x4af03036127ddf8b,
                    0x8bfc04c4d3325ea6,
                    0x0c855feb644ee12f,
                ])),
                Felt::new(BigInteger256([
                    0x1d0a21bfe521553a,
                    0xbb45855d2e021428,
                    0x9731613dd6c445e7,
                    0x0a4f7dbc8781e066,
                ])),
                Felt::new(BigInteger256([
                    0x5713a71af95b35cb,
                    0xa027d0d148a1fd2f,
                    0xac50831f1d28f9e3,
                    0x065f92b5bf19837f,
                ])),
                Felt::new(BigInteger256([
                    0x22857ed422914778,
                    0xfbbaa146b94c996a,
                    0x0f473e4c0005b463,
                    0x0818b802562c862c,
                ])),
                Felt::new(BigInteger256([
                    0x37a3be841da729ed,
                    0xeb3e17e8370754d5,
                    0x1c0caec7d504e390,
                    0x0d687fb639846d1e,
                ])),
                Felt::new(BigInteger256([
                    0x1704588e1cf916bd,
                    0x945bdf60c9182e73,
                    0xbe47a5a12a764f2b,
                    0x0bf48f73f0750440,
                ])),
                Felt::new(BigInteger256([
                    0xdad7bfe30a4b2a9e,
                    0x640795701c82ddd8,
                    0x1da0fc64dfd39a7a,
                    0x08b871872ae9987c,
                ])),
                Felt::new(BigInteger256([
                    0x8c618dac546c4089,
                    0x06c63e4643d152b0,
                    0x0f6ae2e761e02571,
                    0x05858c1b7aa21857,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe0f018beb4b1bf02,
                    0x46661a4e8b06a4ff,
                    0x439445e3f19647aa,
                    0x0cdf74046df32b7a,
                ])),
                Felt::new(BigInteger256([
                    0xe79bb9e6d4c47e3e,
                    0x1bcbda7dcdea370e,
                    0xccb6a31ca618480e,
                    0x0312667fe467ef08,
                ])),
                Felt::new(BigInteger256([
                    0x3ed514afc8b7a982,
                    0x33c6b0d024bd9b39,
                    0xbd564d7b23b497e0,
                    0x114fe32ab1748f8a,
                ])),
                Felt::new(BigInteger256([
                    0x1c721a5432e56e5c,
                    0x8c302668dbc068a6,
                    0xe7ddbc09485ce76d,
                    0x0fb3ac037aca2984,
                ])),
                Felt::new(BigInteger256([
                    0x98e835b32547a0d5,
                    0x6e9f7563795ab54d,
                    0x6bdef4a4381eac16,
                    0x04579f0ee2796b03,
                ])),
                Felt::new(BigInteger256([
                    0x67b5470a9db800fe,
                    0x6486731cd57724d1,
                    0x00fec1d2d82ba7f7,
                    0x03c16df6d30a792b,
                ])),
                Felt::new(BigInteger256([
                    0x85a3738ba5b73687,
                    0xae2b8f46dbb491b0,
                    0x90ecf2def451c358,
                    0x0c3b94407b96f31c,
                ])),
                Felt::new(BigInteger256([
                    0xc097f5ac898bac20,
                    0xbf83c3801499143a,
                    0xded8bb28cc3d6c5c,
                    0x0583d3f2920b0682,
                ])),
                Felt::new(BigInteger256([
                    0xb61f6c57d4bb58dd,
                    0x72ad780f81091f7a,
                    0x4c77ae20cd5a7f77,
                    0x0e8fee53adf798d4,
                ])),
                Felt::new(BigInteger256([
                    0xd74b794c72700d53,
                    0x5e38d68d3d8285b5,
                    0x8c2caef303cb19d4,
                    0x0129d7f6d27e5ba7,
                ])),
                Felt::new(BigInteger256([
                    0x7969183b0a2c7200,
                    0x275d417f8ed2eaf4,
                    0x63c23eecd23e0215,
                    0x07daab9ef2929545,
                ])),
                Felt::new(BigInteger256([
                    0x33a41072edb82002,
                    0xa1560459c395f1c6,
                    0x179f39c6d105a8b9,
                    0x0cf5b7dedeb091cf,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0xb76f9745d1745d17,
                    0xfed18274afffffff,
                    0xfce619835b36a173,
                    0x068b6ffd78dc8d16,
                ])),
                Felt::new(BigInteger256([
                    0xb76f9745d1745d17,
                    0xfed18274afffffff,
                    0xfce619835b36a173,
                    0x068b6ffd78dc8d16,
                ])),
                Felt::new(BigInteger256([
                    0xb76f9745d1745d17,
                    0xfed18274afffffff,
                    0xfce619835b36a173,
                    0x068b6ffd78dc8d16,
                ])),
                Felt::new(BigInteger256([
                    0xb76f9745d1745d17,
                    0xfed18274afffffff,
                    0xfce619835b36a173,
                    0x068b6ffd78dc8d16,
                ])),
                Felt::new(BigInteger256([
                    0xb76f9745d1745d17,
                    0xfed18274afffffff,
                    0xfce619835b36a173,
                    0x068b6ffd78dc8d16,
                ])),
                Felt::new(BigInteger256([
                    0xb76f9745d1745d17,
                    0xfed18274afffffff,
                    0xfce619835b36a173,
                    0x068b6ffd78dc8d16,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x547eaa4fe92c17b5,
                    0xdbdc56d3eeee3424,
                    0xd4e029a17d9b9417,
                    0x0e71b0e9185f0412,
                ])),
                Felt::new(BigInteger256([
                    0x547eaa4fe92c17b5,
                    0xdbdc56d3eeee3424,
                    0xd4e029a17d9b9417,
                    0x0e71b0e9185f0412,
                ])),
                Felt::new(BigInteger256([
                    0x547eaa4fe92c17b5,
                    0xdbdc56d3eeee3424,
                    0xd4e029a17d9b9417,
                    0x0e71b0e9185f0412,
                ])),
                Felt::new(BigInteger256([
                    0x547eaa4fe92c17b5,
                    0xdbdc56d3eeee3424,
                    0xd4e029a17d9b9417,
                    0x0e71b0e9185f0412,
                ])),
                Felt::new(BigInteger256([
                    0x547eaa4fe92c17b5,
                    0xdbdc56d3eeee3424,
                    0xd4e029a17d9b9417,
                    0x0e71b0e9185f0412,
                ])),
                Felt::new(BigInteger256([
                    0x547eaa4fe92c17b5,
                    0xdbdc56d3eeee3424,
                    0xd4e029a17d9b9417,
                    0x0e71b0e9185f0412,
                ])),
                Felt::new(BigInteger256([
                    0xd66a1b1b52ed0c94,
                    0x7350e41fff172b46,
                    0xdee8ec7bf3d076d4,
                    0x08092cd96d87788d,
                ])),
                Felt::new(BigInteger256([
                    0xd66a1b1b52ed0c94,
                    0x7350e41fff172b46,
                    0xdee8ec7bf3d076d4,
                    0x08092cd96d87788d,
                ])),
                Felt::new(BigInteger256([
                    0xd66a1b1b52ed0c94,
                    0x7350e41fff172b46,
                    0xdee8ec7bf3d076d4,
                    0x08092cd96d87788d,
                ])),
                Felt::new(BigInteger256([
                    0xd66a1b1b52ed0c94,
                    0x7350e41fff172b46,
                    0xdee8ec7bf3d076d4,
                    0x08092cd96d87788d,
                ])),
                Felt::new(BigInteger256([
                    0xd66a1b1b52ed0c94,
                    0x7350e41fff172b46,
                    0xdee8ec7bf3d076d4,
                    0x08092cd96d87788d,
                ])),
                Felt::new(BigInteger256([
                    0xd66a1b1b52ed0c94,
                    0x7350e41fff172b46,
                    0xdee8ec7bf3d076d4,
                    0x08092cd96d87788d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xbc9fbddce41f262d,
                    0xdd9574526d0633f2,
                    0x74ab4b549cae7cc8,
                    0x00f4b6647a675f0c,
                ])),
                Felt::new(BigInteger256([
                    0xbc9fbddce41f262d,
                    0xdd9574526d0633f2,
                    0x74ab4b549cae7cc8,
                    0x00f4b6647a675f0c,
                ])),
                Felt::new(BigInteger256([
                    0xbc9fbddce41f262d,
                    0xdd9574526d0633f2,
                    0x74ab4b549cae7cc8,
                    0x00f4b6647a675f0c,
                ])),
                Felt::new(BigInteger256([
                    0xbc9fbddce41f262d,
                    0xdd9574526d0633f2,
                    0x74ab4b549cae7cc8,
                    0x00f4b6647a675f0c,
                ])),
                Felt::new(BigInteger256([
                    0xbc9fbddce41f262d,
                    0xdd9574526d0633f2,
                    0x74ab4b549cae7cc8,
                    0x00f4b6647a675f0c,
                ])),
                Felt::new(BigInteger256([
                    0xbc9fbddce41f262d,
                    0xdd9574526d0633f2,
                    0x74ab4b549cae7cc8,
                    0x00f4b6647a675f0c,
                ])),
                Felt::new(BigInteger256([
                    0x86ef9156cec705ed,
                    0x31911e672304df9a,
                    0xdb1cd013ebe897a2,
                    0x110866f6f86e425d,
                ])),
                Felt::new(BigInteger256([
                    0x86ef9156cec705ed,
                    0x31911e672304df9a,
                    0xdb1cd013ebe897a2,
                    0x110866f6f86e425d,
                ])),
                Felt::new(BigInteger256([
                    0x86ef9156cec705ed,
                    0x31911e672304df9a,
                    0xdb1cd013ebe897a2,
                    0x110866f6f86e425d,
                ])),
                Felt::new(BigInteger256([
                    0x86ef9156cec705ed,
                    0x31911e672304df9a,
                    0xdb1cd013ebe897a2,
                    0x110866f6f86e425d,
                ])),
                Felt::new(BigInteger256([
                    0x86ef9156cec705ed,
                    0x31911e672304df9a,
                    0xdb1cd013ebe897a2,
                    0x110866f6f86e425d,
                ])),
                Felt::new(BigInteger256([
                    0x86ef9156cec705ed,
                    0x31911e672304df9a,
                    0xdb1cd013ebe897a2,
                    0x110866f6f86e425d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x53e71745d1745bdc,
                    0xaa1116eabffffeb8,
                    0xff0b3527e2b10fca,
                    0x0da5b495c3ed1bcd,
                ])),
                Felt::new(BigInteger256([
                    0x53e71745d1745bdc,
                    0xaa1116eabffffeb8,
                    0xff0b3527e2b10fca,
                    0x0da5b495c3ed1bcd,
                ])),
                Felt::new(BigInteger256([
                    0x53e71745d1745bdc,
                    0xaa1116eabffffeb8,
                    0xff0b3527e2b10fca,
                    0x0da5b495c3ed1bcd,
                ])),
                Felt::new(BigInteger256([
                    0x53e71745d1745bdc,
                    0xaa1116eabffffeb8,
                    0xff0b3527e2b10fca,
                    0x0da5b495c3ed1bcd,
                ])),
                Felt::new(BigInteger256([
                    0x53e71745d1745bdc,
                    0xaa1116eabffffeb8,
                    0xff0b3527e2b10fca,
                    0x0da5b495c3ed1bcd,
                ])),
                Felt::new(BigInteger256([
                    0x53e71745d1745bdc,
                    0xaa1116eabffffeb8,
                    0xff0b3527e2b10fca,
                    0x0da5b495c3ed1bcd,
                ])),
                Felt::new(BigInteger256([
                    0x8cf500000000000e,
                    0xe75281ef6000000e,
                    0x49dc37a90b0ba012,
                    0x055f8b2c6e710ab9,
                ])),
                Felt::new(BigInteger256([
                    0x8cf500000000000e,
                    0xe75281ef6000000e,
                    0x49dc37a90b0ba012,
                    0x055f8b2c6e710ab9,
                ])),
                Felt::new(BigInteger256([
                    0x8cf500000000000e,
                    0xe75281ef6000000e,
                    0x49dc37a90b0ba012,
                    0x055f8b2c6e710ab9,
                ])),
                Felt::new(BigInteger256([
                    0x8cf500000000000e,
                    0xe75281ef6000000e,
                    0x49dc37a90b0ba012,
                    0x055f8b2c6e710ab9,
                ])),
                Felt::new(BigInteger256([
                    0x8cf500000000000e,
                    0xe75281ef6000000e,
                    0x49dc37a90b0ba012,
                    0x055f8b2c6e710ab9,
                ])),
                Felt::new(BigInteger256([
                    0x8cf500000000000e,
                    0xe75281ef6000000e,
                    0x49dc37a90b0ba012,
                    0x055f8b2c6e710ab9,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdd9d785bb15c05a4,
                    0x474848e019adb58e,
                    0x1b1b841e83f8ed38,
                    0x105c33973389e1f7,
                ])),
                Felt::new(BigInteger256([
                    0x05c5c247369a73ca,
                    0xa82ec792a6e3a097,
                    0x9ba79c372e79e7b6,
                    0x0a1328a38ccb1ba1,
                ])),
                Felt::new(BigInteger256([
                    0x82d24f5244f5d893,
                    0x41244b241b83e51f,
                    0x5b78f85c8caafa0e,
                    0x024026c2c15c57a3,
                ])),
                Felt::new(BigInteger256([
                    0x22dc5610ce750016,
                    0xe7d8cfd0569c5c6e,
                    0x79f2e829eda3baae,
                    0x08f7856ca7224dda,
                ])),
                Felt::new(BigInteger256([
                    0x39c0b5e1892d6207,
                    0x2a283e6175d64b89,
                    0xd061a6e509f44cde,
                    0x09eb66861ed17170,
                ])),
                Felt::new(BigInteger256([
                    0x2d983ff404d65d07,
                    0x375a20111d343fa6,
                    0x4970691a7f706984,
                    0x064ccf89e1b9e810,
                ])),
                Felt::new(BigInteger256([
                    0xde34178bf0cd37ac,
                    0x27338e1822577e58,
                    0x820e2481aadbe7a4,
                    0x024ff6a0ffa5f8af,
                ])),
                Felt::new(BigInteger256([
                    0x1baba206ab48ab6d,
                    0xc074045ae55f7150,
                    0xb964a218aea7912c,
                    0x10655f7a5b501b98,
                ])),
                Felt::new(BigInteger256([
                    0x8279c39ce0715f41,
                    0x6113ffb8c46a39bd,
                    0xa3c92a40dbf5f555,
                    0x0d841cfe8395058c,
                ])),
                Felt::new(BigInteger256([
                    0x05132be5d46f9fdb,
                    0x99ef5f4484fbbf8a,
                    0x07605394870a7282,
                    0x0b5300cef5f7a886,
                ])),
                Felt::new(BigInteger256([
                    0x139df5e6433f75f7,
                    0x1d77eefe2a689d02,
                    0x4357ca3951bdcc1f,
                    0x02eae2690dcef310,
                ])),
                Felt::new(BigInteger256([
                    0x8e08ee3c1de2ccc6,
                    0xee26f27594645399,
                    0xb3d978f7715dde7f,
                    0x04c49b4484495fd0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xcbb963e85792974b,
                    0x51b006434114eb75,
                    0x14c2a2a69322ac98,
                    0x018408e584ae14f5,
                ])),
                Felt::new(BigInteger256([
                    0xb557c4566c60c75e,
                    0xdd59ee304a370976,
                    0x827098f2312619fc,
                    0x0a082b7fa0100b26,
                ])),
                Felt::new(BigInteger256([
                    0x101e95e12e8ad2aa,
                    0x09b61e94e51825f8,
                    0x0df849e475484860,
                    0x0160aa61c9a827ca,
                ])),
                Felt::new(BigInteger256([
                    0x724ce495380da89b,
                    0x1141cde32d708cc8,
                    0x649080e46c42fc2a,
                    0x05834c3dfa21a086,
                ])),
                Felt::new(BigInteger256([
                    0x4f6980f493f15476,
                    0xbefd87b18c26bcce,
                    0x5c7f82fae323b0c0,
                    0x09fa8cd0751dd19d,
                ])),
                Felt::new(BigInteger256([
                    0x4f74637a422decb9,
                    0x6c99356f79ea5dea,
                    0x1b33e89ba1f8a11d,
                    0x0f08b0b27ef8bd8c,
                ])),
                Felt::new(BigInteger256([
                    0xbdba5f6cb413ad40,
                    0xf3d0ba07c818e837,
                    0x5bb3bd714d329142,
                    0x080f8d3c9eb08642,
                ])),
                Felt::new(BigInteger256([
                    0x7a2ed119e32966c2,
                    0xfeb02f0e19ad1e2c,
                    0xa3becca4db58d220,
                    0x07d23cd2011e378a,
                ])),
                Felt::new(BigInteger256([
                    0x463587bb6408e556,
                    0x8fd4f27830520f91,
                    0x2de37d194ad75934,
                    0x0fec777c85d1cf73,
                ])),
                Felt::new(BigInteger256([
                    0x781774d224dc49c5,
                    0xe8829a716ceea715,
                    0x7e1131059726de5a,
                    0x0974e70174551113,
                ])),
                Felt::new(BigInteger256([
                    0x1d48fbfd345dc587,
                    0x61cb9ce4307572e3,
                    0x49ad2fabb44ce42a,
                    0x0c2b6c17bb0312a5,
                ])),
                Felt::new(BigInteger256([
                    0x91a5efbf8dfbaa28,
                    0xc188700bd92cd4d1,
                    0xbfa9ac6d072967eb,
                    0x0c95099a720b3eca,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf6219e5ce196998f,
                    0xd34f61e30834f6c0,
                    0x86fcfccdc7c22163,
                    0x0ba950079437d403,
                ])),
                Felt::new(BigInteger256([
                    0x5260a3492cae996c,
                    0x86d1b7290aecd3c4,
                    0x04bb6e74bccd5fab,
                    0x08a003d8e8b05bb6,
                ])),
                Felt::new(BigInteger256([
                    0x22a7b5ed1901933f,
                    0x503eea9dc4c069bb,
                    0x76157e58b85d3421,
                    0x09c08c36022aaa1a,
                ])),
                Felt::new(BigInteger256([
                    0x256631d1e0d9199c,
                    0xbfae2c9f4bbb3445,
                    0xdc407179abdb23bd,
                    0x0325ae71fbdb4a60,
                ])),
                Felt::new(BigInteger256([
                    0x97b837df7c47e216,
                    0xada7e2695eb5f7b8,
                    0x92be3839a860906f,
                    0x1008274b08fd8eb6,
                ])),
                Felt::new(BigInteger256([
                    0xa85f46c8fdcf71a7,
                    0x83a7b69bf2e5a86f,
                    0x528a578f137be03c,
                    0x018cf4f8efee7017,
                ])),
                Felt::new(BigInteger256([
                    0xe39948d74dc15ce5,
                    0x5b5602ce8e8b2eb2,
                    0x1a9c0ba9d22019a1,
                    0x10c78c4f59bc2777,
                ])),
                Felt::new(BigInteger256([
                    0x0a618a67f13af233,
                    0xbc10e6cf4e444528,
                    0x607baf92d60b0d3b,
                    0x101aa85b967f448f,
                ])),
                Felt::new(BigInteger256([
                    0xf5681680d5ab6b6d,
                    0x955b76c94e3de8a1,
                    0xe0d76452f7035082,
                    0x0c5af9b90828f6ff,
                ])),
                Felt::new(BigInteger256([
                    0xa733a4dbeb17c15c,
                    0x5664ad57034f513a,
                    0x074504ed84c8df7a,
                    0x010ba3fe3566a196,
                ])),
                Felt::new(BigInteger256([
                    0xcb13db70d078190e,
                    0x6883ab2eff55eb86,
                    0xa3451acf10d3a56e,
                    0x1117d0b6964d010e,
                ])),
                Felt::new(BigInteger256([
                    0xd9bd87d483dc9a73,
                    0x17adde1b2421248e,
                    0x9f63b21a16484cba,
                    0x0d457068fd336768,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x614edf395b37eb0e,
                    0x3cf51c392d6b05ba,
                    0x6fe245be159997ed,
                    0x0d394e8176f87785,
                ])),
                Felt::new(BigInteger256([
                    0xd0f83eca09cce171,
                    0xd55ab65d3f1e2982,
                    0x93ccb80912a6dd80,
                    0x07d493fadedf8e53,
                ])),
                Felt::new(BigInteger256([
                    0xefeabb85ee3b4e80,
                    0x562b175bcf9178db,
                    0x7f940244ead1861f,
                    0x0b23f4e687d105f8,
                ])),
                Felt::new(BigInteger256([
                    0x2c50801b4598715c,
                    0x929efef7d54b63cf,
                    0xe3edd6b7b4a3c374,
                    0x057aba6634a8736f,
                ])),
                Felt::new(BigInteger256([
                    0x9b5f3c57bb64f8a2,
                    0xf21cf467c3ac27d0,
                    0xd4e84dcd0866d0c6,
                    0x06c8c4c5aee23a27,
                ])),
                Felt::new(BigInteger256([
                    0x20c3a998ec877bf7,
                    0x625c2197278c2390,
                    0x6f103dd64d05ba8a,
                    0x06d30f198e77e0ba,
                ])),
                Felt::new(BigInteger256([
                    0x8de381fc2dc8bfbf,
                    0x6148c49fe5764a3c,
                    0xa86cac5538797a43,
                    0x07e4b147bdbed355,
                ])),
                Felt::new(BigInteger256([
                    0x74819c80aaaf74ef,
                    0xb18fab0522919e2b,
                    0x1aa14be512073d35,
                    0x002cc40c7db0d930,
                ])),
                Felt::new(BigInteger256([
                    0x986716bbed405662,
                    0xb27d37a1037f8a68,
                    0x25fa4dccec7f1caf,
                    0x0e8e55b10961d9de,
                ])),
                Felt::new(BigInteger256([
                    0xba1b776d4232d254,
                    0x2c3c0c7f7149969a,
                    0xff161cb80d41b743,
                    0x0a3ea9d9bd116410,
                ])),
                Felt::new(BigInteger256([
                    0x01f0f1c9a5440efb,
                    0xcb963e6b4ca12bbb,
                    0xc855ef8c6c3e6ad2,
                    0x064228a9cbcce879,
                ])),
                Felt::new(BigInteger256([
                    0xa78b35c89deea869,
                    0x530540acfee8df08,
                    0xd816ea81d99be8ad,
                    0x019a83ab1cecdc25,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7d8ff104806a7f8e,
                    0xb836bbbea8c1e610,
                    0x314f2877927c49f9,
                    0x01afa660aa9b02b3,
                ])),
                Felt::new(BigInteger256([
                    0x11e151ef4408f703,
                    0x03ba657dbc5b0bee,
                    0x51f0ea5a8c9757e7,
                    0x029cf12678f74fcf,
                ])),
                Felt::new(BigInteger256([
                    0x9ec7c18b1d5349c5,
                    0x77806df75dce1cb2,
                    0xd6812dce24813a84,
                    0x0ceb75f7ee7e7964,
                ])),
                Felt::new(BigInteger256([
                    0x138e1a212eda1ad5,
                    0xf94670fb885b89cb,
                    0x8b47cd9c1f7e14e6,
                    0x0b99c2473668c499,
                ])),
                Felt::new(BigInteger256([
                    0xd41a9e8ad2cdd8cd,
                    0xcf0c5e30ab857d2b,
                    0x1b3d42224ea739eb,
                    0x090435d1f506355a,
                ])),
                Felt::new(BigInteger256([
                    0xa8a83ed8bc93cc1c,
                    0x5a39dfe88404a848,
                    0x1a0aa0d621df5a4d,
                    0x09de151e480cc252,
                ])),
                Felt::new(BigInteger256([
                    0x0197298ccc099b49,
                    0x4d3743f680c0b263,
                    0x5ed6881c65bccae6,
                    0x10cc978a237f0287,
                ])),
                Felt::new(BigInteger256([
                    0xc02f821c06e9b0b0,
                    0xe46bcecda9637570,
                    0x8436550f26760a30,
                    0x09594f7c4678642a,
                ])),
                Felt::new(BigInteger256([
                    0x0a13198533e31a4e,
                    0x28f2bd80be26ecdb,
                    0x1989eea03d43b7a3,
                    0x0999c5d908104639,
                ])),
                Felt::new(BigInteger256([
                    0x29e8f1ffaf1f3d5c,
                    0x9f261ed4956861a0,
                    0x631d552e99cac9c1,
                    0x07cc8089fb094aa9,
                ])),
                Felt::new(BigInteger256([
                    0xacbaf20e640a791d,
                    0x344e582153f5b1e7,
                    0x2deb932690649431,
                    0x026ec8301f4c2570,
                ])),
                Felt::new(BigInteger256([
                    0x18b5ca7a0cefb5e2,
                    0x8e0ca02d69f4ce53,
                    0xd7cba9f95ed858fb,
                    0x0c69a13ca9e5b9f5,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb45acf2c99c00cd1,
                    0xc4cbfa2909e86e7f,
                    0xb91f843c80ffd605,
                    0x0c3bde88c8d50575,
                ])),
                Felt::new(BigInteger256([
                    0xc27acd994dab6050,
                    0x335411f3c126eb8f,
                    0xa9989add51be780e,
                    0x086d9b50da38cee9,
                ])),
                Felt::new(BigInteger256([
                    0xce0880ae9c223454,
                    0x3a7910ca83690735,
                    0x9763e614e0b016eb,
                    0x0bdda7422d382437,
                ])),
                Felt::new(BigInteger256([
                    0x024d5dbc30a74820,
                    0x3bdeaf787d6aff04,
                    0x3707cbbd76bde3e2,
                    0x09554cf027650be7,
                ])),
                Felt::new(BigInteger256([
                    0x7d143e6ca61f8da5,
                    0x4662735bb03b3b23,
                    0x9ea81965dd4afebc,
                    0x044617057103f7f3,
                ])),
                Felt::new(BigInteger256([
                    0xfdf120032745ddd8,
                    0xb789ca196c6317d7,
                    0x4b6eb736fc27845f,
                    0x026eebd1060a7b0c,
                ])),
                Felt::new(BigInteger256([
                    0xbf6bddd2ea50fe7e,
                    0xac4e582adf0f4335,
                    0x833a7eaff9f0f6c7,
                    0x10748967f4b37a52,
                ])),
                Felt::new(BigInteger256([
                    0xa6a25c8a314bacdb,
                    0xf698409e4a36fee8,
                    0x6f8733de52a903ff,
                    0x09c99beedc2c1360,
                ])),
                Felt::new(BigInteger256([
                    0x72d8eb313c3fa5c3,
                    0x895add09861db614,
                    0x17d3caffdb1e96cb,
                    0x018cbec87103311e,
                ])),
                Felt::new(BigInteger256([
                    0xc40baef880b209cd,
                    0xe4032c2b34016ef1,
                    0x67fbcfdb02dfa0da,
                    0x08b096a4d44b6bd2,
                ])),
                Felt::new(BigInteger256([
                    0x28358c64c865759d,
                    0x2bc60f4321de47b5,
                    0x138cbfdbec5a5917,
                    0x042aa0b031448ddf,
                ])),
                Felt::new(BigInteger256([
                    0xcf18e062c1bed455,
                    0xfb0c95e51a3b5ff7,
                    0x6ad3caf234439251,
                    0x0bb1a6e1845646fb,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x51ed70b58beecfd7,
                    0xc74fa788841523f8,
                    0xc0e1681fe986a617,
                    0x00f123b795357eb9,
                ])),
                Felt::new(BigInteger256([
                    0xf7deea08109650cd,
                    0x75f95833851cee71,
                    0x452d103c20add6cd,
                    0x036e6216e966b3bb,
                ])),
                Felt::new(BigInteger256([
                    0x4b57c62af17126d6,
                    0x93b75777cbcf03df,
                    0x3407c196a52c8041,
                    0x0ba181f345558b0d,
                ])),
                Felt::new(BigInteger256([
                    0x3fd07bf9e3e5c7c2,
                    0xfcc1e684f5155029,
                    0xe10bf997dc1dab85,
                    0x097ca318ddff1bfa,
                ])),
                Felt::new(BigInteger256([
                    0xff94e184c4f82133,
                    0x8c2eac606ad622d9,
                    0x48a5c254babf96fc,
                    0x06cf6f547f0beca0,
                ])),
                Felt::new(BigInteger256([
                    0x3896cd9d76367906,
                    0x3d18d3816b544697,
                    0x939c7c20abcf2831,
                    0x050a59e26c27ee8f,
                ])),
                Felt::new(BigInteger256([
                    0xda4ad1c7f1459b92,
                    0xf7f66556ecbb4fa9,
                    0xa93b266471f7ba4d,
                    0x06cc94208017d9d9,
                ])),
                Felt::new(BigInteger256([
                    0x9a994e5b4d13658a,
                    0xfa4b3baf44d3e808,
                    0x1c895e52197fe6a4,
                    0x11c78d78d90a085b,
                ])),
                Felt::new(BigInteger256([
                    0x02171f6aa108f559,
                    0xd9068135f4c26af2,
                    0x3071ac4f8e3aeb42,
                    0x08ad62fac60d7d4e,
                ])),
                Felt::new(BigInteger256([
                    0x1fb51a05fd10fe49,
                    0x1c2c9421e494e3e4,
                    0x8b476c1783fde1c1,
                    0x0c609745c6a66601,
                ])),
                Felt::new(BigInteger256([
                    0xa311ef07b7f5bd74,
                    0x9da4b4f4c021dcf6,
                    0x4855e488df5d1d50,
                    0x033caccbbbc998e5,
                ])),
                Felt::new(BigInteger256([
                    0xb46ef4c5b4ecb663,
                    0x87d76f9f488700fa,
                    0x6ae874c293ad9ad7,
                    0x014795ad963c3cd4,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x393de7140eaa23dc,
                    0x93687a1006437fa3,
                    0x945c037f072d2602,
                    0x03fd6da7b38e5b74,
                ])),
                Felt::new(BigInteger256([
                    0x3938a66e621bdd94,
                    0x6d56e82d8d045fa4,
                    0x4026b049b00d2967,
                    0x0341d0820405f12f,
                ])),
                Felt::new(BigInteger256([
                    0x91c3575684f31b7a,
                    0x9f883591a30eb4c1,
                    0x94862665259bd942,
                    0x11a68ba0615c1196,
                ])),
                Felt::new(BigInteger256([
                    0x419206716e3b167f,
                    0x023a8d331666fd4b,
                    0x993cf6650a624ee2,
                    0x0b7a51e69c1fcefb,
                ])),
                Felt::new(BigInteger256([
                    0xcb182c5a001e5982,
                    0xd84338cbb2e3dcc8,
                    0x396ee273c0bcfb8c,
                    0x0cf92f16f2f83836,
                ])),
                Felt::new(BigInteger256([
                    0x6417115311d6437e,
                    0xb56dc6925ac1ed1e,
                    0xa49f1619e92651b7,
                    0x050370d12e328372,
                ])),
                Felt::new(BigInteger256([
                    0xa7e5ea74e431f945,
                    0x91edadf52ff7952b,
                    0x02843583d0c70af1,
                    0x0f60e25f48558a48,
                ])),
                Felt::new(BigInteger256([
                    0x148a68e0d8310c5a,
                    0x149384f6c745ae65,
                    0x6fc528ddbb7187f9,
                    0x1016c4fbd4916ff9,
                ])),
                Felt::new(BigInteger256([
                    0x303ff0ba64e8abcf,
                    0x0bd0e9e019bae42f,
                    0x3c045532de4f6842,
                    0x10bb1813af948abf,
                ])),
                Felt::new(BigInteger256([
                    0xc20ee62d98577c1a,
                    0x801c14f922d018e9,
                    0x5e7bfd1abce999df,
                    0x084a7fedc199c4c9,
                ])),
                Felt::new(BigInteger256([
                    0x364da091b7883093,
                    0xe2a4f436b0a713ab,
                    0xdcb9387896ebae5a,
                    0x0c8155748daa26ef,
                ])),
                Felt::new(BigInteger256([
                    0x0f41ba6424ee3e6b,
                    0xfb550089fb3aa5be,
                    0xd06b7792cdf2f3c4,
                    0x081b1bdd51fe7515,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7be05e24b05d8c06,
                    0x038b70fe11735378,
                    0xe9c179b434967406,
                    0x0f2e72b80d53854b,
                ])),
                Felt::new(BigInteger256([
                    0x330f652af5759a82,
                    0xbfa77b5925bde6ba,
                    0x59084f12bee3d460,
                    0x0fa94b16f80df489,
                ])),
                Felt::new(BigInteger256([
                    0xd50f8fd258e59ad4,
                    0xb6f008050e3d6751,
                    0x0af507ebe9372382,
                    0x017aa333f46c4ce4,
                ])),
                Felt::new(BigInteger256([
                    0x070323e3c7143fa8,
                    0x090a431e1ab9c5da,
                    0x650f79217fbd32d2,
                    0x0e2fd130d146a751,
                ])),
                Felt::new(BigInteger256([
                    0x94a8eb6ce17be63f,
                    0x6684ad6e5dff140e,
                    0xbd283eac9c68205f,
                    0x09ae5edf94539fb7,
                ])),
                Felt::new(BigInteger256([
                    0xc82b624ce0137a82,
                    0xdce4fa6133c074c1,
                    0xb57469ac76e819cb,
                    0x0e5ac21eafecdb9c,
                ])),
                Felt::new(BigInteger256([
                    0x42e1aa07a76b2cad,
                    0xa4c6bf19d5fd2523,
                    0xa288bb098661904f,
                    0x01251882cd2a4a77,
                ])),
                Felt::new(BigInteger256([
                    0x2869b2d57532faa2,
                    0xa2495481b7c54fc9,
                    0x44fa19626417b35a,
                    0x04d92d1b72b7c0a4,
                ])),
                Felt::new(BigInteger256([
                    0x43f1c15521226159,
                    0x977c9e4142a84382,
                    0x4e8cb32544cefdbc,
                    0x049263eb2a419e86,
                ])),
                Felt::new(BigInteger256([
                    0xb567b333b132b5dc,
                    0x349291f267e95d02,
                    0xecfac6ab605197e8,
                    0x04fb0c33268d395e,
                ])),
                Felt::new(BigInteger256([
                    0x41b02c2989bd5bb8,
                    0x2a0da405e0c64f22,
                    0x50f8da50c6269c2b,
                    0x0bbb9732656f0599,
                ])),
                Felt::new(BigInteger256([
                    0xfbdc01b4b4984b38,
                    0x4b4a7ab094831efa,
                    0x8a8c1bec4a1070aa,
                    0x032eb6f3deedfd4b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe192ec158c1a5368,
                    0x3744c42a4c3c44da,
                    0x00e8da888d6aa45e,
                    0x127aa3c8e8f2ba1b,
                ])),
                Felt::new(BigInteger256([
                    0xa9ec0d5dbba95947,
                    0x22884dc9ff99d6a7,
                    0x65a136a030d2ee03,
                    0x128729461dadafdf,
                ])),
                Felt::new(BigInteger256([
                    0xe2db6b2e483ce63b,
                    0x2ab0c6da70d17037,
                    0xa534fed084d4ed26,
                    0x128218ba2b26d584,
                ])),
                Felt::new(BigInteger256([
                    0x4124c7a3c389bc5e,
                    0x6e002f884bd0b5e8,
                    0xc3e2bad8cf28cc8f,
                    0x102cb03ae691af18,
                ])),
                Felt::new(BigInteger256([
                    0xc2acbe4fd06b8b50,
                    0x9784aaf5c4f7484e,
                    0x915266e7fe7a7a62,
                    0x069fbb9fe15a9025,
                ])),
                Felt::new(BigInteger256([
                    0x041189f516ed6f2f,
                    0x221e3c68df59803a,
                    0xa5c71df8a089a173,
                    0x0090d160b92a3c11,
                ])),
                Felt::new(BigInteger256([
                    0x896c5655dbfb4746,
                    0x197ccb0a960ed72c,
                    0x8e57bb9185d77527,
                    0x02283fd8c09faf99,
                ])),
                Felt::new(BigInteger256([
                    0x93bb1ed7302e6e33,
                    0x6361ae0cef42c53f,
                    0x6487f9ec9c75f06b,
                    0x0f6527b84f470da8,
                ])),
                Felt::new(BigInteger256([
                    0x8fc368d4b54b6db0,
                    0xf325bf8c1dec39aa,
                    0x69ce60f2d2af595a,
                    0x03f1ebfa01d545fd,
                ])),
                Felt::new(BigInteger256([
                    0xa2925bccd3c0c598,
                    0xd91878d665f39fb6,
                    0x96cd16863195b132,
                    0x01626f953634ce1d,
                ])),
                Felt::new(BigInteger256([
                    0x070c4430fa23ec22,
                    0x0ded4b8e7bf14335,
                    0x815c7f6d8428a1ca,
                    0x02592e4955a698c6,
                ])),
                Felt::new(BigInteger256([
                    0x8a334c8661b44c36,
                    0xb5167029bf9b7521,
                    0xed4b9d4bdee7619f,
                    0x10b08d7d09b434ab,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x78bd4e4d261812e2,
                    0x25f35489d4f3f5bf,
                    0x234ce53405cffdb8,
                    0x0aca259d05a2062b,
                ])),
                Felt::new(BigInteger256([
                    0xddcfb31b0fe60650,
                    0x76129998b8106985,
                    0x1cb04c8c5b02503e,
                    0x0771541c3b77be11,
                ])),
                Felt::new(BigInteger256([
                    0x4d6ae498f8c7f1a2,
                    0xa3cd6a427172885c,
                    0x9ca7cdf23348e115,
                    0x03d5f2a4564d3c99,
                ])),
                Felt::new(BigInteger256([
                    0xa710ce349afa148d,
                    0xd96755f223377b48,
                    0x200272e4de7da593,
                    0x0398cf4d1a592b8f,
                ])),
                Felt::new(BigInteger256([
                    0x77370806549e8811,
                    0x1d74867e1cf82765,
                    0x7675c9851f0cd305,
                    0x00b7f447832213b9,
                ])),
                Felt::new(BigInteger256([
                    0x43f9e6fe88d5b35d,
                    0x0ff628fe92222377,
                    0xec17244a04bc3a9a,
                    0x116ba68421770898,
                ])),
                Felt::new(BigInteger256([
                    0x7f1921e08735f0ff,
                    0x4013abed58058db3,
                    0xd681ef7256e28a91,
                    0x0b0cce94aa59d348,
                ])),
                Felt::new(BigInteger256([
                    0xe9b65aa033a6de31,
                    0x11eb3ef7b694fc57,
                    0xe2013b444be46e35,
                    0x0f1a68abf8c35dcf,
                ])),
                Felt::new(BigInteger256([
                    0x7b3c30cb1c85ad43,
                    0xb8ac05380358c16a,
                    0xbd310c91b3867eaf,
                    0x034f240a9e3ff6ef,
                ])),
                Felt::new(BigInteger256([
                    0x4ead26745bb6ef73,
                    0x8d3e85d5e8fd5bdb,
                    0xa33d7d7d9c6209d7,
                    0x108d9dfe09f38d64,
                ])),
                Felt::new(BigInteger256([
                    0xcb443fcda823a3ac,
                    0xcc819cc29528a1af,
                    0x9658d8ad4ae407a4,
                    0x058a6c870e4c7e89,
                ])),
                Felt::new(BigInteger256([
                    0xeec03d3e9cdc818a,
                    0x3c1a60c6c6072ae0,
                    0x782e166a20dee7a8,
                    0x0e804b54852c7ec1,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf1dafd21345c23ff,
                    0x80baef5c2fd4ec22,
                    0xc898d3a9474d2ebc,
                    0x11e7b56ca1d638e2,
                ])),
                Felt::new(BigInteger256([
                    0xb06cca7f5a799156,
                    0xdedd5b7e0efce7f2,
                    0xcdbf666bb19df4ef,
                    0x1148214ed73745f0,
                ])),
                Felt::new(BigInteger256([
                    0xbd091044dafebf60,
                    0x74f3611de4d46f6d,
                    0x2f47311cdac74f1c,
                    0x03ab96609fbbdf5c,
                ])),
                Felt::new(BigInteger256([
                    0x3a33a160b968f6d5,
                    0x3b566cd56a814021,
                    0xef46768ea6157c77,
                    0x09a30720cf7674c1,
                ])),
                Felt::new(BigInteger256([
                    0xcab3af8aa5c33ffa,
                    0x3b66e8b5edfd5c16,
                    0x73385e61940b97f5,
                    0x0df5fd0e49a0ce03,
                ])),
                Felt::new(BigInteger256([
                    0xf59c368a8f520302,
                    0x33ce20591a6ef872,
                    0x6dba186ea4b175db,
                    0x0eec41b2c7382c22,
                ])),
                Felt::new(BigInteger256([
                    0xedfa8f9d1b21fbfe,
                    0x591cc046c2d4cd18,
                    0x4baa935126a5a652,
                    0x0d31bd025d66c86e,
                ])),
                Felt::new(BigInteger256([
                    0xeab811ece7a03455,
                    0x27c02e268a8c4a1c,
                    0xec49152eca0242f2,
                    0x0af273fe65f4d94f,
                ])),
                Felt::new(BigInteger256([
                    0x5a9bb2971585dcf5,
                    0x2f696a3a3e808821,
                    0xd86d2d37addc2faa,
                    0x0b950b1cac7faba2,
                ])),
                Felt::new(BigInteger256([
                    0x265f28d467649c3b,
                    0xac91622f92c47ed0,
                    0x7a055fb32781d2fb,
                    0x013ba5d6e02dd236,
                ])),
                Felt::new(BigInteger256([
                    0xd078a550cb5e6a7b,
                    0x06c282c44ce6d498,
                    0x9ae3409ae8546690,
                    0x06885f9bd5081a30,
                ])),
                Felt::new(BigInteger256([
                    0xdba11749acd6090a,
                    0xf6f954bf9c52eb1f,
                    0xaba9fdab04dfd01e,
                    0x072051fb70144176,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::new(BigInteger256([
                    0x3944fffffffffeee,
                    0x078ca3455ffffee3,
                    0x7f0575814c659e8e,
                    0x048d80befc37098c,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x360c566e9e8f304a,
                    0xa34bb22a2b1cb473,
                    0x624f3c169143bfce,
                    0x0ad21a6a938bf4aa,
                ])),
                Felt::new(BigInteger256([
                    0xd526d28858428fd8,
                    0x4db6d07bfca8a6f5,
                    0xc2c123b84c4ef311,
                    0x084527875e12abb2,
                ])),
                Felt::new(BigInteger256([
                    0xacd8cce51c492a46,
                    0x6b250c0821cf2174,
                    0x1e1b283e439b18c4,
                    0x0c5444384ad941d2,
                ])),
                Felt::new(BigInteger256([
                    0x8fdfc05736d31062,
                    0x07a5a76332a79619,
                    0x35e2dccc998766fa,
                    0x0a1c44e1884fb422,
                ])),
                Felt::new(BigInteger256([
                    0xbe8ef0152fecbda5,
                    0x5292b2c68068836e,
                    0xd91b3d7182e4c30d,
                    0x0cca5378a7dd0010,
                ])),
                Felt::new(BigInteger256([
                    0x8b83ca150afa8490,
                    0x20bfb468786ba744,
                    0x07a020505765b736,
                    0x01bd4c2e51c5a1a5,
                ])),
                Felt::new(BigInteger256([
                    0xef9a2a82f56780e3,
                    0xfb67114afee3555b,
                    0xd9dc407d160d306e,
                    0x0bb66e6334e1867c,
                ])),
                Felt::new(BigInteger256([
                    0x652e48aa1e7e7097,
                    0x7c14248c2878e820,
                    0xd365d8dd93e76bab,
                    0x0887fc7e442344aa,
                ])),
                Felt::new(BigInteger256([
                    0xf61972c6e07a08ec,
                    0xaa27b90c25eb0c3e,
                    0xa39126c220f6dd8c,
                    0x00ea75272148c107,
                ])),
                Felt::new(BigInteger256([
                    0xaab84bcb88939d1d,
                    0x0265253c1573db18,
                    0x2f3adb8e17a6d46c,
                    0x085154361cb4408d,
                ])),
                Felt::new(BigInteger256([
                    0x7d39cb9652a7c013,
                    0xea86804c7e7b55b9,
                    0x2f9828f51d3f9ebc,
                    0x0968cef3960fe856,
                ])),
                Felt::new(BigInteger256([
                    0x27884e43eb10d3db,
                    0x174cd1ba35fd5ec4,
                    0x2b1d9e88efb4fd58,
                    0x0bf7297559317b94,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x195cf3002429024e,
                    0xe17c5533550ed151,
                    0x2ae2ee3af2010aba,
                    0x0e5cc34d1a7175b5,
                ])),
                Felt::new(BigInteger256([
                    0xb76d8398e365cb29,
                    0xa6dfadccaa361ecd,
                    0x31c05e35ced4da1e,
                    0x06e2a941508fdbd7,
                ])),
                Felt::new(BigInteger256([
                    0xfe1a921cd0dc3135,
                    0x575890d9ca94b8e3,
                    0x8f06810c31b0f81b,
                    0x0f93d52b8c0e275b,
                ])),
                Felt::new(BigInteger256([
                    0x4bf8cf43e6c2c2a2,
                    0x014e9d4e360cbab1,
                    0x6788cae0b73a8e29,
                    0x099d5208d89d4ec6,
                ])),
                Felt::new(BigInteger256([
                    0xbd5967fbf4848f36,
                    0xa7a5c35aea353ee2,
                    0x52be4759dfcb9c75,
                    0x0d68dabed5ba4f3a,
                ])),
                Felt::new(BigInteger256([
                    0x21a5735f827df779,
                    0xf7b6524575a77dd5,
                    0x19de454dfca788a1,
                    0x0092721bf79b94f2,
                ])),
                Felt::new(BigInteger256([
                    0x2707b11cf613fe6c,
                    0x4b8a011c53ffe7ae,
                    0xd2e150cbc3f93bb7,
                    0x107acbca117dabe4,
                ])),
                Felt::new(BigInteger256([
                    0x0805abbb3db1dbb5,
                    0x8ef6df4876e2cf3d,
                    0xd3b1a31f0548a2c1,
                    0x0703866b58c9e136,
                ])),
                Felt::new(BigInteger256([
                    0xb6e69081e5db918f,
                    0x0940ddc6d3c33382,
                    0xa2ebb919789b18a5,
                    0x076a2b4da24a3465,
                ])),
                Felt::new(BigInteger256([
                    0x800ed68d7468cfce,
                    0x3a7b9fc34a663cd8,
                    0x8ce755037ef4e74d,
                    0x0321192793ff427e,
                ])),
                Felt::new(BigInteger256([
                    0x42ff64b36c3c9be1,
                    0x3d02fc1929e9c95c,
                    0x2debd649d58e5f17,
                    0x0c7508111c13d672,
                ])),
                Felt::new(BigInteger256([
                    0x47a83f6cbfb962c9,
                    0xe79d78cc66519885,
                    0x49f59cc48e7d1182,
                    0x01f38154a83d6eca,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x69a9e94374b553df,
                    0x0623be5c194ea857,
                    0x61f6db0e32f17acb,
                    0x028692d4f2d881fd,
                ])),
                Felt::new(BigInteger256([
                    0xbd03aeb8ac1a39eb,
                    0x03de815bd79b2c62,
                    0xa473bd22782e5ae5,
                    0x129532779cedbab4,
                ])),
                Felt::new(BigInteger256([
                    0xcb8434e97750d25d,
                    0x0f6fd410ebaa4607,
                    0xda6be7118f08bcf2,
                    0x0aa10e73e6e58cc9,
                ])),
                Felt::new(BigInteger256([
                    0x7299878eeaee6afc,
                    0x41fe1f917bed7392,
                    0xc0c3463b8e90db92,
                    0x097930e69d93685f,
                ])),
                Felt::new(BigInteger256([
                    0x7741a3460f73f2e3,
                    0xe19a0f0a849ec5cb,
                    0xa0b4b2b8e6898a29,
                    0x00b4fc3bc02089ad,
                ])),
                Felt::new(BigInteger256([
                    0x61bce73c00b4e515,
                    0xb52340b8b8fe6f3e,
                    0x16a275adbfc4c946,
                    0x0617970c67875a44,
                ])),
                Felt::new(BigInteger256([
                    0xdd91c321445f7090,
                    0x147cc5c58fc16091,
                    0x3ec5f60badfb0ea7,
                    0x00ba3d64cd219844,
                ])),
                Felt::new(BigInteger256([
                    0xc67682ff46381666,
                    0x1651e197db82a23a,
                    0xa0598378a76d7278,
                    0x119e053d464340b5,
                ])),
                Felt::new(BigInteger256([
                    0x2fa792c40732d32c,
                    0x254b228644f9c19a,
                    0x15185e393ea17a7c,
                    0x07d5cdde2fdd45bb,
                ])),
                Felt::new(BigInteger256([
                    0x13b8f12ad63f4160,
                    0xb706550453179c43,
                    0x6ad680285cd04f49,
                    0x0fcef36cc89fc05c,
                ])),
                Felt::new(BigInteger256([
                    0x966ed28cf093a0c4,
                    0xc465213c38a5ed56,
                    0x1802d31b10eee27e,
                    0x01c5e90d9769bedf,
                ])),
                Felt::new(BigInteger256([
                    0xffef54b73114b0ac,
                    0x5bd48070f452f904,
                    0x16ff24f0ac022d4e,
                    0x055f7fa7f08ef7e8,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb9be4cdaca4ba478,
                    0xd3843ff2c27aaea6,
                    0x57efac29aad0d8a3,
                    0x070c74dada5f6ab1,
                ])),
                Felt::new(BigInteger256([
                    0x3fe003014b72c22b,
                    0xb782822ccde3a80a,
                    0x55ad193d3d9febc6,
                    0x01b96e5a5b5f9c32,
                ])),
                Felt::new(BigInteger256([
                    0x5cd00233fb3ab9ea,
                    0x3d99858673b6601b,
                    0x315708250ac68882,
                    0x11ad461b04fc81b5,
                ])),
                Felt::new(BigInteger256([
                    0x97fa9a1364e30690,
                    0x5b195e8582af64d5,
                    0x1a4d1deb328bf1a3,
                    0x03637bf28bb8f6f2,
                ])),
                Felt::new(BigInteger256([
                    0x5d2387ba78b8431d,
                    0x5eb5838fb268662f,
                    0x35b92b1e5dfa7e01,
                    0x08f1ff2fce490575,
                ])),
                Felt::new(BigInteger256([
                    0xb7a5a6eeab2d5900,
                    0x378972d7a688493e,
                    0x5de76fa6cb60017d,
                    0x07e79f9e02481d81,
                ])),
                Felt::new(BigInteger256([
                    0xd688307959b505df,
                    0x21e42f6d91313f8e,
                    0x4c7e455668cc6b88,
                    0x1142fde5618c6607,
                ])),
                Felt::new(BigInteger256([
                    0x3b2aac066b48220d,
                    0x771bb8422ffc4ad9,
                    0xf66f3a43166032a6,
                    0x0e43b9999305a106,
                ])),
                Felt::new(BigInteger256([
                    0x5e99ee18939b6c8b,
                    0x42b36c9f58c9d337,
                    0x85471a7a867e96a8,
                    0x0db86939717480d5,
                ])),
                Felt::new(BigInteger256([
                    0xde47420a31818cf0,
                    0x59519dd5d4173170,
                    0x016bd44d840eea7c,
                    0x031af35b8fb1657f,
                ])),
                Felt::new(BigInteger256([
                    0x32ac86daa303f994,
                    0x96051218708d3481,
                    0x671bb606c8a7de28,
                    0x087a3d2fcd8e85bf,
                ])),
                Felt::new(BigInteger256([
                    0x70b1bef9a7fc7ad0,
                    0xcb3174e0b03fd711,
                    0xfd254385a963d915,
                    0x101e5c9a9d7b7a3b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x76737a1c68591cc7,
                    0x12c36329ebdf7f3b,
                    0x6933c78d4a8f8632,
                    0x02e31064347593c7,
                ])),
                Felt::new(BigInteger256([
                    0xcafcfb32bcd347f1,
                    0x286cb8e88f6c7519,
                    0xfd20f7daa28f556b,
                    0x08c217b54ae64c33,
                ])),
                Felt::new(BigInteger256([
                    0x9dfba0fed2d0f017,
                    0x709d08f95d414d89,
                    0xc6b3bdcb83069024,
                    0x09d95d3f954f88ed,
                ])),
                Felt::new(BigInteger256([
                    0xa22e9f8846a7cb91,
                    0x16656f270b6725d0,
                    0x1daf27903c0276f7,
                    0x0a9b7707762968fc,
                ])),
                Felt::new(BigInteger256([
                    0xcdb9f2910d18c0c6,
                    0xa8ff607d38c15fad,
                    0xca50b7feaf526e9c,
                    0x090594e053eb7b6c,
                ])),
                Felt::new(BigInteger256([
                    0x722a182dc45936da,
                    0xb06cec1072f7cc01,
                    0xbc11ea098a991b60,
                    0x0d7fc3bb608cf628,
                ])),
                Felt::new(BigInteger256([
                    0xa990fb7b3f72161d,
                    0x1d55a03bf7cd80a0,
                    0xb9cc92585b2eae9f,
                    0x0501a8804bf1a483,
                ])),
                Felt::new(BigInteger256([
                    0x63a8d4c6be1077f7,
                    0x13c125f003865c5d,
                    0xf84ee128db3b481b,
                    0x1052f16fd6088e35,
                ])),
                Felt::new(BigInteger256([
                    0xf1e08f63a4ac4236,
                    0x3b55a8d4b54f2b27,
                    0x0e49c7c2bbdd31d4,
                    0x127914bedcbefea4,
                ])),
                Felt::new(BigInteger256([
                    0xa59327e05e236fec,
                    0xc759a65a04405536,
                    0x17043cdd794cbc40,
                    0x056f6e038e715163,
                ])),
                Felt::new(BigInteger256([
                    0x00397143ec864565,
                    0xa13982443b1548a3,
                    0xd8b56e445e9e369c,
                    0x0d698f86149e8c09,
                ])),
                Felt::new(BigInteger256([
                    0x374ed72f7526d052,
                    0x3dd049675a906761,
                    0x161db7f3742ba04e,
                    0x0ba3a2e66c49a1fd,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf679b2e69e3220aa,
                    0x7dfb643d4be0c1f9,
                    0xca96279b3325cdba,
                    0x01620c0add4b996c,
                ])),
                Felt::new(BigInteger256([
                    0x2707fc8cff831c12,
                    0xb9daeaec5e72eb20,
                    0xc56260144ad72ee5,
                    0x07b559c9b25a3d8d,
                ])),
                Felt::new(BigInteger256([
                    0x68844b11e79f9e1a,
                    0x53e66b4dcc1fb1ed,
                    0xe152db799a801218,
                    0x09629885faa5d95e,
                ])),
                Felt::new(BigInteger256([
                    0x0a9abf29c4eb22b2,
                    0x9f7279407f0a5a5f,
                    0x0550a91e2f57e438,
                    0x05b6a5fa144fdf32,
                ])),
                Felt::new(BigInteger256([
                    0xed252112db7f7a23,
                    0xe5a523c00b0c669c,
                    0x7151aaf6ace5a40e,
                    0x03dd3e7b149315dd,
                ])),
                Felt::new(BigInteger256([
                    0x57481860c0b62a7c,
                    0x7e0aa723f302c347,
                    0x33eccd74d00a7ddc,
                    0x07450618faa1101a,
                ])),
                Felt::new(BigInteger256([
                    0x87cca66363c7a505,
                    0x941f3b70d391073e,
                    0xb9026336ae38fc4d,
                    0x11cccc119687338c,
                ])),
                Felt::new(BigInteger256([
                    0x226f622387c902b3,
                    0xf78fd80a16b6ef5b,
                    0x0ec4a1e684f7680c,
                    0x05e08b04fd175eed,
                ])),
                Felt::new(BigInteger256([
                    0x88235ba1ad114528,
                    0x05992b78fbb7ec79,
                    0xcece0f7dc7dc1fdb,
                    0x00c91b01e3e8fc2e,
                ])),
                Felt::new(BigInteger256([
                    0x7ba32513401432f6,
                    0xd336793c8506f0f6,
                    0xeb51044af9c8959c,
                    0x0cfba83bc35036f3,
                ])),
                Felt::new(BigInteger256([
                    0x5067d3149e1da1dd,
                    0x98b902f2f40e2cb3,
                    0x7c64cbb3f2fab431,
                    0x0e2a4caed9357737,
                ])),
                Felt::new(BigInteger256([
                    0x73a9a2eee6c282ba,
                    0x3959ff35ce68548e,
                    0x10cec827b9a2d5b2,
                    0x088dee0bdbfb73df,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
