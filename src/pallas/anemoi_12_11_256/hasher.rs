//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 31 == 0 {
            bytes.len() / 31
        } else {
            bytes.len() / 31 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 31-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 32];
        for chunk in bytes.chunks(31) {
            if num_hashed + i < num_elements - 1 {
                buf[..31].copy_from_slice(chunk);
            } else {
                // The last chunk may be smaller than the others, which requires a special handling.
                // In this case, we also append a byte set to 1 to the end of the string, padding the
                // sequence in a way that adding additional trailing zeros will yield a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 32];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 31 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn merge(digests: &[Self::Digest; 2]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        // 2*DIGEST_SIZE < RATE_SIZE so we can safely store
        // the digests into the rate registers at once
        state[0..DIGEST_SIZE].copy_from_slice(digests[0].as_elements());
        state[DIGEST_SIZE..2 * DIGEST_SIZE].copy_from_slice(digests[0].as_elements());

        // Apply internal Anemoi permutation
        apply_permutation(&mut state);

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        // We can output as few as 2 elements while
        // maintaining the targeted security level.
        assert!(k <= NUM_COLUMNS);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger256;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger256([
                0x3f3f083f129cc272,
                0xe9e6a022d72c37a3,
                0x1211cea0104e5d02,
                0x0e81be54a953cf00,
            ]))],
            vec![
                Felt::new(BigInteger256([
                    0xaf7434f4079dfb24,
                    0x31af2b81d91354d6,
                    0xe689167199fb032d,
                    0x032fa793314b19af,
                ])),
                Felt::new(BigInteger256([
                    0xa4b79327ced523b4,
                    0xaa0e070144d51492,
                    0xff02f3486d2b8720,
                    0x00a1fa1ad8c0acfa,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x4737a8762860670d,
                    0x4871d5732350ec8a,
                    0x9d1cf96dcc366670,
                    0x10de66dd12761075,
                ])),
                Felt::new(BigInteger256([
                    0x0db7ce6712c6657f,
                    0x9a7ec12268722282,
                    0x8f7d7945a5e29f3c,
                    0x37e097d9b595b223,
                ])),
                Felt::new(BigInteger256([
                    0xa5eae2c6e89f6232,
                    0x42eb6def20555cec,
                    0x857735612795802b,
                    0x36b61f37fc865cd6,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xa78f7ea52c82064d,
                    0x3bf3c9ca891b8cb8,
                    0x7d9227fdc7a7f67f,
                    0x098b64fe4fcc8074,
                ])),
                Felt::new(BigInteger256([
                    0x4679b91affe743db,
                    0x7e27d5bff6636bd2,
                    0x3d7ca962c7eb26b5,
                    0x21593213836b7fec,
                ])),
                Felt::new(BigInteger256([
                    0x24c2016ce165356b,
                    0x69e42d0856c401fe,
                    0x88f53d2da723a7de,
                    0x17c18489cf270b20,
                ])),
                Felt::new(BigInteger256([
                    0x043c16e589f28e81,
                    0x8a647074f530e5c4,
                    0x2e05820420343fd0,
                    0x0549cab2fc2c89ee,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x66bf6edd5957303f,
                    0x82923a9ba23c3547,
                    0xe59a4c489df08a18,
                    0x101f49da0b1f447e,
                ])),
                Felt::new(BigInteger256([
                    0x69030f8af319fed7,
                    0x372f28d1a2159dc3,
                    0xa654560135ec7222,
                    0x166b1801ca450d56,
                ])),
                Felt::new(BigInteger256([
                    0xfde74b84ce92e0be,
                    0x697361324a76fafc,
                    0x1c2633a23b324523,
                    0x1a62565b44554b3f,
                ])),
                Felt::new(BigInteger256([
                    0xe96f4e6be86f1ec6,
                    0xbce1445ed1704d79,
                    0xbb78ca773041340c,
                    0x3db1ca01c34d87b2,
                ])),
                Felt::new(BigInteger256([
                    0x9eff02329625ea99,
                    0xff2906f3fc2181c7,
                    0x987cfef97e60b50c,
                    0x353a44eacfabf209,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x59d0afd98d5de5c1,
                    0xb2908a93a3ac2d5f,
                    0x3f4ee43d3c884f0c,
                    0x15ec3e8ba12e82e5,
                ])),
                Felt::new(BigInteger256([
                    0xfdb71cd4ef94fca8,
                    0x172026535ab8b834,
                    0xcbb2fac20c9c6a60,
                    0x3aa3a583e79ef67f,
                ])),
                Felt::new(BigInteger256([
                    0x3e751598706ba3cb,
                    0xf8551500376c179d,
                    0xb0288e650d088a53,
                    0x2c1899efacc27d0d,
                ])),
                Felt::new(BigInteger256([
                    0x3fe0082ef75c5de1,
                    0x85deb4bec19a7198,
                    0x629eaae65efafc34,
                    0x276495e83cb0120c,
                ])),
                Felt::new(BigInteger256([
                    0x7b775ca0cfc130da,
                    0x36729d3c0e17495d,
                    0x7105b8db28cd0a5f,
                    0x194aaadcd85332f9,
                ])),
                Felt::new(BigInteger256([
                    0x044e9781a0680e9a,
                    0x100514afd379b950,
                    0x067867c7135c4bb3,
                    0x0e669a36e28eddc6,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0xbf7a34441ab29ef1,
                    0x6227919e76b0a8e4,
                    0xb7e63e1ccaee5e0f,
                    0x0a771db949e362be,
                ])),
                Felt::new(BigInteger256([
                    0x6ca98bc79b5869c6,
                    0x65f33e1d89dfe78d,
                    0x34103803cd5cda4d,
                    0x0dc8eb3a44c79487,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0e9fb6fc440584c9,
                    0x9c550dbd4f1a1a71,
                    0x616b7967d097797c,
                    0x04b8adf2e4c1784d,
                ])),
                Felt::new(BigInteger256([
                    0x46a5702dd84afb0b,
                    0x07fa9d83686941e8,
                    0xdad88de1727cf715,
                    0x3eb80c584f335ff6,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0c12df71364f945a,
                    0x8866f5688324d28a,
                    0x7b97349ca92b0c29,
                    0x0775030a4fa5f1e7,
                ])),
                Felt::new(BigInteger256([
                    0xf47d0e27b39c6465,
                    0x5c91b9c43e7bbce0,
                    0x279fbbfd80919a0a,
                    0x1bd97eecf58166e7,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5fe29784f1e63e01,
                    0xa85ed2cef9c91d52,
                    0xae87a4d0849d6ffb,
                    0x26cd295eb101a50c,
                ])),
                Felt::new(BigInteger256([
                    0x33cba35c0e8b7510,
                    0x29f6614b4f86db21,
                    0xd94534e4986dae6a,
                    0x029407c10c792485,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x936120171e726ce7,
                    0x995d677b41948b76,
                    0xf9075335e4ad775e,
                    0x2787956b6ce21082,
                ])),
                Felt::new(BigInteger256([
                    0xf667cc9b1f09d9b4,
                    0xaaa0c2b090338794,
                    0x7555391b0daa268d,
                    0x18ded0a8f751a267,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xd466798536105464,
                    0xe1015f7962d5024d,
                    0x950a144b88588e99,
                    0x09e7bda5012cd347,
                ])),
                Felt::new(BigInteger256([
                    0x01a7cb620e2ec4d3,
                    0xedbbb8cca452b8fd,
                    0xe1165d41b558e56e,
                    0x1882ffb5f4f44015,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa0fe4dbd304d31c4,
                    0x3863783f71af3467,
                    0xa3a25ddb3d6d1c9b,
                    0x0d79113ba0f0a943,
                ])),
                Felt::new(BigInteger256([
                    0xf341ba54a3720a03,
                    0xfa6b0cbee807269a,
                    0xc212907122dcd1eb,
                    0x089dd735d154c38c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4882cee41e999065,
                    0xb8f3dd56368d1f51,
                    0x9145c19f5b774cfd,
                    0x37cb8eacdba2d2dc,
                ])),
                Felt::new(BigInteger256([
                    0x780f6cd6feda4f8d,
                    0x60df3192af09ecd7,
                    0xb6e4a6f8e615aca2,
                    0x0059d84ef23f66e0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2e63853b1661dd11,
                    0xf04edfca0a6584b4,
                    0x6edf2982639352ed,
                    0x23e5e6d858452260,
                ])),
                Felt::new(BigInteger256([
                    0xb646e12c0af1c7f9,
                    0xb87010de4613a423,
                    0x52205bdef0dfdf83,
                    0x0bdd53f4fb52d8f9,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xfe636ee327fa5430,
                    0x362e2897abc1f500,
                    0xb2cedd8aa4904753,
                    0x12d93a0687172cee,
                ])),
                Felt::new(BigInteger256([
                    0x60b7ffe4d2ebea95,
                    0x6b72890130264623,
                    0xc7de69af6e90933b,
                    0x2666645aa6d21eb7,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xca8b46bc3ca5a680,
                    0xf39e3108d8fa2678,
                    0x6247f09f56b3dd05,
                    0x01675172256755bb,
                ])),
                Felt::new(BigInteger256([
                    0xa6899016e644d122,
                    0x9f06a3bfe5bca9aa,
                    0x7571aab48ebc9383,
                    0x1336a495fde90b8c,
                ])),
                Felt::new(BigInteger256([
                    0x3fc198bf7cf3f9cd,
                    0x7e7cb3a8ebc3b6bb,
                    0x2a36eb7a5f0bb4f5,
                    0x1ad68951ad42c9f8,
                ])),
                Felt::new(BigInteger256([
                    0x6923c1a2611a04ca,
                    0x760403a96408e916,
                    0xffc35febe984759f,
                    0x1a69800344767249,
                ])),
                Felt::new(BigInteger256([
                    0x575d20f53c0d6c79,
                    0x2c9e5f932b0e19c0,
                    0x94b22a7006729b4d,
                    0x179cdde9497afe00,
                ])),
                Felt::new(BigInteger256([
                    0x0c118395f377b731,
                    0x89a5eaf165f061da,
                    0xdd8f8e8baf13bc1a,
                    0x08cc895bfb500a48,
                ])),
                Felt::new(BigInteger256([
                    0x69d55742957cea46,
                    0xae55024e508da25b,
                    0x7f80bf317e5fe76a,
                    0x060bddbf8f64895a,
                ])),
                Felt::new(BigInteger256([
                    0x646c8573d2b3c172,
                    0x5b0f8704dc71209d,
                    0xe3146e6fc75c6e4d,
                    0x38642e68193e6568,
                ])),
                Felt::new(BigInteger256([
                    0x51b9fbb466d54e7b,
                    0x6c36ad58b2e598e6,
                    0x573fa5c7d078d937,
                    0x1e19af85d77fe047,
                ])),
                Felt::new(BigInteger256([
                    0x74b7cf70640d8adb,
                    0xa2a15fd3f218b720,
                    0x7c3ae1fd297c957a,
                    0x3a51cce652b42b40,
                ])),
                Felt::new(BigInteger256([
                    0x67a4b6c5e8f6212a,
                    0xd78a9dcde6002d4d,
                    0x6f51ccf1db81122d,
                    0x1010cea405947226,
                ])),
                Felt::new(BigInteger256([
                    0x13f3138a38d9006b,
                    0xf91832660ef4299c,
                    0x82d5f44bc004108b,
                    0x1dcf5bbf48f700d4,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x73a18af8584d63b5,
                    0x3e00881816c90fb6,
                    0x4c2f4ff03c9ea2c3,
                    0x2dd006a436c42801,
                ])),
                Felt::new(BigInteger256([
                    0xcaba46132381cfe8,
                    0xa4e11876321489e7,
                    0x0a748f6550db2086,
                    0x290766252840942b,
                ])),
                Felt::new(BigInteger256([
                    0x0a316355f2f236b0,
                    0x9e25dcfa701524a5,
                    0x7ac3337eb97567ff,
                    0x2a5e467a13d37272,
                ])),
                Felt::new(BigInteger256([
                    0xe02f01256d929ca0,
                    0x692871f366704ecd,
                    0x6fdd8d6d1ca6625e,
                    0x1c8155f4dfb741f7,
                ])),
                Felt::new(BigInteger256([
                    0x5deb2627401c04e3,
                    0x132c8873cf6c8684,
                    0x86d5f7a4ae571acf,
                    0x1cae58a2bc785151,
                ])),
                Felt::new(BigInteger256([
                    0xa5f26f9c87a13489,
                    0x12bb0f1435371e80,
                    0xe617de13021ccbc4,
                    0x1a0734e638eef640,
                ])),
                Felt::new(BigInteger256([
                    0xd9a9a92d7ce0d443,
                    0xa3b3a12e8d31eed9,
                    0x9d66b840ff37ca09,
                    0x2e31ea69441cbe47,
                ])),
                Felt::new(BigInteger256([
                    0xdf00f8694cd6d38a,
                    0x28d9d51555a8fa63,
                    0xfd73be4ca57e6f1e,
                    0x168b2414a64f11dd,
                ])),
                Felt::new(BigInteger256([
                    0xf1f30dd232157177,
                    0xa5ae4f5d8596fca6,
                    0xec27e5a434eb0a1d,
                    0x08ff7f467a51b536,
                ])),
                Felt::new(BigInteger256([
                    0x6e0fb267c6a0684f,
                    0x9967eecb470dc2f7,
                    0x97f38996bc5f5216,
                    0x0449ea311d20485e,
                ])),
                Felt::new(BigInteger256([
                    0x6db0a99b9e98f91c,
                    0xdbb6d1f6bd1efd00,
                    0xbb9fc8a8fe1a1f37,
                    0x2878d31dd8fb24fa,
                ])),
                Felt::new(BigInteger256([
                    0x4689c27961590a00,
                    0xa74b4cf6737a8128,
                    0x5ccf109a69ec03fb,
                    0x327ec854c03d60f5,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x982379d9d1c74bd1,
                    0x6190a8da290ac402,
                    0x1ec0aba6f4f451b4,
                    0x2c0855a61be46408,
                ])),
                Felt::new(BigInteger256([
                    0x2b1ce366f5c92ae5,
                    0x1ff3599093325aee,
                    0x8419b9e030274ea6,
                    0x39d5071d52723ab3,
                ])),
                Felt::new(BigInteger256([
                    0x1430851387527dea,
                    0x607343e2b6e13a70,
                    0x1caed91b7f29635d,
                    0x2a36862868924bbf,
                ])),
                Felt::new(BigInteger256([
                    0xa297fe7194da6dc3,
                    0x2498d2943727528d,
                    0x7d9137bad6cc9046,
                    0x1ec7d87b7bed0541,
                ])),
                Felt::new(BigInteger256([
                    0x2b8ddf9380de77ca,
                    0xdf11c0348bfdb974,
                    0xe0685f53e5884cb5,
                    0x17848cdd21519cc5,
                ])),
                Felt::new(BigInteger256([
                    0xd4ede2ce0d84196c,
                    0xc610e1711d5165b1,
                    0x51939cd9e6f28fdd,
                    0x1681d8ed467fc8c0,
                ])),
                Felt::new(BigInteger256([
                    0x42909c0a0ff95cbc,
                    0x9758437f61f4532c,
                    0x84bc97672b911489,
                    0x0c0675ed8bba9e3a,
                ])),
                Felt::new(BigInteger256([
                    0xf341005ee45137e4,
                    0x2deb4f1d85ad183d,
                    0x5d09076b1aed7d88,
                    0x3f41cf15dbc1338a,
                ])),
                Felt::new(BigInteger256([
                    0x4e11e21e900d25cd,
                    0x6350c313d43ba487,
                    0x4fc2ba8f11f85c7e,
                    0x12046e34914a2e65,
                ])),
                Felt::new(BigInteger256([
                    0x55ef2f699387d771,
                    0xd65d154b2a58ab95,
                    0x6c58bed43d98cbc4,
                    0x1603f5f86ef4c7cd,
                ])),
                Felt::new(BigInteger256([
                    0xc46f5f461650f118,
                    0x9cbd85473ab5b0d6,
                    0x477efab32bec16ed,
                    0x28095a9cea3f673b,
                ])),
                Felt::new(BigInteger256([
                    0x3baf54238fd41ae9,
                    0x9dc2dbe2d3e4407b,
                    0xdd6bc26c4fe90917,
                    0x0c26007729ae95ec,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x6f48eb5d6c1e8dd7,
                    0x83c39e98a0cdd153,
                    0x3ff531a241fb2543,
                    0x1fffcedd27bcc4c4,
                ])),
                Felt::new(BigInteger256([
                    0x1e984e9a01f59939,
                    0x0bc220fa070ff847,
                    0x0c39ebc3939e4788,
                    0x2d3bc3886e703417,
                ])),
                Felt::new(BigInteger256([
                    0x1223c346da5b3834,
                    0x3c9cc80346eaf684,
                    0x318b39d66122e8dd,
                    0x26bc8fcfe7be0e00,
                ])),
                Felt::new(BigInteger256([
                    0x40023e7de9482321,
                    0x17b96c3b54ad5412,
                    0xef84961ca785fb6c,
                    0x3217e2ede818fdfd,
                ])),
                Felt::new(BigInteger256([
                    0x2b7763803f0251cf,
                    0x8892fe0745788746,
                    0x6c9cd1861b9c7b74,
                    0x10fe29c37e3e099a,
                ])),
                Felt::new(BigInteger256([
                    0x175d4760051293d7,
                    0x6135a4ceef633958,
                    0x992bfcad6d4436d5,
                    0x14b16821c03403cd,
                ])),
                Felt::new(BigInteger256([
                    0x26597400bda589f4,
                    0x3e5781d476c1825b,
                    0xad68a77b2e1dc506,
                    0x107b0308e1b47ffe,
                ])),
                Felt::new(BigInteger256([
                    0x2b72541b3bfd4fb7,
                    0x7c27e9b6badc2e42,
                    0x0bda4d23834b7ac2,
                    0x1b4519839e09c5c0,
                ])),
                Felt::new(BigInteger256([
                    0xa6e763e032074b4d,
                    0x320429c9f8f7dfd5,
                    0xd05342096aceab83,
                    0x1a5b4fbb6aca152d,
                ])),
                Felt::new(BigInteger256([
                    0xe946c05ea5f1516d,
                    0xe4690d5b2c71fc63,
                    0x34305da9b8b76dd0,
                    0x158b6011f20f8503,
                ])),
                Felt::new(BigInteger256([
                    0x1738dc83d6c6f47d,
                    0x0891220e4128fc73,
                    0x7bf6757fb1874a07,
                    0x0675acd53fa19d73,
                ])),
                Felt::new(BigInteger256([
                    0xf41805502ccf77ca,
                    0xc6954dc12a71214d,
                    0xcd1ec822f8dddab3,
                    0x3f8dc99859f38b2d,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x395ea1fa35db5445,
                    0x896fe31a7f9ee09e,
                    0x65744589d9c3aaa6,
                    0x1c29c384d660c5c9,
                ])),
                Felt::new(BigInteger256([
                    0x9223201a4cb1cfdd,
                    0xbea6ced27e0914e4,
                    0x42f844c7a78e32a1,
                    0x2d5573cf481dd142,
                ])),
                Felt::new(BigInteger256([
                    0x1c7ff4824a88a35c,
                    0x4d8cc162aa22b2cb,
                    0x0ae60e89a3684868,
                    0x12403418d8242720,
                ])),
                Felt::new(BigInteger256([
                    0x6ba5c7948faca0ba,
                    0xb4d6e0477484a8c9,
                    0xf7289303db1f984e,
                    0x34f63632ff2c6f29,
                ])),
                Felt::new(BigInteger256([
                    0x207ae0a38c37298e,
                    0x175157d1ea80ce27,
                    0x2b519790b4061e3e,
                    0x3913f7feb4797359,
                ])),
                Felt::new(BigInteger256([
                    0x278aab9b3bbcce87,
                    0xd124d2bb42e860e7,
                    0x8b140da4c2da7974,
                    0x31bf83bfef7b7d0e,
                ])),
                Felt::new(BigInteger256([
                    0x3140f82a2e9c55d7,
                    0x812a6446ceec5804,
                    0x13a19d7c1b5a1abd,
                    0x1dd6d8b8f3ce3b7c,
                ])),
                Felt::new(BigInteger256([
                    0x9aaede011d12d453,
                    0x43da15c18e916a90,
                    0xf9ba720f932f6161,
                    0x10082db0b4637604,
                ])),
                Felt::new(BigInteger256([
                    0x2c9f6ee213dc31d2,
                    0x5d230fe4bab08e69,
                    0x2a46e6371b16e435,
                    0x19c1775fdeb907d1,
                ])),
                Felt::new(BigInteger256([
                    0xdeb14bbc213e89b3,
                    0x49caebb070a5e61f,
                    0xe7009e24bef660bd,
                    0x2dcafac220124ad4,
                ])),
                Felt::new(BigInteger256([
                    0x51fc3082824d0e70,
                    0x354db04936149400,
                    0x1d6424c5da287885,
                    0x32805923e1ea43a7,
                ])),
                Felt::new(BigInteger256([
                    0xdbd2ef410958b185,
                    0x894dac08315b43f2,
                    0xf023c22a06415861,
                    0x1024540fef1b6932,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x19d9cbf98897f651,
                    0xd4cb7da36bb8afa2,
                    0x782b679a8d1b599e,
                    0x2024c5009f5237dc,
                ])),
                Felt::new(BigInteger256([
                    0xa864caaac2fb0ece,
                    0x1fdeef4b4436a5b5,
                    0x3327129d96fcccae,
                    0x2deab099351cff08,
                ])),
                Felt::new(BigInteger256([
                    0x447f5c9d3f219521,
                    0x7ddd4229bac5bc5e,
                    0x19345648e1ce3b12,
                    0x0cbed1be64e4c3fb,
                ])),
                Felt::new(BigInteger256([
                    0x963f30aad09da716,
                    0x62eb700f648e2594,
                    0x6e22d8d937f9c465,
                    0x14647de4019af5e9,
                ])),
                Felt::new(BigInteger256([
                    0x6941bdb9d2eb98d3,
                    0xba2a54f5f57c3ceb,
                    0x127b03180e9f498c,
                    0x34d1ad32ce1d7010,
                ])),
                Felt::new(BigInteger256([
                    0xdb8448912957317c,
                    0x661726fc9114fb61,
                    0xee056a4324b715c5,
                    0x08e8cf9a96bf7622,
                ])),
                Felt::new(BigInteger256([
                    0xa646f91009938fb4,
                    0xd12d7f27d2049375,
                    0x11a95126b13f62dd,
                    0x0a08bb7f75be5ad2,
                ])),
                Felt::new(BigInteger256([
                    0xe974b58d9d011e75,
                    0xe7347fb1297191fb,
                    0xc25a5f6f661936af,
                    0x24c12bfbcc82a6f8,
                ])),
                Felt::new(BigInteger256([
                    0x96313fc7e79f69c3,
                    0x3cedbbae6dd87af9,
                    0x08969e69d4780790,
                    0x0c9e54f1205b051c,
                ])),
                Felt::new(BigInteger256([
                    0x5af7ce282117357f,
                    0x35e4e30d78502057,
                    0x167a82d78721f176,
                    0x12b1a3afbf02a629,
                ])),
                Felt::new(BigInteger256([
                    0xbee1b533f133769b,
                    0xd6be7ec7b6acd914,
                    0x1414e1114d6b6085,
                    0x29f16f14b309c542,
                ])),
                Felt::new(BigInteger256([
                    0x8e05c962f8ae54e6,
                    0xb1f906454faf07de,
                    0x86b7c47502f29a77,
                    0x0a5e15353f07b5a2,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0xbf8f990ac50e9bc1,
                    0x20e7f5f766ff4b72,
                    0xbeebe4634af5eb1e,
                    0x1937d197f2484283,
                ])),
                Felt::new(BigInteger256([
                    0x51407f149d0db191,
                    0x60161fcbc4724460,
                    0xed48d28605186274,
                    0x11630c54d79d5b3b,
                ])),
                Felt::new(BigInteger256([
                    0x2e07bbca1657de8b,
                    0x759d7de7d7f49529,
                    0xe66ed4e4a01a55f8,
                    0x38e53d16411c19dc,
                ])),
                Felt::new(BigInteger256([
                    0xf919dcf77a4143b9,
                    0x48fdd796a7c805e9,
                    0x01a5ba76e362e67b,
                    0x250de4f0644fe99b,
                ])),
                Felt::new(BigInteger256([
                    0x9f32882fcdd6dd0d,
                    0x3c6e8d07f119abf4,
                    0xc82a8c91ca0ad2fe,
                    0x115b1435007b9a23,
                ])),
                Felt::new(BigInteger256([
                    0x3b6bf40a67f45b06,
                    0x4de23edeb84e2892,
                    0x8ca3186cbf202947,
                    0x0eece410ee8e7179,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x145376084ef40c9e,
                    0xa694f77596f148c6,
                    0xa7670e553f840a9e,
                    0x2b3cacec8edd5f7e,
                ])),
                Felt::new(BigInteger256([
                    0x3aec578b2f5b52f0,
                    0x61ec4ab6463d4983,
                    0xe09f84f27efb1ba2,
                    0x10224780f8bf93ee,
                ])),
                Felt::new(BigInteger256([
                    0x506e767e9621deb6,
                    0x84511a69f45ff89c,
                    0xe888d3a3330b457f,
                    0x282c761abaeb8ceb,
                ])),
                Felt::new(BigInteger256([
                    0xc9afa2c3356fa511,
                    0x1e364a34d7165f31,
                    0xdad38ebbf5b98af0,
                    0x2383da9b6d78c28e,
                ])),
                Felt::new(BigInteger256([
                    0xba3a48f99f280047,
                    0xdd596f1635019f27,
                    0xe0a646b48eecc542,
                    0x3cda1d00157a1b96,
                ])),
                Felt::new(BigInteger256([
                    0x74de70c9e23a0276,
                    0xc7d3e8f370fbe415,
                    0x0bc17de20d2efb8a,
                    0x3fe10b46b37b1c5e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x20531b3af2a3a457,
                    0x85ce7d245f980d79,
                    0x639a339de2bb2f0e,
                    0x347069c1671e2ecf,
                ])),
                Felt::new(BigInteger256([
                    0xe7b61a19db63029b,
                    0x30d571e494a23a5f,
                    0xcb017e819ca3330c,
                    0x2a0f73943b37b0dd,
                ])),
                Felt::new(BigInteger256([
                    0xfbe6b36a313da0a9,
                    0xf696e2335c1dcfd0,
                    0x53596383c0f69cb9,
                    0x08f064fe126d37d0,
                ])),
                Felt::new(BigInteger256([
                    0x2f828c6d6d3bba50,
                    0x3f3922e26f262358,
                    0xd7cc237a8fe60197,
                    0x339101d940b20265,
                ])),
                Felt::new(BigInteger256([
                    0xbaea81eff2725231,
                    0x79a2bb9eaeeb43fc,
                    0x68902c6346da04e2,
                    0x1c4c8fe51d4b117e,
                ])),
                Felt::new(BigInteger256([
                    0xaf02e88cadc42081,
                    0x1914123e3f368c26,
                    0xb475771fd9164f8e,
                    0x26b0c085674406da,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x27829a7c8e04b1b0,
                    0x110dcb8e47c62d27,
                    0x3ba45d9e51f5934a,
                    0x18c90f6925640478,
                ])),
                Felt::new(BigInteger256([
                    0xa462e5f4fe7f7bb0,
                    0x011c4f6fe645c63a,
                    0x1d4f730a8909ef9d,
                    0x0b9b0d4fc6c21303,
                ])),
                Felt::new(BigInteger256([
                    0x03d62ea321ac2deb,
                    0xaf9331c18662c266,
                    0x50c11b93331c4428,
                    0x0633210f3b9fc912,
                ])),
                Felt::new(BigInteger256([
                    0xd2ff44b340edeb16,
                    0xa05f0e5ad5f19cf7,
                    0xf0e7561d87027d0a,
                    0x1cd2afada91fc62b,
                ])),
                Felt::new(BigInteger256([
                    0x18ef8701ac588fa5,
                    0x1a43d5c5fd67adef,
                    0x290999a82dc89522,
                    0x25301987b871cb78,
                ])),
                Felt::new(BigInteger256([
                    0xe5e2ecf3b6708b49,
                    0x2bfa3d9b797ae38b,
                    0xa6ab0eb875796175,
                    0x08bf69478114d6f4,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xbf9e7cde2b579828,
                    0x7eb67ff8515adc09,
                    0x32b02a6e8bbefacb,
                    0x21257e0beacd6af4,
                ])),
                Felt::new(BigInteger256([
                    0x4e703f0fcd4aa580,
                    0xd8276d5d4c5f6bfe,
                    0x8dc6819fe3ae59fe,
                    0x2a4e76b08c3a7644,
                ])),
                Felt::new(BigInteger256([
                    0x51109252f0f66808,
                    0xd9ea55ebe07ac08d,
                    0xd5dab48594f273fb,
                    0x06bfbd2321d7b304,
                ])),
                Felt::new(BigInteger256([
                    0x8b81935fe88773c4,
                    0x9d33d84346b081ee,
                    0xf4897706c4fe56b7,
                    0x2533dfbd6814544c,
                ])),
                Felt::new(BigInteger256([
                    0x5536ef35588a5c4f,
                    0x0381ee25528c7b7b,
                    0x00c0dfe1461dbb0f,
                    0x043061c70afa10e3,
                ])),
                Felt::new(BigInteger256([
                    0x778bb4e239df717d,
                    0xca2516682611e2e1,
                    0xaed7319ff993b311,
                    0x08c74a4afc889982,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x02d29dbde48010f3,
                    0xa0b12423eca71469,
                    0xb6bb3270153025c4,
                    0x188b83820c7956be,
                ])),
                Felt::new(BigInteger256([
                    0x2b8023177a181f72,
                    0xb194208fcb2d028c,
                    0x9b14a6d5757ebbf7,
                    0x1db350f8b34bc3a0,
                ])),
                Felt::new(BigInteger256([
                    0xa5017e9431119290,
                    0x42d468093a9fd20e,
                    0x10b954f444accc5f,
                    0x01dd61374c053bb7,
                ])),
                Felt::new(BigInteger256([
                    0x7d189e8fd8b10425,
                    0x308f672e9cc7a3f0,
                    0x12be5f149c3c7719,
                    0x2d24be7db846caff,
                ])),
                Felt::new(BigInteger256([
                    0xe095d14f6906a826,
                    0xf894c1dcf27dd247,
                    0xd1aa0f60d3aab473,
                    0x1bd60d634a5a6f98,
                ])),
                Felt::new(BigInteger256([
                    0x698b25b2a73dbb8c,
                    0x03c495739572f553,
                    0xe3981fb486ee514a,
                    0x21d2bd83a146e5f0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3860353310a018e3,
                    0xd2471c48d82bf9cf,
                    0xdd2cdda6f9804bfd,
                    0x39bba9f7f20fff89,
                ])),
                Felt::new(BigInteger256([
                    0x390f380bd12769c5,
                    0x776736b8f681da77,
                    0xb74c298dcab7f0ba,
                    0x1ec04b6e77922335,
                ])),
                Felt::new(BigInteger256([
                    0x500602300ce2df2d,
                    0x3bc6fbb2656447f9,
                    0xac241db3d95f9c76,
                    0x2749c254b0137b6e,
                ])),
                Felt::new(BigInteger256([
                    0x10b816d2f98ee27a,
                    0x3f7327bdfbbd8cc1,
                    0x681000f832204345,
                    0x2ebab7fe7781fe30,
                ])),
                Felt::new(BigInteger256([
                    0xb8cd03f5a23d285e,
                    0x0d4a89a1bbd5bbfb,
                    0x13a9ab38f36913ce,
                    0x15ad27ac897ccab1,
                ])),
                Felt::new(BigInteger256([
                    0x7e40e068ed732872,
                    0xe6a68149a06ca9ff,
                    0x6ffdd9ba16732452,
                    0x0c750fab7d96ceb7,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x43887f95e28d584a,
                    0x8ac4b300177b291c,
                    0x5f3e7c44b6736ab7,
                    0x26d2200963f49814,
                ])),
                Felt::new(BigInteger256([
                    0x1d96ff75ed86289f,
                    0x5a2393210eb9cc2d,
                    0xf66463b5feff26a3,
                    0x3d7b78cd9d8c31e9,
                ])),
                Felt::new(BigInteger256([
                    0x92d7d1bb14c43f4e,
                    0x8a693c0f9b6a23c0,
                    0x2dd1603b9701f89e,
                    0x29f0458f5ff83967,
                ])),
                Felt::new(BigInteger256([
                    0x4952fb2bc1989525,
                    0x55c7521d132c34b7,
                    0x7dae2c54406c400f,
                    0x05e8a6e01523599e,
                ])),
                Felt::new(BigInteger256([
                    0x94abcd5fee6c0e47,
                    0x01f196c68bae51c6,
                    0x6eed7ab8d90ef7b0,
                    0x13cc369f624ffdef,
                ])),
                Felt::new(BigInteger256([
                    0xed0e147a533d5c73,
                    0x10a6b8c33862c1b1,
                    0xefb74aa75866306b,
                    0x1f5daca111f95324,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf09283c5522bf78e,
                    0x22f641a085448d75,
                    0x8d6bec900f937ba6,
                    0x1b17cb83c1fff7f1,
                ])),
                Felt::new(BigInteger256([
                    0xe321fe7237f2ab7a,
                    0x3acca2757f14ae88,
                    0x354e5565cbc6d38a,
                    0x2049ba026843e91a,
                ])),
                Felt::new(BigInteger256([
                    0x9ded78f0ae989130,
                    0x7338d71831e8c6c3,
                    0xd8fdbd3f564cbb2c,
                    0x24d3aa56947000bb,
                ])),
                Felt::new(BigInteger256([
                    0x0cb059237b6fbd66,
                    0x49823b6f603ecbcb,
                    0x1e5d503326c98846,
                    0x052aa9ed4ed72bcc,
                ])),
                Felt::new(BigInteger256([
                    0x8e795a52b67bf8dc,
                    0x11101c6eaa40eda5,
                    0xbf703e56b99f0330,
                    0x2d8d421a17c3500f,
                ])),
                Felt::new(BigInteger256([
                    0xcec23e039b9bc4c5,
                    0x0bb620a5dd8961bd,
                    0x60bf25c6f012ea33,
                    0x24bec490ed53cb81,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf93e61ba043ee227,
                    0x3a5b7ed6e67549fa,
                    0x64136d5e14b8e6bf,
                    0x362b32fc64e7b4ba,
                ])),
                Felt::new(BigInteger256([
                    0x6a72d87fc551fdf5,
                    0x19ad7f1fe0030d9d,
                    0x87c2b9769dbc0d77,
                    0x169e607a69bd7329,
                ])),
                Felt::new(BigInteger256([
                    0x9201d2d531020965,
                    0xe996a58f8bfbadc1,
                    0x49a3a96d681f9e73,
                    0x18aedec2ff561349,
                ])),
                Felt::new(BigInteger256([
                    0xad7a9cc175a2dd3b,
                    0x26957697431c299c,
                    0x72b929c6c1c910ac,
                    0x2378bbfd5b7fb456,
                ])),
                Felt::new(BigInteger256([
                    0x4da0e862afedbebd,
                    0x158cfd7a534326fa,
                    0xfd53e46985b39ad3,
                    0x050de4df37060793,
                ])),
                Felt::new(BigInteger256([
                    0xd420335ac29345eb,
                    0xb2cc0c35bb45b627,
                    0xfc04b459b072efc3,
                    0x24f8236da5a2bb34,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x91959e322a1bd51f,
                    0xe6fe3f3459d9c6d8,
                    0x696fa8b75b2ae766,
                    0x025cf7b360a3cb0f,
                ])),
                Felt::new(BigInteger256([
                    0xf76ca495cdd9669a,
                    0x277b3a86f0ca1c0a,
                    0x2069374eeeb3468e,
                    0x3f4f8a6fe337619a,
                ])),
                Felt::new(BigInteger256([
                    0xce023ba1fbc0ef39,
                    0x0dcfb29a98eb97ab,
                    0xa48e20278d34baf3,
                    0x129f7c9eb4ecc29b,
                ])),
                Felt::new(BigInteger256([
                    0xf66484f942d8e13d,
                    0x0ca30aa819166a9a,
                    0xfe493f8efce72d2f,
                    0x20ff9ad07be61f51,
                ])),
                Felt::new(BigInteger256([
                    0x3848877a61943f2c,
                    0x401f6e8f03446ba7,
                    0x1c72bbf08ad57339,
                    0x17b21ced2949f9f4,
                ])),
                Felt::new(BigInteger256([
                    0x823cfe74566d070f,
                    0x0f68a1f802c04d89,
                    0xfcfe1167a79ddcb0,
                    0x02ddc3452a6bf1b0,
                ])),
                Felt::new(BigInteger256([
                    0x02dc43d16e304b14,
                    0x557722f176b10927,
                    0x2511923cc544142e,
                    0x2d566819c87c8568,
                ])),
                Felt::new(BigInteger256([
                    0x00edb8347526a73a,
                    0xad27eaa2bcb50169,
                    0xd3d4fc337eef814b,
                    0x0a15958c2e31e62f,
                ])),
                Felt::new(BigInteger256([
                    0x413d852b50d765ca,
                    0x95e89f35eba1b755,
                    0x22f24bcca0481f27,
                    0x36b2b3550d6c459b,
                ])),
                Felt::new(BigInteger256([
                    0xb6dce0997ccc2568,
                    0x7daf4b856d1b0c2a,
                    0xb2cc24b9ebbc9d0c,
                    0x0c8972317f9ace34,
                ])),
                Felt::new(BigInteger256([
                    0x444e14ed0de334f1,
                    0x599553add391527a,
                    0x3d21de1fac0eaa70,
                    0x1e30a12aa2970f9f,
                ])),
                Felt::new(BigInteger256([
                    0x511e8819db552f08,
                    0xa963703b83069b15,
                    0x05e36082fa5c238b,
                    0x2fce325b163ec235,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x3079cfeff6f04f59,
                    0x053482fb9aa35bfa,
                    0x04aeaba7b24653d7,
                    0x081c78906e59a075,
                ])),
                Felt::new(BigInteger256([
                    0x7e13e58354d41cf1,
                    0x585122d8b8527bae,
                    0xf28cdc560731e620,
                    0x0facbf6cca5f4e07,
                ])),
                Felt::new(BigInteger256([
                    0x63940b94013234f2,
                    0xcdf7ef487548d830,
                    0x6c916ef6a720a1b8,
                    0x2f32bdbd21f18b37,
                ])),
                Felt::new(BigInteger256([
                    0xcc57ee0bdca372c2,
                    0x7c25aeea7e1eeb3d,
                    0x60d70d814946b47e,
                    0x3e7bc51c8b7e51ff,
                ])),
                Felt::new(BigInteger256([
                    0x329f5c04f4ebecee,
                    0x71b122d62d910862,
                    0xc156ffe8f49f5802,
                    0x3e74f6a4abb009fc,
                ])),
                Felt::new(BigInteger256([
                    0xe4e1ea210fae7e2d,
                    0xb8a19c95a96074c1,
                    0x2ccb6846863de516,
                    0x306b5267216a93b5,
                ])),
                Felt::new(BigInteger256([
                    0x52ca2781d38e0c55,
                    0x24a533f4694cb228,
                    0xd7547495421caa3c,
                    0x1bfb7c49684c8f7e,
                ])),
                Felt::new(BigInteger256([
                    0x1367084499bd21f0,
                    0xb8c1bb6fe53d55b5,
                    0xf9c16dd90f6e0dd6,
                    0x1c3a2dbb428e6c50,
                ])),
                Felt::new(BigInteger256([
                    0xa3e764bb6ac49074,
                    0xade60b6a871973fa,
                    0xf7f3b8a9935b5695,
                    0x0094792529d33355,
                ])),
                Felt::new(BigInteger256([
                    0x99cfb00546aff251,
                    0xabe09e14490addf6,
                    0xb2aec90fe2fe2e07,
                    0x21db35bdc8a52543,
                ])),
                Felt::new(BigInteger256([
                    0x8ce1e7821498c9ad,
                    0x4a65e67348777f14,
                    0x1cd6d14c72c72e0c,
                    0x1fc350aeff2ce9c4,
                ])),
                Felt::new(BigInteger256([
                    0x2f83350eb5b01001,
                    0x6402e0157e0e4ab4,
                    0x698c9150291e3652,
                    0x2776763eef710f9c,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x70a2a47f0fca2d28,
                    0x056c8c87c8cb1f7f,
                    0x1b4680c6f525216b,
                    0x2578ecf889dfb357,
                ])),
                Felt::new(BigInteger256([
                    0x3235a71615f98fa0,
                    0x4a3b33c40b84cd7e,
                    0x03e81566592383b7,
                    0x08c617340d63ce82,
                ])),
                Felt::new(BigInteger256([
                    0xeb1af729097cc246,
                    0xd67e6b8a22922c46,
                    0x29fcb1a737e37f59,
                    0x1bbf4ef302095e31,
                ])),
                Felt::new(BigInteger256([
                    0x3c1e4ab614362299,
                    0xaecd479900cf0937,
                    0x536b7dd1ec8d0b8f,
                    0x06337e228b9765f2,
                ])),
                Felt::new(BigInteger256([
                    0x890fed9814252747,
                    0xe2edc768da8c80bd,
                    0xace38706deaae368,
                    0x2ff625448899c774,
                ])),
                Felt::new(BigInteger256([
                    0x23805bf0cb5be4f6,
                    0x747bb8c900d868b2,
                    0x3d9fe9bea82925d8,
                    0x3514aee3b445fb59,
                ])),
                Felt::new(BigInteger256([
                    0xda74924c251ed092,
                    0x3af9533e19f5d263,
                    0x842df2f330f69717,
                    0x324dd2995c0d39c8,
                ])),
                Felt::new(BigInteger256([
                    0x5f31b24f672d9a6c,
                    0x9a8763b618e4ba13,
                    0xf1ba7619ea5ee74a,
                    0x1420c2f39bba8cd6,
                ])),
                Felt::new(BigInteger256([
                    0x37702262ff350ed0,
                    0x3b4031847244efd5,
                    0x7e04c7ded45c1a71,
                    0x3af5ada0419019be,
                ])),
                Felt::new(BigInteger256([
                    0x768d658061bd4868,
                    0x93f99fdceed175ea,
                    0x459e005f7c4df9ef,
                    0x0450802015720a28,
                ])),
                Felt::new(BigInteger256([
                    0x552975c3cfdf8ba3,
                    0x0a8c8f5ecfe346e7,
                    0xbbf38333a4db43ad,
                    0x35367501d5d09888,
                ])),
                Felt::new(BigInteger256([
                    0x60df7cabd52223c4,
                    0x8132a44e18e1536d,
                    0x6167c78be207a5e5,
                    0x2cd6d9758c6a1cb5,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x499ed3dd7bd02ad8,
                    0x15199f31adf5e0d9,
                    0x81879737ba76d6f1,
                    0x2e8c218e69c31d68,
                ])),
                Felt::new(BigInteger256([
                    0xfebc0c0b55a8357d,
                    0x662ae68b2c2005f8,
                    0xbb6e2d6d48680877,
                    0x084c9d8a41b43ff9,
                ])),
                Felt::new(BigInteger256([
                    0xc4f34c57aad3bd83,
                    0xa92f2b6300b8872b,
                    0x8bf95ac7c607ed31,
                    0x3f648bd56c5944af,
                ])),
                Felt::new(BigInteger256([
                    0xbf0b389480c6237e,
                    0xf77909fce7bb7b47,
                    0x8c3f2afa4f621a4d,
                    0x1864a70adb24f874,
                ])),
                Felt::new(BigInteger256([
                    0x0db09d867504ba74,
                    0xf9220b670e39c5fd,
                    0x1d5ea7239cae68a3,
                    0x2f0b4495e7ffa766,
                ])),
                Felt::new(BigInteger256([
                    0x6d619f52b42e659b,
                    0x187266b2a3b4587b,
                    0x4a634c5f94750b18,
                    0x2222fcec3356241f,
                ])),
                Felt::new(BigInteger256([
                    0x90d7a95f0f76ef14,
                    0x682419cd376f85a7,
                    0x6cc864db17c4697f,
                    0x23786b6fbce553df,
                ])),
                Felt::new(BigInteger256([
                    0xd4cbb36cd3d31f47,
                    0xd3a537047034b0de,
                    0x77d41ab3ffac24df,
                    0x12b5b7a359f8209f,
                ])),
                Felt::new(BigInteger256([
                    0xb7f41b9f811e2121,
                    0x60afb27c605c5c77,
                    0x00b40df40620ed5f,
                    0x02dcddd215ea6fd9,
                ])),
                Felt::new(BigInteger256([
                    0xf59165e9f11d6bab,
                    0xe4a8d93b87b8edc2,
                    0x3a0e0374ba61c1ef,
                    0x2dea6d1de1886a71,
                ])),
                Felt::new(BigInteger256([
                    0x5b71378f86922236,
                    0x193dfd07d1ec6728,
                    0x0fd9bbfd6da3b9d5,
                    0x395f1edfe9dc1c57,
                ])),
                Felt::new(BigInteger256([
                    0x606618428fcefadf,
                    0xee5198b95f2ae4fd,
                    0x12b19d75e9b5c078,
                    0x319dc2b110868046,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xd383499295f38a91,
                    0x3a52ee388e249b86,
                    0x9479a230a0926bf6,
                    0x33b291a687c43be6,
                ])),
                Felt::new(BigInteger256([
                    0xcadd8fe874cbc3fc,
                    0xe79dd463561a2fe2,
                    0x88c887baaabff8f4,
                    0x281ee21ed91e384a,
                ])),
                Felt::new(BigInteger256([
                    0x1ecd5a6b5998ebcb,
                    0x62c91880adb41bbd,
                    0xc6ab94d10635ee3b,
                    0x181964a8e4ccb7fb,
                ])),
                Felt::new(BigInteger256([
                    0x073e001a924b8fe2,
                    0xeb5deeca7e46c9b9,
                    0x352188c846dde267,
                    0x398316dd5cd946d2,
                ])),
                Felt::new(BigInteger256([
                    0x2933017aa9949b29,
                    0x1daf07fcffae1da7,
                    0xa74412556f00b64a,
                    0x0ff1b8f07126b589,
                ])),
                Felt::new(BigInteger256([
                    0x0dca4e1b9ff1f558,
                    0x83f143e7038d7821,
                    0xb0fecf8c3a75782f,
                    0x1ccf68fc60e3b5bb,
                ])),
                Felt::new(BigInteger256([
                    0xe1a824011dac0248,
                    0x22e06218af7ec9b8,
                    0xc3241c0987b041a6,
                    0x08d0ef83568a6f58,
                ])),
                Felt::new(BigInteger256([
                    0x1170db0c3dc8eb7e,
                    0x30a55da82803ca19,
                    0xe91ed80aef4f4a19,
                    0x1f00be464bd6655f,
                ])),
                Felt::new(BigInteger256([
                    0xbf2695857535ba39,
                    0xb5e552a413727c01,
                    0xee43a096869d4ce8,
                    0x03e8ab36b032ff74,
                ])),
                Felt::new(BigInteger256([
                    0xb09e6f1b30a52cd9,
                    0xaf5ac8bb0596a56b,
                    0x696171c28e3338a9,
                    0x0c0fe9f59960c41e,
                ])),
                Felt::new(BigInteger256([
                    0xa7c240b545694f19,
                    0x25de5b17989e4828,
                    0x7f547b3ce7b708c1,
                    0x299616a21a7e7f1e,
                ])),
                Felt::new(BigInteger256([
                    0xcc9acc203486dc55,
                    0x152ebbeff03c11d3,
                    0x457154eacb8521ef,
                    0x242b5ffbc771cc2a,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xb7e9cce494d7a7d8,
                    0x0106e56339f8c6dd,
                    0x99ceee47c42d7911,
                    0x17a86a64e618cac6,
                ])),
                Felt::new(BigInteger256([
                    0xbfe348ea9a1636b5,
                    0x5050564d3cad5fdb,
                    0x70d6cb68c481bd80,
                    0x33a5b5dccaecda52,
                ])),
                Felt::new(BigInteger256([
                    0x7c97cde501a486b2,
                    0x3422b46cc7f7468e,
                    0x9b45c41f12f62041,
                    0x3522bd8660bc6d8f,
                ])),
                Felt::new(BigInteger256([
                    0x58b4a1ffde14a491,
                    0x8ae5f8b269999d78,
                    0xe64bc22a519d5b42,
                    0x17de7b5fcfdc184f,
                ])),
                Felt::new(BigInteger256([
                    0x314328bb245d0b7c,
                    0xd7176b2f1a012c70,
                    0xa05c33d4c65f91f8,
                    0x3ca0f8f43bf2fbd1,
                ])),
                Felt::new(BigInteger256([
                    0x66289ee63f8ab855,
                    0x700a2083be26c12e,
                    0xf1821e636d589561,
                    0x2fcfb8badcfa7ecd,
                ])),
                Felt::new(BigInteger256([
                    0xc10b81242cf2e005,
                    0xf30a0c92ee25f242,
                    0x55262de4e76f6f87,
                    0x08d5ad654a86a1c6,
                ])),
                Felt::new(BigInteger256([
                    0xe73a323dd2ebd57d,
                    0xd6d549ba4937da0b,
                    0x35758a62f398a252,
                    0x3f4fe233c786b9f6,
                ])),
                Felt::new(BigInteger256([
                    0xde1b7ce3f938a7be,
                    0x30b7d3969e200940,
                    0x1a93305853758f19,
                    0x20c8d0b2ccdc988d,
                ])),
                Felt::new(BigInteger256([
                    0x59d8b27dfe7e2fde,
                    0x82962f39b82beaa3,
                    0x1b928a0fdee286a0,
                    0x38d5c12273b86b57,
                ])),
                Felt::new(BigInteger256([
                    0x9e7e79c04119cf60,
                    0xef263748d967780f,
                    0x07980b99997c31d5,
                    0x3376f90c96c23f89,
                ])),
                Felt::new(BigInteger256([
                    0xab27aae13f3e9e5d,
                    0xa37bc691305a13f6,
                    0xf73b962c6c72b7f7,
                    0x04c81a988e1322e4,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0xf39cac17a93d5758,
                    0xb0ad67eb26c09374,
                    0x6d8545d9b51b1414,
                    0x237822e333dff684,
                ])),
                Felt::new(BigInteger256([
                    0xec991f297f43504f,
                    0xd4af9d451b3b79c0,
                    0x7b91a569a79b7236,
                    0x055dd5562a7bb650,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xeca1d3a6843deb99,
                    0xc3b24efdadb8ee52,
                    0x709628ad017c1560,
                    0x104340075f430801,
                ])),
                Felt::new(BigInteger256([
                    0xe04d3a2b4704fa76,
                    0x25afe4e2850293ae,
                    0xc734919081e3a21d,
                    0x33872d6319b372db,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3df71fa816539730,
                    0xd3c181fa6154282b,
                    0x1f83c384ea8bd0aa,
                    0x19ad5ea496d6781e,
                ])),
                Felt::new(BigInteger256([
                    0x93e12d39f662dd6a,
                    0x4495750d3064f7a7,
                    0x5743191c059f8431,
                    0x045135f2e32dba1e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xab1b1f345c096f3f,
                    0xb89e3a19c243a460,
                    0xb56f12d9b2da6c94,
                    0x042c4a0019759902,
                ])),
                Felt::new(BigInteger256([
                    0x5d45179bf5ddf20f,
                    0xcd759b6635b246be,
                    0xb4e1d7e08585ce1c,
                    0x312d2644f0f6b023,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x1763cf46bcc7c760,
                    0xcc05a2b80883bd49,
                    0x269db13fe135636e,
                    0x23449dda52da70d9,
                ])),
                Felt::new(BigInteger256([
                    0x03188a1cf224ce0a,
                    0x75ef93fb55ff6f17,
                    0xc6ba9c3dfce4831b,
                    0x36ea207670c7789e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xfc5519178db5a289,
                    0x0fe524f3e1e6e3bc,
                    0xa3b551517d6245b0,
                    0x05ecfd02b84cb4e8,
                ])),
                Felt::new(BigInteger256([
                    0xe548392cbca5600a,
                    0x8ed2a018494d8bd5,
                    0x2caef42e305420b7,
                    0x03bf61cff55d1605,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xac3879def916ca0e,
                    0xc4f381f868486f78,
                    0xa823d0cb98211f5f,
                    0x2c702d7e7afe2605,
                ])),
                Felt::new(BigInteger256([
                    0x36670c966bef191e,
                    0xf46b0aaee9d86f9a,
                    0x25de309de2c16426,
                    0x285b4f067ab54328,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdf9fcde2bba38b1a,
                    0xe07bf33a4df3bcf0,
                    0xa500a7d0ee8e0404,
                    0x1ced959946901f43,
                ])),
                Felt::new(BigInteger256([
                    0x200232875c028867,
                    0xa6b1ed661f6d44e3,
                    0xb39a23bbc1882c42,
                    0x372b0bdbe7de6c2e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5d77e65635cee064,
                    0xf1a4fc846acf0185,
                    0x8bfcea9cfa0ba8ec,
                    0x3889bd33eed7c08f,
                ])),
                Felt::new(BigInteger256([
                    0x8b192d9094f40e1a,
                    0x589a1226b4701210,
                    0x5eb80a3c81ebdba4,
                    0x010a63db8efe532c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x72cef1f54e897792,
                    0x8ef559d411eed1cc,
                    0xa5abdf87502d5f7a,
                    0x1d247955562cde0f,
                ])),
                Felt::new(BigInteger256([
                    0x87533f6e362dc719,
                    0x2ddc77c5b57aa985,
                    0x179e956680551c0c,
                    0x05833ef76e57799e,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 6));
        }
    }
}
