use super::{sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 2 elements (64-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 13 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 13;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2 + y2.double().double();
        *t -= beta_y2;
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2 + y2.double().double();
        *t += beta_y2 + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x1ebf8fbd58351aaa,
                    0x097c227a314273d9,
                    0x63f7440d1fe290bc,
                    0x0e191543576137c4,
                ])),
                Felt::new(BigInteger256([
                    0x4bee0f288fd5f4dc,
                    0x9f4c2babcb6c027c,
                    0x12628cfc03c1333f,
                    0x2b06500526acc475,
                ])),
                Felt::new(BigInteger256([
                    0x572eeca9be6a307a,
                    0x7a119fed72d5a678,
                    0xf8f699e0664f916d,
                    0x1b38e6137da697ac,
                ])),
                Felt::new(BigInteger256([
                    0xcff22ff484bb7c5f,
                    0x9eb89e28db1279e3,
                    0x3fa9339d9aa45e0d,
                    0x0a267bdeed6f5833,
                ])),
                Felt::new(BigInteger256([
                    0x00edcb1bf19e98bb,
                    0xa313f5c8dca62933,
                    0x7df5538051a51c57,
                    0x01d39357d098eb0a,
                ])),
                Felt::new(BigInteger256([
                    0xd6c3d6bd3e552585,
                    0xda8f14f5d492d407,
                    0xf7ed5133a9a0c7a4,
                    0x3fc38068517137e2,
                ])),
                Felt::new(BigInteger256([
                    0x7cc29a6792b0cac4,
                    0xdb5ba9a4149e9853,
                    0x405f2ed4cac00448,
                    0x2ae643d8628ec8de,
                ])),
                Felt::new(BigInteger256([
                    0xe67de9aa700d0047,
                    0x2b2d02821c95b396,
                    0xacdeced371c1e1f6,
                    0x08ff4c50995d1ee9,
                ])),
                Felt::new(BigInteger256([
                    0x76656d96ebe10486,
                    0x765119dcc0690a51,
                    0xff43880e3a653486,
                    0x201d5da3e6742413,
                ])),
                Felt::new(BigInteger256([
                    0xddd0e59f2cb5fd3a,
                    0xe75a29e4e5862ba9,
                    0xbf6f2e0cfdf510d6,
                    0x01b89a1c34bc9e90,
                ])),
                Felt::new(BigInteger256([
                    0x286341ed9d8be812,
                    0xf1ccc6cbb19c2f05,
                    0xc56bd31a31875e9b,
                    0x26029dd328b4cfc5,
                ])),
                Felt::new(BigInteger256([
                    0x36cd389c54a6d800,
                    0x389247657255c592,
                    0xf112ee862e01af39,
                    0x084736d1728c89af,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x1139a2b136f7d0ca,
                    0x36e51d3ed2e7368f,
                    0xb40d0d3d9f376d4e,
                    0x27b84172c516a4cf,
                ])),
                Felt::new(BigInteger256([
                    0xa9b6e3a070895d75,
                    0x594c5b3cf1f6de36,
                    0x827aa151329780ba,
                    0x12cead9003ac9e46,
                ])),
                Felt::new(BigInteger256([
                    0x690b2282c65c0687,
                    0x7d5b10203b4758a5,
                    0x4a14bb8f8f0a7292,
                    0x2621222fdb48d62b,
                ])),
                Felt::new(BigInteger256([
                    0xc05d46c24f643343,
                    0x53e60076e0a10849,
                    0x9a5c22fd0bf82aee,
                    0x21fd9cb1f078edcb,
                ])),
                Felt::new(BigInteger256([
                    0xa4a0dbb79521a7b3,
                    0xaad1943802a1025b,
                    0x895942c476232de6,
                    0x1514a91f49b7ae66,
                ])),
                Felt::new(BigInteger256([
                    0x5f85bcfab8ede151,
                    0xa20ac247ecde9294,
                    0x06e6be81c5099e7f,
                    0x213c4633de68266a,
                ])),
                Felt::new(BigInteger256([
                    0xf043b28941a306ad,
                    0x50aa07b98191b26d,
                    0x08ba8900bac7ce76,
                    0x388908d17062adef,
                ])),
                Felt::new(BigInteger256([
                    0xe7309998c86d5cf5,
                    0xbe77d02319b8db1b,
                    0x22e8582d592e02f2,
                    0x3fc6886d987ec378,
                ])),
                Felt::new(BigInteger256([
                    0xcaa5664903685833,
                    0x1028086c107d52df,
                    0x33db4ff43fc74573,
                    0x23efa01b9cc24f78,
                ])),
                Felt::new(BigInteger256([
                    0x83ff5ef2aca8459b,
                    0xac8110d64a84ed55,
                    0x09c0779d68aceb38,
                    0x1fd19168d8ceab22,
                ])),
                Felt::new(BigInteger256([
                    0xff681ebc8c1ed1fd,
                    0x1354f3e011f27f00,
                    0xa2b1669cf9caef51,
                    0x313ae8b9a5581ab8,
                ])),
                Felt::new(BigInteger256([
                    0x8a716c842f2568c3,
                    0xa47045a734012680,
                    0xcf00390660e14a00,
                    0x217a57cdc055f462,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x520ade8760309713,
                    0x717dfb053afb068e,
                    0x0856eccf5c568138,
                    0x17ebdd653fdf0891,
                ])),
                Felt::new(BigInteger256([
                    0xa48ce25568653366,
                    0x291dc60ad1ecf440,
                    0x25fa06de1603b57b,
                    0x392d0da07e6c18f2,
                ])),
                Felt::new(BigInteger256([
                    0xb336221c0f5524ef,
                    0xdd68c426705dad90,
                    0x803cb50a34b07aa6,
                    0x3281d045f1b408be,
                ])),
                Felt::new(BigInteger256([
                    0x923c079ae8bb2243,
                    0x231904f5d939fddb,
                    0xf98c75456ba39d5c,
                    0x19fde85b74035c28,
                ])),
                Felt::new(BigInteger256([
                    0xd759c9a77c875482,
                    0x1d8f977728ed850c,
                    0xf15efdbd30150459,
                    0x3df4ed441451c7bb,
                ])),
                Felt::new(BigInteger256([
                    0xfa252f53eb8fb2f3,
                    0x6e4a4b323e7a95cf,
                    0xfcd76a51e76e3b68,
                    0x0f63c9f1fcb9f2aa,
                ])),
                Felt::new(BigInteger256([
                    0x0fc577c080db3b06,
                    0xac4b93eeaff9680b,
                    0x7d5d2963bda3064b,
                    0x0c9823e08244e7e2,
                ])),
                Felt::new(BigInteger256([
                    0xf6bb751d9ea20fae,
                    0x47d5382bae9b0599,
                    0x2dd6bda41a051e12,
                    0x37079fd74db2d0a4,
                ])),
                Felt::new(BigInteger256([
                    0x69656515c48f44c7,
                    0xe2ffaf3044a4141b,
                    0x63c4d7682be920e1,
                    0x07e893d194e8814a,
                ])),
                Felt::new(BigInteger256([
                    0x4174f53a4328b4f7,
                    0x227f1149e316bedc,
                    0x65821b4aba1cc996,
                    0x316de3ade8153b2d,
                ])),
                Felt::new(BigInteger256([
                    0xab6d6b5da29e728c,
                    0x50e6585d0206dd08,
                    0x58248ac17650a7e3,
                    0x3efe3ed6f2afc47b,
                ])),
                Felt::new(BigInteger256([
                    0x7c5e292b6cebd777,
                    0xde53977e9fc9912f,
                    0x3a31d65aab7b9242,
                    0x091e935f9f8eab62,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xea4476fb23e0fa7a,
                    0x433d2822dbd1de01,
                    0xe6561a2ff9a4d19f,
                    0x1c3e9fb303c59ba3,
                ])),
                Felt::new(BigInteger256([
                    0x6fb4900656df148a,
                    0x679299a8a7f8af0e,
                    0x287b0e2b31de5c7d,
                    0x256a0788534c748a,
                ])),
                Felt::new(BigInteger256([
                    0xfbd2fc1a5ed70a38,
                    0x3c05f3d2fc325356,
                    0x696cf98b1e5e509a,
                    0x0eaf9488b4c9261c,
                ])),
                Felt::new(BigInteger256([
                    0x76ce5ea8543ecd2c,
                    0x3684fe2d811417a5,
                    0xff4cb66d535cbc44,
                    0x256b3694fe3fdeb9,
                ])),
                Felt::new(BigInteger256([
                    0xcbd84c4cf7b54786,
                    0x6ffa61ec6e577115,
                    0x10e8ecb58c660525,
                    0x19396e9d3ca5cd90,
                ])),
                Felt::new(BigInteger256([
                    0x25bb3e77707b71cc,
                    0x8c204114f57dfa59,
                    0x963ac89a58de2f8f,
                    0x039dd81e3824684f,
                ])),
                Felt::new(BigInteger256([
                    0x5adcef6e022e0156,
                    0x0d7fe174b384071a,
                    0xedbffc62be0f136b,
                    0x301f25ea3be82dbd,
                ])),
                Felt::new(BigInteger256([
                    0xab1f27dec36c4362,
                    0x06117f1c12a30fe7,
                    0x00305caf71d50f24,
                    0x31ea73a0f23aabb7,
                ])),
                Felt::new(BigInteger256([
                    0x25b6ef49c8bbf219,
                    0x8269570c929525ba,
                    0xc7c0443300b61d60,
                    0x02ba3c1aae21294e,
                ])),
                Felt::new(BigInteger256([
                    0x50b5c5e0e0367b3a,
                    0xfb3a3d321932e01a,
                    0xe54c5c360dcbb601,
                    0x15576c72c0ef2449,
                ])),
                Felt::new(BigInteger256([
                    0x11c074dfcb74b437,
                    0x63d0d407a0dbaa5f,
                    0x0cc8cc978e6762d4,
                    0x05a8cd70734079f3,
                ])),
                Felt::new(BigInteger256([
                    0x079e73f233724d54,
                    0x11ec51f9642ec43a,
                    0x72cb922d05d8c240,
                    0x104979c6ca6d3279,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5a5190a1cbb69e64,
                    0x15fe7a26fd7efd73,
                    0x1ff14d9addd3129d,
                    0x3d3aa19f7807f4a0,
                ])),
                Felt::new(BigInteger256([
                    0xbeaf4fd77fe9b1f1,
                    0x4cb502cd0ef60a39,
                    0x28f4e7850243f439,
                    0x302567b058a39301,
                ])),
                Felt::new(BigInteger256([
                    0xb633c7292c6f81b6,
                    0x96888c8909b733ec,
                    0x475b38443c6633ad,
                    0x247bbe5829516585,
                ])),
                Felt::new(BigInteger256([
                    0x26d2587053da6892,
                    0x3c40b7cb623150ff,
                    0x9a2d80ce23525976,
                    0x3f637fc4ce0b8fa0,
                ])),
                Felt::new(BigInteger256([
                    0x1b95c5f23089f83f,
                    0x9b78843c04e23720,
                    0xcedaffa00f20bd33,
                    0x3073dd05d113de17,
                ])),
                Felt::new(BigInteger256([
                    0xf486a22e50df687b,
                    0xf2ba329a3ccd7e75,
                    0x51c13dd537d8399f,
                    0x15da5ef55e43fc78,
                ])),
                Felt::new(BigInteger256([
                    0xb8e1ad0759ea9ba1,
                    0xcbd4f79093faf5f3,
                    0x35ad40cb54700d87,
                    0x018058f0087f2455,
                ])),
                Felt::new(BigInteger256([
                    0xa5521225e5e03718,
                    0x1fa9198244848fa5,
                    0x699c91bff2229330,
                    0x0adb8ad78506ef63,
                ])),
                Felt::new(BigInteger256([
                    0x4e12d22b972ccb80,
                    0x0ce886d7349f36b3,
                    0x57129c0f22830ccc,
                    0x23660a98e7e8be85,
                ])),
                Felt::new(BigInteger256([
                    0xb030002770e7f459,
                    0x6606bd61b69843c0,
                    0xd2371ecfcc367fa2,
                    0x003bb7fe659f1c37,
                ])),
                Felt::new(BigInteger256([
                    0x798a54caed68eeb7,
                    0xdfd21ea300405f58,
                    0xfbb8d528b3ea8b69,
                    0x29491a3f077e26e3,
                ])),
                Felt::new(BigInteger256([
                    0x95000d0a8cb39f27,
                    0x62885c008b25f18b,
                    0xeba81de7ae719366,
                    0x1db2f4737aee2025,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x154824f0e27e2f7b,
                    0x0b7ef33b6e5f423d,
                    0x68ccaf1d251ab8ac,
                    0x01ac06d45cd0eabf,
                ])),
                Felt::new(BigInteger256([
                    0x0ee45d5af9cad27d,
                    0x231a4c5f0ee75b61,
                    0x93a7627b88f0212a,
                    0x2703e36ba8504a81,
                ])),
                Felt::new(BigInteger256([
                    0xaae04e1ce9459c73,
                    0xca3e4f33f629362a,
                    0xa030eedeaedd2eae,
                    0x0bd59b4dcf9fa4c1,
                ])),
                Felt::new(BigInteger256([
                    0xd16b59b996bb801f,
                    0x0c191c5791d77ca5,
                    0xa6e043bc4593c6e2,
                    0x1233737afaf8502d,
                ])),
                Felt::new(BigInteger256([
                    0x6a6d4bd2509b55ab,
                    0xcfaed1764ccf0380,
                    0x3987ccedd5af7094,
                    0x1ae729c2649b1194,
                ])),
                Felt::new(BigInteger256([
                    0x8ff9be99a116423c,
                    0xaa14172258d6a4b1,
                    0x9882689eb2fccbce,
                    0x1a561bd800bd7269,
                ])),
                Felt::new(BigInteger256([
                    0x5c8a686de7a75a02,
                    0x2904be56e7431312,
                    0x0cedf05e36ba5a22,
                    0x1d832bd56cd79592,
                ])),
                Felt::new(BigInteger256([
                    0x92c1550b0aea1af0,
                    0x24521ea4b0271156,
                    0x211fe7880670fff6,
                    0x1b8ba9b012ed55c3,
                ])),
                Felt::new(BigInteger256([
                    0x6f79b64329da4995,
                    0x215228054ebfa225,
                    0x7d68de389bb4f158,
                    0x274924ccbab16b9a,
                ])),
                Felt::new(BigInteger256([
                    0x141428e52219f648,
                    0xbd69c21a633f3e4b,
                    0x9e2a76fa6cd12aad,
                    0x0450e8926b8f1412,
                ])),
                Felt::new(BigInteger256([
                    0x1eade2259a0fd1d9,
                    0xfbce05ec5af8ed11,
                    0x630177d81551a971,
                    0x008628bc6e3af965,
                ])),
                Felt::new(BigInteger256([
                    0x4b11a95169a5f8db,
                    0x321229dc1f33d1f0,
                    0xda1cb1cd832bd7af,
                    0x069387531c374841,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdd9b73f1b7f51dfc,
                    0x25a8a2c64253dfcc,
                    0x2518d7e77709bcca,
                    0x3fc61e1dc768024b,
                ])),
                Felt::new(BigInteger256([
                    0xc0a6535f37597f8c,
                    0xb717ce67e89bdfda,
                    0xcd620cd91ea66761,
                    0x1267d98f68b4bd11,
                ])),
                Felt::new(BigInteger256([
                    0x009e9fa95785210b,
                    0xbabe1f325adf7db3,
                    0x4814da2a7ec3fbb7,
                    0x250be98ba5437440,
                ])),
                Felt::new(BigInteger256([
                    0xf13aa59cb989067e,
                    0xb927bac7096f5cea,
                    0x039e9d3be89e7b0c,
                    0x00a88fbe46719c12,
                ])),
                Felt::new(BigInteger256([
                    0xe663fa630e8e33bb,
                    0xa9abd0f7a5d9db2e,
                    0xf16090ab9c82f4d7,
                    0x19bc0b3febe84c0c,
                ])),
                Felt::new(BigInteger256([
                    0x6aa31feda3cbe4aa,
                    0x94b69d65796b0a5c,
                    0x0709e087b69d41a7,
                    0x2fbe00ebe1fd7b6e,
                ])),
                Felt::new(BigInteger256([
                    0x55a953f2940bfe13,
                    0xf1e0efd821402101,
                    0x7b427669064bce40,
                    0x1ab2dc844a2585a0,
                ])),
                Felt::new(BigInteger256([
                    0x7b75b0880cf5d88a,
                    0xc21df6b0d4750bd6,
                    0x4b6467fe5d526769,
                    0x1d81a0f677ad61f4,
                ])),
                Felt::new(BigInteger256([
                    0x98fed7be4be5c3c8,
                    0x7c5825fad20285ea,
                    0x856cfcb783a8dcec,
                    0x2b4ef4896fac3abd,
                ])),
                Felt::new(BigInteger256([
                    0x2066d938ad485757,
                    0x2e3dbcd100105078,
                    0xd72ba16962460383,
                    0x1d9f52eb477fc18d,
                ])),
                Felt::new(BigInteger256([
                    0x4ae4da927f7c1960,
                    0x25d5cb2644f94c34,
                    0x9bb3252971fa3ea7,
                    0x1007150ddb755622,
                ])),
                Felt::new(BigInteger256([
                    0x411a3bc96a7f4083,
                    0x9457eb0ceac3f71d,
                    0x1be4f0b73cf5b0e2,
                    0x177935c6be9d372f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x213ed99b30240526,
                    0x28aec05d93523d4e,
                    0x8abea9a0022b920e,
                    0x3edce50786c79e6b,
                ])),
                Felt::new(BigInteger256([
                    0x6e85d106d6e42f0d,
                    0x3789d2c8e1824258,
                    0xc737f171c1584615,
                    0x0cc7f01f3d8e5a7d,
                ])),
                Felt::new(BigInteger256([
                    0xe80ba97ea03d2dd8,
                    0xf18e5941ccac5fb7,
                    0xd695515f1664bd87,
                    0x04eea38279c52943,
                ])),
                Felt::new(BigInteger256([
                    0x445d995ba6f99e6c,
                    0xb8aab988595fa9c9,
                    0x2b9a32f45775695a,
                    0x0ba7dc55a021c51c,
                ])),
                Felt::new(BigInteger256([
                    0x3b7e1146e9f02b07,
                    0x3aac06d0d7c5ac5f,
                    0x3f753c3eccc446b7,
                    0x00fd8a9bea2db88a,
                ])),
                Felt::new(BigInteger256([
                    0x0ff00dbcfc7474db,
                    0x51da2f7dead07f10,
                    0xccc82874e8294b79,
                    0x14cefe9508d85004,
                ])),
                Felt::new(BigInteger256([
                    0x155a2ffa20a8af1e,
                    0x9c56b93f2aed0d31,
                    0xa9161e056aa6f49b,
                    0x179da1d2b24b843b,
                ])),
                Felt::new(BigInteger256([
                    0xe929a3ca0ddff472,
                    0x14edcfd0c5432379,
                    0x16ba5ed948320d34,
                    0x28b3008ee30e0b61,
                ])),
                Felt::new(BigInteger256([
                    0xbb2a1233a4a4ca77,
                    0x418fcedd63cd826b,
                    0x7f131d23f56f55ae,
                    0x2660f87dda51fa91,
                ])),
                Felt::new(BigInteger256([
                    0xae739d9f0ad64190,
                    0xdda62f497706f86d,
                    0xc15b66ca5a70f14f,
                    0x054cf0dc1039e529,
                ])),
                Felt::new(BigInteger256([
                    0x54dea0144f997bf8,
                    0x9e5b44000b101f76,
                    0xba8c0ea002fe1c9a,
                    0x1ff0b5343388c7ef,
                ])),
                Felt::new(BigInteger256([
                    0xb9407e974787fc91,
                    0x52fb012759b8772b,
                    0xee5c5ee3fe9ddc41,
                    0x35f6d9c2188fa4fc,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4876cd6d846c17de,
                    0xc9164be9ed87e56d,
                    0xb4878e1590ed1e20,
                    0x2164897f4ba138c8,
                ])),
                Felt::new(BigInteger256([
                    0x00e17bca50df6261,
                    0x99ffed1ad878d8c2,
                    0xa4a55652d57be89e,
                    0x1c62d038ae02ba3a,
                ])),
                Felt::new(BigInteger256([
                    0x671bf3588d0c14b1,
                    0xc70b4ceb32f9b26a,
                    0x00a62a128090d3de,
                    0x2c99b37a948ab057,
                ])),
                Felt::new(BigInteger256([
                    0xb4ff2e32a760dde4,
                    0x662dcb281d8b27b1,
                    0x2546e3e1d13daa40,
                    0x341adbb640f8e126,
                ])),
                Felt::new(BigInteger256([
                    0x716a36408b31cf84,
                    0x12e4a588ed03bcf1,
                    0x6c93b49ad2cdde5e,
                    0x014076b6db3cb0d6,
                ])),
                Felt::new(BigInteger256([
                    0xd342eb70687fd411,
                    0x5c713dde0d08cde6,
                    0xa326a866f017bb9c,
                    0x092f5832bb7b7969,
                ])),
                Felt::new(BigInteger256([
                    0xda435f9cd2f671dd,
                    0x59f37abb231852e4,
                    0x7760e114d7179d7b,
                    0x3fa454b43c78fed0,
                ])),
                Felt::new(BigInteger256([
                    0x28a21d8d8389a3ee,
                    0xb9574944f40ca988,
                    0xe424ed73e8d5977c,
                    0x357670b03ecae05f,
                ])),
                Felt::new(BigInteger256([
                    0xe19d869b0da91ad7,
                    0xc4042df7b6cb3677,
                    0xf037afff87b7c562,
                    0x2529b0f193a87efe,
                ])),
                Felt::new(BigInteger256([
                    0xa75597221163eef3,
                    0x847774b0b7af6b42,
                    0x3aa56cf663f08ea0,
                    0x2f32aee44ff6f470,
                ])),
                Felt::new(BigInteger256([
                    0x6b8244dce7baa1ff,
                    0xe1c215be5f4281af,
                    0x4b60282c58e51a6b,
                    0x14298078e26e0a55,
                ])),
                Felt::new(BigInteger256([
                    0x3f96d7ba2d206d93,
                    0x6441c136fc8a3b3f,
                    0x1e8880a5c2ecfc3a,
                    0x13a764e146d00fbc,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3c7be73e4d0102ba,
                    0x8bf28a10b2a8fd00,
                    0x6271b4aa62094058,
                    0x39c94490bea1feba,
                ])),
                Felt::new(BigInteger256([
                    0x1171a5bdb8acc487,
                    0x3a7682c20a3ddcf5,
                    0x14a778bec27a3df0,
                    0x009bcca354189025,
                ])),
                Felt::new(BigInteger256([
                    0xc1d486652264d3c4,
                    0x9e533c833c0e8c03,
                    0xaa6073320db6c61f,
                    0x0834446eff5840b9,
                ])),
                Felt::new(BigInteger256([
                    0xcf26966831f04442,
                    0xa39a8bdb8bb96fff,
                    0xa907fd42dcdabaa4,
                    0x30c35a6979ccfbc4,
                ])),
                Felt::new(BigInteger256([
                    0xd3ed9441992186e6,
                    0x8f4ebf343462d706,
                    0x7619aebbedf89c37,
                    0x386e5cae3e775b5b,
                ])),
                Felt::new(BigInteger256([
                    0xcb1638a9959bf597,
                    0x9a5d713d8a7a8b06,
                    0x52597c8bf7809104,
                    0x3997b64216390d2d,
                ])),
                Felt::new(BigInteger256([
                    0x77af7bce45503e2e,
                    0x0960dd728d33ac93,
                    0x5a9e02934aa8dd89,
                    0x310e804d3048e4f4,
                ])),
                Felt::new(BigInteger256([
                    0x20a44de2320d22ea,
                    0x60ace43f954e9f76,
                    0x0966fe06c59e000f,
                    0x0819375dd23fb232,
                ])),
                Felt::new(BigInteger256([
                    0xb479946abbc5bc52,
                    0x991419c8200dbe07,
                    0x4aa856c9da2f5359,
                    0x28ad473e9412561d,
                ])),
                Felt::new(BigInteger256([
                    0x7c0b8aa52e6badf4,
                    0xd3bad4378916736e,
                    0xaa504d8760cf26f8,
                    0x0bcc0dd108908f6a,
                ])),
                Felt::new(BigInteger256([
                    0x7715c148b0893664,
                    0x680ca14533775af1,
                    0xe2a94f36d698ae90,
                    0x1213164847c35d2f,
                ])),
                Felt::new(BigInteger256([
                    0x1283c154e3bd0953,
                    0x65dd3b428d2d32bf,
                    0x28c38175a2b3864b,
                    0x1e0fa0953fa562c1,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x94b3c4ba685f824e,
                    0x394c8987e688882a,
                    0xa984b2367b0df6fb,
                    0x07912c95401e576f,
                ])),
                Felt::new(BigInteger256([
                    0x271c2134fefa6478,
                    0x27f39baa1e728b36,
                    0xc0ba9ef7ac54d5a5,
                    0x1e36776f7a76d221,
                ])),
                Felt::new(BigInteger256([
                    0x129a5626b59b732c,
                    0x15e18defbb4bda80,
                    0x1b0aecb2dc9714c6,
                    0x1ebc0e6defd89411,
                ])),
                Felt::new(BigInteger256([
                    0x6bbee62978b0dfcc,
                    0x2b8fbffe4d583f09,
                    0x56c3840b928e8a99,
                    0x23f4b0b9e9342266,
                ])),
                Felt::new(BigInteger256([
                    0xd37540392d3cfafe,
                    0x1d7055759bfb51c2,
                    0x937877220b457fcf,
                    0x30a225daff9ec4a1,
                ])),
                Felt::new(BigInteger256([
                    0x90a7c761cd24ea41,
                    0x6bac261818aab2f9,
                    0xa887fac4c3ae0a9c,
                    0x0dbaeb467b04d0aa,
                ])),
                Felt::new(BigInteger256([
                    0xd5c20cd82bb34ac7,
                    0xac86a82cbbe75397,
                    0xbf14a2e77531c8a2,
                    0x03c3ccc2bc5b89a5,
                ])),
                Felt::new(BigInteger256([
                    0x660e3425c873c2a5,
                    0x3ccb9b9a7eac9c27,
                    0xdd571d8fb462d210,
                    0x13b145de0fd536b2,
                ])),
                Felt::new(BigInteger256([
                    0xe7b1b657e41a874b,
                    0x4255bfae8f437283,
                    0x41b89e554ac65aec,
                    0x1dc2143ceeca8aed,
                ])),
                Felt::new(BigInteger256([
                    0x25fcbf49fbabb13b,
                    0x1d5cd8b80cbb4b46,
                    0x83e1e1e242d16faa,
                    0x060b4c878f49a20a,
                ])),
                Felt::new(BigInteger256([
                    0x43e08a272da8b711,
                    0x6b4e23631a9cd89d,
                    0xef90c5c63c7d323c,
                    0x0f4859eae71a0e67,
                ])),
                Felt::new(BigInteger256([
                    0x0d14560121357091,
                    0xc3c62d6869a007cd,
                    0x86f6028ff68ede54,
                    0x1c1ea187f2a5ab70,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x292cb928b495ecb2,
                    0xd3c2029836679c83,
                    0x535375cabec399be,
                    0x245898c0dcb9cf37,
                ])),
                Felt::new(BigInteger256([
                    0x647fe21584ed5024,
                    0xd39b8455ee09733d,
                    0x4f511da70caff80c,
                    0x1571d1d674eb4e4b,
                ])),
                Felt::new(BigInteger256([
                    0x6919c49d6e4da674,
                    0xf8ff1725831c36c5,
                    0x740cb36a9dc207bf,
                    0x22a9294a80977ebf,
                ])),
                Felt::new(BigInteger256([
                    0x9524d66269aa8ee8,
                    0x363d0ff388e26669,
                    0x584dfcd28fe0a61c,
                    0x0d597bd4595cb648,
                ])),
                Felt::new(BigInteger256([
                    0x09f76e48669e3a47,
                    0x70bad3caeac29d2a,
                    0x7250981e2902b60f,
                    0x34e53f92c8f3be50,
                ])),
                Felt::new(BigInteger256([
                    0xb4e917047ed83c3e,
                    0xadc832b00b5a6839,
                    0x3c0968df86bd7bf2,
                    0x1559cc0e557e6f4d,
                ])),
                Felt::new(BigInteger256([
                    0x7e4f57a09449833e,
                    0xf44ab3bc8a9deeb5,
                    0x0969f6180f72b777,
                    0x34ac24070b5dcbf1,
                ])),
                Felt::new(BigInteger256([
                    0x0fac450942e48c60,
                    0x2519870c83308fab,
                    0x3ee33823ee9f9655,
                    0x3ca577c675d19dea,
                ])),
                Felt::new(BigInteger256([
                    0xce637c2519e44c3d,
                    0x6b5a12ce03f2fe3b,
                    0xf0a7823d146b6996,
                    0x16eee8cb08e6f309,
                ])),
                Felt::new(BigInteger256([
                    0x6c2ca0979d13bf15,
                    0xa7e5d5dea84b7776,
                    0x43ff1195cc136aa3,
                    0x027b87b48a4548d0,
                ])),
                Felt::new(BigInteger256([
                    0xd3f32af6ffbccf6a,
                    0xc512140f10051dd1,
                    0x4a5747c3d0be2f93,
                    0x2d7bd23c0c166306,
                ])),
                Felt::new(BigInteger256([
                    0xd023c841d43bde5a,
                    0x3b32705a998de412,
                    0xe73290b7f780f48d,
                    0x08d5a0e19ac499fc,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x630fe4d815eec1ce,
                    0x107b9cd215c736a3,
                    0x2432a989c615c8c1,
                    0x2816be2aa5ad7539,
                ])),
                Felt::new(BigInteger256([
                    0xfb09bb7cf4a0c28c,
                    0x557367daee9dfd97,
                    0x79368d6fbc820771,
                    0x321101d4ba64caee,
                ])),
                Felt::new(BigInteger256([
                    0xb419534b7bc8240f,
                    0xf3deb79e335434a1,
                    0xb856e4ee2cc0c144,
                    0x2a068d6cbf02a228,
                ])),
                Felt::new(BigInteger256([
                    0x8fdd9ca279e981d4,
                    0x6c97a9281a962b2f,
                    0x97df06d91759b9e5,
                    0x33ffb17214fd95e2,
                ])),
                Felt::new(BigInteger256([
                    0x69377030b5f688ed,
                    0x300f31cd860280f5,
                    0x58341769dc8cff17,
                    0x3c914638dacf9ffb,
                ])),
                Felt::new(BigInteger256([
                    0xfbbe0366c6559e06,
                    0x13b4a9f7dff5c95f,
                    0x11fecda71d03210e,
                    0x11752d75fe2a0a5f,
                ])),
                Felt::new(BigInteger256([
                    0x3b2d1391ae2ba0ca,
                    0xc81ea85fc26bf094,
                    0xd40effb8dec95e64,
                    0x2666c0978cf15219,
                ])),
                Felt::new(BigInteger256([
                    0x72b8ae36de61f385,
                    0xf5bd50ddbf688a11,
                    0x79c2db54d3b5beed,
                    0x2691b52bf159600c,
                ])),
                Felt::new(BigInteger256([
                    0x93e2a2374ede74ff,
                    0x952a2bbe735f14e2,
                    0xfd034b7b0501c27b,
                    0x0df40cafe2b3eb58,
                ])),
                Felt::new(BigInteger256([
                    0x5840f13e7b50b2dc,
                    0x362cbc363541d820,
                    0xbd4ee71de239bf9b,
                    0x2006f8da101cc867,
                ])),
                Felt::new(BigInteger256([
                    0x8cc266029d1e4e5e,
                    0x81dd54b09ca3da3f,
                    0x4a9d49ea7f234b15,
                    0x0ec0157acb9309b3,
                ])),
                Felt::new(BigInteger256([
                    0x286a88a4e9939ac4,
                    0x49e9a42ad1de91d2,
                    0x2fa6c6a6b46bb878,
                    0x1563008301f5eace,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdf59a57d066abcaf,
                    0x74d1946a71749777,
                    0xdd703e19f5b0fde8,
                    0x07a61396b11fc102,
                ])),
                Felt::new(BigInteger256([
                    0x0fb680665b5995bf,
                    0xd70ffaaf31145eab,
                    0xbb10b0056e2271b9,
                    0x3a48dacc73d06901,
                ])),
                Felt::new(BigInteger256([
                    0xf2997559b0b1596a,
                    0x7d3052852e4dbcf9,
                    0x4cf596a34a153930,
                    0x3f7de265e44e59b1,
                ])),
                Felt::new(BigInteger256([
                    0x1573c68c7756f237,
                    0x6cc8609a4b93f195,
                    0xc7c7f09a2582af4f,
                    0x18e41007c6fdfaec,
                ])),
                Felt::new(BigInteger256([
                    0x54627fcc205618c1,
                    0xf8fbf56846e3e7f0,
                    0x5fab0d1bdcfd866a,
                    0x238e9d44d3f41483,
                ])),
                Felt::new(BigInteger256([
                    0x7e5b38eeb59c7330,
                    0x39cf793819ac6e68,
                    0x83efeff8a49a79d4,
                    0x375f982ff89bebfa,
                ])),
                Felt::new(BigInteger256([
                    0x65b5da27b03c0a70,
                    0xd180f6b09fb77798,
                    0x6e15ac9f25e32692,
                    0x0493a64014f81d40,
                ])),
                Felt::new(BigInteger256([
                    0x049ba1464bcd5bac,
                    0xf0a8118fe473aa09,
                    0x7cf566f8cd7479b2,
                    0x19286196947a27ee,
                ])),
                Felt::new(BigInteger256([
                    0x2351528d938b15fd,
                    0xc755f174838d5b31,
                    0xa12eaca3bd3ee842,
                    0x3a0b2db08e29fde6,
                ])),
                Felt::new(BigInteger256([
                    0x0177a987e681a3fc,
                    0xbe709b10124a6c80,
                    0xb0756f69fcfc59b6,
                    0x3f132c711a4a1275,
                ])),
                Felt::new(BigInteger256([
                    0x486b65e139b1bd80,
                    0x036f7f35f6225091,
                    0xdc3accb6335093fe,
                    0x1733760c293c6701,
                ])),
                Felt::new(BigInteger256([
                    0xb76c913ae53be4d3,
                    0x26182b11063cfbf9,
                    0x187313372ef75b20,
                    0x02b56c71dc3854c5,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4f6199df5e65d8ca,
                    0xbc76c1bc85818ac6,
                    0x539d4c1fb2639a96,
                    0x205dd4073357846c,
                ])),
                Felt::new(BigInteger256([
                    0x2d252644d0b0d598,
                    0x715f1bbe0185ab46,
                    0x1d3cd39ae1ff7621,
                    0x361068fa847127fd,
                ])),
                Felt::new(BigInteger256([
                    0xcff7915db7a7af5d,
                    0x36358d6fbe2ad25f,
                    0x8c42a930315aa692,
                    0x107620b55baaee40,
                ])),
                Felt::new(BigInteger256([
                    0x7fc20b0b36b3505c,
                    0x7a09ad85c9d60550,
                    0x2ba4cf6cc295a2de,
                    0x21a5ffb8719aa626,
                ])),
                Felt::new(BigInteger256([
                    0x9d3d1c37245424ea,
                    0x23c923076a9583da,
                    0xec855e5e84be0e00,
                    0x38c670cdc5e74c4e,
                ])),
                Felt::new(BigInteger256([
                    0x5e366acd5b6056a5,
                    0x8ee701bc58e81463,
                    0x5457985fa878ccc3,
                    0x1106775dec6b9928,
                ])),
                Felt::new(BigInteger256([
                    0x474266b6b022a3f1,
                    0x36cc56642b5a4076,
                    0xd3ff3d0e304b47fc,
                    0x2d3ab1ac7c6a1bf1,
                ])),
                Felt::new(BigInteger256([
                    0x716bb7aef7c93068,
                    0xd14ad71471735782,
                    0x836f505ab45bd173,
                    0x2a6d82b4d2c63cf9,
                ])),
                Felt::new(BigInteger256([
                    0x9132cbebf3d47a88,
                    0xe9c458f41253e377,
                    0xf2b33a0246cdc297,
                    0x06c6413154bc36cc,
                ])),
                Felt::new(BigInteger256([
                    0x1732d120c009b032,
                    0xbbff12bdaa4afc3d,
                    0xf22d42ff7ccd0bda,
                    0x3bfd4d80cfcdfaf1,
                ])),
                Felt::new(BigInteger256([
                    0x199787acd2e5175a,
                    0x80e47993cf3361b1,
                    0x34d39857bb744411,
                    0x2ed87756eec2cf8e,
                ])),
                Felt::new(BigInteger256([
                    0xed4246a7b54d6a1e,
                    0x99313bd1e4be3d30,
                    0x9cc299af91d1a600,
                    0x01b782989dc13b88,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x352364eadc3cd5af,
                    0x44d6341de9c47901,
                    0x09455180319f052a,
                    0x12e922c3925568b6,
                ])),
                Felt::new(BigInteger256([
                    0xeb324aec88dbe0f1,
                    0x6c73ec7be3a3e785,
                    0xe0fa9e5af326580d,
                    0x3ee1c81bac143743,
                ])),
                Felt::new(BigInteger256([
                    0x1443619cf37ac09e,
                    0xd69fc6e2617f5ac8,
                    0x5fb1628118f8bbae,
                    0x3c22933cc5412aef,
                ])),
                Felt::new(BigInteger256([
                    0x93fada090b438876,
                    0xe81a8800c8b6b64f,
                    0xcf255ce38371b45b,
                    0x3ceb4dcb0224569c,
                ])),
                Felt::new(BigInteger256([
                    0xf3178967a6b514d3,
                    0xe7066a2a45eb0ba5,
                    0xfa7af7ee12bc5d60,
                    0x3f955a41d045da83,
                ])),
                Felt::new(BigInteger256([
                    0x5d6a954e00ea5e94,
                    0x6587dce3038e52ca,
                    0xbf4d4b508f01d5c3,
                    0x09a0450263e18686,
                ])),
                Felt::new(BigInteger256([
                    0x65fe73ebce532f9e,
                    0xc1e5464430bbf64f,
                    0xa1c65f7526a1662c,
                    0x05383e563478171d,
                ])),
                Felt::new(BigInteger256([
                    0x530f2319b974cef4,
                    0xa1f173f1b1450d4f,
                    0x96d09decb818fe70,
                    0x1c8760fdc259c41c,
                ])),
                Felt::new(BigInteger256([
                    0x76462aec510933ec,
                    0x456b4f45932ae4b9,
                    0xa1570af96b63dede,
                    0x02c6de661d3a9302,
                ])),
                Felt::new(BigInteger256([
                    0xa38b03aea28fdbf2,
                    0x52c65913120d617c,
                    0x8a5571a35733d8df,
                    0x1bb7d6a1bfd31528,
                ])),
                Felt::new(BigInteger256([
                    0x306abd0ae14c19fc,
                    0xc193f975e34f2c4c,
                    0xb0764c59743e40ac,
                    0x1997b8d64737a3f1,
                ])),
                Felt::new(BigInteger256([
                    0x9b0ed10ec5d5d5bf,
                    0x77ac6f494418f691,
                    0x5bc8bc9631c5adc1,
                    0x1d9f3e76d52e4bac,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb97039dbb78e32c6,
                    0x1d340ae7e58b96e3,
                    0xc45d8aef85ce4070,
                    0x2c71d6566269d8f8,
                ])),
                Felt::new(BigInteger256([
                    0x458c949fb8c307e5,
                    0x465bf1a4cd5c09d0,
                    0xf9cc60759efa3419,
                    0x3f2a916f0c524f34,
                ])),
                Felt::new(BigInteger256([
                    0xe9c982ca5d67c79c,
                    0x59db74e78bc8a16a,
                    0x67b1e718ab75be8c,
                    0x10f75eb24c23a69c,
                ])),
                Felt::new(BigInteger256([
                    0x962a361edef11c38,
                    0xbe06977a80ce778a,
                    0xe896c6e8abedf7e3,
                    0x1b9145b3be6906f1,
                ])),
                Felt::new(BigInteger256([
                    0xace0176a8cfd004c,
                    0x9875d3e8df3f3f49,
                    0x24fe7bd55a23ffa9,
                    0x039f3e7d49136c3b,
                ])),
                Felt::new(BigInteger256([
                    0x8f557e9fa99a9ed9,
                    0x8573e1befbf16412,
                    0x3f76b8e1a95661cb,
                    0x3819038b3a60842b,
                ])),
                Felt::new(BigInteger256([
                    0xcbfbcdbd4569a002,
                    0x8ef8d5a2ae6b65e6,
                    0xcface2b890cdc1f3,
                    0x36ce692859ad0b95,
                ])),
                Felt::new(BigInteger256([
                    0xbcd5cc227bea6872,
                    0xe4e881c9cb01f58d,
                    0x2f591d5f53dc19e0,
                    0x1c442141c2a2de18,
                ])),
                Felt::new(BigInteger256([
                    0x295578e7d138ce40,
                    0x7d9c0ed97199f2df,
                    0x8fada00b284f0ed0,
                    0x2f59d2f5e52aba9a,
                ])),
                Felt::new(BigInteger256([
                    0x877e3f253875dd25,
                    0xa37bf8b2d4914e20,
                    0xf0d36cef2102b2d9,
                    0x3fefec4c13973634,
                ])),
                Felt::new(BigInteger256([
                    0x6fe58313f3519522,
                    0x090c06509e15d573,
                    0x0f26ce9fe24d3793,
                    0x15759489b0b15f71,
                ])),
                Felt::new(BigInteger256([
                    0x19571f5ff66ee380,
                    0xaab85a352565f2ab,
                    0xdf4179540159a22d,
                    0x34a7b73108249472,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdc1571891f726816,
                    0xc22db20020c0ba17,
                    0xd383dbc6e2ca3e8a,
                    0x21e637672d86928e,
                ])),
                Felt::new(BigInteger256([
                    0xa5f3e129a06de55c,
                    0x7b65ce73518e9689,
                    0xa87457a510ca847a,
                    0x334dacad80612f85,
                ])),
                Felt::new(BigInteger256([
                    0x1a7641b5b6f42b3a,
                    0x14bd6030e436acc2,
                    0x69b91f0ab024e66f,
                    0x3c52fc8d8e5abe3c,
                ])),
                Felt::new(BigInteger256([
                    0xb18fb71ff39d5e52,
                    0x9e14d4d5722bbf01,
                    0x095a778bb61a4bb8,
                    0x047326a69108bbcd,
                ])),
                Felt::new(BigInteger256([
                    0xdbc979f6d7a567c6,
                    0x01dd6c09206438bd,
                    0x4ca5bd51d8c3ea33,
                    0x268524f33b59de08,
                ])),
                Felt::new(BigInteger256([
                    0x0b1c431c27b649f4,
                    0x327784dc92a9fc5e,
                    0x11babd2ff5087d34,
                    0x0373994aebbdd457,
                ])),
                Felt::new(BigInteger256([
                    0x1d32bfd7ba280198,
                    0x5d1e551d23049bb4,
                    0x54e1fccc483fb504,
                    0x21f31b445eef9fc3,
                ])),
                Felt::new(BigInteger256([
                    0x08c3891be0d26588,
                    0x1ee66de798722bc0,
                    0xe2bc9ad2218416a0,
                    0x0607db7ec8b8fb6e,
                ])),
                Felt::new(BigInteger256([
                    0x2f85e8d930139e0a,
                    0x9614f967653fdf68,
                    0x3a80a6f710fd0c04,
                    0x10e297d22d47e86d,
                ])),
                Felt::new(BigInteger256([
                    0xec19df74a8d44742,
                    0x4f35953b6c6390ab,
                    0xedf5dad85c9a83cc,
                    0x11f9dfbd81cdb396,
                ])),
                Felt::new(BigInteger256([
                    0x956e187f176fc9a3,
                    0xd9fdc5f0510ae869,
                    0x9ec2ba204c98fed1,
                    0x3105a74391111d58,
                ])),
                Felt::new(BigInteger256([
                    0x85d4fc0664234c35,
                    0x6d3fd0cfc6dcd193,
                    0xd98635d15b6d6692,
                    0x23c266196b630479,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x8047070199605890,
                    0xbf22992a76ee0e9e,
                    0x4ae748246314bd5d,
                    0x3fcf9dee2c1adc4f,
                ])),
                Felt::new(BigInteger256([
                    0x1290c869194430b1,
                    0x7973b51afc9b4107,
                    0x8d24e20ed7164c8e,
                    0x322e14c8fc81a1de,
                ])),
                Felt::new(BigInteger256([
                    0x78d3af385a5a1103,
                    0xd4ff587deb78648b,
                    0x2d1208f097471513,
                    0x0e668932f7d74d2e,
                ])),
                Felt::new(BigInteger256([
                    0x6a38fc8188709115,
                    0xe0dd7551050a6549,
                    0x66f44e231e55ebfd,
                    0x3bc7d26b9f08ed7c,
                ])),
                Felt::new(BigInteger256([
                    0xfd83af65d6fd35c2,
                    0x3a0f80e67fba4f62,
                    0xe491b92aa9b7b9e5,
                    0x18ada14dec93e3da,
                ])),
                Felt::new(BigInteger256([
                    0x6d4b3a514e9df657,
                    0x3133dea8ac631062,
                    0x8bc461f16bb0a13b,
                    0x273f436158e21657,
                ])),
                Felt::new(BigInteger256([
                    0xa621556eb8938518,
                    0x44f66335a295440a,
                    0xbfc3e36a3ac4bd46,
                    0x20f288718a254e0b,
                ])),
                Felt::new(BigInteger256([
                    0xa9b3a6dde4fe570c,
                    0xef2344e6bae0f05f,
                    0x57a14d8c868596c2,
                    0x17334a03c63056df,
                ])),
                Felt::new(BigInteger256([
                    0x3678ec6cbef8d439,
                    0xefbc71d1780e90f1,
                    0x35fe916a3a5cf736,
                    0x1d1be8371c4d3f41,
                ])),
                Felt::new(BigInteger256([
                    0x5d202d5b78f913af,
                    0x17c2b18ee9671666,
                    0x3e66612985256480,
                    0x378c410007f2b62c,
                ])),
                Felt::new(BigInteger256([
                    0xe0e2f38585a83e92,
                    0x720a686c1505fa82,
                    0xd745c55e8851de1d,
                    0x1ff2708103c52eab,
                ])),
                Felt::new(BigInteger256([
                    0x4ca048d7f178e723,
                    0xaaebbee16a48f838,
                    0xcd12737300a22d6e,
                    0x0102edb36c7c4725,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf16ff8ae348d5660,
                    0xf0c6e69fdf576b22,
                    0x947855d104b0537f,
                    0x21ff792be53f113b,
                ])),
                Felt::new(BigInteger256([
                    0x4c535ceba5f6d4d2,
                    0x05be236329c589eb,
                    0xa25b715d95e0271b,
                    0x156fd0d4feb3277c,
                ])),
                Felt::new(BigInteger256([
                    0x8b8a91c0a3ab947d,
                    0x73531297a364a010,
                    0xf913c515fa3e02f5,
                    0x247fadb836197d2a,
                ])),
                Felt::new(BigInteger256([
                    0xffff1c3cbf155c6d,
                    0x290e8a172e522a4e,
                    0x9e18bdf6aa3f2a9b,
                    0x21895898e62cfe9b,
                ])),
                Felt::new(BigInteger256([
                    0xbf3c51ba9619854a,
                    0x50d4cb03b6a04481,
                    0x97aa0c456eaefaad,
                    0x2dd1a796ceac8990,
                ])),
                Felt::new(BigInteger256([
                    0x8eb1c970a790a651,
                    0x8314bf698b349009,
                    0xeb529a59f68644b9,
                    0x3da3c5877114b07b,
                ])),
                Felt::new(BigInteger256([
                    0xae54557715380a56,
                    0xdae4da9d1d196fcc,
                    0xaf3100821d126e22,
                    0x163bf084e15e5099,
                ])),
                Felt::new(BigInteger256([
                    0xf60e886ff40ddff8,
                    0x3889f450dbfd1df1,
                    0x5c4d97fd9e350583,
                    0x3762f6d578c01a4f,
                ])),
                Felt::new(BigInteger256([
                    0x8f5b8914811c87f6,
                    0xa4fd15e9d1df42bb,
                    0xc64336f4c77f6b6e,
                    0x0ac27ae7676ea7d8,
                ])),
                Felt::new(BigInteger256([
                    0xceae5583a7987620,
                    0x20ad026efd3a0122,
                    0x7b6e7d5ca9e7ed37,
                    0x28f04ab1fad41785,
                ])),
                Felt::new(BigInteger256([
                    0x43f7013ea1beff1b,
                    0x1869f307122b330e,
                    0x1dcfa0a6d704c85b,
                    0x018390b66223a7c3,
                ])),
                Felt::new(BigInteger256([
                    0x2e31c5a8d091486c,
                    0xd3306675f8619ded,
                    0x70454a053964c69e,
                    0x0c6c1b94b4988861,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3729c50c0ac1be4f,
                    0x6e32fb97b63a14f3,
                    0x5cddc314bd54a27d,
                    0x106f9e3bf93e2440,
                ])),
                Felt::new(BigInteger256([
                    0xa8ed119dbd07cf9c,
                    0x835fd71d48188884,
                    0x79e92727e6c4dca8,
                    0x25e599111eb0523f,
                ])),
                Felt::new(BigInteger256([
                    0x0df3382184fb0681,
                    0x1273ee4f606fc107,
                    0x20556776ebfc7038,
                    0x06c0ea51ec066401,
                ])),
                Felt::new(BigInteger256([
                    0x3aec0d7048222479,
                    0x61bdbe3074c57cf8,
                    0x3f6640909c69b797,
                    0x000df7e1865a2d14,
                ])),
                Felt::new(BigInteger256([
                    0xb0cb1d8bbc23ab3c,
                    0x4214b36a6ef16657,
                    0x73d2540652a6951e,
                    0x1f5aaa08d2149ed8,
                ])),
                Felt::new(BigInteger256([
                    0x75005258f5f0dce7,
                    0x15e9566adcb96ee2,
                    0x960e4767afa5e65f,
                    0x1252ac96f7335726,
                ])),
                Felt::new(BigInteger256([
                    0x00aaf5fd22a20320,
                    0xe29c862ade48b01c,
                    0x27c1237d5a3db5cc,
                    0x388340ca513a742b,
                ])),
                Felt::new(BigInteger256([
                    0xbb43b51b41276f5b,
                    0x3032884be1a78dd5,
                    0x2efdc02e68dd834c,
                    0x36e187b4c68f881e,
                ])),
                Felt::new(BigInteger256([
                    0xea7c9e2a014a66da,
                    0x62841a962ff258d6,
                    0x8ea58a71dd8108b0,
                    0x21b02803a3c5668e,
                ])),
                Felt::new(BigInteger256([
                    0x6e8da965bb1fb4b4,
                    0x836daf45eee464e3,
                    0xc5e0dea4fe6a1bec,
                    0x2bc530c3d35c467e,
                ])),
                Felt::new(BigInteger256([
                    0xacfffcafcdac8671,
                    0x00f6869e6cd19c19,
                    0xbdb490e2cf224065,
                    0x0e5910b68d05ada9,
                ])),
                Felt::new(BigInteger256([
                    0x75fe5ca5e1d9f626,
                    0x9c82e93d91b6c8f6,
                    0xaceedb41c073c8fc,
                    0x1077923ee8f25c14,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xd5b4efa3b39eb9dc,
                    0xfc4d109d0ec5ceb2,
                    0xa6202676352f372a,
                    0x318c3d18ff64e6f7,
                ])),
                Felt::new(BigInteger256([
                    0x04bc8e1b66f66930,
                    0xb720ea57dd0753a0,
                    0x8c2a58d2d628f220,
                    0x11b3d7621a41e4ff,
                ])),
                Felt::new(BigInteger256([
                    0x55ef9c1a78de73e2,
                    0x5184649a81429c11,
                    0x8fb72213bba8095d,
                    0x3627624eabe18258,
                ])),
                Felt::new(BigInteger256([
                    0x24f6ca5c86d6f81c,
                    0x5937433cf958a525,
                    0xcfaae3915f43c60a,
                    0x083e5e1943507d7c,
                ])),
                Felt::new(BigInteger256([
                    0xe7146e9f64c06e02,
                    0x4a3518069c4be197,
                    0x12d9cb0594ba8768,
                    0x17a8daef82985696,
                ])),
                Felt::new(BigInteger256([
                    0x0fa59c50663600bd,
                    0xf633ee430f33381a,
                    0xd4e4a1ebff9987df,
                    0x37d1af8dfbd110ed,
                ])),
                Felt::new(BigInteger256([
                    0x49d2f4802a7e490f,
                    0xfa15f06748eb87be,
                    0x2e931ae3dab63472,
                    0x0c4254f9a0a42b6f,
                ])),
                Felt::new(BigInteger256([
                    0x70909a9e0f317c96,
                    0x831ad2f64305ee24,
                    0x5df5e4d7f826264c,
                    0x270857079be0cef1,
                ])),
                Felt::new(BigInteger256([
                    0xa42abffe942977ea,
                    0xa1cedbe33f710c16,
                    0x8f5cc90c181ceceb,
                    0x025c5f8ed3963f34,
                ])),
                Felt::new(BigInteger256([
                    0x70706e585c7be5a8,
                    0xa713b1349c561e0a,
                    0xb1887fb51e768a49,
                    0x2d2e960fd44ca369,
                ])),
                Felt::new(BigInteger256([
                    0x907bb51579442985,
                    0x8ec34eb34b9fc247,
                    0x1dce24009bba4b21,
                    0x27ae9f8d300b3c9f,
                ])),
                Felt::new(BigInteger256([
                    0x0e3e67990ea28e7d,
                    0x25325873abbe0ce3,
                    0xdef5ce1fed8eba9d,
                    0x0aa5a805b0f9e2a6,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x6ecce3d3beddbce8,
                    0x4fc5c65749ab3606,
                    0xcd5b7cc6919bd8d1,
                    0x2f79e861186f6df5,
                ])),
                Felt::new(BigInteger256([
                    0x35b0d186844c702f,
                    0x0d9593f53f3ad885,
                    0x86bf69a3284f4490,
                    0x147ad2f02a5c6640,
                ])),
                Felt::new(BigInteger256([
                    0x3d1b1aa774138d4b,
                    0x71a92ab06d13ee0a,
                    0x6dbcfe77620db761,
                    0x3103065505481b06,
                ])),
                Felt::new(BigInteger256([
                    0x7f255d981334993c,
                    0x3b498614c3f48ae2,
                    0x2c98e60138f39a77,
                    0x1ae3f78546b6d745,
                ])),
                Felt::new(BigInteger256([
                    0x98e17f874cfbe65d,
                    0x6da4787f2403c88a,
                    0x12c1844b71ae7b3d,
                    0x37f48679cf2322de,
                ])),
                Felt::new(BigInteger256([
                    0xf33b9535a9b49696,
                    0x13d8ba2cedcfa6a4,
                    0xf8e9cb2032680e24,
                    0x0579dc6a60d19150,
                ])),
                Felt::new(BigInteger256([
                    0x225dd123346f5427,
                    0x40bafb0f81f3a9da,
                    0x0870edaed3fad622,
                    0x31611629e81de4d7,
                ])),
                Felt::new(BigInteger256([
                    0xa0b0412dffed8b75,
                    0x741d8e6a708d9d8f,
                    0x55727c00c0cd561f,
                    0x3dea2ef77b9acf6c,
                ])),
                Felt::new(BigInteger256([
                    0x543aad6077a37c7c,
                    0x9531816ac44369c9,
                    0x2741858cdfbab309,
                    0x3805e3166f99376e,
                ])),
                Felt::new(BigInteger256([
                    0xe28235b91286307f,
                    0x3b221040a2acca8a,
                    0x8e2c136d751c0249,
                    0x0bf9b4d0bfc97948,
                ])),
                Felt::new(BigInteger256([
                    0xd7e43839c2b1c651,
                    0xab3fc62c66fcdec3,
                    0x8aba2cc221d4b8b6,
                    0x3e1ae8acc481706a,
                ])),
                Felt::new(BigInteger256([
                    0x89d89fd99e072664,
                    0xc85745cd951ba855,
                    0xf8a7750d553db69b,
                    0x0819e652be7f4a37,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf5079253d7b30af7,
                    0x3c50fed0b8788916,
                    0xc82a9073d673276c,
                    0x3148c4d94c4f3c31,
                ])),
                Felt::new(BigInteger256([
                    0x7410d263140dace5,
                    0x0b50f2b46e94ddec,
                    0xae90ab336035e024,
                    0x33b5fbdd5b1a2e56,
                ])),
                Felt::new(BigInteger256([
                    0xc0320890302a513a,
                    0xdacde37032507612,
                    0xb43d1c0c975f3924,
                    0x1f75184e66505f6a,
                ])),
                Felt::new(BigInteger256([
                    0xcd6e65862c0dc268,
                    0x8a2db50a4f06252a,
                    0x9ddc4c026df2a4b0,
                    0x27623fcc1dbcc41c,
                ])),
                Felt::new(BigInteger256([
                    0xc4df405f27df8d70,
                    0x2de324d020a0dc4a,
                    0xc379d4e66eab7b6f,
                    0x2533edd4df2a461e,
                ])),
                Felt::new(BigInteger256([
                    0xe5a9e51fd436553a,
                    0x84a2d983d9238182,
                    0x8026e1b66de0dab6,
                    0x2ded67e50d19cd9b,
                ])),
                Felt::new(BigInteger256([
                    0xa2e4f43bbac28673,
                    0x04c657a7de7261d8,
                    0x9f14b4b3f555e846,
                    0x0f6d51b1123b48f8,
                ])),
                Felt::new(BigInteger256([
                    0xf067705a977adc29,
                    0xa10c98d1d793b7c6,
                    0x63ad185ff36f3765,
                    0x12e5b30e9ed9095f,
                ])),
                Felt::new(BigInteger256([
                    0x39b7e87a59dfabc2,
                    0x36c28a19c0039d2c,
                    0x39861982e9fd43a2,
                    0x3989fec5cc12b924,
                ])),
                Felt::new(BigInteger256([
                    0x75131be812b07278,
                    0xd63516372f852684,
                    0xba27b584876631d1,
                    0x130902b12960ae83,
                ])),
                Felt::new(BigInteger256([
                    0xcf16637059d514a1,
                    0x152f1b2c0202eb20,
                    0x1efe41ebe6c81b71,
                    0x1b5abd6bc9086a45,
                ])),
                Felt::new(BigInteger256([
                    0x107d2b9e9c8917aa,
                    0x181265dc877359e9,
                    0xd1eadd6eb2b2606a,
                    0x2e34e61a105ed06b,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
