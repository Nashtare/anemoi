//! Implementation of the Anemoi permutation

use super::{mul_by_generator, sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 1 element (32-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= mul_by_generator(&y2);
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += mul_by_generator(&y2) + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies an Anemoi permutation to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Applies an Anemoi round to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x89b371c9f85eceb7,
                    0xcc8910a30b12349c,
                    0x5a93d72910d73818,
                    0x34a1828132991cad,
                ])),
                Felt::new(BigInteger256([
                    0xef3df1bc4f6494ac,
                    0x70ccc00089f0bf61,
                    0x0cb94a8c163c7037,
                    0x16055df534df3a7d,
                ])),
                Felt::new(BigInteger256([
                    0x1ffee3dd701025a7,
                    0xdbd3695ff14cfab8,
                    0xc912d0010dbefca1,
                    0x2eab47a5789ac5b0,
                ])),
                Felt::new(BigInteger256([
                    0x4201716e2eaed5d6,
                    0xe8df448a9bbbd3a3,
                    0x63949662a6069186,
                    0x195154576523a9e3,
                ])),
                Felt::new(BigInteger256([
                    0xe6d3d9278838cca4,
                    0xaa5501fddc8eb3fb,
                    0x25ecec16ecb168c9,
                    0x13f76904198ca031,
                ])),
                Felt::new(BigInteger256([
                    0x5ead91282753de29,
                    0x397fb808e745b565,
                    0xfef908805bbc7e55,
                    0x276a86d66558a5cd,
                ])),
                Felt::new(BigInteger256([
                    0xf7a6c7b8fc586406,
                    0x695aa431156c810d,
                    0x7a14557058b64811,
                    0x38f293b7feb56208,
                ])),
                Felt::new(BigInteger256([
                    0xfa8d3f84a46e8e49,
                    0x422779a238da1b13,
                    0xe6e34b8126624d4b,
                    0x0e1bfbbd82261774,
                ])),
                Felt::new(BigInteger256([
                    0x871b0b0bfa1d0d94,
                    0xd5538d0980920801,
                    0x57a6d4f88a3d50e4,
                    0x1645d0fe3b8e2f8d,
                ])),
                Felt::new(BigInteger256([
                    0x44b026349e4be52e,
                    0xfc78a6738ccb7934,
                    0xf4e52fe650eb73c8,
                    0x0b002b865f996a16,
                ])),
                Felt::new(BigInteger256([
                    0x180e0a91dc721a6e,
                    0x12c4ea0d1185c183,
                    0x58d709a180692aaa,
                    0x2b04c6b3c7f25d42,
                ])),
                Felt::new(BigInteger256([
                    0x637ebc60b154d5bc,
                    0xbef8c51a9f8fb141,
                    0xe9f21d55bae5ae1c,
                    0x34616520ce4bdd7c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2c34ff0ebe4dea07,
                    0x13bb01174d703cf7,
                    0xbf50a58e7303f5ee,
                    0x170bead664a06bd8,
                ])),
                Felt::new(BigInteger256([
                    0xa8d09b8758fa3673,
                    0xcb06d6ab24f0ae62,
                    0xc5ade99438669cc8,
                    0x1ab65c35e62b52dd,
                ])),
                Felt::new(BigInteger256([
                    0xfca38de80cdcd731,
                    0x76fa54d81a5b8137,
                    0x939dd4a792e3a62b,
                    0x0476a97d63aeaf77,
                ])),
                Felt::new(BigInteger256([
                    0xab492ea802c5d241,
                    0xb06c4a9e5ce8e41e,
                    0x8cfa74b0781615ea,
                    0x061370e798fec623,
                ])),
                Felt::new(BigInteger256([
                    0x65ecf7c46813779d,
                    0xf4038b674faa493a,
                    0x73fa3525a222b511,
                    0x3a3faf8680e4c27a,
                ])),
                Felt::new(BigInteger256([
                    0xe8daa374678caaa2,
                    0xf45e45c271a98801,
                    0xe6c0b3f78918a155,
                    0x00f27b04e8b3b1c0,
                ])),
                Felt::new(BigInteger256([
                    0x390a28385ce71daa,
                    0xe8eff550eb2af806,
                    0xd0bdaa67f8621459,
                    0x3b90d2cf2071ebf0,
                ])),
                Felt::new(BigInteger256([
                    0xb6bfe76cb1e44220,
                    0x3ca41318683980b9,
                    0xead5a01833cd2de3,
                    0x24c5bc1eba498318,
                ])),
                Felt::new(BigInteger256([
                    0x3c74e34c6c41ce9d,
                    0x773b6f6f9f95dbd7,
                    0x614d3c7e21c31efa,
                    0x3f52f51b8c910b5a,
                ])),
                Felt::new(BigInteger256([
                    0xaea584bac743932a,
                    0xe360e9956557f236,
                    0x22093ad214ce8850,
                    0x272656b548952489,
                ])),
                Felt::new(BigInteger256([
                    0xb281342e7b2730ca,
                    0x59d3b9e347d3b48a,
                    0xeebf993cdb08bfa6,
                    0x21bd6dcbf47f248f,
                ])),
                Felt::new(BigInteger256([
                    0x8c86e56d55c7cc92,
                    0x8bcf07c3d80d69fa,
                    0x4faeb34767e85ba5,
                    0x0a2029cd0c761d62,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x144fb2e5ef775f3b,
                    0x7fff7b7ee964042e,
                    0xf3c883057843f4dd,
                    0x1eb306877394ebeb,
                ])),
                Felt::new(BigInteger256([
                    0x7b73c353c3c59c3f,
                    0xb8242f047d693d9c,
                    0x62675866c67d7941,
                    0x1e03c937997d35b7,
                ])),
                Felt::new(BigInteger256([
                    0xbf6b92d572535abd,
                    0xf95a830aa21fb00b,
                    0x772ff23c9b5af3d7,
                    0x002abf223344b547,
                ])),
                Felt::new(BigInteger256([
                    0x8fdfe6f42301e177,
                    0x64d9a152fa2a998c,
                    0x18d40366133b43f3,
                    0x232bd7e1e68d8e7e,
                ])),
                Felt::new(BigInteger256([
                    0x2a50ef5326b74193,
                    0x409f4b6c3f40e128,
                    0xf186a510796c77a0,
                    0x3352045dafe97904,
                ])),
                Felt::new(BigInteger256([
                    0xcbedda541841472b,
                    0x70f759f170fa6b19,
                    0x5101c2fd58ee1a05,
                    0x0905d81c1026caed,
                ])),
                Felt::new(BigInteger256([
                    0x66e35340a9967a84,
                    0x07886e5002da2cb6,
                    0x4cedbf4e8c8c47f5,
                    0x39538668afbba932,
                ])),
                Felt::new(BigInteger256([
                    0x0c1d1cb17de05bd1,
                    0xefde69cb4cb54f8b,
                    0x5845e7fbe545bab7,
                    0x24558d8bb0c45383,
                ])),
                Felt::new(BigInteger256([
                    0x01cdfc6bae4e330c,
                    0x86fbba4f88d060fc,
                    0x4f461e2c826a7255,
                    0x3d1d9548979d15ba,
                ])),
                Felt::new(BigInteger256([
                    0x33c1e0c8ede0fde6,
                    0x2cd65b6b943bb3ed,
                    0x4895af7afc1da5e1,
                    0x374ec3e6966f4f41,
                ])),
                Felt::new(BigInteger256([
                    0x3f0a5a1aea1f1e2a,
                    0x730464ed61adb8de,
                    0xb0afdf7d78879083,
                    0x3ec82960ff028cf0,
                ])),
                Felt::new(BigInteger256([
                    0xee064ff4b5512a62,
                    0x903328c4451c4690,
                    0x540b7992e132c150,
                    0x0f6618f430538eec,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x9774690ab952942f,
                    0x51f4aaa2572a9f2c,
                    0x1979f4c45909500a,
                    0x3b27502e5e51b0f1,
                ])),
                Felt::new(BigInteger256([
                    0x85a2b696deffff8f,
                    0xedde33e484fd56b8,
                    0x8c378c6cf3346b2e,
                    0x1919aaff9246e40e,
                ])),
                Felt::new(BigInteger256([
                    0xcafe110975e57d90,
                    0x6ed20c430451885a,
                    0x7a3b9c2a6815a66d,
                    0x3a0e30ae2a585fab,
                ])),
                Felt::new(BigInteger256([
                    0xfe3e41243f72e2c4,
                    0xf8eaa4a3a4f763bf,
                    0x124d190191c724ec,
                    0x209aa3f36e227210,
                ])),
                Felt::new(BigInteger256([
                    0x6fe4c36a626dc147,
                    0x855f577bb86342cf,
                    0x72a15d121592eab4,
                    0x1b65e8774ae28c64,
                ])),
                Felt::new(BigInteger256([
                    0xeeff13282aef9dda,
                    0x07af54b546df0f7c,
                    0x00893976a5bb6649,
                    0x0ae1c39262a2e635,
                ])),
                Felt::new(BigInteger256([
                    0x57aac75c0cd38cc9,
                    0x58c8c42122871134,
                    0xb49841687a113ce5,
                    0x22698db550db0036,
                ])),
                Felt::new(BigInteger256([
                    0xbd79a96e4fea4ba2,
                    0xf862250c0e166f2e,
                    0xa5927dcfd56b5a4c,
                    0x3d6f55e5a0dbbe83,
                ])),
                Felt::new(BigInteger256([
                    0x683f9590ab0f70d6,
                    0x0955fc653e13cef8,
                    0x1f109e9f748f26c3,
                    0x115302eaa87d1862,
                ])),
                Felt::new(BigInteger256([
                    0x5f1d9f36be5b76c4,
                    0x502cdd4bf5a2ebd8,
                    0xe5944ec61361bc1a,
                    0x1f12f0db68a5e38f,
                ])),
                Felt::new(BigInteger256([
                    0x31ed3a8186b2c2db,
                    0x495450285d082617,
                    0xa8595a84d5d3443f,
                    0x138600d128eead63,
                ])),
                Felt::new(BigInteger256([
                    0x849ac85a3d2687bd,
                    0xfff341add60b0025,
                    0xea1602baeb27f2d1,
                    0x20543ef8cf87e762,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x843e72f3db6ba6a1,
                    0x7311aa91f1214ab6,
                    0xfd37aee2b54858c1,
                    0x2a62ecce1f448437,
                ])),
                Felt::new(BigInteger256([
                    0xecf5687d57614314,
                    0x8227f8252287d50c,
                    0x1d5ce424ac5328f3,
                    0x0d67c9dfe84fb442,
                ])),
                Felt::new(BigInteger256([
                    0x05f5cb0c7173759b,
                    0x1cc583277fe77284,
                    0x3e87f0ff317bb9b5,
                    0x19e3e0381fdfd74a,
                ])),
                Felt::new(BigInteger256([
                    0xd725a1fe608bc4e0,
                    0xd35a1e6c412b0353,
                    0x9ad80955b2a87623,
                    0x39a0db06316b6bb4,
                ])),
                Felt::new(BigInteger256([
                    0xef518ef33fa7bcfe,
                    0x10122863d18a51c5,
                    0x90b66df64d541cd6,
                    0x2562a0733e90bf40,
                ])),
                Felt::new(BigInteger256([
                    0xe87ec0ab414d402a,
                    0x67d6680fc6129ee1,
                    0x9f00ee8619b9bdfd,
                    0x22b4b6236f4c06c8,
                ])),
                Felt::new(BigInteger256([
                    0x0669003817d8b81d,
                    0x3d3b41f7c53e804b,
                    0x63752a7280c60913,
                    0x1cefc7a1bc09ae9f,
                ])),
                Felt::new(BigInteger256([
                    0x2ece82f7e0df712b,
                    0xc151db87a2eef404,
                    0x1c5cc11914f52fa9,
                    0x0f0030b8707d9732,
                ])),
                Felt::new(BigInteger256([
                    0xbb16fd313a9a0044,
                    0x555cd3aac4f47230,
                    0x9201348928c18844,
                    0x12d95c7fb57ffda5,
                ])),
                Felt::new(BigInteger256([
                    0xe4f1601317e28bf2,
                    0xca5a55463b5971c7,
                    0x420c370a7de86e8c,
                    0x1c800d741caadfd6,
                ])),
                Felt::new(BigInteger256([
                    0x55a8e4357ecba33d,
                    0x1760aad1f0ae8b45,
                    0x79ffd71f954ebfeb,
                    0x28e3105af1439823,
                ])),
                Felt::new(BigInteger256([
                    0x7ee75f72a5c4b25f,
                    0x5f699022022efd75,
                    0x8a85743e6b65de7a,
                    0x3c0825423d72c841,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3530ca2051d05e2f,
                    0x094e1ff135a9fcb4,
                    0xbe008eadb0d9dda4,
                    0x3902bc49a55c1ec0,
                ])),
                Felt::new(BigInteger256([
                    0x2e8d0d4c2132c267,
                    0x72fcfedb9128561c,
                    0x410e8b2592be222f,
                    0x212c7942d0868729,
                ])),
                Felt::new(BigInteger256([
                    0x11aa0d0083cca6f0,
                    0x53640fad7444257a,
                    0x9dec595cbbc833e9,
                    0x2ae4ec5d49cefc4c,
                ])),
                Felt::new(BigInteger256([
                    0x60f5e361aee9516b,
                    0xa1ea87b8084af5cc,
                    0x5a7e61c2c3d6a24d,
                    0x1d77fc354fe6e7a8,
                ])),
                Felt::new(BigInteger256([
                    0xf0931e647b077839,
                    0xd0db9173737d64f2,
                    0xc16dc84a562a38a8,
                    0x328f5cc2125b3d82,
                ])),
                Felt::new(BigInteger256([
                    0xc339fe57a0d40d11,
                    0x430ad815b0569611,
                    0x9a12f6706c7c0db7,
                    0x254ceaec67e1364a,
                ])),
                Felt::new(BigInteger256([
                    0x9a01164594513b96,
                    0x128d8ff714cdeb26,
                    0x402b40256ab03dd1,
                    0x1bb3f20279303f45,
                ])),
                Felt::new(BigInteger256([
                    0x172aabed16f63994,
                    0x8b11b04646631c80,
                    0xffb5b79cec6f33fb,
                    0x07185c238b5e0dcf,
                ])),
                Felt::new(BigInteger256([
                    0xff3a707609f72536,
                    0x73272798371a4694,
                    0xf29ed44cba826bf1,
                    0x2cf7ed0a8ddaa006,
                ])),
                Felt::new(BigInteger256([
                    0x4e22b0805764858a,
                    0x4147ecf9f2f755e8,
                    0x5c92095e83a19fbb,
                    0x060fb8607dfa844d,
                ])),
                Felt::new(BigInteger256([
                    0x7935b126e578c323,
                    0x97c96ff14a4a6e2c,
                    0x93a912708ad4f9d1,
                    0x19bc4bbd445eb0dd,
                ])),
                Felt::new(BigInteger256([
                    0x32b6c62cf25dceef,
                    0x479918c15f02cc9c,
                    0x0798d6758d840fcf,
                    0x1f3ad519de77a06b,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x0a7e7c3e99999999,
                    0xb83c0a9bfa6b6a89,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x3785babe3451890e,
                    0xbad6a04b96e7e335,
                    0xdaecef0c6271ae56,
                    0x309b6fa4569ce2e5,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
                Felt::new(BigInteger256([
                    0x376eae911f9c7044,
                    0xf15d13a83fed92e2,
                    0x8a6f1eb3ded38974,
                    0x0a63a5046381f69e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0xe89d156895f33598,
                    0x22cc8f90197cdefa,
                    0x59d1af10ece372fe,
                    0x3c38ccf4eeef1fb8,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
                Felt::new(BigInteger256([
                    0x1fae7c1b952b2763,
                    0x6ff92987f72625f6,
                    0x05ce29c9b82e2059,
                    0x02ee5a311dcf8a77,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xae41e60699999981,
                    0x819db2fb1b340ff2,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x64b4c3b400000004,
                    0x891a63f02533e46e,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x75ce566c07a5d5e9,
                    0xfc4cd9bb0f60fc15,
                    0x38e82b51a22cb118,
                    0x17dd5c2e9e590ce4,
                ])),
                Felt::new(BigInteger256([
                    0x7a33a36e4a2bd13d,
                    0x5a5950b849f5293f,
                    0x789bb105c4b69012,
                    0x27e85532a549c8b8,
                ])),
                Felt::new(BigInteger256([
                    0xe5ada066de9765c8,
                    0xc290cb75ed7d6958,
                    0x2e4a91a2a3555e27,
                    0x22ff75bac4c3f87e,
                ])),
                Felt::new(BigInteger256([
                    0x67ce2d6aee3f3f50,
                    0x0faa89f5407a0803,
                    0xd7f6a9fbd7956fbc,
                    0x21bf9c001ef7f07a,
                ])),
                Felt::new(BigInteger256([
                    0x6a7f9f5249d91f59,
                    0x0a1fca6481efe312,
                    0xf7505abee469c2dc,
                    0x3963f8e79687a261,
                ])),
                Felt::new(BigInteger256([
                    0x2ae17b9797df71c8,
                    0x35d5a6d55c8a3528,
                    0x9a3d6f1ff776663b,
                    0x00b746b741710a26,
                ])),
                Felt::new(BigInteger256([
                    0x6eb7b9fa991b3b77,
                    0x3cae022d3b50900a,
                    0x26829e8f71a1b452,
                    0x26960c50559fd0f7,
                ])),
                Felt::new(BigInteger256([
                    0x6e384f2c88069b35,
                    0x5ed6602b79640ee6,
                    0x8daeb4cee910e636,
                    0x12ceacc7400837fe,
                ])),
                Felt::new(BigInteger256([
                    0x6f586ac88bccebed,
                    0x579e126a6388beda,
                    0x0c8b2fd0ff28e9f8,
                    0x2b4dda1cab13214c,
                ])),
                Felt::new(BigInteger256([
                    0xd1bb6769ac279e39,
                    0x81f2ff9a3b6e3b67,
                    0x0e8bbcae74b7869a,
                    0x0a5fb738f6c201cb,
                ])),
                Felt::new(BigInteger256([
                    0x38d96603d81115e5,
                    0x6c8af7d1c8b4b21f,
                    0x20c1b1803f0be775,
                    0x321a0ffeeaf98cc1,
                ])),
                Felt::new(BigInteger256([
                    0xd8725cdd1c602cb8,
                    0xdb1afb77af1351e8,
                    0x79b0ffee4e4075c0,
                    0x2311b24d4932e392,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb20d8052303f16d0,
                    0x000645371aef8ea5,
                    0x549f7b4a0b611960,
                    0x3f51c6532c1aabf8,
                ])),
                Felt::new(BigInteger256([
                    0xf540dcab84bc8e4d,
                    0x2cfb9e1154a5d7e1,
                    0xd3aa8b380636c8e0,
                    0x137b73502020c76a,
                ])),
                Felt::new(BigInteger256([
                    0x5d830972b283cabd,
                    0x368c8a9d3d302085,
                    0xf540334f28750c21,
                    0x18e5567243735665,
                ])),
                Felt::new(BigInteger256([
                    0x1fd3d91a79d0f4f3,
                    0xe3917d61fc695278,
                    0x74a452479d80f56f,
                    0x37411d54a149821a,
                ])),
                Felt::new(BigInteger256([
                    0xc438b5cf1a383ff1,
                    0x1640af821adb0b0d,
                    0x919f8131150a648d,
                    0x3a81dfc877b67e29,
                ])),
                Felt::new(BigInteger256([
                    0x541ed1f1a847cd39,
                    0xe2ed3732cd7d73f6,
                    0x937b6b5869722e18,
                    0x349edbdbf3de6334,
                ])),
                Felt::new(BigInteger256([
                    0x38b601f5fedf0171,
                    0xf6ff9f0617f7de28,
                    0x07987c758ae41897,
                    0x1cc0848060bde79a,
                ])),
                Felt::new(BigInteger256([
                    0x52da89a568d25a1e,
                    0xf25389afc3b2b6f3,
                    0xcf2557859549e6fb,
                    0x07b331ff0126e26b,
                ])),
                Felt::new(BigInteger256([
                    0xaeea614b39f599cf,
                    0x9913a63befa3f542,
                    0xa6688cb07994fc3c,
                    0x098cfbb35ca465f4,
                ])),
                Felt::new(BigInteger256([
                    0x7119d018b5911d68,
                    0x148b5273b03ae665,
                    0x90d46933fb9572fc,
                    0x38a4cbd4ce61cd30,
                ])),
                Felt::new(BigInteger256([
                    0xb8d71ba69369feba,
                    0xc482b4e1a9fe77a8,
                    0xe431a97b6521c0b5,
                    0x09aec88575ea04ba,
                ])),
                Felt::new(BigInteger256([
                    0xa09c25ac60258f3a,
                    0x55ea06e02715dbce,
                    0xf7abdc70fdda4ad5,
                    0x3a838a7747c39581,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x05cf74a29f70797d,
                    0x86d6181e0c10a7ba,
                    0x39cea7e93585a33f,
                    0x0f33eb6cb00737c5,
                ])),
                Felt::new(BigInteger256([
                    0x2b4992a7a9b787cc,
                    0x4b767edec8c1ffac,
                    0xb43a2acf8ee2e870,
                    0x0829c8fa4338f94d,
                ])),
                Felt::new(BigInteger256([
                    0x44b83c615b729fda,
                    0x9203baf773a3ebcb,
                    0x106cacf2fc267fdc,
                    0x33bd8ed58dbec7c2,
                ])),
                Felt::new(BigInteger256([
                    0xab9241d9b3cf207e,
                    0xb5a7cb87360d2536,
                    0x30a8556f8c4b5a3a,
                    0x33df77656f15e56b,
                ])),
                Felt::new(BigInteger256([
                    0xe3567a82f07e2123,
                    0x3b151da0dda3a5ae,
                    0xa403d6060f5e8d9c,
                    0x0cf09ba081d4f8c3,
                ])),
                Felt::new(BigInteger256([
                    0x2a9439c269c28255,
                    0x325e8837cb8d06a1,
                    0x32e48ea50666536d,
                    0x0431aa221b058e8c,
                ])),
                Felt::new(BigInteger256([
                    0x1882add303843894,
                    0xc1c79eb90e01ad47,
                    0x58d3537d1357458f,
                    0x3b6a95100f511294,
                ])),
                Felt::new(BigInteger256([
                    0x3c5df7986a38e826,
                    0x535385e12a72b08f,
                    0xd2e5568aa7439bcf,
                    0x21b3dd93c156c460,
                ])),
                Felt::new(BigInteger256([
                    0x87442bbdbf6fa5d7,
                    0xe499723615b9575a,
                    0xc36cae45c6a0a095,
                    0x19805c2105ae1160,
                ])),
                Felt::new(BigInteger256([
                    0xa66466fb912c7d96,
                    0xfbb8d79d5808e6ae,
                    0x7349a33f96490bbd,
                    0x2d2ea2d468750103,
                ])),
                Felt::new(BigInteger256([
                    0x0a87a043440205a8,
                    0x7cdcdbc5efaac7ce,
                    0x77b38fb0a7b94473,
                    0x37d6f7f16691d340,
                ])),
                Felt::new(BigInteger256([
                    0x9f5030a99457fd33,
                    0x47fbf1c4e2ca974c,
                    0x6082037fad1d2b3c,
                    0x2aeba60b2cabbeb3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa263b9df4a417d65,
                    0x2b2e61fb78cb0929,
                    0x35601f1796169213,
                    0x1a00c0145f11679d,
                ])),
                Felt::new(BigInteger256([
                    0x9af3c89378649d47,
                    0x654680240ff13b09,
                    0x3b450aba75abb149,
                    0x3e713473ee59ba0d,
                ])),
                Felt::new(BigInteger256([
                    0x886b6de5cc58e449,
                    0x288e5be09610ffa1,
                    0x20d7ea04f65b593a,
                    0x0be1cfaf005e34ef,
                ])),
                Felt::new(BigInteger256([
                    0x527718a8e66bc2ba,
                    0xca6b4cb15b4d8bac,
                    0x162d1ab37ad60856,
                    0x3b014698609c24e9,
                ])),
                Felt::new(BigInteger256([
                    0x12d98a81a6915ce5,
                    0x723d5b0e71ca7dce,
                    0x2287744a1d85eaee,
                    0x2a6f005330013dba,
                ])),
                Felt::new(BigInteger256([
                    0x45f9acf2c932bea9,
                    0x8b0a3e0126387e57,
                    0x4db95cd5e90dc4f1,
                    0x26150b0e68cae070,
                ])),
                Felt::new(BigInteger256([
                    0x2879e4e6af29225d,
                    0x98029f7d80313950,
                    0x6728c627099895d5,
                    0x0af15a548a99e8a2,
                ])),
                Felt::new(BigInteger256([
                    0xad7c95aed8cc088e,
                    0x021eaa384e3bea91,
                    0x1db524504e847f98,
                    0x1b797ae6f7c5abdd,
                ])),
                Felt::new(BigInteger256([
                    0xf911c4f71d2bf1d8,
                    0xc87a9af310a7e452,
                    0x6c77fbd24fe8976f,
                    0x2ded02df9e16b4f2,
                ])),
                Felt::new(BigInteger256([
                    0x902591be378c6877,
                    0x2fb26ace9e1ca4ef,
                    0xb2df3177b101940e,
                    0x1cae760a3b9e5a4a,
                ])),
                Felt::new(BigInteger256([
                    0xedb74f4191891e0f,
                    0xa0dad8a4cb621494,
                    0x1c210618f743cbef,
                    0x3e5f5358ceeb3af3,
                ])),
                Felt::new(BigInteger256([
                    0x2ca3b685bd3f2915,
                    0xe2aae773dcfa86f0,
                    0x51272a5f10d25077,
                    0x3f58912dfa6e3607,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x73767aa9c461bd0e,
                    0x6ae0a09a41b1395a,
                    0x5c9b0dce0ebe2c98,
                    0x1abb194c45d341b9,
                ])),
                Felt::new(BigInteger256([
                    0xa1529379a871ab1e,
                    0xfe87e106218d3544,
                    0x8b6f845e8998cba7,
                    0x11bc49d7b9d10d57,
                ])),
                Felt::new(BigInteger256([
                    0x15a996808cad3c51,
                    0x12e84f109a419ecd,
                    0x0adf6447a9d98c03,
                    0x34b9c14d41df2878,
                ])),
                Felt::new(BigInteger256([
                    0xbc389b10ed923c83,
                    0x5d604d00143a4398,
                    0x869f6d89798dda0f,
                    0x3c6affa750b21510,
                ])),
                Felt::new(BigInteger256([
                    0x606aacd6074c9314,
                    0xef7df63f0d3d9247,
                    0x3ed231199284838d,
                    0x0f3dc4fbe4b9d61e,
                ])),
                Felt::new(BigInteger256([
                    0x01c62e9eec273f44,
                    0xbc4914e1ba0554a7,
                    0xe4ea4af3e5247efb,
                    0x1ec3b69e002785c9,
                ])),
                Felt::new(BigInteger256([
                    0xe6232b39cb245be0,
                    0xd2c3a2292f397b3c,
                    0x38f57fed30ecf22b,
                    0x0523d4d5f723c5a2,
                ])),
                Felt::new(BigInteger256([
                    0x7a8fe476e7d053a4,
                    0x83adc80590cbe948,
                    0x8a0d51e5bb5c725c,
                    0x195034c2b2bf2e9a,
                ])),
                Felt::new(BigInteger256([
                    0x93dc6e4aef40086a,
                    0x186005b6ebeab30d,
                    0x26c1cf329717441c,
                    0x38cb1b3e6bbf2c16,
                ])),
                Felt::new(BigInteger256([
                    0x3faf99a2aa31621d,
                    0x48301e10b85bb672,
                    0x941d5168a7a99705,
                    0x06bbae69d7739b94,
                ])),
                Felt::new(BigInteger256([
                    0x62df595b1e5f2d62,
                    0x6e9b35226142d649,
                    0xea7b0786593cbc73,
                    0x2e6baf8d09671525,
                ])),
                Felt::new(BigInteger256([
                    0x48f5e2af32fa3087,
                    0x3ca2241c3ba78557,
                    0xff8eb99786c40ac3,
                    0x23537f8b18600219,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xc321114a3baa84f2,
                    0xcc6fcef16b0b11bf,
                    0x1620316e1522f5aa,
                    0x19a4b86194132960,
                ])),
                Felt::new(BigInteger256([
                    0xb78bd2fd9817255e,
                    0x56f79fc03175a74b,
                    0xb6b37c42e07f65e3,
                    0x12c05cc4eefc15a9,
                ])),
                Felt::new(BigInteger256([
                    0xbeb3373d1ee8dc74,
                    0x36dbc42346a118f3,
                    0xe5f46d37cf744406,
                    0x284b2ea29ded3cea,
                ])),
                Felt::new(BigInteger256([
                    0x0636d7497435e681,
                    0xd611ac63f92e3777,
                    0xc8032e11ba1e560f,
                    0x08d2431bbdb4ecf9,
                ])),
                Felt::new(BigInteger256([
                    0xedd8fd2fbc429f15,
                    0x23d4cdadd387c3f7,
                    0xade9924919aa0af5,
                    0x3057300f3db5c6bf,
                ])),
                Felt::new(BigInteger256([
                    0x6ff15b532cb66185,
                    0x2cc6bfc9207cd8d0,
                    0xdc722e09943a0391,
                    0x19266a871763b311,
                ])),
                Felt::new(BigInteger256([
                    0x8dcb36d29c26203b,
                    0x181333eb2494c28c,
                    0x22554fb93810eb3d,
                    0x29b224cc3e7c7782,
                ])),
                Felt::new(BigInteger256([
                    0xc128ab9128b63858,
                    0x4056bb7255bf78ac,
                    0x2737c1b8576b8dc5,
                    0x0992567f4a547fa3,
                ])),
                Felt::new(BigInteger256([
                    0x7a434f14754ac0a6,
                    0x0ff45b1d189b65eb,
                    0x62dc0d6b0b3e20c8,
                    0x0a70aca06e0e669f,
                ])),
                Felt::new(BigInteger256([
                    0x5ee697aa8ac331c6,
                    0x34657644053778fa,
                    0x8acd8d54f0b7083b,
                    0x12ce6b1041f7fb4c,
                ])),
                Felt::new(BigInteger256([
                    0x0c09fedf81b70bf9,
                    0xe0e4264eb2530701,
                    0x5c2db65660758adb,
                    0x08d06f49b9773047,
                ])),
                Felt::new(BigInteger256([
                    0xc6058607b4dd66b4,
                    0x1af3b861443679d3,
                    0xaa2b5cc8c78c5b75,
                    0x114ee3858242355a,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xf133f5170b69c5bf,
                    0x436250557635a551,
                    0x57d6be2e0355b7e1,
                    0x383a05bb84b63d24,
                ])),
                Felt::new(BigInteger256([
                    0x18d1c8113952f7f7,
                    0x041cfd51a13467c5,
                    0x9732a1423004c1df,
                    0x09969d63620f222e,
                ])),
                Felt::new(BigInteger256([
                    0x09870a87e270b7c6,
                    0x90f45832c8fcf8e0,
                    0x062cbacececf7e3e,
                    0x065efccf714fd56f,
                ])),
                Felt::new(BigInteger256([
                    0xbe0ffbe626786343,
                    0xa4b80a424d35810d,
                    0x048a9ed7ca4d4398,
                    0x014781dfc9a2fb35,
                ])),
                Felt::new(BigInteger256([
                    0xa3cf76859a76537c,
                    0x2f5d11e79c45b4d1,
                    0x82c5e19b77558f11,
                    0x0fb1f86cc2bea7a1,
                ])),
                Felt::new(BigInteger256([
                    0x1e04656cce22964e,
                    0x6175782bbf38c068,
                    0xf6a93cb26f0e13ed,
                    0x1a71654063fd3b0e,
                ])),
                Felt::new(BigInteger256([
                    0xd497df8770e29a30,
                    0x9d4d4625a11f51ef,
                    0xe379c34103499389,
                    0x3d3ac6be61aca5f8,
                ])),
                Felt::new(BigInteger256([
                    0x03178caf0297666a,
                    0x714cf1306b43e6a3,
                    0x3ec3db3faf54569b,
                    0x0e4633262e837cff,
                ])),
                Felt::new(BigInteger256([
                    0x9d24bfafe47f2f58,
                    0x3cbe0b1c7b591787,
                    0xf30ca7a29019b7f4,
                    0x2ddafc9ada757323,
                ])),
                Felt::new(BigInteger256([
                    0xd7aa501202effdf2,
                    0x8c8937fa4b2decea,
                    0x9dd5c0e7d388aecb,
                    0x11b759aad10ee5bf,
                ])),
                Felt::new(BigInteger256([
                    0x768609591cf07e06,
                    0x1067adfbda1f23d9,
                    0xa8a6257835e56ecc,
                    0x22907ed0229fee02,
                ])),
                Felt::new(BigInteger256([
                    0xf1227e6c5f438f22,
                    0xace1e2d12a712627,
                    0x1c4dccfcc0e1b74d,
                    0x24117e374382d02e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x1c9214377cebc798,
                    0x3cb55f5f25bf8a1f,
                    0x744330d0bcfa9e25,
                    0x38427e6fb17dace8,
                ])),
                Felt::new(BigInteger256([
                    0xed4c112b7f3da3e6,
                    0x6cc7644175ba8bbe,
                    0xe9e28a218fb13e77,
                    0x07b1f38d4fc58bbe,
                ])),
                Felt::new(BigInteger256([
                    0xeea9ee61503dbef0,
                    0xebca6888a79938ec,
                    0x001278fbcac9359e,
                    0x3fe3a029c63a1fa7,
                ])),
                Felt::new(BigInteger256([
                    0x3d10b12a2a667a0d,
                    0x51458382abb0efa0,
                    0x0705069b2a6250f4,
                    0x08dabe76c21981de,
                ])),
                Felt::new(BigInteger256([
                    0x6f578cadc802064e,
                    0xe04b5f37007c5777,
                    0x2409d459bd75ff2f,
                    0x2c4cdf653660cc09,
                ])),
                Felt::new(BigInteger256([
                    0xa57d9f6295daad08,
                    0x7f66252dfe860b5f,
                    0xd0762c7ad057575d,
                    0x3cdaaea28d053ea0,
                ])),
                Felt::new(BigInteger256([
                    0xd031ea7255a669ea,
                    0x780cbeb569e6e6fd,
                    0x00da3041f6f34023,
                    0x31de4ad97caf6e90,
                ])),
                Felt::new(BigInteger256([
                    0x725aa3e87b56847c,
                    0xe3dd9a1e8d8b3049,
                    0x2175dd26f840efb9,
                    0x13fc4a00d6006ef1,
                ])),
                Felt::new(BigInteger256([
                    0x43b2cbf0ce3b5144,
                    0x9a52ea6972823258,
                    0x7def1278596da9b9,
                    0x329005cd5fc4dc0e,
                ])),
                Felt::new(BigInteger256([
                    0x45dcda4a5e7cde55,
                    0x634d860edccbb4a7,
                    0xa90695a8ba3344a0,
                    0x09e3513b5850533c,
                ])),
                Felt::new(BigInteger256([
                    0x0894f54b62a04eca,
                    0x39986aad3bb92a96,
                    0x0cbb99c3ddba4f28,
                    0x16375af151f4fb65,
                ])),
                Felt::new(BigInteger256([
                    0x99d62a8d8053d733,
                    0xa6ad350239188f08,
                    0x38f59095830479bc,
                    0x3c2beba69ed9ef1d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa9391fc92ad38d35,
                    0x062e71f4387bf393,
                    0x48d5a770dc6dd4b6,
                    0x3e9bfdd6495bb5d4,
                ])),
                Felt::new(BigInteger256([
                    0xe446f952cac61e2f,
                    0x2512ed16107a09f9,
                    0xe3f1e498deb4613b,
                    0x36ed0b9848e33d01,
                ])),
                Felt::new(BigInteger256([
                    0x1aebd6a581d8b7f3,
                    0x537902682e6cb2f5,
                    0x72180f32ea51950b,
                    0x3436a589d4c810a6,
                ])),
                Felt::new(BigInteger256([
                    0xfb58cae369738e18,
                    0x45bf62b2d3ffeb2a,
                    0xf6c9be02edacdb9b,
                    0x297a5ee595c979d4,
                ])),
                Felt::new(BigInteger256([
                    0x117f94cf650c38fd,
                    0xc304ea50190d6606,
                    0x9c8cdfb0c98dc858,
                    0x1329d8460b05e14e,
                ])),
                Felt::new(BigInteger256([
                    0x1ee1fdb0f6363c8b,
                    0x13d48d6906a5bb20,
                    0x4998baeae31fcee1,
                    0x26a5bcc0ac2eeae8,
                ])),
                Felt::new(BigInteger256([
                    0x3111646a141722f6,
                    0xb75e7c6b958ba342,
                    0x1afec0e7dd7114cf,
                    0x1827913e7dd72006,
                ])),
                Felt::new(BigInteger256([
                    0x59ad9df2a9f37d96,
                    0xff619b14f7ff4bec,
                    0x5a8ec5b0e0947220,
                    0x2e533a054446990b,
                ])),
                Felt::new(BigInteger256([
                    0x44f5497a9af21113,
                    0xfdee4b19a926605a,
                    0x4ccea02a35144580,
                    0x1c6a8dcfc1a132a2,
                ])),
                Felt::new(BigInteger256([
                    0xab5fa51e65938b9c,
                    0x583f744cb1f2320d,
                    0x290d1ba66cc58778,
                    0x23cdc432e5933b39,
                ])),
                Felt::new(BigInteger256([
                    0x2fde68b8dcbc8e54,
                    0x6d622c3ff9c1e57d,
                    0x5f883259611e25e9,
                    0x238e14c9044a6e6a,
                ])),
                Felt::new(BigInteger256([
                    0x5c6b5d5ce34164ac,
                    0xd16600edf1465842,
                    0xa69a82690d414467,
                    0x297ef0b49316e1ac,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe92bed3c1ebae70f,
                    0x66113ee5c19ee045,
                    0xb55c71a3cfae63c1,
                    0x2e618d34dba2f5b3,
                ])),
                Felt::new(BigInteger256([
                    0x75806b5edcc00543,
                    0x5a38b41b3c6ff8cd,
                    0x94ddad22d1dae057,
                    0x0e7720612e29e88e,
                ])),
                Felt::new(BigInteger256([
                    0x444daf8595c67722,
                    0x8b56827f6c7166f2,
                    0x4b2c187ab68699e7,
                    0x2db8c6b11f286eff,
                ])),
                Felt::new(BigInteger256([
                    0xecf66f9839b19b74,
                    0x6712bb239842c6bd,
                    0x5c1a678f739e72f9,
                    0x1af64c3298a07377,
                ])),
                Felt::new(BigInteger256([
                    0xcf4a6fdbf7c7f7d6,
                    0xb2be3713ef21f500,
                    0x2e6ec6395ef57423,
                    0x0ae5488cca6bed6b,
                ])),
                Felt::new(BigInteger256([
                    0xe573b5cf55f0ebb9,
                    0x26a583efe1a043d1,
                    0xd72523b341e87b02,
                    0x00b82c1ae501bd64,
                ])),
                Felt::new(BigInteger256([
                    0x24e7be421ef8b73a,
                    0x761150cab8db539c,
                    0x2cf9f705b8dd45ed,
                    0x160235bb5fd379a7,
                ])),
                Felt::new(BigInteger256([
                    0x884227ec96bc0bc5,
                    0x1ab4df32c5ab5a7d,
                    0x2efded59001ae0da,
                    0x2b8dd3cad3a8a403,
                ])),
                Felt::new(BigInteger256([
                    0x50d5ac3f9ee943cb,
                    0x1943b89240aa0ed9,
                    0x910f1452c28e7885,
                    0x3732939052be2adf,
                ])),
                Felt::new(BigInteger256([
                    0x8e941e0265cdd622,
                    0xdffe3b617b0d6a3a,
                    0xa156c53949ff536a,
                    0x1b45b72fbac65508,
                ])),
                Felt::new(BigInteger256([
                    0x2a3b7ce2766f426d,
                    0xd076a8241d527705,
                    0x4798aff0489471bb,
                    0x22cb68fcba13b2f0,
                ])),
                Felt::new(BigInteger256([
                    0x576246d04f31a53a,
                    0x27ecedcf2f66db39,
                    0xc2d65ac560594133,
                    0x3e1ae74ee1470fc0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4a78ae03e7d9016e,
                    0x671f277c03e2ccda,
                    0x16abc6b93749d424,
                    0x3ce098539fc8629d,
                ])),
                Felt::new(BigInteger256([
                    0x83ea201870bae09a,
                    0xbd64e395d83dc2c8,
                    0x52f5f5c4d47ce6f6,
                    0x3e4df49ee5697e9b,
                ])),
                Felt::new(BigInteger256([
                    0x726a870f5713789e,
                    0xf95d48ef06b8b3af,
                    0xaa65b184e5f5561f,
                    0x0431361fa86981cd,
                ])),
                Felt::new(BigInteger256([
                    0x2d0cec8f3b254305,
                    0x609353f018e3f1d8,
                    0xf0e99711cb6dbfa5,
                    0x137d958c73eda561,
                ])),
                Felt::new(BigInteger256([
                    0x9447fae96a10ddea,
                    0x373ba545d734109e,
                    0x04a56516dbb084c5,
                    0x0697cb437382237b,
                ])),
                Felt::new(BigInteger256([
                    0x05f4323c496c016d,
                    0x72cc17b49b1b3724,
                    0xbac98c27da05180b,
                    0x38a81e87e5f88452,
                ])),
                Felt::new(BigInteger256([
                    0x9239035a491d6df5,
                    0xe777c21ba39af902,
                    0xacf69efaa5882357,
                    0x26e179540cc183a0,
                ])),
                Felt::new(BigInteger256([
                    0xd600678600b614e6,
                    0x7170ab0e5d0d17ff,
                    0x9ae51e16d62d6990,
                    0x063e7eeee97623ab,
                ])),
                Felt::new(BigInteger256([
                    0xc47ed286a2425bfa,
                    0x33ff55e4584906d3,
                    0xa818660efa171bde,
                    0x0855ea8e90c38c49,
                ])),
                Felt::new(BigInteger256([
                    0xb69055c8992d5741,
                    0x5be50d858bea6aae,
                    0x3630df7e7f049c56,
                    0x2695f7e2c1ef9afd,
                ])),
                Felt::new(BigInteger256([
                    0x0ab411228c304a70,
                    0x8883062e645cac32,
                    0x48522423967a203b,
                    0x273b1be190b66837,
                ])),
                Felt::new(BigInteger256([
                    0x0ff1b83ba595948d,
                    0xd94bdbe3389c469b,
                    0x765394ff96d5da36,
                    0x2856b02a0ad6f95b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x349cbed58dae2d5a,
                    0xd61fd02b590a00a5,
                    0xf22da2c8587b8eef,
                    0x36d683897403fd07,
                ])),
                Felt::new(BigInteger256([
                    0x0e77cd0f00691136,
                    0x97247ac4f9f696a6,
                    0xe42cf5d24d3399a5,
                    0x20609984cff0e1e0,
                ])),
                Felt::new(BigInteger256([
                    0x96b334a3e95a71e6,
                    0x0a3e8b5cd1a226a1,
                    0x06dbbe55ffb3c822,
                    0x37e6c78c95bbc33d,
                ])),
                Felt::new(BigInteger256([
                    0xc7f7bdff32903e70,
                    0x81a86447e3d971d4,
                    0x2b7788d78106fd23,
                    0x227a0589bd583482,
                ])),
                Felt::new(BigInteger256([
                    0xdcc97f855b3b9a9a,
                    0x05edb66bf565a355,
                    0x520a62224b2b049d,
                    0x1d07d8ae390c0c6e,
                ])),
                Felt::new(BigInteger256([
                    0x33cb274d0c0a36d8,
                    0x82a6dd153de219d7,
                    0xe9860283e7666cf5,
                    0x17a7427f7ac83e4b,
                ])),
                Felt::new(BigInteger256([
                    0x3ae09c69f10cb330,
                    0x5923c847db89ba46,
                    0x96fc76e73c602968,
                    0x0e293de695feaa9b,
                ])),
                Felt::new(BigInteger256([
                    0x6d7acc5be1bd8b5d,
                    0x64c31b1d4c3c6d17,
                    0x85b68aa3f665410e,
                    0x3fd79244676e2b45,
                ])),
                Felt::new(BigInteger256([
                    0xdeda6357f7da2b04,
                    0x93ee671c8beefa28,
                    0xffc11341eee30a4b,
                    0x1c21276abaf9a6a7,
                ])),
                Felt::new(BigInteger256([
                    0xfc1ba97f68f9658e,
                    0x782178c946e68cad,
                    0x957911ef78b06652,
                    0x0a8204a8d5834df6,
                ])),
                Felt::new(BigInteger256([
                    0x691f29af4a758459,
                    0x970d8c270e5f3838,
                    0xe2c57f3aea0bfba2,
                    0x1e7c6e400b1ba608,
                ])),
                Felt::new(BigInteger256([
                    0xf324c45d9772e33f,
                    0x169cd47f8fa1aa9e,
                    0xec29954e2be21eb2,
                    0x3e812e494a68c377,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xbb0de6dcffffffb1,
                    0x6c36ca39213f207b,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x082088e05f0f994f,
                    0x176dace9016728ed,
                    0x698edf73b7fe45c4,
                    0x072ddaae86e974f5,
                ])),
                Felt::new(BigInteger256([
                    0x5faad2a4442db96e,
                    0xaa122ee4f9de902c,
                    0x966d63967a5afa15,
                    0x28271e2c4b7a1de7,
                ])),
                Felt::new(BigInteger256([
                    0x45c92311a1d91b33,
                    0xc344cb8bbd12737a,
                    0xb00f6fb5ec1ee15f,
                    0x332bc9f4f70db291,
                ])),
                Felt::new(BigInteger256([
                    0x9ef07905c640b716,
                    0xb2a233e3a42211d3,
                    0xe3b0b6666518acc8,
                    0x1760c0c95d5cf417,
                ])),
                Felt::new(BigInteger256([
                    0x380533d4c328054f,
                    0x936902f5d9ef0288,
                    0x17dd3cf97854deea,
                    0x20b3dfb92d7c3141,
                ])),
                Felt::new(BigInteger256([
                    0x416efcb06e68083e,
                    0xe1f2f5064cc65765,
                    0x54232dbdfd33b6c7,
                    0x2d7c924f54c70a4d,
                ])),
                Felt::new(BigInteger256([
                    0x8470cc27e549f06e,
                    0x0a2f43525bf9516c,
                    0x9049eff069bfdfdf,
                    0x1f41578ca23f4e28,
                ])),
                Felt::new(BigInteger256([
                    0xdaabe5fbff484d46,
                    0x1193e4554adb4f0b,
                    0xe60400a9354379ae,
                    0x3f54e03020e38f7b,
                ])),
                Felt::new(BigInteger256([
                    0x9d5876296925ae35,
                    0x42b80cc8bf392528,
                    0x156b906826799268,
                    0x2fe8597a4c3c0004,
                ])),
                Felt::new(BigInteger256([
                    0x15c00eb1615555ba,
                    0x7e90b59363cd2270,
                    0xdcb274d283a9ebad,
                    0x06fe26e26fdb4649,
                ])),
                Felt::new(BigInteger256([
                    0xde7512dc263c03c5,
                    0x7daef3e83bac3fd5,
                    0x915765df779b313b,
                    0x2b828a0a7f99ca82,
                ])),
                Felt::new(BigInteger256([
                    0x09702793f8ff574a,
                    0xff88f58e8f670ff0,
                    0x67cc224d43d342fc,
                    0x212ac5bca5fc9a84,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x107ab4db01a6be2b,
                    0x523a019fc1b2d252,
                    0x116770f3ebeac969,
                    0x2daac11eba5b1307,
                ])),
                Felt::new(BigInteger256([
                    0xd6ee2f064982f8df,
                    0xd6f26c867b3dc780,
                    0x5b0d6ba04f0dcd63,
                    0x152dac7b1fdba7bb,
                ])),
                Felt::new(BigInteger256([
                    0x003c441d9621bd57,
                    0xfc72a8fc5e58a83c,
                    0x75acdf6c7df76f1d,
                    0x0887e4d8b5a0a727,
                ])),
                Felt::new(BigInteger256([
                    0x8255dcf6054e52e4,
                    0x8ba6736f0010fb94,
                    0xff59ac36dbf648de,
                    0x3291263f99b9360f,
                ])),
                Felt::new(BigInteger256([
                    0x3bad9306613230aa,
                    0xf4c2596b364d2f7e,
                    0x234e405af7be1cad,
                    0x25496f2582b0e9d6,
                ])),
                Felt::new(BigInteger256([
                    0x7d0b48585582e41c,
                    0x10b28d771aea232d,
                    0xfdfefac1ac3a1748,
                    0x01d47d1257805eee,
                ])),
                Felt::new(BigInteger256([
                    0x5e33dc3b73135b56,
                    0x04da16e4ae9db2c2,
                    0xef500c204ffb8578,
                    0x15250a9f8ce8753b,
                ])),
                Felt::new(BigInteger256([
                    0x34cf81d2e62fa532,
                    0x7b8747f6e3529362,
                    0xfe04d7f65d27a1d0,
                    0x210a48bb9ccba065,
                ])),
                Felt::new(BigInteger256([
                    0x0093a91ad6c6d858,
                    0xe716dfd96e939a84,
                    0xfef362c9ee9eaa85,
                    0x2f652f5ae6302945,
                ])),
                Felt::new(BigInteger256([
                    0x6f7fcfef0f5741f4,
                    0xfad69bd5fe4fa56a,
                    0x39ea0e0942f43497,
                    0x3013538eaf9931ab,
                ])),
                Felt::new(BigInteger256([
                    0x9747ac4ca91d43fe,
                    0x6b7fc23281938e2f,
                    0x2f7429109dcf6206,
                    0x2afbe388c1ed9f48,
                ])),
                Felt::new(BigInteger256([
                    0x56150af1a4baf09f,
                    0x4719f0e6dd09fbdf,
                    0xd5a2ffc94b08a5bf,
                    0x1d3437ce26244247,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x477f889ddf7493c5,
                    0x09b5424063126fc8,
                    0x268b71a3734e2681,
                    0x3fca1b84a7f3f418,
                ])),
                Felt::new(BigInteger256([
                    0x01b0bb02ed2ee246,
                    0x20856ad11a57cd38,
                    0xd1983fd35275b123,
                    0x2d1ed1b4203019e4,
                ])),
                Felt::new(BigInteger256([
                    0x0d9a20a38a105a43,
                    0x4f16c430633e1aee,
                    0x28c2f8bd47867424,
                    0x345fbb05607cd539,
                ])),
                Felt::new(BigInteger256([
                    0x2ba6e0865d639818,
                    0x090d7629c05a1be2,
                    0xb3c13e65a9c0c7d9,
                    0x36ee7ffb33eb881d,
                ])),
                Felt::new(BigInteger256([
                    0x2e32ebd408c68223,
                    0xbf66e7635fab8cf6,
                    0x53a0e361e26da922,
                    0x0f4731fd61760ff9,
                ])),
                Felt::new(BigInteger256([
                    0x043a8c39f64a2073,
                    0x2aab0fce74f6e726,
                    0x83e2412562a41791,
                    0x1d425fa75267435c,
                ])),
                Felt::new(BigInteger256([
                    0x58f8bdb6d16433e3,
                    0xc809e96778a7aa29,
                    0x83a293b0535eb894,
                    0x24c7828f9a485f86,
                ])),
                Felt::new(BigInteger256([
                    0x6c152dca83e97aa2,
                    0xfc05c5a162dee78e,
                    0xd530c32d90e96527,
                    0x1f9785880f4a762f,
                ])),
                Felt::new(BigInteger256([
                    0x17259cf12fdeae22,
                    0xb109652f4796b002,
                    0x7a01764c0ccba981,
                    0x3696650c79a6fbc8,
                ])),
                Felt::new(BigInteger256([
                    0xe778cff80c40ed37,
                    0x12cc4638a813aa38,
                    0x37b1d4f71f0af99a,
                    0x33b7ff8e4b9a74d9,
                ])),
                Felt::new(BigInteger256([
                    0x917e5547894854a9,
                    0x4f24372a016107b6,
                    0x0ef2cd64c7514e6f,
                    0x06a3b8f679e555fa,
                ])),
                Felt::new(BigInteger256([
                    0x8c0894e0c86625d6,
                    0xa3cf19ff72e7b144,
                    0xc575dfe64576cd51,
                    0x15b191a7254baffc,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4eb7a3137e221d07,
                    0xb8cf95246b58ab47,
                    0x8f30bbc6f9d50473,
                    0x2ca7a5d51bee0c92,
                ])),
                Felt::new(BigInteger256([
                    0x7fe8ef1764d13309,
                    0x1b752282def14cf8,
                    0x21f8718886b3614c,
                    0x128a19a0dfbddccf,
                ])),
                Felt::new(BigInteger256([
                    0xecc146c6d4ba4bd3,
                    0xf33ccfd653877b82,
                    0x9727a88748308a26,
                    0x2af221450a3de025,
                ])),
                Felt::new(BigInteger256([
                    0x2d366466809ed7c4,
                    0x1af44542a1318520,
                    0x90c754003774e44a,
                    0x3c3297f0226194a4,
                ])),
                Felt::new(BigInteger256([
                    0xc6f7edb363f3a621,
                    0x631fd6986371a610,
                    0x199adb259dac4f24,
                    0x170048702a8b0dee,
                ])),
                Felt::new(BigInteger256([
                    0x8caa19e4512d975a,
                    0x0c9fac6a5d537a42,
                    0x5ae7a9cfdd1adf1c,
                    0x19916581816dfa99,
                ])),
                Felt::new(BigInteger256([
                    0x2b2adf2c8698611d,
                    0x28cde171c89f0db3,
                    0x9e7fa115f9e7041e,
                    0x3a52f7cbe460c26c,
                ])),
                Felt::new(BigInteger256([
                    0x779ab7e4c80f50d0,
                    0x5d9e46f29ffb5ebb,
                    0x0f5eb7a504a3c8ae,
                    0x26a4265b95f11013,
                ])),
                Felt::new(BigInteger256([
                    0x1996bd71f0d8b6b3,
                    0x6009dabcf16e3881,
                    0x36aa7e3e26f1d7d5,
                    0x355f455eaabd5325,
                ])),
                Felt::new(BigInteger256([
                    0xcee4645bfadc9420,
                    0xe863d87243ffd15b,
                    0xeaa8aa205cb55738,
                    0x08c36d9907d49444,
                ])),
                Felt::new(BigInteger256([
                    0xf092661571a44c1b,
                    0xfa9bac6ae382a9ab,
                    0x954c64e14938573e,
                    0x0cb1f0870962fbbc,
                ])),
                Felt::new(BigInteger256([
                    0xf227003c54fe1258,
                    0xa0d35dfd62d7539a,
                    0x8b81c68dd59e9dde,
                    0x36d919bf00dccfa1,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x8060712b153fb60d,
                    0x23609d5bd6cd4e0a,
                    0xa46d6fb551eee42e,
                    0x0aa03503f382c780,
                ])),
                Felt::new(BigInteger256([
                    0x7d161ca3ffb3a998,
                    0xc2d2f50b35afc201,
                    0x10a465f91952002d,
                    0x1fe3430ef43163c7,
                ])),
                Felt::new(BigInteger256([
                    0x9f7fa6fc21b9a5c9,
                    0x5ef0a8a9b450a567,
                    0xf7844cb5bbe792bf,
                    0x344d5cf18e2287a0,
                ])),
                Felt::new(BigInteger256([
                    0x1107b5f75ef96198,
                    0x7c88d9fac2e23208,
                    0x1dcab17a9c8564ae,
                    0x083d298e86036424,
                ])),
                Felt::new(BigInteger256([
                    0x711a2de644345334,
                    0xc2c3c535422d24f9,
                    0x48c01e80efe3e197,
                    0x3901152ad01b3362,
                ])),
                Felt::new(BigInteger256([
                    0xd089869083e309af,
                    0x35e7621d892b6844,
                    0x445e4c2545e2d46d,
                    0x0a3a1c89d05479c4,
                ])),
                Felt::new(BigInteger256([
                    0x111e130991de1ad7,
                    0x0d6c877e74e8928f,
                    0x6442560d7a98f280,
                    0x123d0976859e1657,
                ])),
                Felt::new(BigInteger256([
                    0xf0a83324e82e87e4,
                    0xaa62ea8209a834b3,
                    0x92bdd564d89aabdb,
                    0x2dd64efbe8bead83,
                ])),
                Felt::new(BigInteger256([
                    0x6be96c3f0bb0a780,
                    0xafb27485d3b1990c,
                    0x8c6439577b8e8f9c,
                    0x339703949a14f9dd,
                ])),
                Felt::new(BigInteger256([
                    0x16f23a5ed25253d5,
                    0x1965a450bbcf104e,
                    0xbebd49b0532d4018,
                    0x2e6197dcc719da82,
                ])),
                Felt::new(BigInteger256([
                    0x3dc7c894c0e323f9,
                    0xd169978d1fdaf8a5,
                    0x553c5cc8a93678cc,
                    0x2f9bcf3c44fd9163,
                ])),
                Felt::new(BigInteger256([
                    0x2961f76733c2e341,
                    0xd00ef15025a419c1,
                    0x48789fe7df73104d,
                    0x16a943ddc4da9957,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb1fba1f424cedc0a,
                    0x696d42e93893e327,
                    0xac23f0bd8d241a5a,
                    0x27e6543ef876ae97,
                ])),
                Felt::new(BigInteger256([
                    0x19eb5d197caacb1d,
                    0x570bac4332137101,
                    0xf248b47d948de60f,
                    0x3320361d9fe69a08,
                ])),
                Felt::new(BigInteger256([
                    0x8d217cbe24a3a57f,
                    0xe8bce5dfbfdfc0c3,
                    0xe27c687b8974eb81,
                    0x24898beb0d1252a6,
                ])),
                Felt::new(BigInteger256([
                    0x1bd46fdb62cf345f,
                    0xdba1d7da49c297e6,
                    0xa0d1c0c6648c3566,
                    0x131d60bfc8e7ecc6,
                ])),
                Felt::new(BigInteger256([
                    0xc24d16b4d01a4e69,
                    0xe71b3cca1c9adf72,
                    0xc9e51103757f5c75,
                    0x011312d6ac5fd493,
                ])),
                Felt::new(BigInteger256([
                    0x6e3ab8cc6094372d,
                    0x7a01f41d98aad1f0,
                    0x693d791e6e70f6bc,
                    0x29cbe08fbe8f3f0b,
                ])),
                Felt::new(BigInteger256([
                    0x0a5c69fcd9e49bc0,
                    0xee70fb867cbce5d8,
                    0xf7b384923d34fec6,
                    0x02eddb7fc76424f1,
                ])),
                Felt::new(BigInteger256([
                    0xd2def78b9db06eaa,
                    0x885b9da3d6ac6580,
                    0x03668a76c98033ac,
                    0x01f8d31436014d44,
                ])),
                Felt::new(BigInteger256([
                    0x589198ae75cb1b41,
                    0x8bab69fbc77dfefb,
                    0x33c45571412fe6b8,
                    0x0523bd357ed4a921,
                ])),
                Felt::new(BigInteger256([
                    0xa3242619891fe6fb,
                    0xcc179d5d72ed32ef,
                    0x2a5a6fb52335342e,
                    0x128980595d2d2b79,
                ])),
                Felt::new(BigInteger256([
                    0xf28de47ed8c0fa69,
                    0x9c40ce8de4a3e38e,
                    0x4f4c4e37deb819de,
                    0x282a6d7470cef48a,
                ])),
                Felt::new(BigInteger256([
                    0x60e0893a5f3b3efd,
                    0x5c2020cc2684ad34,
                    0x68af7f0a7bb8c4fb,
                    0x1be196067a65d4af,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
