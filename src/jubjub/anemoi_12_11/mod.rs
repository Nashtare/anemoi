use super::{mul_by_generator, sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 1 element (32-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= mul_by_generator(&y2);
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += mul_by_generator(&y2) + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies an Anemoi permutation to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Applies an Anemoi round to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x9fc3d41a3719068f,
                    0x14356eb0e2ab96a1,
                    0x9f43847ca017a076,
                    0x71df42235c962eb9,
                ])),
                Felt::new(BigInteger256([
                    0xf5074f9e15565b8d,
                    0xed43cad2b6ae1d89,
                    0x36bc85879fb037a0,
                    0x65f16e9eba97cd09,
                ])),
                Felt::new(BigInteger256([
                    0x80e2a6b9d33e5bb7,
                    0xb6061128f98fc890,
                    0x8713295154a0ae96,
                    0x20a27d1fd381cba1,
                ])),
                Felt::new(BigInteger256([
                    0x733681b114936a8c,
                    0x1025def6d755d2e4,
                    0x1ee1e8fc4006652e,
                    0x211b49282f8e9c89,
                ])),
                Felt::new(BigInteger256([
                    0x6b99fdd4d514a571,
                    0x57ae653196e9ebff,
                    0x4d51ff99ab5c09ba,
                    0x2d24ffc25542f3eb,
                ])),
                Felt::new(BigInteger256([
                    0x6d16f812f9816084,
                    0xcabb103331dc9615,
                    0xe6ab4eb53b3c01d0,
                    0x07f380fda18caa20,
                ])),
                Felt::new(BigInteger256([
                    0x73f7b6a89ca8d7dc,
                    0x4cc94e0cfd0482c6,
                    0x160b70ad9f292aa7,
                    0x4a366b8cd709d1c5,
                ])),
                Felt::new(BigInteger256([
                    0x4999b030c2af772d,
                    0x0a514f700396416f,
                    0x7b8e63dabab1b677,
                    0x71f6a6bbd753412b,
                ])),
                Felt::new(BigInteger256([
                    0x894f9376e1d29c83,
                    0x6a5784e6219f1bc4,
                    0x14c237673235aec9,
                    0x305d0f244357cfa4,
                ])),
                Felt::new(BigInteger256([
                    0x3a7f1c2607fb68e5,
                    0xea6ff77252d321a5,
                    0x310e5c716646151e,
                    0x46912f7a67663542,
                ])),
                Felt::new(BigInteger256([
                    0x6814cd17f4aa468f,
                    0x997c2509ce892e9b,
                    0x14f739d15025f001,
                    0x3b7b069fe4ed69fc,
                ])),
                Felt::new(BigInteger256([
                    0xfd62f4b6e6c581db,
                    0x8ec716a4697ad3bd,
                    0xa2a0fcad018af952,
                    0x0ec2e7ba7be8fb0c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xd96817007fa7e424,
                    0x27967047ae18d921,
                    0x62348459e5ba0ee0,
                    0x02b2ea516187b7bb,
                ])),
                Felt::new(BigInteger256([
                    0xb28f0290c6b0beca,
                    0x54ba5763ce75a2eb,
                    0x9b65d97fc03c37ed,
                    0x52f6fb22c562d611,
                ])),
                Felt::new(BigInteger256([
                    0x2b8ea0f4c1ac93fb,
                    0xa679cbb2293aeebe,
                    0x8f7848e46bd9f637,
                    0x39ba0a217353d9f2,
                ])),
                Felt::new(BigInteger256([
                    0x74fd451bd9cedf2a,
                    0x825ed0aae5aac02d,
                    0x781bd2e257240642,
                    0x735cc9b95d77f850,
                ])),
                Felt::new(BigInteger256([
                    0x8d1d16eea7d1cd8b,
                    0x286a299e7a1a5449,
                    0x288db168d66ebb95,
                    0x6889971cf356a4ac,
                ])),
                Felt::new(BigInteger256([
                    0x6a23dfe0df9ddf4b,
                    0x1469362ae785a7c0,
                    0x02c57a5057dc775d,
                    0x4db3550aaafcc387,
                ])),
                Felt::new(BigInteger256([
                    0xb9607a72435b54cc,
                    0xc77fd20af0bcb85a,
                    0xd47d948ca951ee0f,
                    0x35095ec3881a737c,
                ])),
                Felt::new(BigInteger256([
                    0x58bd6628234179b2,
                    0x614c7fddd6a9fa7c,
                    0x3c8b34a9a814660b,
                    0x460e819bd20b03db,
                ])),
                Felt::new(BigInteger256([
                    0xd66e116812911360,
                    0x9869bc62fa032c1e,
                    0x68f48894b91e44b6,
                    0x26751281e8f0e179,
                ])),
                Felt::new(BigInteger256([
                    0xa4063bde059f50ca,
                    0x28e5eb94024e40bd,
                    0x135c448287a8f3a7,
                    0x7365746de68821ce,
                ])),
                Felt::new(BigInteger256([
                    0xeb421d45280ed73d,
                    0xe55fb9508e548b05,
                    0x16f124b52b139b61,
                    0x618c5a898fd40068,
                ])),
                Felt::new(BigInteger256([
                    0x582cfd85b6650c1e,
                    0x38d09724937d5ae3,
                    0x6704787a41eba79d,
                    0x1a7ef832152699dd,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x483c8248e8b75360,
                    0x612181d883ca9190,
                    0xae62290866ffca8b,
                    0x3401ed44ea7c43b5,
                ])),
                Felt::new(BigInteger256([
                    0xedeb57651af0e319,
                    0x1044e6e218fbd12f,
                    0x5b91907614c8a58d,
                    0x4f7f93d7ac4fb59d,
                ])),
                Felt::new(BigInteger256([
                    0x0f43e845960b9f90,
                    0x67e56d2fdf005968,
                    0xdf618f8c3cc02580,
                    0x5abaa4f791c9355c,
                ])),
                Felt::new(BigInteger256([
                    0x8aed10b849431128,
                    0xb7b4fd28fa28474f,
                    0x8daf4b5ad7b968e8,
                    0x2820af589a3007e8,
                ])),
                Felt::new(BigInteger256([
                    0xe914b56534e5a2ec,
                    0x22e56a9cf4bb8cdc,
                    0x139fe02677505a18,
                    0x40bfe8c31a79435a,
                ])),
                Felt::new(BigInteger256([
                    0xd3a422a99d50f354,
                    0x997cb54e72cca892,
                    0x2df8b4a71500b0d9,
                    0x5aa7739cf22aa7a0,
                ])),
                Felt::new(BigInteger256([
                    0xeda9cdff80b8a835,
                    0xdf7a5522357c3be6,
                    0x1dff36892f53d92b,
                    0x18f52db46177a73c,
                ])),
                Felt::new(BigInteger256([
                    0xf99ddaaffc1bca63,
                    0xa1d3b40bda972303,
                    0x3810b0f0937d1361,
                    0x2894b99338aeec24,
                ])),
                Felt::new(BigInteger256([
                    0xa32f7eb26a897f75,
                    0x9f61db7ff880c687,
                    0x57a3cd870992364d,
                    0x0360905e8b976a81,
                ])),
                Felt::new(BigInteger256([
                    0xd423395955cb609d,
                    0xb39b793b978007d5,
                    0x96042a49991de5f1,
                    0x36dadf5d90638080,
                ])),
                Felt::new(BigInteger256([
                    0x91b380590e4b5bd0,
                    0x7f6e2955358d47ad,
                    0x7b354cfe1fd4979e,
                    0x2f0196ee6668fd5a,
                ])),
                Felt::new(BigInteger256([
                    0x927ad4e894992198,
                    0x83e39517c8102b83,
                    0xb9a1d7e18e20f414,
                    0x25b0ec2af5ae47d4,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3770dd6ab1ed6883,
                    0xa6baa5bac80c662b,
                    0x8352b396ea5de48a,
                    0x5a18b5c374f17427,
                ])),
                Felt::new(BigInteger256([
                    0xe8920bc4af77cca9,
                    0x1ed94a8f9ac91da3,
                    0x5f245a700ae9bc60,
                    0x350021d7f284b05f,
                ])),
                Felt::new(BigInteger256([
                    0x8722b932d21ce1f3,
                    0x4275ef4be53add9f,
                    0x80d6805ea04d91d3,
                    0x69037b20c6ab3f2e,
                ])),
                Felt::new(BigInteger256([
                    0xa845a0961f0a512a,
                    0x1d28b978d36deac1,
                    0x71feca88f90209c7,
                    0x44e81c0087a6b27f,
                ])),
                Felt::new(BigInteger256([
                    0xe4899481f0680231,
                    0x02c7335ae7d8dc88,
                    0xefca6c215d207748,
                    0x03ecc8d4f32e97df,
                ])),
                Felt::new(BigInteger256([
                    0xbe97089a5b4170b8,
                    0x475d1f4174715fcd,
                    0x4d10542e38157097,
                    0x67d9b20cc9e168ca,
                ])),
                Felt::new(BigInteger256([
                    0x99d0916935105fd2,
                    0x6c6ba01bdf45e7f4,
                    0x51bec4f27bb0dfde,
                    0x4f2610c8698a6da9,
                ])),
                Felt::new(BigInteger256([
                    0x44c5a0ac284f038d,
                    0x6efc97c96f55634b,
                    0xa6486970c908d5db,
                    0x0a22aebd6aa108d1,
                ])),
                Felt::new(BigInteger256([
                    0xa4a504b70d2fdcc1,
                    0x867e379296742520,
                    0x8f5d5a97d4e4b230,
                    0x2e0af17cc9816670,
                ])),
                Felt::new(BigInteger256([
                    0x62ea45c0d91aed97,
                    0x5c16c21fcde4c87e,
                    0xe894174118d104e3,
                    0x02e4f498ce3dd807,
                ])),
                Felt::new(BigInteger256([
                    0x96397dc131c86914,
                    0xc27bd23e3e1ba1f0,
                    0x5a6763ca306b70c1,
                    0x17f5bdb24c081711,
                ])),
                Felt::new(BigInteger256([
                    0xe5eda787e0e70230,
                    0x74acd1c2fedf5f44,
                    0x3e57b63d9a77a6c8,
                    0x2fe08ae0f74093f2,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xbeaad9639c170ec3,
                    0x58a8ec107c6c2872,
                    0x81c66d7d05125170,
                    0x1c98e2e2fd686a4f,
                ])),
                Felt::new(BigInteger256([
                    0x405f437cde62ff64,
                    0x2a0197d36fe03878,
                    0xefb9d9a97c38aaff,
                    0x10b26eb614fdb8ef,
                ])),
                Felt::new(BigInteger256([
                    0x8bcf3e8bb3a43a07,
                    0x337f6287784748eb,
                    0x3fe3708a52fcc902,
                    0x15d6c6854dfa5185,
                ])),
                Felt::new(BigInteger256([
                    0x2b8c77005c55d916,
                    0x49b6180f6741eb54,
                    0x8c29ad64651654d2,
                    0x35aaeb6fad61f18a,
                ])),
                Felt::new(BigInteger256([
                    0xb83bdf94c479f157,
                    0x0e9f297addeee96c,
                    0x4b5f3186822d049b,
                    0x1f471650f2219a1c,
                ])),
                Felt::new(BigInteger256([
                    0x5b87feebc0520a7e,
                    0xe1b9540285a542ca,
                    0x082682a1e77b74e7,
                    0x490365d7862f9454,
                ])),
                Felt::new(BigInteger256([
                    0x494fa276a6b6cf03,
                    0x1d44cd2e9d2d3e67,
                    0x2b991e4d77b633fb,
                    0x5597ad6c01d6a864,
                ])),
                Felt::new(BigInteger256([
                    0x1109ba5f80f53505,
                    0x2e1c4033336030f1,
                    0x617acd9d78dbde72,
                    0x3b90bb1a7ffeb226,
                ])),
                Felt::new(BigInteger256([
                    0x6b141f14e80d4dc9,
                    0xacd5c7831445dc1d,
                    0x5449943d65ff31c8,
                    0x2af25958a61672db,
                ])),
                Felt::new(BigInteger256([
                    0x06e8880225016033,
                    0x603b21ea1474eda7,
                    0xf446770c776aed46,
                    0x18c9617d267ee399,
                ])),
                Felt::new(BigInteger256([
                    0x7befa3337a7f388e,
                    0x4753c5b305e96694,
                    0xa141ac123946b9c8,
                    0x40a58acc2a75eb0d,
                ])),
                Felt::new(BigInteger256([
                    0x69bfbfd46a3c3344,
                    0x1677bdb334e55387,
                    0xc28d9963f7cc88ad,
                    0x0c01ec51a7f21446,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x10c6084f3db6cb2b,
                    0x2bcfcfb25661f684,
                    0x7331b9e8a0426892,
                    0x24a010e3032cf7ab,
                ])),
                Felt::new(BigInteger256([
                    0x743c154aabacad65,
                    0x4143501bdeb357e3,
                    0x332a4a6841a2309b,
                    0x2456da1333daf78c,
                ])),
                Felt::new(BigInteger256([
                    0x2c4bbe00a6565275,
                    0x2eedb399a910f52b,
                    0x75bc88fa20f0c15f,
                    0x4e884cce10e72bea,
                ])),
                Felt::new(BigInteger256([
                    0x360b38fa349a32b8,
                    0x4db66fa924cb49f2,
                    0x589e22226614f2af,
                    0x1d402221732737af,
                ])),
                Felt::new(BigInteger256([
                    0x43bb660001388a0c,
                    0xb14321481519b0ec,
                    0xa00b42dbfa05d717,
                    0x1f1f79a4f5ef5c66,
                ])),
                Felt::new(BigInteger256([
                    0xbff93e37ebb034fc,
                    0x0561c1376d44a236,
                    0x90657c13bf0bba18,
                    0x15e6257f392ae636,
                ])),
                Felt::new(BigInteger256([
                    0xd5b720c442a68dd9,
                    0xd57a72c7be0142d3,
                    0xb43690ab1d93a5d5,
                    0x379a806b5f11769d,
                ])),
                Felt::new(BigInteger256([
                    0xe862e381bc44cbe9,
                    0xe3a90d3c22797d5e,
                    0x017a8ed0ffe14a84,
                    0x3272ffd77660ce46,
                ])),
                Felt::new(BigInteger256([
                    0x346f79796918359a,
                    0x4b1ce014a8b8470a,
                    0x6fcce7a5837b2c0c,
                    0x3c5cf66e4c738049,
                ])),
                Felt::new(BigInteger256([
                    0x0bb042d2a39f9c12,
                    0x8a5ffd8843853e81,
                    0xd277545bcb9fa525,
                    0x5454bca965076cc6,
                ])),
                Felt::new(BigInteger256([
                    0x58ab5d0a26056605,
                    0xa6103e17e714c70d,
                    0xe911a2d0909c36e2,
                    0x67d3b17e02165cca,
                ])),
                Felt::new(BigInteger256([
                    0xdd880e29abf1f97b,
                    0x3504717c9a5e2a87,
                    0x75bf9251f96f3583,
                    0x0c45db1e99989c1a,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x90dcb329626999ef,
                    0x15551138f604969d,
                    0x89a145f1c175be5d,
                    0x32059740ac73f025,
                ])),
                Felt::new(BigInteger256([
                    0xa867463241773828,
                    0x0e71a2629d3d10f1,
                    0x564b652535b1c2aa,
                    0x1bc5a1d0e43e59f2,
                ])),
                Felt::new(BigInteger256([
                    0x7ec235fd2b271ad4,
                    0xabdc62aa6a71d167,
                    0x7afd55d1305ddf41,
                    0x51d6c55d36e1de38,
                ])),
                Felt::new(BigInteger256([
                    0x4076103f71477e2d,
                    0x506b491edccb343b,
                    0xb1cc0b0c5de11dfd,
                    0x613359df19f92414,
                ])),
                Felt::new(BigInteger256([
                    0x332603a053cc13a0,
                    0x9a94bfe57a921adc,
                    0x8e2cef51780014a5,
                    0x656788e7942f9887,
                ])),
                Felt::new(BigInteger256([
                    0x93c201f7a4cc5986,
                    0x1df5c87a2dd81986,
                    0x566d0953170b9566,
                    0x658fdef476c7f91d,
                ])),
                Felt::new(BigInteger256([
                    0xcf8d3cd7664f648d,
                    0x83676a31742a4597,
                    0x4a8571fcf013b011,
                    0x1c19b8ad64c48ea5,
                ])),
                Felt::new(BigInteger256([
                    0x377d9c263a6afb1c,
                    0x460542d2e421074b,
                    0x79d4c3292c342a91,
                    0x6305badcbf01a1b6,
                ])),
                Felt::new(BigInteger256([
                    0x337ccb515e17d626,
                    0x32b443358a2f1348,
                    0x21e0ddb727c0420c,
                    0x309cf94cdd805712,
                ])),
                Felt::new(BigInteger256([
                    0xc2206222dee072da,
                    0xf6f75556fd7978eb,
                    0x8d3619b6b7b3d204,
                    0x058fa9952934dff5,
                ])),
                Felt::new(BigInteger256([
                    0xb6695b11a6617441,
                    0x253415a2d97fca2e,
                    0x3c94d078e8fbfbdb,
                    0x6911e7ef16cf106b,
                ])),
                Felt::new(BigInteger256([
                    0x4528cefdb329492a,
                    0xc5c225063f26f571,
                    0x1e2bc26b62668ff0,
                    0x6a4b9169a7685918,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xef124bf16262f4bd,
                    0xf85260086d86ee25,
                    0x4ef295e2d898d6bc,
                    0x01ca9471ab6cf884,
                ])),
                Felt::new(BigInteger256([
                    0xfa0ebab2e6df0593,
                    0x8f842119d84ed23b,
                    0x57ec8f9b3b839b66,
                    0x398395a199691f5c,
                ])),
                Felt::new(BigInteger256([
                    0x8eed55c00ec731d7,
                    0xd423c57b4b17bf2f,
                    0x5c0f1212cac54ef9,
                    0x55e558f3a3c2da92,
                ])),
                Felt::new(BigInteger256([
                    0x965e1abb4d65b2c5,
                    0x0d1df1f0416d12b8,
                    0xceb4a67a719d6f50,
                    0x606446652103b9de,
                ])),
                Felt::new(BigInteger256([
                    0xced0c9e90d714e08,
                    0xc084b2a0e86558d4,
                    0x29fe375aa71e4c3e,
                    0x454c588bde22142f,
                ])),
                Felt::new(BigInteger256([
                    0x1b1d60e5eb8df91b,
                    0xfc225cb991cb2ec2,
                    0x13e10d39988fe784,
                    0x62e9bb2ce2422e28,
                ])),
                Felt::new(BigInteger256([
                    0x739bc7c750149e4f,
                    0xaebac406bc7ccbb3,
                    0xa6dc0107ac8a1628,
                    0x0c12fa0663d1e4ee,
                ])),
                Felt::new(BigInteger256([
                    0x0778057a1ed79e67,
                    0x4886ab6783ee71c7,
                    0x95dcf88ae9fc6a62,
                    0x159c8eb682afe34d,
                ])),
                Felt::new(BigInteger256([
                    0x4e2f411324c4371b,
                    0xddaacfe656e47851,
                    0x51f77393a406693a,
                    0x5e55380ba059a85c,
                ])),
                Felt::new(BigInteger256([
                    0x6c40f47cf94b62d7,
                    0xbab0aa0a8af15cb0,
                    0x312528438784ec7e,
                    0x6364bc70a213882d,
                ])),
                Felt::new(BigInteger256([
                    0x46084bf8a79fff09,
                    0x5ddad8f1ed659437,
                    0xcf8b6b3317f0aaed,
                    0x5193f31cd433da75,
                ])),
                Felt::new(BigInteger256([
                    0x794702d45972d808,
                    0xfd3501ffbc900cf5,
                    0xbabc937eba1c6e7a,
                    0x48bbb5225d38a5bc,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0af190d9699a780a,
                    0xa5db0ced5b8af7c0,
                    0x61e64472ecc782c2,
                    0x307ef21fedf15c98,
                ])),
                Felt::new(BigInteger256([
                    0xd9abb69d5d6784a0,
                    0x39bee1eee75ffc83,
                    0xa56f60a76053239b,
                    0x56f924276e0d0c46,
                ])),
                Felt::new(BigInteger256([
                    0xae1f8c5e3e62f1fc,
                    0x2f527c8a4c6d74cd,
                    0x034224bfc23a9c2f,
                    0x7031182c50416fc2,
                ])),
                Felt::new(BigInteger256([
                    0xf0155636ba8dc2d9,
                    0x5d731ebb2680650f,
                    0xbeb9fb705343c1d1,
                    0x281ad138a982bf1e,
                ])),
                Felt::new(BigInteger256([
                    0xd6129f2d3c25dcc7,
                    0x0c600d3621f56e54,
                    0x0a2e063c76724c83,
                    0x55a704ed18df4e76,
                ])),
                Felt::new(BigInteger256([
                    0x7cc9d0c76c6fa5d0,
                    0x127f35d2d56fb76b,
                    0xe89eb373de7f80d1,
                    0x588bc2edf15ac69f,
                ])),
                Felt::new(BigInteger256([
                    0x340905bbe84be6d7,
                    0x17c9e23743088602,
                    0x9b9e6ea31d11cfc3,
                    0x264b360423ad35cc,
                ])),
                Felt::new(BigInteger256([
                    0xdbcfc67075ecef57,
                    0x3bf4e55e22c702c8,
                    0x19ae8f78bb97ee28,
                    0x3795e0b96c364035,
                ])),
                Felt::new(BigInteger256([
                    0x303727dd131801cc,
                    0x506274ba1c048633,
                    0x941eaf0bc9106b1c,
                    0x6dcf620e1f4b6ed1,
                ])),
                Felt::new(BigInteger256([
                    0x6bd12f8c095a3fc8,
                    0x23058dfc18ef9023,
                    0x476b128d302e31c7,
                    0x463fb694dcaef126,
                ])),
                Felt::new(BigInteger256([
                    0xa2e6fc8435cda8ee,
                    0xe737c48b6acfc98c,
                    0x5772fe467e37e989,
                    0x3f1ee3f857d3e91d,
                ])),
                Felt::new(BigInteger256([
                    0x03a8615e9f7839cd,
                    0xfb8af6d46a24a35d,
                    0x58b932dfb4c1ad01,
                    0x1f024d7ccb873a26,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x40ecc675b9c4c64f,
                    0xab21f3f39afbb0e2,
                    0x10004a5e9dcff383,
                    0x2a346eba5f46ef21,
                ])),
                Felt::new(BigInteger256([
                    0xea3ec67b15a107e6,
                    0x60ec7d547f4939a9,
                    0xec2b3b1f52712d34,
                    0x01931cdbe6799bbe,
                ])),
                Felt::new(BigInteger256([
                    0x0d773f7200c433df,
                    0xdbdf3cd5dd1f8d90,
                    0xfd1b58cf475f51fe,
                    0x1b10e8823f8c9157,
                ])),
                Felt::new(BigInteger256([
                    0x133064bcc9b337a8,
                    0x866e13374333a253,
                    0x3a93a66213ebec08,
                    0x42456bdfcd994e39,
                ])),
                Felt::new(BigInteger256([
                    0x0c9ed7e1d0b92f12,
                    0x0cf2d34a3753242f,
                    0xf03ce69f8402630f,
                    0x61c8e453fb8bb928,
                ])),
                Felt::new(BigInteger256([
                    0x1ea328adfa065127,
                    0xe4d94035eb91366c,
                    0x7fa4c05307b1d0ed,
                    0x515fb070d329ac7d,
                ])),
                Felt::new(BigInteger256([
                    0x76a2292321bb21a0,
                    0x95106efa4beb6ea7,
                    0xd20929f96cf980e5,
                    0x00e449ef8916939b,
                ])),
                Felt::new(BigInteger256([
                    0xc5d2c20bf1ba3d67,
                    0x394889a815acc1ca,
                    0xff6d5b46f6e17d55,
                    0x33ea80c94a079184,
                ])),
                Felt::new(BigInteger256([
                    0x3e95fa1c1717eb31,
                    0x521393ae1855014e,
                    0x32075e84ed8632e6,
                    0x0405df4fbeebec9d,
                ])),
                Felt::new(BigInteger256([
                    0xf6b36f651a090a60,
                    0xcb74b7972480264a,
                    0x1caf0a0c6b1348d5,
                    0x0c150363d622e858,
                ])),
                Felt::new(BigInteger256([
                    0xc12da22b4798bf08,
                    0xe172ce9eb8aa227b,
                    0x02bdc078838e790c,
                    0x367bd2ba1d7eb02b,
                ])),
                Felt::new(BigInteger256([
                    0x2da96d185e2aa789,
                    0x2f4debb8d57e2c68,
                    0x421abc2e2da3766e,
                    0x3739ec33c1d2d52d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf3c032a7f2f89c3f,
                    0xf7d2a3bcb7e36937,
                    0x0d031801781f9d18,
                    0x2d4616c0d4200317,
                ])),
                Felt::new(BigInteger256([
                    0xd7fef7df862385d1,
                    0xc2d548ae3ddeab11,
                    0xa3cfdeaf3467822c,
                    0x3077d1d35ae13070,
                ])),
                Felt::new(BigInteger256([
                    0x1373806bd51bf6f9,
                    0xa54645835362e7bf,
                    0xba8a06e8014d8989,
                    0x25152e5149527b29,
                ])),
                Felt::new(BigInteger256([
                    0xd691abf3c9f2e1f1,
                    0x1bf5474ce480b273,
                    0x8e7f49fa66591f0e,
                    0x2d461fd622440f54,
                ])),
                Felt::new(BigInteger256([
                    0xf12632cda217da92,
                    0x3fe4bc31cac46ff0,
                    0xdfad9ca9fba3016d,
                    0x18cb2bc505888bbb,
                ])),
                Felt::new(BigInteger256([
                    0x68df09b9d98acfc7,
                    0x320c54bdfbece522,
                    0x01f2988fc7f5fd27,
                    0x5bd9a7e58658ffea,
                ])),
                Felt::new(BigInteger256([
                    0xf0884540edfa763c,
                    0x94ae3eea85a5b036,
                    0x1a9107d20cebf1cd,
                    0x0a68763eb2e31256,
                ])),
                Felt::new(BigInteger256([
                    0xa808277b51ab40d5,
                    0xeb47a833dfee7698,
                    0x6e2c0890437329b1,
                    0x133fb8c2d3e8ad05,
                ])),
                Felt::new(BigInteger256([
                    0xdc2ef93363b52ee5,
                    0xda7623d16f2117d4,
                    0x0f78059b0da9b11f,
                    0x63ffe2c43496ecda,
                ])),
                Felt::new(BigInteger256([
                    0xc00d503bd5e7f6d7,
                    0x2c570fb0b143a589,
                    0xfe776e6f0b50073d,
                    0x0066d634038625b5,
                ])),
                Felt::new(BigInteger256([
                    0x0793ad0a378caacc,
                    0xcb56fc5fcaa6c41a,
                    0xcaac0924c9ce2671,
                    0x159f4b2b0c78146c,
                ])),
                Felt::new(BigInteger256([
                    0x3529ddb27c9ec189,
                    0x940b3d06127e3898,
                    0x8d7f94c5806652b2,
                    0x73b9e588ad62f090,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xaa8909acb9ab3376,
                    0x48c4c9d5e39d4799,
                    0x0fbab0ef5957e93c,
                    0x6d6c874ba03d12f4,
                ])),
                Felt::new(BigInteger256([
                    0x5fec343d9f625b71,
                    0xeb99afb221887ccd,
                    0x3867feb6d69d9d55,
                    0x3d332027018741ff,
                ])),
                Felt::new(BigInteger256([
                    0x29461da74c91c6de,
                    0x44551044fd3c88a6,
                    0x3ade30c15ad650e3,
                    0x17f754edddc5c535,
                ])),
                Felt::new(BigInteger256([
                    0xd8ba393fc6db19f1,
                    0xb4719de1520fca8d,
                    0x10d8cb463d586df8,
                    0x55a2bf585293e1df,
                ])),
                Felt::new(BigInteger256([
                    0x85d2d08457168a90,
                    0xd0b8900f01866c23,
                    0xb29fdc05dbafd3e7,
                    0x64f4823f419ca736,
                ])),
                Felt::new(BigInteger256([
                    0x07d463a458b4209d,
                    0x02e3075d95b68344,
                    0x982bfa98e054578b,
                    0x3ba50d24a423f3d7,
                ])),
                Felt::new(BigInteger256([
                    0xbef9370f816b4490,
                    0x7cb327aa9005e169,
                    0xb4d8e2f9a62159cc,
                    0x04895ae6d3b4a2f3,
                ])),
                Felt::new(BigInteger256([
                    0xd3d28fb6e234aad8,
                    0xc9f0fdb720d43c15,
                    0xda359f0bdd2279ba,
                    0x66e426aeef2c84bc,
                ])),
                Felt::new(BigInteger256([
                    0xc6a23cf5767174b2,
                    0x1162e314123d5f1f,
                    0x08b236cdb910651f,
                    0x26ece1dfcb9f09c5,
                ])),
                Felt::new(BigInteger256([
                    0x085e7c0be218f22e,
                    0x227866867af3554f,
                    0x19e4c0872cb40431,
                    0x19907fee5d54c22b,
                ])),
                Felt::new(BigInteger256([
                    0xdaceef0282f49255,
                    0xaf3c6b4a6b257f66,
                    0x776da53d869011a8,
                    0x56510f55e45ff6af,
                ])),
                Felt::new(BigInteger256([
                    0x3b6430160395fd32,
                    0xa95e265df2667239,
                    0x8486217407a9c7b2,
                    0x0b2cd6e37ec24ccd,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x549aec871525ab9f,
                    0x9542cb8824cff5fb,
                    0x772a50526058e07b,
                    0x1ee3b0f7b0bf0831,
                ])),
                Felt::new(BigInteger256([
                    0x55deb7358fb7e9f5,
                    0x8845d03cd4fdf7a3,
                    0x256e61f8274989be,
                    0x5d693562f1e4fc6d,
                ])),
                Felt::new(BigInteger256([
                    0xa8e93fe35a4d7153,
                    0x7a8af9eb65a03ddf,
                    0x71805e29bb716243,
                    0x46241a497506248b,
                ])),
                Felt::new(BigInteger256([
                    0x356135018a0787fa,
                    0xaf4a31b336bf9728,
                    0x26c47ad8949e8295,
                    0x5ab6d40d372f2bd4,
                ])),
                Felt::new(BigInteger256([
                    0xc76c6fb90ba0f20a,
                    0xe9e9a4723765fa65,
                    0x3967171230d483fa,
                    0x1c49951adeadc300,
                ])),
                Felt::new(BigInteger256([
                    0xaff2dcbe3257a4fc,
                    0x27979dc00ea588e8,
                    0x762c10b006176c48,
                    0x38f4c3361579735a,
                ])),
                Felt::new(BigInteger256([
                    0x8f21463ef4dd1fef,
                    0xad75b8b00775e127,
                    0x6b551cef047a0f99,
                    0x50c1ffa7f38cd0b2,
                ])),
                Felt::new(BigInteger256([
                    0xdf4aabb1b9f77d4b,
                    0x3e0d3dc1ac250cd7,
                    0x74a30902b1781663,
                    0x20ee9789d79d1f2a,
                ])),
                Felt::new(BigInteger256([
                    0xcb459aab4316ac6d,
                    0x643c6d49f85dd3df,
                    0xd97239f28bc6d2c0,
                    0x1537855dfbec21bb,
                ])),
                Felt::new(BigInteger256([
                    0xc031f9074edfbaca,
                    0x6f7463f698f2299d,
                    0xe4fe65985f9ec8a5,
                    0x5bae009ead3bc634,
                ])),
                Felt::new(BigInteger256([
                    0xd99a766ea2514716,
                    0x7b94c06e4a4f296f,
                    0xd3c8f4bdbfdb9350,
                    0x2618c411d198848e,
                ])),
                Felt::new(BigInteger256([
                    0x2c40ed4da1f484e3,
                    0x4e9a17557f4a9b73,
                    0xc3436fbe83f46481,
                    0x0d8087992ef8366c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0660198a6efe62d6,
                    0x5545bec6306ad77c,
                    0x2a96136af4a3790b,
                    0x35a4dab3dca8c436,
                ])),
                Felt::new(BigInteger256([
                    0x7f3b8854182482b0,
                    0x4d477c469f27ba1a,
                    0x7d275c9d9b68326c,
                    0x6d4feb54a33e959b,
                ])),
                Felt::new(BigInteger256([
                    0x25bcbde38884e010,
                    0xb42bcfe5875633aa,
                    0xe69f2638b9b33e9e,
                    0x0695aa2860ae0f3d,
                ])),
                Felt::new(BigInteger256([
                    0xcfdf3377195f8c9d,
                    0x688c402752241c19,
                    0x5949b348f7bfe9c9,
                    0x27d15fed66c7ff18,
                ])),
                Felt::new(BigInteger256([
                    0x7e12841caef7db39,
                    0x65a43ad72fd9765c,
                    0x6d58be243d19d594,
                    0x3b66f703f94f6aac,
                ])),
                Felt::new(BigInteger256([
                    0x8167deb4c5b4b094,
                    0xb367238493ab21a1,
                    0x9d319d16f53daa0e,
                    0x435a2f95f34ffe50,
                ])),
                Felt::new(BigInteger256([
                    0x3443ef178323659e,
                    0xb524aaaa6eeeae48,
                    0x443dc5044e17cbe3,
                    0x5d7b86f74fdf15a3,
                ])),
                Felt::new(BigInteger256([
                    0x70ae3fbc3f92e9b5,
                    0x09c2a4d60e524f8f,
                    0xc69afa4a23aee02c,
                    0x0276e2a4ddc1769a,
                ])),
                Felt::new(BigInteger256([
                    0xe0ed65e0b3c0b5ff,
                    0xf9f03a38087de7ef,
                    0xbecce16d618331f0,
                    0x4dba9cecf02c2e32,
                ])),
                Felt::new(BigInteger256([
                    0xb5637e3b96a3aa50,
                    0xb4f83d97119171e3,
                    0x969287e54ff8e804,
                    0x4ec460959b40a069,
                ])),
                Felt::new(BigInteger256([
                    0x376a68cd4d80c1c0,
                    0x920dc8a5c16ad0d4,
                    0x6d4faecdf99f14a9,
                    0x705adb7d311f0115,
                ])),
                Felt::new(BigInteger256([
                    0x91913ecff3bd4f9f,
                    0x7e3b9a838e3f0744,
                    0x962770024ec8aeb3,
                    0x4312e4157d1454a9,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa7b7f12b30c2c3ba,
                    0x9d9d94fe75de0158,
                    0xcdb07a7b948c6dbd,
                    0x401832b8912431dd,
                ])),
                Felt::new(BigInteger256([
                    0x9102ebf3d1ef3173,
                    0x475032a16630fb32,
                    0xbda05c5448dae8bc,
                    0x1d9d4ba04a030447,
                ])),
                Felt::new(BigInteger256([
                    0x27a87e83f24723df,
                    0x0e169420896c0550,
                    0xf6c3296be08f38ca,
                    0x33e94e8f46327dd2,
                ])),
                Felt::new(BigInteger256([
                    0x184c4c426b741930,
                    0x85d655f8cb659785,
                    0xdcfcb9b419ca5659,
                    0x2211a7f979bbcdd3,
                ])),
                Felt::new(BigInteger256([
                    0xe72b89bca5ab870a,
                    0x69bdc40ae9961872,
                    0xe5a1407184d88539,
                    0x214f625d8c6bb5de,
                ])),
                Felt::new(BigInteger256([
                    0x9a66b6447803f690,
                    0x6bea26dfa62a12a4,
                    0x7ae6b5dcd0764e61,
                    0x2a2bb067c7d81577,
                ])),
                Felt::new(BigInteger256([
                    0x13dff481fc970330,
                    0x309c50c60a3912e5,
                    0x59b6ef7be98022a7,
                    0x6455c1323d639769,
                ])),
                Felt::new(BigInteger256([
                    0x7d99126cedddc146,
                    0x69016566a9cc46dd,
                    0x473a6a59ad4da6a0,
                    0x5098e5ff7840cfe7,
                ])),
                Felt::new(BigInteger256([
                    0x84aee53a7a6e53c1,
                    0xa791269a702520dc,
                    0xe91137c7a71d42d8,
                    0x21d68d3e40126f03,
                ])),
                Felt::new(BigInteger256([
                    0xc320d70d5c2d208d,
                    0x658f26aba2823675,
                    0x79aa458aa8da007b,
                    0x03eee267a7588230,
                ])),
                Felt::new(BigInteger256([
                    0x77222159c3867889,
                    0x413df7cab62a6bf7,
                    0xa7dfd75ac51a4d35,
                    0x35ba16e99cdb17b1,
                ])),
                Felt::new(BigInteger256([
                    0xc45be41661a96ecd,
                    0x1f4133df4743f193,
                    0xdf638b49c57a5c95,
                    0x72826d8902956d57,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf284755fe653853c,
                    0xdbf8bc56cc2481bf,
                    0x28fcdf495b79344d,
                    0x29e9b84bc55f8b21,
                ])),
                Felt::new(BigInteger256([
                    0xac934931e8156472,
                    0xb6682899e44d1e4b,
                    0xc1da971d079ca76b,
                    0x11bc8eaa5c623986,
                ])),
                Felt::new(BigInteger256([
                    0xa6182800ca9fcb34,
                    0x4ff482240859caef,
                    0x0d98218612dc9b09,
                    0x668352e751d4fab0,
                ])),
                Felt::new(BigInteger256([
                    0xd5aaad7d1c0503a2,
                    0xdf397fd633847c78,
                    0xf69adb997e51af48,
                    0x32c1391cf3750247,
                ])),
                Felt::new(BigInteger256([
                    0xe417854d1565df5d,
                    0x6e8130f2ad268ba7,
                    0x13db5327da0f04f4,
                    0x6ade788c05377209,
                ])),
                Felt::new(BigInteger256([
                    0xbb71426ac8bd9945,
                    0xfcb20b483284780a,
                    0x0e27280c861072aa,
                    0x28fb852a0a143460,
                ])),
                Felt::new(BigInteger256([
                    0xd3fdc9050f082e7a,
                    0x8fa1742b255145b0,
                    0x8b97da8710ca845b,
                    0x275526cd4a475be7,
                ])),
                Felt::new(BigInteger256([
                    0xead35dbb63c80ce1,
                    0xce4dd44bb616a46d,
                    0x4228b5f953a63f7b,
                    0x2147f40040d3a0d4,
                ])),
                Felt::new(BigInteger256([
                    0x3e3d303102cac036,
                    0xc3e1f81032a84964,
                    0xf68365a06018d769,
                    0x52a717f2cf1c5773,
                ])),
                Felt::new(BigInteger256([
                    0x94368e0a77c2f660,
                    0xc93f3ddfe79d8d2e,
                    0x6933bd85de8a5340,
                    0x557a776103137b94,
                ])),
                Felt::new(BigInteger256([
                    0x370faf3b8c07fd08,
                    0xda110bb043874205,
                    0x73d235badd8da797,
                    0x2f205168d704f967,
                ])),
                Felt::new(BigInteger256([
                    0xc0723b507a46e29a,
                    0xfe97fe0395f5b3ff,
                    0xe11898f8f8ceb790,
                    0x0c39cbc1ff769d5d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xaaa86fe82a22e638,
                    0xe272234ed5a8d9ac,
                    0xa2ddb803b9e22c04,
                    0x080adcfc6b57af0a,
                ])),
                Felt::new(BigInteger256([
                    0xfc93f3ab9b0c2ff6,
                    0xef273892c9a06954,
                    0xd7e914bb69ff4060,
                    0x46169c84fe09af0f,
                ])),
                Felt::new(BigInteger256([
                    0x2ce04307932073d3,
                    0xa0ee20f65bf71d32,
                    0xccd659bae369bceb,
                    0x411ed6ed3a1993d8,
                ])),
                Felt::new(BigInteger256([
                    0x69de6ca61b11e564,
                    0x09d69cd0848e96b0,
                    0x6f1e88001e410098,
                    0x536a2919d3a675d5,
                ])),
                Felt::new(BigInteger256([
                    0xaf28f79e9823543e,
                    0xe963f993a8dffb7a,
                    0xfcf1fcfa616f3806,
                    0x27c8ead49d833237,
                ])),
                Felt::new(BigInteger256([
                    0xf4914a0a1652e0f8,
                    0xc982c782dff2f8f6,
                    0x1faf0322a28da441,
                    0x1e6056827a353d6a,
                ])),
                Felt::new(BigInteger256([
                    0x93d73b29369805e8,
                    0x6b504d270b2c5ab7,
                    0x0c86d6113edf1709,
                    0x00a84ecb1bd0d1ba,
                ])),
                Felt::new(BigInteger256([
                    0xa687e83cc700136f,
                    0x88a2423a8cfb2c6a,
                    0x576a23bbc5082a9b,
                    0x001d09cfb9f09c16,
                ])),
                Felt::new(BigInteger256([
                    0x7b634dba96769095,
                    0x688f546ae69f3791,
                    0x10e2b455839538a2,
                    0x542cec7f7bc31d29,
                ])),
                Felt::new(BigInteger256([
                    0x99e6fab12bffde2b,
                    0x1eec85fbddd9d103,
                    0x79ee8a9f7da3d35d,
                    0x3d01f8e864c659bf,
                ])),
                Felt::new(BigInteger256([
                    0x8717a6a504c47a50,
                    0x1a98a64c3493818a,
                    0xf23db2b23b49ffd8,
                    0x6654611465d6a924,
                ])),
                Felt::new(BigInteger256([
                    0x41a13f2de622c8d1,
                    0xf2400e4c282d802c,
                    0xdf8740221bf7acfc,
                    0x10f88820e29d3d1f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7d32240d6fa1ba3e,
                    0x1a198a161d2aade5,
                    0xf203c7794c20c75f,
                    0x56ad8e5e2357fd82,
                ])),
                Felt::new(BigInteger256([
                    0x38ce196c5b9d84a5,
                    0xa7f6a275ccb342ca,
                    0x8d7c78fd651beaa3,
                    0x40ad7f4b1ed64bee,
                ])),
                Felt::new(BigInteger256([
                    0x37a32374b9654794,
                    0x8eca4401c358ae4c,
                    0x62cbd8cf947fc634,
                    0x537d9aec970794d3,
                ])),
                Felt::new(BigInteger256([
                    0xbdcb4be8cceeaad5,
                    0x72d22507f31b90b8,
                    0x1b6ce3f25b2fa40e,
                    0x14b07a8e36e31248,
                ])),
                Felt::new(BigInteger256([
                    0x55aecda9ab20565a,
                    0xa4718b9e1d124506,
                    0x05a9119e3c040c22,
                    0x4d26ab7139105af8,
                ])),
                Felt::new(BigInteger256([
                    0x442c1832ee7e12d7,
                    0xe3abdb80e4a4d8ed,
                    0xed064d22e0bcb794,
                    0x0ca3ddfc701f2b98,
                ])),
                Felt::new(BigInteger256([
                    0xf15a78836abc36d9,
                    0xedd46c3e9b29541f,
                    0x78111889019c7a8f,
                    0x5fcead4bdd28d6bd,
                ])),
                Felt::new(BigInteger256([
                    0x77b8757542cc919a,
                    0x88aa3a6acf3a0eda,
                    0x0363903107ae157f,
                    0x5a0a2de3e0d1056f,
                ])),
                Felt::new(BigInteger256([
                    0x38b81b84f39d3230,
                    0x89dd4e82d41f0def,
                    0x0f09113fd858244a,
                    0x657f32438a12498c,
                ])),
                Felt::new(BigInteger256([
                    0x5161bc25129eb5c2,
                    0x2ed7cc03f2399501,
                    0x0460218ef889e121,
                    0x0ccf9a0cc422d9df,
                ])),
                Felt::new(BigInteger256([
                    0x8477cdeb33246d1f,
                    0xe76f9554f3a2794c,
                    0x33cdb5a5a73608d2,
                    0x0934bd0e16bfc923,
                ])),
                Felt::new(BigInteger256([
                    0x0220071a24001bd1,
                    0xd5439014e804abaf,
                    0xb1c46f638a4aea52,
                    0x1ee425e5a95d8064,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x7f8992894416a185,
                    0x8407d0f1729c8559,
                    0x6ff51f54c4d148bd,
                    0x157878f71889bfdf,
                ])),
                Felt::new(BigInteger256([
                    0x27fd2feb3137f9fc,
                    0x5fefaae3e29d750a,
                    0x70e40212776423d2,
                    0x5b88db82ca1d3821,
                ])),
                Felt::new(BigInteger256([
                    0x9e9a20f798a2392a,
                    0x5c7902ed333beba2,
                    0x5151ce15680e4e96,
                    0x1d2be6681d16957e,
                ])),
                Felt::new(BigInteger256([
                    0x01e3007c6dae5124,
                    0x547ebe19b81f59af,
                    0xd006dbbf1840836a,
                    0x1a1deebdc71ed0f5,
                ])),
                Felt::new(BigInteger256([
                    0x59806c68bbf9a826,
                    0x85f141664d25b429,
                    0x6432381da6749343,
                    0x3767e49c6ed01ef3,
                ])),
                Felt::new(BigInteger256([
                    0x613f95db57c627da,
                    0xe25c2cbba7229782,
                    0x3da17fe975d3a7a5,
                    0x70a797201bd78b55,
                ])),
                Felt::new(BigInteger256([
                    0x899c533359e7ce6f,
                    0xdad1815c41db7385,
                    0x06b562c7bd1d244b,
                    0x6a34985f74d8afcd,
                ])),
                Felt::new(BigInteger256([
                    0xd0b111a124dadf6b,
                    0x0e4401c69b9f1675,
                    0xb4c01b41368fd38b,
                    0x4713e8d385f2b0d1,
                ])),
                Felt::new(BigInteger256([
                    0x7b2b4adcdee08d44,
                    0x25e93997adeeb981,
                    0xdc6795da41761833,
                    0x59b4840dfdd9a75d,
                ])),
                Felt::new(BigInteger256([
                    0xa9f1c0cd336adfc6,
                    0x6b02aef900207cd3,
                    0x7bc0ca5ab908b99e,
                    0x2668656bbe25901b,
                ])),
                Felt::new(BigInteger256([
                    0x60f1451329591ed5,
                    0xbbfe94c12749db5d,
                    0xc82987abdc22a139,
                    0x2579c44197defbad,
                ])),
                Felt::new(BigInteger256([
                    0x1a8e8611aae90e62,
                    0xcd5ea03d6fd3ffff,
                    0x5034e81e6b591448,
                    0x040e9870825ade41,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb51a7639934323b7,
                    0xf3f486921374d69b,
                    0xf8d854d54009768c,
                    0x73adfa358292a4ec,
                ])),
                Felt::new(BigInteger256([
                    0xba27e3df1f25395a,
                    0x60a45e1fe137949c,
                    0x697a82ee601b1516,
                    0x583abd8d937d7622,
                ])),
                Felt::new(BigInteger256([
                    0x90b8aa3c8171beea,
                    0xa867420764cb7b76,
                    0x59ddf4b235c3bce2,
                    0x1af89f12b005beef,
                ])),
                Felt::new(BigInteger256([
                    0x4a3fd6de8142d2b1,
                    0x073e694c4684f1d5,
                    0x5506b27df3ac7d5d,
                    0x3a91042faa6e5582,
                ])),
                Felt::new(BigInteger256([
                    0xab73bb05650f6b05,
                    0xa831fc1862f8d1d1,
                    0x7df13a839fd3a81d,
                    0x4556bbc90ebe6893,
                ])),
                Felt::new(BigInteger256([
                    0xa038a2d137e0fe19,
                    0x8fdc186c78c068c9,
                    0x8e7094439b328718,
                    0x6758e40ac9455193,
                ])),
                Felt::new(BigInteger256([
                    0x60dd982fc2c89565,
                    0x8c79c6d0b21a0291,
                    0xb96c2c5433397d5e,
                    0x272e86f26e2ed990,
                ])),
                Felt::new(BigInteger256([
                    0x2c3e43ad0efe5a55,
                    0xdcdf060917f39632,
                    0xf2807c47d5b9df05,
                    0x54c589c234d87381,
                ])),
                Felt::new(BigInteger256([
                    0xeb8901d2404cc5de,
                    0x5d51add1b413771c,
                    0x30e1567e097c54a4,
                    0x55af95b6d8c2776d,
                ])),
                Felt::new(BigInteger256([
                    0xcd7866a8d38d74dd,
                    0xdd1e7f0269af603f,
                    0xf88fa5301edbc94e,
                    0x37c5029b9f72b870,
                ])),
                Felt::new(BigInteger256([
                    0x730570a5c6d3285b,
                    0xecf3b03f2a89b673,
                    0x103471807a58eeaa,
                    0x27c30f5138e652ce,
                ])),
                Felt::new(BigInteger256([
                    0x9bc3de53727ac0fd,
                    0x0fa22aaff9a61103,
                    0xaf1494d711cb6935,
                    0x6559e573323d3d36,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3327800493c93016,
                    0xc84ac1471ade2cb0,
                    0x0dc0af182773ba85,
                    0x6db92c3c08280564,
                ])),
                Felt::new(BigInteger256([
                    0x908fac9219e5242f,
                    0x10f59d17fa380a2f,
                    0xb3ee389fd4586bac,
                    0x64e52aa659daeca0,
                ])),
                Felt::new(BigInteger256([
                    0x0bbb7ea40e36a7ba,
                    0xf6946e645cc396b2,
                    0x7fde2213232f094d,
                    0x29410f56f30a692b,
                ])),
                Felt::new(BigInteger256([
                    0x308d505b038d6144,
                    0x18b1dc71b67a712d,
                    0x8033e39ece6c75f2,
                    0x624fa4a7963026ef,
                ])),
                Felt::new(BigInteger256([
                    0x14da057b37d0d908,
                    0xeb08e0cdfda73fa2,
                    0x5942182df07cf9aa,
                    0x26b1becf45d14d2b,
                ])),
                Felt::new(BigInteger256([
                    0x784c1d18e2fa8645,
                    0x3903124fe6d57b26,
                    0xdbe0fe02260c1874,
                    0x4d63aa5c014fa423,
                ])),
                Felt::new(BigInteger256([
                    0x753e31bf5ec695e6,
                    0xc58673087be13847,
                    0x1a152d1c3a8ec64f,
                    0x08a1a1bc820a76c8,
                ])),
                Felt::new(BigInteger256([
                    0x139be5d429fa30a3,
                    0x2296003f80346140,
                    0x76b08b9ecda86204,
                    0x13406df2862be830,
                ])),
                Felt::new(BigInteger256([
                    0x66ed323dbaf6af15,
                    0xd48c2fa8494c9a47,
                    0x9a65bec03e01a002,
                    0x11673c4227d309c8,
                ])),
                Felt::new(BigInteger256([
                    0x97b1b1265fa25c09,
                    0x9f9d3c88c31ebcc9,
                    0x7ed6d264e7eb3d36,
                    0x38fe36131821d8d7,
                ])),
                Felt::new(BigInteger256([
                    0xfe33a02e739b7ac2,
                    0x0e78bf45810d14a4,
                    0x68d24086f1298ffe,
                    0x0696d0994df65f61,
                ])),
                Felt::new(BigInteger256([
                    0x19db1224e60d355e,
                    0xe2e26abdc8f9c385,
                    0xc6401f87499cd112,
                    0x5e96531192deded3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xc1281595bdcb4e36,
                    0x7ab09703287e8950,
                    0x72c2911891abea86,
                    0x4b3c6d4571ded02b,
                ])),
                Felt::new(BigInteger256([
                    0xbc5a9b3cae04d5b8,
                    0x83b1cc62014eb403,
                    0x725903bd6a23431b,
                    0x710678c4f98ce450,
                ])),
                Felt::new(BigInteger256([
                    0xddd8712339eec6d1,
                    0x61d9432863f62918,
                    0x36a2bda5e19855bc,
                    0x1a5cc13035804b20,
                ])),
                Felt::new(BigInteger256([
                    0xf9992d916d1b7d27,
                    0x31ccd7bb50759461,
                    0x26ac487999012c98,
                    0x6ca0fb296ec6d62e,
                ])),
                Felt::new(BigInteger256([
                    0x69dc259bceb0a7e4,
                    0x5e75354234394bae,
                    0xafbad26b84e464e6,
                    0x0258cd357eb33c35,
                ])),
                Felt::new(BigInteger256([
                    0xd0f2b6af9e4cc6f3,
                    0x41f83eb7dd88e4c3,
                    0x94886f53642e7348,
                    0x32014e0519222f11,
                ])),
                Felt::new(BigInteger256([
                    0x7c20d3b1bb8f282e,
                    0x62c2e7bc7b743f9d,
                    0x88055ee5c2f076dc,
                    0x2e80080d0ced1dec,
                ])),
                Felt::new(BigInteger256([
                    0x1e54d8b3a99a6db8,
                    0xc33cb79b3bda7baf,
                    0x5320a085ca960246,
                    0x3b3140a753c2d584,
                ])),
                Felt::new(BigInteger256([
                    0x68240922b26916bf,
                    0xde81ea0b40bb107d,
                    0x26c057a87f73bcb4,
                    0x3d81e05dd37a034f,
                ])),
                Felt::new(BigInteger256([
                    0xcf4201c69f0f25d8,
                    0x06419ad68cd67ee5,
                    0x47da33230ebca28b,
                    0x4d531c58367be3b9,
                ])),
                Felt::new(BigInteger256([
                    0x7d4dbfef5ed0f695,
                    0xcde4e2b5c37bc29d,
                    0xd1e5b19baea275a4,
                    0x20e0e275c2029712,
                ])),
                Felt::new(BigInteger256([
                    0x605ebf91f40d9639,
                    0x6a8a3695e74a9d26,
                    0x45f999b4da726a4a,
                    0x2c0b6328e7b29660,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xfc8b71a06979f235,
                    0x85d59ee25187d490,
                    0xb2c93d63b091d70b,
                    0x3ce8054d0a2b724d,
                ])),
                Felt::new(BigInteger256([
                    0xea7c6cc94c5f6f0f,
                    0x9af1f79eb8810767,
                    0x222549f37c2f0c76,
                    0x31288c96168acaea,
                ])),
                Felt::new(BigInteger256([
                    0xb740a44744df78a6,
                    0x49f25073410bbe92,
                    0x88bd11738a286cd8,
                    0x26a38354b8c0ae99,
                ])),
                Felt::new(BigInteger256([
                    0x9d82569318b91c22,
                    0xacf73ab43be4c1a0,
                    0xc159303b6849c4b7,
                    0x3c3c68f693061498,
                ])),
                Felt::new(BigInteger256([
                    0xf19b3b241b1d4b23,
                    0x311ff6e3178aa8f2,
                    0xff82fb6c9fe4a5d0,
                    0x2972ea5dca25fa6b,
                ])),
                Felt::new(BigInteger256([
                    0x74c48e1376499abc,
                    0x614399ce0e72c1c7,
                    0x96a385d2a7a26804,
                    0x05aa29fffb3cdeb0,
                ])),
                Felt::new(BigInteger256([
                    0xcb305f81bac63744,
                    0x010a001eeb6d5661,
                    0x1481779a79f6b7bf,
                    0x45dbface15a7975c,
                ])),
                Felt::new(BigInteger256([
                    0x7b79d25124479312,
                    0x9dae859288b0edff,
                    0x5ddefc30d4fad23a,
                    0x3c4f50b1dcc432de,
                ])),
                Felt::new(BigInteger256([
                    0x5a3aa71a27548f31,
                    0xe59bf95ce0544175,
                    0x23e53278bd2e4f09,
                    0x1aedfda4704ccce1,
                ])),
                Felt::new(BigInteger256([
                    0x22b89d14a2ffaa79,
                    0xeb7af2e066753b7c,
                    0x1e71e1276853c394,
                    0x6126dd7f27d00b1d,
                ])),
                Felt::new(BigInteger256([
                    0xe2ae3755c42f8007,
                    0x8e7e8f65058ec4c4,
                    0x44afc7b72fe0d60f,
                    0x7267401dd60d2a8a,
                ])),
                Felt::new(BigInteger256([
                    0x4162b3afeda25c2f,
                    0xea2375bcbb6dbeac,
                    0xa9aaa74afec5adf6,
                    0x437235f9b27b8137,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x99896d0519bfe1b7,
                    0x28094bb4ed9bcd2e,
                    0x263bc156feec5eda,
                    0x12c11b2f53f23338,
                ])),
                Felt::new(BigInteger256([
                    0x4497a89a6e90e1be,
                    0x3e4745f603eecb66,
                    0xd960da5ad0fe7781,
                    0x3ac101ddcceae6fe,
                ])),
                Felt::new(BigInteger256([
                    0xcdfa85fd9586ffdd,
                    0xaa7f92fafe57d00f,
                    0x4e087126a1a7617a,
                    0x305dca1a032f3cbb,
                ])),
                Felt::new(BigInteger256([
                    0x3ea0464624836752,
                    0x321623b7c66d87e4,
                    0x90f124567482e69f,
                    0x1f97e6dda8497c99,
                ])),
                Felt::new(BigInteger256([
                    0x7d9d307bc38c1158,
                    0xff79fd560f73c2a7,
                    0xc42c9496487ee390,
                    0x6ac535bc547f9d1b,
                ])),
                Felt::new(BigInteger256([
                    0x016663e859f8d58f,
                    0x042df3bde353e22e,
                    0xbd834ff37de46494,
                    0x2262361d14c2f89b,
                ])),
                Felt::new(BigInteger256([
                    0x6933f3b56f416daf,
                    0x5c2c7c1573ac3432,
                    0x9e31dc9bd68eb34c,
                    0x44aab5304327a14b,
                ])),
                Felt::new(BigInteger256([
                    0xa518792fd6221a61,
                    0x040f8a72248fc75b,
                    0xaf12a4c8bbde66c2,
                    0x098de05104d8709a,
                ])),
                Felt::new(BigInteger256([
                    0x4c8e71e1606256cd,
                    0xf34569920f8153c7,
                    0xfef7c78f0051e023,
                    0x320811cacf21f6ee,
                ])),
                Felt::new(BigInteger256([
                    0x3d6c06e5d455b155,
                    0x2dd23c58bc108883,
                    0xc07f5eb101b044da,
                    0x70beb0c585e189a0,
                ])),
                Felt::new(BigInteger256([
                    0xef3bce54b58aebb5,
                    0x9130e59bb252a0f3,
                    0x56427ef386dae8fd,
                    0x6e9903398b2118d4,
                ])),
                Felt::new(BigInteger256([
                    0xfbd96156aa91fe86,
                    0x5dc73555e1f91d6b,
                    0xb4547b16bc7f1b63,
                    0x4d6382e2dcfb20a7,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
