//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 31 == 0 {
            bytes.len() / 31
        } else {
            bytes.len() / 31 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 31-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 32];
        for chunk in bytes.chunks(31) {
            if num_hashed + i < num_elements - 1 {
                buf[..31].copy_from_slice(chunk);
            } else {
                // The last chunk may be smaller than the others, which requires a special handling.
                // In this case, we also append a byte set to 1 to the end of the string, padding the
                // sequence in a way that adding additional trailing zeros will yield a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 32];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 31 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn merge(digests: &[Self::Digest; 2]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        // 2*DIGEST_SIZE < RATE_SIZE so we can safely store
        // the digests into the rate registers at once
        state[0..DIGEST_SIZE].copy_from_slice(digests[0].as_elements());
        state[DIGEST_SIZE..2 * DIGEST_SIZE].copy_from_slice(digests[0].as_elements());

        // Apply internal Anemoi permutation
        apply_permutation(&mut state);

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        // We can output as few as 2 elements while
        // maintaining the targeted security level.
        assert!(k <= NUM_COLUMNS);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger256;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger256([
                0x536516bc525b0a23,
                0x26c7ee02ef6bc6da,
                0xb7e0ece6eb02da30,
                0x1368618776f7cbd1,
            ]))],
            vec![
                Felt::new(BigInteger256([
                    0xde3d6694395c9a95,
                    0x239e5e89ecefb0c3,
                    0xd1ef0dcde8a20991,
                    0x1500a01da6f96e1c,
                ])),
                Felt::new(BigInteger256([
                    0x00e48d8b7e0ca03e,
                    0x7af9e197f4b9b72f,
                    0x8562b01342d7ed4d,
                    0x1abcda536c9d023b,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x385dc598695b9ec8,
                    0x28c8121c048b5ec1,
                    0x2702fc930a3d2789,
                    0x3be5bd5ec252dc48,
                ])),
                Felt::new(BigInteger256([
                    0x80756263c591da15,
                    0x7a074316b1758d01,
                    0x8c79659c06761c22,
                    0x19af207552ade057,
                ])),
                Felt::new(BigInteger256([
                    0x2983ebc691245b37,
                    0x8c0a1023e4310033,
                    0x5195eebe204e53cc,
                    0x062676364945b2f6,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x23f6ebd1d2363e51,
                    0x815a3b72cc9d4dc2,
                    0x512e1476b7ae1578,
                    0x1fa12a88f4e189b8,
                ])),
                Felt::new(BigInteger256([
                    0xa21f97cd1098cb09,
                    0x9e141ffffcfd3a7d,
                    0xc235b840ae2bc686,
                    0x2c3ee03649dca9aa,
                ])),
                Felt::new(BigInteger256([
                    0x38e91756b00cd7e2,
                    0x9de1d0ee8b01de3e,
                    0x4926151ea0ae2034,
                    0x292a9e9c1b55d590,
                ])),
                Felt::new(BigInteger256([
                    0xd476f64484bbe588,
                    0xebb53ea91b7b170a,
                    0x275119334748a19b,
                    0x1ae17a69d731d3a8,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x066d8a035d6bb5d1,
                    0xf4b6a133f36578f4,
                    0x2af165adfb850558,
                    0x214a7bb52aa532f6,
                ])),
                Felt::new(BigInteger256([
                    0x5a8879cd0def859c,
                    0x04475e954b42ee62,
                    0x8454881e8847b63a,
                    0x09b52308b786d818,
                ])),
                Felt::new(BigInteger256([
                    0x577617e0daed219e,
                    0x52943d917e00b79b,
                    0x4cd1fc43e8469847,
                    0x2f0aed3ba49b69fd,
                ])),
                Felt::new(BigInteger256([
                    0x3f9bd9aef223f135,
                    0x0f8f0b6ebc4d3627,
                    0x830b2bef3dd43d9f,
                    0x39a75ae595f9aa08,
                ])),
                Felt::new(BigInteger256([
                    0x8e9cc7832fff04cf,
                    0x0addb005015b2eaf,
                    0xfbab22c830eda30a,
                    0x3bef868a64b01fd7,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x4b437292d010990a,
                    0x484be6f5e17584a4,
                    0xee1c2a14b1b0a57b,
                    0x3bfc30634557c67a,
                ])),
                Felt::new(BigInteger256([
                    0xe748ecbeb31fd17b,
                    0xde51857f4786b57b,
                    0x5e43eecdd63e881e,
                    0x2da7e415b193ddda,
                ])),
                Felt::new(BigInteger256([
                    0xf5621e3a52d70d80,
                    0x6acc4ad669895d1b,
                    0x5f23fd366c04ef10,
                    0x32bbf259c56106f3,
                ])),
                Felt::new(BigInteger256([
                    0x84466defe205424c,
                    0xdb185a24af777fde,
                    0xd160a01c901f2526,
                    0x0b5830774fb60d78,
                ])),
                Felt::new(BigInteger256([
                    0x9cc80b823d597255,
                    0x61feea69564cd9a2,
                    0x11477ac75df0fafa,
                    0x2f9bd00e9a728b3b,
                ])),
                Felt::new(BigInteger256([
                    0x9ec59c3b54e87057,
                    0x7c80ea51ea767035,
                    0x5b844b7990f49163,
                    0x253d4c5b22c3f00b,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x2ac5146ec058d834,
                    0x065d448b02841a6b,
                    0x6411c5c425c17764,
                    0x152674d0ffe2d2ca,
                ])),
                Felt::new(BigInteger256([
                    0xe11c3855723196bd,
                    0x7d00a4da869cd8bf,
                    0x24129c3171168e00,
                    0x089bd031c8776d3d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe6fec186766faa1c,
                    0x3f41bdc102a1d76d,
                    0xf94b4cc1912e7011,
                    0x1d2c0afc50ada3d8,
                ])),
                Felt::new(BigInteger256([
                    0x1d2abf05eb2992bc,
                    0xe2b29da56fd7f863,
                    0x0c4c1e60f47981a3,
                    0x01ed107701ee6421,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x319b0cbc8639684b,
                    0x33739bad115ad6e7,
                    0xfc1b6acfc61bc65b,
                    0x3f612d0c7c553fad,
                ])),
                Felt::new(BigInteger256([
                    0x8b37d79201aad5b5,
                    0x827aae3ebce68f06,
                    0xbf098a295a22b637,
                    0x02a1cb0aa0991081,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x46511ff0986d8a3a,
                    0xd2c207def2192bde,
                    0x2c18e1ce6256107a,
                    0x14dcdb15ab7fdda9,
                ])),
                Felt::new(BigInteger256([
                    0x9c2e172009cbb887,
                    0xd884345195987ac3,
                    0x4054f26c38f2b976,
                    0x266d038243a6623b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x1ed66d3eb5667ebf,
                    0x1f5c90f82ad14f45,
                    0xf2c55b20868c7874,
                    0x0be83b2692852703,
                ])),
                Felt::new(BigInteger256([
                    0x2d75ef2bcf429372,
                    0xc773c44d481cfb55,
                    0xf1e6af7da97cf11a,
                    0x0833d7deb45e764e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa9cbbbbde48af389,
                    0x3a2f6cc561019cfe,
                    0xd459fff84b039201,
                    0x26742a3f121bc6fe,
                ])),
                Felt::new(BigInteger256([
                    0x6c47328295d9a996,
                    0xef96c5aad0d10a72,
                    0x33a698ed385a54dd,
                    0x3ff3c41701e74f1d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3caafa501afa8e3b,
                    0x2c2207e91b1d36b0,
                    0x08d53445a0b2e157,
                    0x157f3bf8a6a94cd0,
                ])),
                Felt::new(BigInteger256([
                    0xf541a2dcae700acd,
                    0xfa8cf58296fbe500,
                    0x369f5ac9578f87a0,
                    0x0b3185b2b234e63b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x19d2276273381fd5,
                    0xf92ba3123ed18b34,
                    0xc57fa589f4435d6c,
                    0x15e9361a3f18330d,
                ])),
                Felt::new(BigInteger256([
                    0xa4fd3a4bfe82591c,
                    0x151e8cefbc74f683,
                    0x1d242f0f47596612,
                    0x1843fb12936547e5,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x27f7fa0cdcaeb12d,
                    0x1cfaa10abf0f1c88,
                    0x5201bf8c123acdda,
                    0x1cd4a9ad662148aa,
                ])),
                Felt::new(BigInteger256([
                    0xbabb8ae42e47c46e,
                    0x28a8df485a5c7ce7,
                    0x26f103501bcc9df8,
                    0x357f93fae185aeb9,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xc7f712f2775e37d7,
                    0x7b817e7cdc2e2440,
                    0x159bf243f4dd04c1,
                    0x2c53db0e4b7904ad,
                ])),
                Felt::new(BigInteger256([
                    0x73bbbdbd3d28c09d,
                    0xe44bdb22bba2d532,
                    0x39c7a68802ba694b,
                    0x1304051ab726a0a3,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x60e5605c20e48772,
                    0x443e94a3a951fef8,
                    0x5de3a94701477206,
                    0x24c0961bedcfef7e,
                ])),
                Felt::new(BigInteger256([
                    0x1327d93d517c312b,
                    0xea36c3723707cd75,
                    0xed9edf83351b2d1e,
                    0x196b116baa9c9a98,
                ])),
                Felt::new(BigInteger256([
                    0x12e67313a34ddce2,
                    0xd0c35bc09c927832,
                    0x7580b55f35940999,
                    0x24f39bc3ec675681,
                ])),
                Felt::new(BigInteger256([
                    0x618d802ef94709c1,
                    0xe4f7a9f002f8a0db,
                    0xb8d58e0fe8553bc9,
                    0x37879e460ee26945,
                ])),
                Felt::new(BigInteger256([
                    0xb557246c46ad74d0,
                    0x5f80ace0d9da73fd,
                    0x9c688681b835ee41,
                    0x00ffd681bd0d7b96,
                ])),
                Felt::new(BigInteger256([
                    0x29846c45f1a307c2,
                    0x0849214f4360a9e7,
                    0xf7ed596a8fdd26d3,
                    0x13f40840421e1273,
                ])),
                Felt::new(BigInteger256([
                    0x13c595480d0605fa,
                    0xc18195b3a31ad18a,
                    0x52e8da7a3694944c,
                    0x2fe594002813ddd3,
                ])),
                Felt::new(BigInteger256([
                    0xddbb7c8961898f26,
                    0xaa6252f49902abcb,
                    0x69fce125214af8c0,
                    0x12f72c4a92eaba69,
                ])),
                Felt::new(BigInteger256([
                    0x764d2e5a6449379e,
                    0xca76fb2ee1bb7136,
                    0x51231f760e4cfed7,
                    0x10fe4ce47cb5ac5c,
                ])),
                Felt::new(BigInteger256([
                    0x439b028c2785d2a6,
                    0x4d01faec153a7b43,
                    0xd47693258eb7d257,
                    0x01f0f1415595c23c,
                ])),
                Felt::new(BigInteger256([
                    0xe65650e7a57f39de,
                    0xa4d511a74da6b5f3,
                    0xf6826067b1fbe33d,
                    0x03f36e25c7a25a31,
                ])),
                Felt::new(BigInteger256([
                    0x4fe9ea20b79633b7,
                    0x28cfbdd88c4c155b,
                    0x207d4e780cede0a9,
                    0x105c568f308db6b1,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x260bb250a4a3c8a3,
                    0xd50cf950efee51d1,
                    0xe0c3f97f533db2ab,
                    0x3d5447dade9a2c55,
                ])),
                Felt::new(BigInteger256([
                    0xc90be629b1546576,
                    0x3c72a8cd501010a2,
                    0x4e8426911a5db48e,
                    0x2a52487d1c0f64d4,
                ])),
                Felt::new(BigInteger256([
                    0x729cda0f66a01791,
                    0x99e3da09e90dc99d,
                    0x37e67984585df31b,
                    0x20d57973741952e2,
                ])),
                Felt::new(BigInteger256([
                    0xccd5301bc2904c91,
                    0x5c11f834d5c3f5fe,
                    0xbe564852d765752e,
                    0x1a885efc4c74ef39,
                ])),
                Felt::new(BigInteger256([
                    0x1aa6af2cee3abfbe,
                    0x4559053a0e3f5766,
                    0xf3bd6f6438e1b119,
                    0x1f1828b42e9e8d05,
                ])),
                Felt::new(BigInteger256([
                    0xc51311a3ef508128,
                    0x4a8f16468f45524a,
                    0xdfd6fb0842fce740,
                    0x1ddc62e0ef0446f0,
                ])),
                Felt::new(BigInteger256([
                    0x5c7a090c3270748c,
                    0x8ca5dc558bb7d243,
                    0xa9d837a231712d89,
                    0x12e16add09383625,
                ])),
                Felt::new(BigInteger256([
                    0xe9a5e8b404640cd9,
                    0x6b96613600668a83,
                    0xcee308a9fecde176,
                    0x0a8cc1f5509ccc79,
                ])),
                Felt::new(BigInteger256([
                    0xa44b9b332afe4f96,
                    0xe51b35e5e351a5fc,
                    0x7248cd285fb5014c,
                    0x03e67240ca77d846,
                ])),
                Felt::new(BigInteger256([
                    0xe7bc18985855c97a,
                    0xb989577de239e36c,
                    0xec2c202c4ae7681e,
                    0x3576970b9be031ba,
                ])),
                Felt::new(BigInteger256([
                    0x92a2f8e7b138ecd2,
                    0x6c53103d18810556,
                    0x17ec817a8d6de9b8,
                    0x1e9cde0e33386aab,
                ])),
                Felt::new(BigInteger256([
                    0x67eb7149b52342e1,
                    0x456bfd26a41f8119,
                    0x5aadd100d117a619,
                    0x123424b0fb47ce53,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x9beb9283f2f08915,
                    0xec8dfb309c699b80,
                    0xbd0bff4d23125650,
                    0x1186eb5e6ecb9391,
                ])),
                Felt::new(BigInteger256([
                    0xd0f0eda901ceb4ed,
                    0x0a346a4088da2847,
                    0x568241651b8e27bd,
                    0x1e77b7aef5100676,
                ])),
                Felt::new(BigInteger256([
                    0xb20c2a480b592acf,
                    0x5385cff5d0b8909a,
                    0xb7c666d90f2bfca4,
                    0x1b4afbe2a589ef86,
                ])),
                Felt::new(BigInteger256([
                    0xaa9f9f83dbd337fb,
                    0x76941d64d2574bd1,
                    0x12efce26b3f74269,
                    0x1e8068094c019501,
                ])),
                Felt::new(BigInteger256([
                    0x604d08f47561555a,
                    0x78c7b5cfaf592423,
                    0x4fb9b7692b48db2c,
                    0x09aeba79d550119b,
                ])),
                Felt::new(BigInteger256([
                    0x1062bfc448905969,
                    0x96e3aa994ac5ad58,
                    0xf68baee3183a5057,
                    0x18ac7d1571a4e7aa,
                ])),
                Felt::new(BigInteger256([
                    0x999fec69f155e2c3,
                    0xad071204e906967c,
                    0x2c102bc05cc61fae,
                    0x2e203d4484156ea5,
                ])),
                Felt::new(BigInteger256([
                    0xa768fca69cd0b204,
                    0xe938608fc88363e1,
                    0x926f5e5ae2c67bda,
                    0x1c0feaf3798db962,
                ])),
                Felt::new(BigInteger256([
                    0xc47168500f838ef7,
                    0x64f15a9632bbffd7,
                    0x346e6ede11ebfd36,
                    0x0ab2c24728073a74,
                ])),
                Felt::new(BigInteger256([
                    0x4d7bf38a30164e41,
                    0x08371d95e92efd9d,
                    0x70c858dabe057694,
                    0x1ff42f1b160c4d74,
                ])),
                Felt::new(BigInteger256([
                    0xefe8b00c6eb4c82f,
                    0xbb3cd6a3602ea388,
                    0x97dde37a25b3e698,
                    0x39f1773b2985d728,
                ])),
                Felt::new(BigInteger256([
                    0xb4bf2a4e7bddb55c,
                    0x8992ed095c1ea0be,
                    0x9333725086dd2596,
                    0x09f64e72acd0614a,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xa4b01ed7f6c303e2,
                    0xdad6a1c440aa7b36,
                    0x6342fd80f2955718,
                    0x376dc7dd1283d22c,
                ])),
                Felt::new(BigInteger256([
                    0x3f377742498823dd,
                    0xdb187ce62511aeed,
                    0x59c2699d02daee18,
                    0x0a331956c891b020,
                ])),
                Felt::new(BigInteger256([
                    0x603ca9f976bfcc38,
                    0x5248190fed05f1ba,
                    0x7ef075e4487eb150,
                    0x23480ed04e0c91de,
                ])),
                Felt::new(BigInteger256([
                    0x3744f0bb99faede9,
                    0x4a693705a8a5b224,
                    0x1f947a674c851e32,
                    0x07bdfc04dcec6d57,
                ])),
                Felt::new(BigInteger256([
                    0xb27805b63c0bc471,
                    0x64c18966d32e072e,
                    0xcd34fb8fd8b336ae,
                    0x1aa1d1aa2a3b693c,
                ])),
                Felt::new(BigInteger256([
                    0xaf6158c1a17c5dac,
                    0xc53336acb3670689,
                    0xd981e3e714f54177,
                    0x38771978672a4adc,
                ])),
                Felt::new(BigInteger256([
                    0x8c03f9b07052fcc6,
                    0xd794c54115de5257,
                    0x24c0cfc42c11e006,
                    0x0558849af46e6b8d,
                ])),
                Felt::new(BigInteger256([
                    0x093f72e356e1c41b,
                    0x000d519677d7fb49,
                    0xa6d69461dcdf493c,
                    0x13c0711b3c6de1f8,
                ])),
                Felt::new(BigInteger256([
                    0x65583eecffbae6eb,
                    0x8b2a4cb7cfd9ccf2,
                    0x2b4982a72fe8adfa,
                    0x117404255cec2de4,
                ])),
                Felt::new(BigInteger256([
                    0x82f20cbf32f59511,
                    0x585f6dc203b67426,
                    0x25282d0a8bdb32ff,
                    0x25bd15d38e3ea080,
                ])),
                Felt::new(BigInteger256([
                    0x084cf156589093da,
                    0xe692604a17d4eeaf,
                    0x145438bd5a351fe2,
                    0x11cb0574cdee0402,
                ])),
                Felt::new(BigInteger256([
                    0xb08db1ef34393576,
                    0xc76ad8c56d6948ee,
                    0x04c8a1fa1e0933ee,
                    0x27ae1e80dea9fce6,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xf68b134c7dca27ae,
                    0x71879cde0681058d,
                    0x3e04c1c4c86e96cd,
                    0x084bea649cbbeb79,
                ])),
                Felt::new(BigInteger256([
                    0xae0f7fdab522a192,
                    0xcf8c830e95160301,
                    0x02301be20fcf54b5,
                    0x32ec625679345ae8,
                ])),
                Felt::new(BigInteger256([
                    0xf11d1bf4b50cab73,
                    0xf31906e51f26d2b4,
                    0x61422528555d342d,
                    0x140769e7d5554b0d,
                ])),
                Felt::new(BigInteger256([
                    0x1e8ac5ca02955a2e,
                    0x6ac94ea1595b9508,
                    0xc237728ab005e646,
                    0x28e5848fe40c864c,
                ])),
                Felt::new(BigInteger256([
                    0xe554c6ac4b6e9413,
                    0x21094bf6dd7b0887,
                    0xeef5cabb801cfba9,
                    0x19aa8bc062b78d2a,
                ])),
                Felt::new(BigInteger256([
                    0x8ee048e60ab1ee27,
                    0x642936cb559812c6,
                    0x5b288ce64a409e7d,
                    0x0bfdda62cb4be7ee,
                ])),
                Felt::new(BigInteger256([
                    0x58ec3f67a911c1a3,
                    0xd3d014725e71dec5,
                    0xf2925fb240068cc8,
                    0x1daee8e5c53d6224,
                ])),
                Felt::new(BigInteger256([
                    0x1f112994670d0491,
                    0x1c0a53c166268bc9,
                    0x5b1620ddb6e36d17,
                    0x0335e8d878ee4ce8,
                ])),
                Felt::new(BigInteger256([
                    0x7988e75a52ca8997,
                    0x506db55c96bb8cab,
                    0x09cc910ce3cb5c49,
                    0x2be0add88c29f6b6,
                ])),
                Felt::new(BigInteger256([
                    0x8edd97556220dab8,
                    0xdbcf512dd03f9294,
                    0xeb5e5416aa01409a,
                    0x18cb31400e17c6ff,
                ])),
                Felt::new(BigInteger256([
                    0x5b5e0515a4500d13,
                    0x90e10741e34fbd9f,
                    0x9879f7d2748be084,
                    0x04bf9eff97d4049b,
                ])),
                Felt::new(BigInteger256([
                    0xacc39797a7efe92a,
                    0x2352915365305afd,
                    0xcaaef36fa1eabe40,
                    0x397e02c6cbb86a5d,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xb0206a841df926b7,
                    0xf320dd4c208a1ee2,
                    0x50ba171db081d6b1,
                    0x3484ff70e01f1b4a,
                ])),
                Felt::new(BigInteger256([
                    0x4137a41e2aac3888,
                    0x6d52ca9bbe5849e4,
                    0x9bb923e13861aee2,
                    0x081b9614f634a954,
                ])),
                Felt::new(BigInteger256([
                    0xc8f45d32f23e2be0,
                    0x9f06fb17e387f989,
                    0xe6ce9e12c0c42e56,
                    0x08064b61dbb0d978,
                ])),
                Felt::new(BigInteger256([
                    0xea09ecfe77451b15,
                    0x5b6894891481904c,
                    0xff5691c4ad501f6e,
                    0x39688f161aeff606,
                ])),
                Felt::new(BigInteger256([
                    0xa010b78097c211ed,
                    0x1c183cd147285391,
                    0xf5ece1f0d156d5ed,
                    0x0acf47e93c3cf9ac,
                ])),
                Felt::new(BigInteger256([
                    0x69f7c3e1ea7e950a,
                    0x6fb3096e5894e281,
                    0x61f2a0d5e4016ff4,
                    0x3afde8cd7fb2c736,
                ])),
                Felt::new(BigInteger256([
                    0x1b9dafb90b58a7c8,
                    0xc9f6c27ded13c219,
                    0x5ccb99263196d518,
                    0x287f6f5878932fe7,
                ])),
                Felt::new(BigInteger256([
                    0x5071468e65bb05aa,
                    0x3b8a4ec8622a2fa7,
                    0x4b65f66ecff26ff7,
                    0x2520a0c0cafa4cbb,
                ])),
                Felt::new(BigInteger256([
                    0xd37b7b95f0512f86,
                    0xc16a7429ee8f9600,
                    0x7ae0a4573b7ebe35,
                    0x2928f67724dca86d,
                ])),
                Felt::new(BigInteger256([
                    0xebfd77c73b305272,
                    0x1491f1a5ac9b170c,
                    0x8b146145a7ec0994,
                    0x08207dc5736fb554,
                ])),
                Felt::new(BigInteger256([
                    0x80f784c8f797579c,
                    0x803bc00f0f754b3f,
                    0xfbe86d645eac3f8f,
                    0x3aa3e5548c0da508,
                ])),
                Felt::new(BigInteger256([
                    0x91e9edc1243c8b0d,
                    0xb58b7f15e88e24a1,
                    0xe429aa6fe7266b88,
                    0x089fd47e6c6937e4,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x61d9350dc33c9b8e,
                    0x23b2e46021a83a68,
                    0xaf7b13398850cc94,
                    0x258d2293f1274391,
                ])),
                Felt::new(BigInteger256([
                    0x695ab23bc0dfc920,
                    0x5d9f6c48e02571be,
                    0xcf3da2ce225337e2,
                    0x18dd38e9d69e95ce,
                ])),
                Felt::new(BigInteger256([
                    0x5615c886005c599c,
                    0xeacfb2399610b7ed,
                    0xb4e60c03fb08bd41,
                    0x3f632c0f8c1b9567,
                ])),
                Felt::new(BigInteger256([
                    0x9ac6c03069ba1b2d,
                    0x94543cb8e4122ab1,
                    0xb7e89722b67bb46d,
                    0x3ba0bf1928863218,
                ])),
                Felt::new(BigInteger256([
                    0x10ed79fc0877fd58,
                    0x81bece7f36186629,
                    0x9be44c444896590d,
                    0x187e76db8d9bd91c,
                ])),
                Felt::new(BigInteger256([
                    0x66ff757d267f1eae,
                    0x2f338851670b6495,
                    0x260775ee0a65367a,
                    0x35f6af5cea2f9fc9,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x38d540e9925d5097,
                    0x407c1d64ad29bfc2,
                    0x39c9d84b35ba2b03,
                    0x2bf60583ce190bc8,
                ])),
                Felt::new(BigInteger256([
                    0x1e61e017535a5859,
                    0xc410c895dcb43980,
                    0xf4be9ab4daf9c359,
                    0x3e30c4f40c1b6c9b,
                ])),
                Felt::new(BigInteger256([
                    0x54978f84195608d0,
                    0x604ca71776c6591f,
                    0xcd3f7620b0ee7ee6,
                    0x1c1ab1a4520e1750,
                ])),
                Felt::new(BigInteger256([
                    0x1c0ed69ec89c810b,
                    0x3a96e4e1e5966fc7,
                    0xacc97498615c8a47,
                    0x38ac9cb01564f2b9,
                ])),
                Felt::new(BigInteger256([
                    0x6b5e4bd360b5940f,
                    0x236b4868cba4e2e1,
                    0x953a54eaab1f9b9e,
                    0x1a2c5fc70ae7fdd2,
                ])),
                Felt::new(BigInteger256([
                    0x421cd06fb006259a,
                    0x10cbf55de99148b3,
                    0xb808faf76ed32f8d,
                    0x153c23d0a13f9a02,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0c4303ebb9fbe83d,
                    0x613002ebfdec5492,
                    0x58b0d990d55524d7,
                    0x0377fae198a64324,
                ])),
                Felt::new(BigInteger256([
                    0x82b7d846e3aef22c,
                    0x6ea36e04ed33291c,
                    0x6419e6ef1b63ac08,
                    0x0ba05bebdc88f52a,
                ])),
                Felt::new(BigInteger256([
                    0x73f77bd6e7b2c18b,
                    0x4f3f427f0646892b,
                    0x76d54b6d91cb0966,
                    0x38839d6b6261e9bd,
                ])),
                Felt::new(BigInteger256([
                    0x80b1273931d0322c,
                    0x737d8102a8d071a8,
                    0xee156670f35c91aa,
                    0x0f6813e2fc285bf9,
                ])),
                Felt::new(BigInteger256([
                    0x4b6b36273a3eb21c,
                    0xc939258fcd68c61a,
                    0xd91475090b0e345f,
                    0x003f0d9b8c4406b2,
                ])),
                Felt::new(BigInteger256([
                    0xaf6502548a53fc7e,
                    0x9b1fd1c2715fb9fd,
                    0x67f366ac21731a3c,
                    0x2078aab65c4f3e0d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xee75d2d0cb00b245,
                    0x2a9139868ec78b63,
                    0x384c9b3e2c7993a9,
                    0x1040f0575a1d8812,
                ])),
                Felt::new(BigInteger256([
                    0xa4febb2f51b5af54,
                    0xf9eca9af19af1334,
                    0x1b7aa31257494d40,
                    0x118edd82a2524f99,
                ])),
                Felt::new(BigInteger256([
                    0xb960362abdf98cd3,
                    0x5110a4f718fd67f1,
                    0xb24ef68bd81d03ba,
                    0x00dd51810b508433,
                ])),
                Felt::new(BigInteger256([
                    0xd6d687adf7195718,
                    0x2e20caf62c2bc56e,
                    0x689f60f087212d1d,
                    0x30665d37e7fc08a6,
                ])),
                Felt::new(BigInteger256([
                    0x396221d9abaf20da,
                    0xa7f9ef26d7433bcc,
                    0xd38f7f98feee22d8,
                    0x3fc672f2091bc4bf,
                ])),
                Felt::new(BigInteger256([
                    0x74203918dc299ac7,
                    0xe8c76f8a58a6b45a,
                    0x4c3778d9730d78f3,
                    0x300d9f199aa2f49e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x6a731fbac289dfee,
                    0xfc8b51529e2416fa,
                    0x896229c47154fb72,
                    0x049d850480845d79,
                ])),
                Felt::new(BigInteger256([
                    0x385bed600256d9af,
                    0x47956a7395162784,
                    0xc360cc1ee9d229c7,
                    0x14631a5de24c2f4b,
                ])),
                Felt::new(BigInteger256([
                    0xd439c56c30c43f9f,
                    0x354c0caf047e0a84,
                    0x51cbbe4fc4dc2a85,
                    0x317c3c47250074a0,
                ])),
                Felt::new(BigInteger256([
                    0xac1841bc3ae568e6,
                    0xac489560a172177f,
                    0x0fa740a51ca9ea26,
                    0x3b3fa74e7eb3d8b3,
                ])),
                Felt::new(BigInteger256([
                    0x830d9994ee0fd571,
                    0x184f0938899e2e53,
                    0x73d4e7652352c24a,
                    0x11b6665695d44f8e,
                ])),
                Felt::new(BigInteger256([
                    0xcbef12dc4d84e636,
                    0x4ed5b3086e19c786,
                    0x14952dd3d0333e2c,
                    0x0c101bb7ad448c6e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x555d7182a6ef9c59,
                    0xb2416b388ecdf88a,
                    0xb0ba48df55848f61,
                    0x206dce5aca17d469,
                ])),
                Felt::new(BigInteger256([
                    0xab20e818bf18ee61,
                    0x22edd0008f13d121,
                    0xabff6894b3e6e972,
                    0x286456461cfc20a5,
                ])),
                Felt::new(BigInteger256([
                    0xa701205b7e134d94,
                    0x9f7e903a778ee341,
                    0xf484b2e29b3ef7ff,
                    0x1c9d0846f94fb285,
                ])),
                Felt::new(BigInteger256([
                    0xc1098e687b7a0e04,
                    0x29363f94c64d95cb,
                    0x15631dfd7c914736,
                    0x24044bdaf72bccb6,
                ])),
                Felt::new(BigInteger256([
                    0x46c55b192dbcf51a,
                    0x805aaf586a3a0636,
                    0x9a28a624fba60fcd,
                    0x1a492e10373340cf,
                ])),
                Felt::new(BigInteger256([
                    0x8c1e4d6488e8849c,
                    0xcc4b255ef96057f2,
                    0xce31962026a230ce,
                    0x24726cb64639c6d6,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0424dd02e3eeba50,
                    0xcd64c0725cd86201,
                    0x6a19dd29dab18ebc,
                    0x32183dda480b30de,
                ])),
                Felt::new(BigInteger256([
                    0x8bb5d30d925086db,
                    0x877bbfc03c3b57d3,
                    0xa7af87981696b7dc,
                    0x1c12d53b86bd1450,
                ])),
                Felt::new(BigInteger256([
                    0xb86e4c66397c8764,
                    0x64bc17070ff4a0fb,
                    0xa2c6ed85553966d4,
                    0x146c8f07f8963ff9,
                ])),
                Felt::new(BigInteger256([
                    0xf71276d8d3f67855,
                    0x376d9ca9c7d9ecf9,
                    0x04eb82a980dca1e1,
                    0x2bb1775297a0c868,
                ])),
                Felt::new(BigInteger256([
                    0xde82f5526c1c8358,
                    0x682549d19188f1e6,
                    0x5beb375eba8baac6,
                    0x1ab171996a64fabb,
                ])),
                Felt::new(BigInteger256([
                    0x865c5794fae6d6f9,
                    0xdcf8f37b2f981b0f,
                    0x56f9b163a3b9fc3d,
                    0x0e184d08011b905f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4ce9ea0edb68d27a,
                    0x555db1c052081123,
                    0xd9bf8ea3bda59bfa,
                    0x3da36fbb44a43caf,
                ])),
                Felt::new(BigInteger256([
                    0x8e94c332cf44fef9,
                    0xc1ff358675f8dd10,
                    0xfbd3a86f6ea0a294,
                    0x0d30a415b7cb2616,
                ])),
                Felt::new(BigInteger256([
                    0x133f00dc72a14249,
                    0x4f9959ede874970c,
                    0xb91d579271932808,
                    0x15be5b21d47888e9,
                ])),
                Felt::new(BigInteger256([
                    0x196578f855a82dc6,
                    0x3992fdfa7d60e4f1,
                    0x424c483982703ac1,
                    0x13bc7f12858ebc9c,
                ])),
                Felt::new(BigInteger256([
                    0xf623286c9814d8d9,
                    0xfd3ba7663b01e80a,
                    0xf80d5a4babb11e65,
                    0x2af7457e699a60cc,
                ])),
                Felt::new(BigInteger256([
                    0x69576671d6764973,
                    0xbe938b1ab0968bd4,
                    0x0ee836b0145380c3,
                    0x22ac6545a2274ed7,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xaac24fcf445fff96,
                    0xc1f839f02281ffac,
                    0xf0c6eef85f266793,
                    0x2378fba46067bc5a,
                ])),
                Felt::new(BigInteger256([
                    0xadc979876fcc0354,
                    0xe181bb294e9d0004,
                    0xa032c0496a9b3a4c,
                    0x35e48bf01cbcb942,
                ])),
                Felt::new(BigInteger256([
                    0xffc751dcd74bb24e,
                    0xb31e91f205640880,
                    0xf69d96b9bcd928de,
                    0x21baece50eb50645,
                ])),
                Felt::new(BigInteger256([
                    0xf82c560d5560a7cb,
                    0x55ec8ae86b8a3a5b,
                    0xf0ee2587bcc4e8b8,
                    0x0972fcff851ca8e7,
                ])),
                Felt::new(BigInteger256([
                    0xaa2a2ecb9326660e,
                    0x8fe99565c1ac4c6d,
                    0x1b9ca03c2a75564c,
                    0x2324f9488b5c18fe,
                ])),
                Felt::new(BigInteger256([
                    0xebdf337c40ffef61,
                    0x9c27a2c5572ccca8,
                    0xab491352d1f68361,
                    0x150412a2f0b5a71d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe6113814495a09ce,
                    0xe247c5375e95ab9c,
                    0xb0f274142869844c,
                    0x1a5e9028d783eacb,
                ])),
                Felt::new(BigInteger256([
                    0x8512ebf113e19008,
                    0x004c1d70016d4380,
                    0xf04b9701f2dc5e36,
                    0x20b3fbee3709e662,
                ])),
                Felt::new(BigInteger256([
                    0x68ae003dfc1d6e64,
                    0x36376b40ebfe30a1,
                    0x59c4299a3657947e,
                    0x3776689dea588e61,
                ])),
                Felt::new(BigInteger256([
                    0x4bc15422eaada6f5,
                    0x90bdc703a4499767,
                    0x1b84b66156126683,
                    0x0f5e449bacfb71d7,
                ])),
                Felt::new(BigInteger256([
                    0x8a964ed9278f7e73,
                    0x99292b9cfb3ee284,
                    0x80e6966fc1142ce2,
                    0x103dac8a422b8bb3,
                ])),
                Felt::new(BigInteger256([
                    0x5fab4efab21bc3fb,
                    0xada7a3e8ea2866e5,
                    0x256a1c268df9ef83,
                    0x20d8c6c2bc7baf70,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x99a92a9ef43d479f,
                    0xf0f22b2b11a4052f,
                    0xcb1a31421af09437,
                    0x2c18712b60f4f1ed,
                ])),
                Felt::new(BigInteger256([
                    0x3730a3e54888b529,
                    0x34bcf5d6367aa1a2,
                    0x5f42382b9aa3fb67,
                    0x0f82453b0da5c885,
                ])),
                Felt::new(BigInteger256([
                    0x91b80fc04793d803,
                    0xbbfffef01031d978,
                    0x1a82738bb36d48f8,
                    0x2d52d59a3d6b64ed,
                ])),
                Felt::new(BigInteger256([
                    0xbe540790e72ed0bf,
                    0x76a10474783880b5,
                    0x1fb24e71e8402cea,
                    0x3f6158084068a66c,
                ])),
                Felt::new(BigInteger256([
                    0xb7709720be3f8d59,
                    0x1c7ba7628d607142,
                    0xec205a583d4d887b,
                    0x34b0eb08033bfda6,
                ])),
                Felt::new(BigInteger256([
                    0x7098466f7fbeb202,
                    0x1fe87bae991e5721,
                    0x1765d85314633b45,
                    0x1e2569925c50f241,
                ])),
                Felt::new(BigInteger256([
                    0x554b6750bf013047,
                    0xa304ecf3c4d04dd2,
                    0x9dba7d06e311ff0f,
                    0x05f9d29491deaf8c,
                ])),
                Felt::new(BigInteger256([
                    0xaa0bbf6463387e77,
                    0xd45a821c4e98261e,
                    0x48212c721a2be32a,
                    0x37149b323e7d7c39,
                ])),
                Felt::new(BigInteger256([
                    0xab6df31fcf352bcd,
                    0x84186bfe63b331bf,
                    0xc02f1415fa41f6da,
                    0x03121aa5751f565b,
                ])),
                Felt::new(BigInteger256([
                    0x78e550724f5127cd,
                    0xe8d39f474251e41d,
                    0x3fb9e52c665b0dcd,
                    0x1ed38090e515b107,
                ])),
                Felt::new(BigInteger256([
                    0xab56c9925ae27cb2,
                    0x788bdd313166fdf2,
                    0xd347f0cb0eab6c62,
                    0x3936f195d0d4b609,
                ])),
                Felt::new(BigInteger256([
                    0xdae69e58be74ab9d,
                    0xf20855e8bca2e7e5,
                    0x1f4b5d8f661a8e9e,
                    0x13d1b8abd2d2839c,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x03bc5d4bfc8a60c7,
                    0xc9ddc04a6b90f646,
                    0x3b59007eeffbbb87,
                    0x13628817ea75d306,
                ])),
                Felt::new(BigInteger256([
                    0xa7735b0904160f08,
                    0x7f3df989e5c5775f,
                    0x92c19ceef43d0e9e,
                    0x0c783f22625be416,
                ])),
                Felt::new(BigInteger256([
                    0x5c9e2fe6e96cfa9a,
                    0x7036bfa286141633,
                    0x346d18ef0232fdc5,
                    0x04c1fbfc565ed8a8,
                ])),
                Felt::new(BigInteger256([
                    0x655abe65baf5b7b6,
                    0xf1c9275e75cb3b7b,
                    0x005cc9c7f38e0043,
                    0x28f674b3eeaf9a54,
                ])),
                Felt::new(BigInteger256([
                    0x64f81fe7632fca9a,
                    0xf7c05ccc5c15da24,
                    0x27261a5f6d3b281e,
                    0x1da622b55a064224,
                ])),
                Felt::new(BigInteger256([
                    0xd65027c92f5965d8,
                    0x3b8eacdf657975d4,
                    0xa9d8068da9a6dae4,
                    0x188dc1d0e3c3293f,
                ])),
                Felt::new(BigInteger256([
                    0xb435f8d5ac4e6505,
                    0x31a05b66cc7ba584,
                    0x50168f0230917521,
                    0x2ada627f5fde91b5,
                ])),
                Felt::new(BigInteger256([
                    0xe911baf3e1dc0826,
                    0x1c4b9749b0e1d13f,
                    0x0c043aadf6905080,
                    0x22ada627c07e60ab,
                ])),
                Felt::new(BigInteger256([
                    0xedabf0cbf2f2961d,
                    0x96cb9419861bb32a,
                    0xab3a5134daa58e82,
                    0x0b0b5360f35e67fc,
                ])),
                Felt::new(BigInteger256([
                    0xb45b3d298991d070,
                    0x0d71ef20f9ef17e5,
                    0x6d62d473d2f9fb54,
                    0x2aebfd8447b47301,
                ])),
                Felt::new(BigInteger256([
                    0x77e7a504eec9ce48,
                    0x71896fbfda6151fd,
                    0x42cf8908d906f54f,
                    0x0fffab17537d6f7d,
                ])),
                Felt::new(BigInteger256([
                    0x987767f30caac093,
                    0xa23e67282adf0274,
                    0xca87a7c51c7b0f8d,
                    0x3b5a0d20480f89cc,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x2c6ca1a71316d3dd,
                    0x81945cc8de94e6c9,
                    0x1dcdea76eb98baa5,
                    0x3929468e7c7b0b88,
                ])),
                Felt::new(BigInteger256([
                    0xfaa9138c6a85cd1d,
                    0xd2c9ed25952103b4,
                    0x7cad7f60084839ac,
                    0x2c9d26b9eb99804f,
                ])),
                Felt::new(BigInteger256([
                    0x58f57f0a843b8c50,
                    0x23fb499d1093dc90,
                    0x1feff40a9f3d87f4,
                    0x256c24977db56e82,
                ])),
                Felt::new(BigInteger256([
                    0xaf3eccb811ab08cf,
                    0xa4a28389142ddfbe,
                    0x66043c25cff71b26,
                    0x14ac0147e0419340,
                ])),
                Felt::new(BigInteger256([
                    0x2158d117368a402d,
                    0x15b2837a59a41f6a,
                    0xcd2a5f03525b1c25,
                    0x3b8f229ec1d24258,
                ])),
                Felt::new(BigInteger256([
                    0x7d3dbb2adaab0dca,
                    0x20cf6971b301f909,
                    0xa06339552c8d08ae,
                    0x06a960e5492c7dd5,
                ])),
                Felt::new(BigInteger256([
                    0x9572f063ec6812ed,
                    0x4abd96ff7364d4c0,
                    0x88cc5f964c402bc6,
                    0x2482428f2220f288,
                ])),
                Felt::new(BigInteger256([
                    0xa3db892a8f11a6b6,
                    0xb305cb87eedac4af,
                    0x81f8ecd54d40dfcd,
                    0x2e097afeeaf5722f,
                ])),
                Felt::new(BigInteger256([
                    0xced6233ec2d55dc4,
                    0x71f6ca77dbd48398,
                    0x18268c31f2e7b778,
                    0x2e0279f70c7ae1cf,
                ])),
                Felt::new(BigInteger256([
                    0x25a492b8cf4390f5,
                    0xc9777cb09a4bfc62,
                    0x93493c4ff2ab8fae,
                    0x17c9311934eed15f,
                ])),
                Felt::new(BigInteger256([
                    0x13c31c542001ce59,
                    0x6b44b2b5e085f5ae,
                    0xe3b8c6380dc9f005,
                    0x2be0b7292c234cd3,
                ])),
                Felt::new(BigInteger256([
                    0x2dc81479407a0ba1,
                    0x7b1196452b67d778,
                    0x3c2942d30137cda8,
                    0x3262898ebfc8f8b1,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xf712b582a77b86fd,
                    0x1d3ff1b53e4028a1,
                    0xb81790e6f8ff9a87,
                    0x1a929137c02c0470,
                ])),
                Felt::new(BigInteger256([
                    0xf8e82cb2d20e165b,
                    0xd651694602228700,
                    0xcb8eeecbe0661ad6,
                    0x2c23b67c8caa0333,
                ])),
                Felt::new(BigInteger256([
                    0xe1ba4ed1972a89f1,
                    0xb68d92b5cec23c57,
                    0x4ee49d646a4cd326,
                    0x1174b9ec51de75d8,
                ])),
                Felt::new(BigInteger256([
                    0xf778125fd27bf4b8,
                    0x90969c91988d19f6,
                    0x0e3d54a4582e8c10,
                    0x35bbfa23496ab692,
                ])),
                Felt::new(BigInteger256([
                    0xce78894b08912e9c,
                    0x9f97272a29f29a63,
                    0xb8775b1bfcc52d19,
                    0x0cbdc1082a4bbdde,
                ])),
                Felt::new(BigInteger256([
                    0xcd29dd04c922037c,
                    0xdcf02945f337e287,
                    0x2794cf7bb30589e7,
                    0x0ebcbde8db64f5bc,
                ])),
                Felt::new(BigInteger256([
                    0xdf3f39a7290b4f1a,
                    0x29a1bccc0bbce9d6,
                    0x5da3ae518c0cce7f,
                    0x138a107057844a11,
                ])),
                Felt::new(BigInteger256([
                    0xf21840e2534eb6a0,
                    0x661cae4940d5fdc0,
                    0x1305d87b453d0da3,
                    0x282583a12d93680e,
                ])),
                Felt::new(BigInteger256([
                    0x1d45e01bf61a052d,
                    0xdfd68aa5029af8f1,
                    0xaa313b8249987038,
                    0x0786af16bc37c8b0,
                ])),
                Felt::new(BigInteger256([
                    0x0f2924e2299bb39b,
                    0x6c6fa278fb35f8a0,
                    0x83d8293606d78801,
                    0x3e9192ddfb9528cc,
                ])),
                Felt::new(BigInteger256([
                    0xa4cf4aa87f8e5317,
                    0x71f9d48aeef0705b,
                    0x97eeeee2fdf0b8a8,
                    0x0ed4c81c1cb688f9,
                ])),
                Felt::new(BigInteger256([
                    0xd7c7650f88f978ec,
                    0x1ac7f75ad019dc1b,
                    0x62536afc4b73076a,
                    0x37e699b600a1785f,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x9347ae6620ddc19b,
                    0xc2b6c5bc9de9e49c,
                    0xf89d07cd5215add0,
                    0x28e6cfaefb80f159,
                ])),
                Felt::new(BigInteger256([
                    0xdbf300dd9973af79,
                    0x32d5d85656dbe825,
                    0x55e643072d7899cb,
                    0x1acdcb18a1817590,
                ])),
                Felt::new(BigInteger256([
                    0xc6d2db0c1dd46cb1,
                    0x67e84736b2d55f5d,
                    0xc2fd180ae288c4d6,
                    0x398b71d202302393,
                ])),
                Felt::new(BigInteger256([
                    0x35a0a263b441781e,
                    0x327f2f89c37f10fc,
                    0x71a4fb8c503bafac,
                    0x09a7207bb6b290fc,
                ])),
                Felt::new(BigInteger256([
                    0xcb0dcd44fd02c52b,
                    0xebaa00271c563d8c,
                    0xa96ea1e0722d4618,
                    0x36b52497cc2eb974,
                ])),
                Felt::new(BigInteger256([
                    0x761b820cc213f512,
                    0xb4ba4a895de3ba73,
                    0x664415b68a5c368e,
                    0x0a61f15889fe8bad,
                ])),
                Felt::new(BigInteger256([
                    0xdc572ba2165eb305,
                    0x79edf426ae388d18,
                    0x6c9b00986bba788d,
                    0x3d86043f401f2c2f,
                ])),
                Felt::new(BigInteger256([
                    0x18440bc76426e2c1,
                    0x839edf8a6f259d51,
                    0xfef90e866c131a73,
                    0x13d971ed9c64d2b5,
                ])),
                Felt::new(BigInteger256([
                    0x8c5d8f783d4c33d0,
                    0x20a55cba0cdc6482,
                    0xbf11f6f58abaa63f,
                    0x0185c6a8be7cbe80,
                ])),
                Felt::new(BigInteger256([
                    0x5a40907ac4e0c198,
                    0xbae691f68c41f20d,
                    0x33f5182f87a8e2d0,
                    0x3f384aa0d8e8def9,
                ])),
                Felt::new(BigInteger256([
                    0xa15644da53424082,
                    0x05723e17f449e5e4,
                    0xaa4fce9de22d8f5c,
                    0x1e6a107e18da86be,
                ])),
                Felt::new(BigInteger256([
                    0xd548f708112d4c05,
                    0xf04a449dc62a3eea,
                    0xb094d4e887e08e8f,
                    0x19642146dfe27b1b,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x4cb48057fa0f27f5,
                    0x06f30bf6f9fd90f8,
                    0xca9955290b058dc2,
                    0x0891dcc6b3494d31,
                ])),
                Felt::new(BigInteger256([
                    0x18f50d865ade6a89,
                    0x66afdaaf595f2051,
                    0x1854887fb87f09fa,
                    0x29fcfbcd50bd3318,
                ])),
                Felt::new(BigInteger256([
                    0xc62e2b694218f9e1,
                    0xcbb750a21dc6fc85,
                    0x2f16280313b3a450,
                    0x2f84a81ff50613d8,
                ])),
                Felt::new(BigInteger256([
                    0x36130f10cf4d13aa,
                    0xb1b046f2c8550464,
                    0x8b3bbe08ec79b42a,
                    0x26a6a5a679584275,
                ])),
                Felt::new(BigInteger256([
                    0x1d2c202e8d876b40,
                    0xfa0a8300c0f3207f,
                    0x0e3b6bb07fd19f51,
                    0x387ef968bb3d16d7,
                ])),
                Felt::new(BigInteger256([
                    0x33614e091c8d92de,
                    0xd6aa8ad5a76db6a6,
                    0x477f753376b9641a,
                    0x04907c71476f7a2c,
                ])),
                Felt::new(BigInteger256([
                    0x5b2fbcfbdcdf7f4a,
                    0x6800948cfff8d0d7,
                    0xad167927034039d0,
                    0x19a3e10a4db534a0,
                ])),
                Felt::new(BigInteger256([
                    0xa30b3652d53c1378,
                    0x3916f6e24e930ddd,
                    0x6a7bd72eb086ea3c,
                    0x24c6e1a02027f979,
                ])),
                Felt::new(BigInteger256([
                    0xecf47685faf5c995,
                    0xb8d6883c41bea122,
                    0xaaeca210c2cd5044,
                    0x03fa39a09bd00582,
                ])),
                Felt::new(BigInteger256([
                    0x906dd6b4b37aed9e,
                    0xda1f660f8ebcaa56,
                    0x983dd9ec28d2e102,
                    0x3b2c69d106bcfb7c,
                ])),
                Felt::new(BigInteger256([
                    0x510c54786099dd2a,
                    0x50cbfe2bf9cfafa0,
                    0xe0c2ec87f7ab5613,
                    0x0344f8372780dc72,
                ])),
                Felt::new(BigInteger256([
                    0x770bf6e23a93bf15,
                    0xa9c13c7589c7206b,
                    0x3acf561c10da0f87,
                    0x38795ce918cbe79b,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x3c958c6ecc10f281,
                    0x6dfacc1ce43cafa1,
                    0x00456b81cbefe2e3,
                    0x3d6ec57f0adeb216,
                ])),
                Felt::new(BigInteger256([
                    0x529311a7511902f9,
                    0xdc99ff5b1819af4a,
                    0xad2dafdee33422c9,
                    0x0a74a75fe95467b0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x6c8431200c68ed75,
                    0xa1ed73e8e60052e5,
                    0x9c43a35691c84587,
                    0x223d16ef2b0f20eb,
                ])),
                Felt::new(BigInteger256([
                    0x63ffb0e3cbfcfefc,
                    0xcae670dd98b2a03f,
                    0x59910a44ab297d2d,
                    0x0c198574c2bff958,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xcba5b5e9dbed5be4,
                    0x79a86afad19ba3d7,
                    0xa89a9a07722e629d,
                    0x3c3aa5e8874c3394,
                ])),
                Felt::new(BigInteger256([
                    0xb2ce01d49fd320d6,
                    0x7d40c0ca076354c2,
                    0xba22b40c303357ef,
                    0x3b811a8535008f31,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x54f13fb434a95ff1,
                    0x015534a875738644,
                    0xbe2b11630384ba3c,
                    0x10e4b4ca6e89d105,
                ])),
                Felt::new(BigInteger256([
                    0x63ae90d524f8a132,
                    0xee8e4b3394ece420,
                    0xd0517cdc5177f351,
                    0x3202d9d424f14cdd,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x33ad8b0e2b58b5d3,
                    0x8a829555a0ab0e2f,
                    0x63f9e95d699b5b6d,
                    0x041b0309693b6ea7,
                ])),
                Felt::new(BigInteger256([
                    0xef49ae4f8c6d0913,
                    0x2c682843bc3d3d4d,
                    0xa5d8da92e5584497,
                    0x273ad60ffd0dcf2c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x57c6586d995a5e45,
                    0x2e5cbe0a46d54aa1,
                    0x5723a61281df99ea,
                    0x35f0a95346117178,
                ])),
                Felt::new(BigInteger256([
                    0xd406b9356229f883,
                    0xccea1967dca6f6bc,
                    0xdb3f9d6b343004d5,
                    0x0773d1c09fcc3712,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x73b8794e0f72b332,
                    0x221763a413c5e6a3,
                    0xadcc1468a2e3e6c3,
                    0x2a129ef740ca1b53,
                ])),
                Felt::new(BigInteger256([
                    0x47ffcbe989a44777,
                    0x187c16ab98c85474,
                    0x0bcaeb4d87e1f70c,
                    0x0796d0cb6ad5fc1b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4d67ad51e4d177ac,
                    0xe2ef60f95c94af8f,
                    0xabba6b3a29833a50,
                    0x1bbb01fa62e33e02,
                ])),
                Felt::new(BigInteger256([
                    0xe647d7512336c6c9,
                    0xa5d989f3a5d46ad3,
                    0xea95bfa3003f51d4,
                    0x2edc079f41b0803f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x26e522811083413c,
                    0x5188f8885390b28e,
                    0x782c091530ee0bbd,
                    0x03c562d4417d910f,
                ])),
                Felt::new(BigInteger256([
                    0x059a27ea779527b1,
                    0x5b3b536704a5ec07,
                    0xe100ff07a29f36bb,
                    0x16ea51408e730da5,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb4a71fa8f2c23ce6,
                    0x3554873bbbec907a,
                    0xc362de0158077c39,
                    0x3013acebd03e370b,
                ])),
                Felt::new(BigInteger256([
                    0xceaee5306e064cc8,
                    0x73bb1d3ddea0071f,
                    0xaabacabae309da06,
                    0x231a2da06c55bd7a,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 6));
        }
    }
}
