use super::{sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 2 elements (64-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 13 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 13;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2 + y2.double().double();
        *t -= beta_y2;
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2 + y2.double().double();
        *t += beta_y2 + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x3d2e2ddfa3399f52,
                    0x279e3b1f754f9be2,
                    0x2bd417966c98c03d,
                    0x289ff6d99ac7a8ad,
                ])),
                Felt::new(BigInteger256([
                    0x63f86ec45d625a8e,
                    0xdfed9969b8b5e15c,
                    0x9c97ce5af896a251,
                    0x274d1604742c22b0,
                ])),
                Felt::new(BigInteger256([
                    0x1b2c26d915836f52,
                    0xec50db29f32fcbcc,
                    0xa631a4621151ad72,
                    0x0670e65f1ef3d426,
                ])),
                Felt::new(BigInteger256([
                    0x98cd41f95a26c322,
                    0x12283ab88b02219d,
                    0x5aba422b21c74cd0,
                    0x1165defbfd3a27a2,
                ])),
                Felt::new(BigInteger256([
                    0x404ae6d76d1677d4,
                    0x194fe04fa96dc8ce,
                    0xb12d3c5781f2ec13,
                    0x0e48abf4544695e6,
                ])),
                Felt::new(BigInteger256([
                    0xa0e1bbca093d1171,
                    0xb226d8c4a3c312a3,
                    0xb5fd29fa8f2e6bc7,
                    0x34923a450a218028,
                ])),
                Felt::new(BigInteger256([
                    0xd22f570f6f050d9b,
                    0x39417c4513c37a7b,
                    0x9db957a04d83d503,
                    0x31180ec508c6f72a,
                ])),
                Felt::new(BigInteger256([
                    0x90183a2d2a1b4b6b,
                    0x6b02e76f3db49fed,
                    0x3ff0046be9078641,
                    0x2671c929ced7a769,
                ])),
                Felt::new(BigInteger256([
                    0xc8248bca121a4670,
                    0xc9cf483ba15f1ec3,
                    0xfba16826ac9329ef,
                    0x3c9ac93d6f431771,
                ])),
                Felt::new(BigInteger256([
                    0x7fcc5a64f592f9aa,
                    0xc57c61c5895c9591,
                    0xaab704ced17a83e6,
                    0x27abdae16e6bc6d4,
                ])),
                Felt::new(BigInteger256([
                    0x355c42a571261769,
                    0x397b47631555ad4c,
                    0xfa6e3537a00e0e13,
                    0x2d8e90258cabe5ca,
                ])),
                Felt::new(BigInteger256([
                    0x9f0cd9eec4ab2753,
                    0xcf5cec10459e3996,
                    0x31d48bb13e61e6ff,
                    0x3c4f001b160db384,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xabe8000e10794c2f,
                    0x2cbc4a16c90cbf19,
                    0xec302b0733e449e0,
                    0x1dce0e84240da39f,
                ])),
                Felt::new(BigInteger256([
                    0x96731bdcf9178d42,
                    0x6b92a67263529f44,
                    0xa14e36c45307345a,
                    0x22046839c177c9ad,
                ])),
                Felt::new(BigInteger256([
                    0x144181132a7717b6,
                    0xe14e7b55b1049199,
                    0x453c0bd2b88d21f2,
                    0x08b6d667b122d618,
                ])),
                Felt::new(BigInteger256([
                    0x0b3eeb47a0d9429a,
                    0xf279fbf20124f565,
                    0x0bafe460c5c04fc6,
                    0x1c033fa9b92c5ec8,
                ])),
                Felt::new(BigInteger256([
                    0xc47da914de36fa86,
                    0x83468d95bb3a8c1b,
                    0xdc811cab19aa7986,
                    0x033a37df8fa3f51b,
                ])),
                Felt::new(BigInteger256([
                    0x1f0840ce4807699d,
                    0xe4f3213227587440,
                    0x75eeed07c7418834,
                    0x11b65ffe6581d2e7,
                ])),
                Felt::new(BigInteger256([
                    0x3ab07d6f8be13a16,
                    0xfd3c9ee751d26d1d,
                    0x22a4b2ed892943fd,
                    0x01a4fd9a5986ef5d,
                ])),
                Felt::new(BigInteger256([
                    0x76aaae886af92c81,
                    0x8bc35ee349f61d85,
                    0x148dd6645be6836f,
                    0x3a4cd9c717f2b400,
                ])),
                Felt::new(BigInteger256([
                    0x9c44e40bf8a973db,
                    0xa45832c985f80c5d,
                    0x4ec99c3bfb6dba87,
                    0x01b4141e46ad21bc,
                ])),
                Felt::new(BigInteger256([
                    0xceab54abfc70b8ba,
                    0x6ad9e7f8677d198a,
                    0x85c456e9d6329e6b,
                    0x04b843c496cc44fb,
                ])),
                Felt::new(BigInteger256([
                    0x23e9891f2b0e41c9,
                    0xb2979081f9fe3902,
                    0x46f05c15f97b1eaa,
                    0x094153911c64d394,
                ])),
                Felt::new(BigInteger256([
                    0x1cad47d0e7cce6d5,
                    0x2c7f68e41bf2f238,
                    0xabfb48321218d8ce,
                    0x36c2fd234721a43b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x43a536fba3ee1e76,
                    0x133599d4591ac229,
                    0xed90e25216ed96cf,
                    0x17a70f909e7de866,
                ])),
                Felt::new(BigInteger256([
                    0x8cd625ccc6ce9cea,
                    0xfcce917476b3aac8,
                    0x3023fa05fbd2c72d,
                    0x2b29726c077c6324,
                ])),
                Felt::new(BigInteger256([
                    0x9410b39f1cead9a1,
                    0x3ddd20613f0abdbd,
                    0xbccbe60aff6c0064,
                    0x1cdfbb3a5127c858,
                ])),
                Felt::new(BigInteger256([
                    0x435dd881273e99c9,
                    0xf2f18d0194ea34a8,
                    0x79f7d6561bec9b56,
                    0x1b10847c2a54e28d,
                ])),
                Felt::new(BigInteger256([
                    0x65c242dab58a1c56,
                    0x05faae459a63b62b,
                    0x229b5a0c30ba001c,
                    0x2e76a1a698c9affb,
                ])),
                Felt::new(BigInteger256([
                    0x0cadb5f157aece80,
                    0x62b654e558839cf8,
                    0x6b7c2c322ef11088,
                    0x2b0e5b15a99d8828,
                ])),
                Felt::new(BigInteger256([
                    0xdeb3c4086bdda5d3,
                    0x2ce0ae1fab608d77,
                    0x04a77fabf89ad6a7,
                    0x39afaa1f0942b2c4,
                ])),
                Felt::new(BigInteger256([
                    0x7f21438a8702398b,
                    0x5a8dc940f88ca805,
                    0x402aab3ae7cc5baa,
                    0x367f6fc9818acb08,
                ])),
                Felt::new(BigInteger256([
                    0x15612be71673a4ca,
                    0xbae7e62763a6fcec,
                    0x7bec16dc7c2f901b,
                    0x004c7081004477b7,
                ])),
                Felt::new(BigInteger256([
                    0x2c38f87ce69934e4,
                    0x75e76f6f755f42a4,
                    0x0f56dd18f09ae1ff,
                    0x2037d291c3ca5a7b,
                ])),
                Felt::new(BigInteger256([
                    0xaa43799900e66afd,
                    0x61d60ae52225526f,
                    0x9db54b0c2638d709,
                    0x22d7f25b1804859b,
                ])),
                Felt::new(BigInteger256([
                    0x7bd9212e10d2b9be,
                    0xe8fab313422f2133,
                    0x1120bdbac559df3c,
                    0x0ebe2eac34a76a29,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0544ae725e9aa7bb,
                    0x342682469f359f51,
                    0xf503b710a4535000,
                    0x2e66659db66ba7f7,
                ])),
                Felt::new(BigInteger256([
                    0xdb08c622d7a44595,
                    0xa864b914d27c8166,
                    0x0810e8d9cf2897ed,
                    0x22b4385b5bc18938,
                ])),
                Felt::new(BigInteger256([
                    0xc2fdfe8b8e744dba,
                    0x9df87e8312f7b192,
                    0x5ff039fc2278219e,
                    0x0ea9e3b8f80dba6e,
                ])),
                Felt::new(BigInteger256([
                    0x9a1ea2dd86684351,
                    0x3c0bd7c023b77915,
                    0x48d67e39c1a779f4,
                    0x2fcc2cf313edc248,
                ])),
                Felt::new(BigInteger256([
                    0x77bd5f335d156896,
                    0x25b7007ce89f05d6,
                    0x78b72667e36cfc81,
                    0x2707b8e3cc1f7235,
                ])),
                Felt::new(BigInteger256([
                    0x59f5ce667a1d5039,
                    0xcbb215f75fff1789,
                    0xe0fac9736de9bcc1,
                    0x1b7373ae57646a2a,
                ])),
                Felt::new(BigInteger256([
                    0xb21744a73238eaf6,
                    0x812e79ff26f303a0,
                    0xd6382b9ba62af11e,
                    0x397c9ba955018715,
                ])),
                Felt::new(BigInteger256([
                    0xe417e479fc86d6ae,
                    0x5e0b7b34938f1ffc,
                    0x5d2585db5d787880,
                    0x10def66e7b9319a0,
                ])),
                Felt::new(BigInteger256([
                    0x2476f475400b2254,
                    0x7ce3643552e77a2a,
                    0x217117aab57b5560,
                    0x14e53728070b69cb,
                ])),
                Felt::new(BigInteger256([
                    0xf3afe1369f26e81b,
                    0x94cdd71e1a664219,
                    0xb57f6b04364bdc18,
                    0x2446beee5c28c699,
                ])),
                Felt::new(BigInteger256([
                    0xf82e2fc257debde5,
                    0x79b8b7cfffe606f9,
                    0xd37cf34a56e05bfa,
                    0x2d76fb26123d4f1d,
                ])),
                Felt::new(BigInteger256([
                    0xe2de8fdff9b311e3,
                    0x84bcf0b0f31b9118,
                    0x963017a68d15e2b2,
                    0x175af71f53c49a27,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5f979279a3f2c2e7,
                    0x2ec7abc293be7a4a,
                    0xed2fb687761227c4,
                    0x3282defdf1c9d0cf,
                ])),
                Felt::new(BigInteger256([
                    0x1386e940e52ce8cf,
                    0x5983c7091e5069ef,
                    0x5490f3e75724e07a,
                    0x0ef4d0d77005d777,
                ])),
                Felt::new(BigInteger256([
                    0xbacce57140f27646,
                    0x24cfa1c172389df4,
                    0x10ec32712d8f6752,
                    0x36c022e7ee436590,
                ])),
                Felt::new(BigInteger256([
                    0xe93de3fad2325253,
                    0xd185906fdb769be8,
                    0x81fa949ce0e736cb,
                    0x3004719c24519299,
                ])),
                Felt::new(BigInteger256([
                    0x3909ac3b1bd93277,
                    0x6cc4668b2e3fb7fa,
                    0x2c8afc0e348c4905,
                    0x1cf3a3f6352ec0a2,
                ])),
                Felt::new(BigInteger256([
                    0x14c2f1c95f009561,
                    0x52f3a730674be58a,
                    0x90d4c1ef34fb7419,
                    0x357c65387571f83f,
                ])),
                Felt::new(BigInteger256([
                    0xa3bed8c956d62a0c,
                    0xdd5a96b93474e49d,
                    0xdc8c37b551a9bdb2,
                    0x15b4085c3fe49115,
                ])),
                Felt::new(BigInteger256([
                    0x70177a0bacaa9978,
                    0x1e5d3e3f7caaf266,
                    0xb1c64e83b8166ae0,
                    0x2169a6c5cb737af3,
                ])),
                Felt::new(BigInteger256([
                    0x83b7ed814dc83f06,
                    0xe430c9474589a68e,
                    0x2bdef1a7de791163,
                    0x2b78698bf89ca4e8,
                ])),
                Felt::new(BigInteger256([
                    0x254861ae1be4f312,
                    0x128c0bc8e3bdacdc,
                    0xa287f9f96bde4784,
                    0x291ed1f5805e18f6,
                ])),
                Felt::new(BigInteger256([
                    0xa39bf7a3be795513,
                    0x20903eebe8a06cf5,
                    0x30d0f42991d22807,
                    0x38e091460eaaa405,
                ])),
                Felt::new(BigInteger256([
                    0xeae6cddc3e87c7bd,
                    0x452e22d80587ad4a,
                    0xf775d97efdc0919a,
                    0x26668631b745f017,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x6304a36b239c31c4,
                    0x78f23452db4a929a,
                    0x496af919ee000b08,
                    0x0b952996b48a2ca4,
                ])),
                Felt::new(BigInteger256([
                    0x4ac58f445c221122,
                    0xcf0be06431c97b84,
                    0x3a75937afa97f5f7,
                    0x19cadecdefd83f4b,
                ])),
                Felt::new(BigInteger256([
                    0xea0fb93ee5d084c6,
                    0x2e223bca5b347198,
                    0x670d7406e453c457,
                    0x1b66e2ba3b598a76,
                ])),
                Felt::new(BigInteger256([
                    0x5144e015a84da158,
                    0xcc494689decc11ef,
                    0x120e30366a54b7ac,
                    0x26808e509b2a5e20,
                ])),
                Felt::new(BigInteger256([
                    0xf3a1d70a7d86f1e4,
                    0x15e7850f92b864c6,
                    0x2ecb2f18a4145400,
                    0x0bb1011090f09cf2,
                ])),
                Felt::new(BigInteger256([
                    0x36e91dee9fcc5add,
                    0x2fb3bf81b46bd976,
                    0x91db29db5b9c957e,
                    0x0d57e53b684dde8c,
                ])),
                Felt::new(BigInteger256([
                    0xf184bf96c94bd9c2,
                    0x4f21ea3d9f6e2fbe,
                    0x1ff610a068183800,
                    0x3b9a36d69cc98ff4,
                ])),
                Felt::new(BigInteger256([
                    0xc09154820546ed74,
                    0xb1ac40a6de45d37c,
                    0x7d134f965c3f7350,
                    0x15afdc4456f7caed,
                ])),
                Felt::new(BigInteger256([
                    0x08b4d9978b5577cd,
                    0x2b7706bfb01baa8c,
                    0x89634700d1c057b1,
                    0x3786f0cf4b6759c2,
                ])),
                Felt::new(BigInteger256([
                    0xcd9508b2180039f2,
                    0xa1ce33bfd3da4555,
                    0xba0b1218d2a4554f,
                    0x0fbb27bc777b60aa,
                ])),
                Felt::new(BigInteger256([
                    0xdeb0b6d9d0e31ec9,
                    0xff976b2d90d7ae0d,
                    0x25bc354d153cb57c,
                    0x0b076abcb9ce03d3,
                ])),
                Felt::new(BigInteger256([
                    0x45a7366dc483c5c6,
                    0x3d473f2485455d99,
                    0x5a8e406d3c5393a2,
                    0x117ff6dd644d788a,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x116710a37371685c,
                    0xdc4135eff96b3adb,
                    0x0a0be7c120c11822,
                    0x04d3f13feb22b445,
                ])),
                Felt::new(BigInteger256([
                    0x5a9e5678f34b300e,
                    0x191c6f6b1674d25c,
                    0xd6972c5a2cc95fd8,
                    0x06c16cc2c6957268,
                ])),
                Felt::new(BigInteger256([
                    0xf2da31e672704c00,
                    0x48158c4f2f4086f7,
                    0x93d6bcc966f4aec5,
                    0x24cf97ffc1fbad22,
                ])),
                Felt::new(BigInteger256([
                    0x621b678f2d780930,
                    0xdd4a88131e166692,
                    0x83030a26a510ad83,
                    0x1d91781a7ac36936,
                ])),
                Felt::new(BigInteger256([
                    0xf3471954e4a0c61b,
                    0xfb36014699ef0a6c,
                    0x1914c52501669646,
                    0x15f54ccaae55801d,
                ])),
                Felt::new(BigInteger256([
                    0x04a3bce132932fe8,
                    0x23dc304c0ae2794f,
                    0x193c2ba3393a9591,
                    0x19c645114948b34e,
                ])),
                Felt::new(BigInteger256([
                    0xfc2449e3286eaeb3,
                    0x8d937bf0cb864327,
                    0xb8db0486ec5c9f0f,
                    0x3d1bb52fd42a5f61,
                ])),
                Felt::new(BigInteger256([
                    0xffd9fca5bf0b31d9,
                    0x6e738c3949cc5194,
                    0xe42adab0fc021afd,
                    0x33523cfe3b80dbb9,
                ])),
                Felt::new(BigInteger256([
                    0x4da5846f67969b61,
                    0xa63d03241ec8cd41,
                    0x804e4f9b948f0528,
                    0x27de9ac3cd5a25ae,
                ])),
                Felt::new(BigInteger256([
                    0x05b8834d3722daa5,
                    0xa96a407d0f130827,
                    0x0c313e88626514c1,
                    0x097d3fa2d65df448,
                ])),
                Felt::new(BigInteger256([
                    0xf9ec48e3bca93762,
                    0x9cd50d8dd7f5533d,
                    0x9f024d441c2d5d39,
                    0x04d6a5d3f43b4b29,
                ])),
                Felt::new(BigInteger256([
                    0xd185c4ba1b9ff57a,
                    0x1ffbeb1f1a7eb32b,
                    0x4e0a9e4aec4b45a8,
                    0x2a3d42929869098a,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x79b71fb934dabb28,
                    0x2bea0b90a629517e,
                    0xe7f36ae383b42506,
                    0x3aadf008e9f09937,
                ])),
                Felt::new(BigInteger256([
                    0x3a7a7260fe34c42e,
                    0xfca77d6f1980adab,
                    0x1a253b38c74b0f7d,
                    0x3b1c40019a05be3e,
                ])),
                Felt::new(BigInteger256([
                    0xaeae3204ebbb4d6c,
                    0xc837bf6fb5cf01b8,
                    0xa20419705aec8854,
                    0x1fb027b038cec299,
                ])),
                Felt::new(BigInteger256([
                    0x270cb400a1e4d036,
                    0x7c3056a900de6833,
                    0x12c24431c34fd662,
                    0x25179c44b2be7012,
                ])),
                Felt::new(BigInteger256([
                    0x02cebb5da21a7188,
                    0xa371e3484c77d8f6,
                    0xb0ca873fa4d061cb,
                    0x33a7dcb2a6e9c395,
                ])),
                Felt::new(BigInteger256([
                    0x89ff3421ca07ef6d,
                    0xc04eafc79f4c9dab,
                    0x166ebaccafd33d1b,
                    0x1f0775525d1bc5b4,
                ])),
                Felt::new(BigInteger256([
                    0xf572f84da0d326f0,
                    0x3161c2e78f81b824,
                    0xa501f71dcb1762dd,
                    0x04a05dae64c3e8c0,
                ])),
                Felt::new(BigInteger256([
                    0x44ba33262b79bbfa,
                    0xb4c2dbeaef420619,
                    0x29da30d924003765,
                    0x26b446798cb10ee8,
                ])),
                Felt::new(BigInteger256([
                    0x84eab5c40017610c,
                    0xd1d31c53d1f50d6a,
                    0x3f60ee3a923082f8,
                    0x0babdef5a82d8094,
                ])),
                Felt::new(BigInteger256([
                    0x6fb1142d34cd99eb,
                    0x681a68f62dba0fe2,
                    0x919c37cd51461e2f,
                    0x0b4ed2a0ec1c79cf,
                ])),
                Felt::new(BigInteger256([
                    0xb5802f9979056a29,
                    0x2bf7ffd4c4fb4c8b,
                    0x5fb114eff5201b06,
                    0x22ece5a6ec2d41a8,
                ])),
                Felt::new(BigInteger256([
                    0xa69e045bbebd8f7a,
                    0x04e8bd82e063714a,
                    0x41dabc3dfca22daf,
                    0x1e3546f524119060,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4883166fa59447a1,
                    0xb25da407cb810acf,
                    0xbc35af62c6d26959,
                    0x3671a98a56dc2aef,
                ])),
                Felt::new(BigInteger256([
                    0xbdb92eec592565fa,
                    0x82e7725db5bb71dd,
                    0xd623d6406cbd2886,
                    0x1b3d525405183801,
                ])),
                Felt::new(BigInteger256([
                    0x092f2e1ca986c777,
                    0x80dbb1baedb784e8,
                    0xc8d3f27d9a20816a,
                    0x03047c3b01fcb0c7,
                ])),
                Felt::new(BigInteger256([
                    0x7794d860376d204a,
                    0x4b6b3964f6e5014e,
                    0x6a8c8e5a5bd19a10,
                    0x1df2be595c4f2155,
                ])),
                Felt::new(BigInteger256([
                    0x745de36dd1b0cbf1,
                    0x3f8d0f1b14148081,
                    0xaa74623c41fddabd,
                    0x1619b481ead702c0,
                ])),
                Felt::new(BigInteger256([
                    0x1e8b0919cc78a870,
                    0xd6dce62b9f827759,
                    0x094484938c5f1abc,
                    0x0355568e91442517,
                ])),
                Felt::new(BigInteger256([
                    0x5cb420f3bf97dbef,
                    0x92a60d29f32aadf6,
                    0xd99163d9fff2fdac,
                    0x353c9ef4ca78b99f,
                ])),
                Felt::new(BigInteger256([
                    0x01cfb6f3578188d1,
                    0x128ab2da00eda5c7,
                    0x1b2e6e9ad77bfe6f,
                    0x0c94e20b37695d3a,
                ])),
                Felt::new(BigInteger256([
                    0xabe2906621714690,
                    0x19a0e7dc6578aae0,
                    0x807782d1297804f0,
                    0x32ad3376fbbb9bb9,
                ])),
                Felt::new(BigInteger256([
                    0x1f7841a1078c4fbd,
                    0x96d5a3466ef9a64f,
                    0xf1bd7a2c8f1df256,
                    0x3e0ccb26fa9eaa76,
                ])),
                Felt::new(BigInteger256([
                    0x9be863733e0e5d93,
                    0x5fc860a694bc6523,
                    0x31b105731984ad24,
                    0x23b3157c9aef46cc,
                ])),
                Felt::new(BigInteger256([
                    0x21e5a6d2df89d2c4,
                    0xcf5fd11ee65d6969,
                    0x2e0535b88c36dd71,
                    0x0778e94083e475ea,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7ed8275026689782,
                    0x1119186a0acb873d,
                    0x1a542f77d2250236,
                    0x019ea3728eeccf28,
                ])),
                Felt::new(BigInteger256([
                    0x6a75a806ca5e4339,
                    0x235d7a0fad15a374,
                    0x20eb11ca2698a207,
                    0x3134e35622df0762,
                ])),
                Felt::new(BigInteger256([
                    0x5cc6046be6754a23,
                    0x81f6efbd2eedaae4,
                    0x9de36265d740957d,
                    0x2cd707813f59bd29,
                ])),
                Felt::new(BigInteger256([
                    0xa4b9f501fd8c94e7,
                    0x10151e8a59b03776,
                    0x6d9c5190e35fdb77,
                    0x08b1f79a772614ec,
                ])),
                Felt::new(BigInteger256([
                    0x9a1e7bc90c91c762,
                    0xbaf1c31ce22c5c4a,
                    0xc47433672a229b4d,
                    0x1336c0646de5ab51,
                ])),
                Felt::new(BigInteger256([
                    0x1cfdb95764d7f18e,
                    0xf4010620f3af4cdf,
                    0x5a49d3abb3d47f20,
                    0x25f0e0e335f763c7,
                ])),
                Felt::new(BigInteger256([
                    0x92085035229f40b5,
                    0xa8a39c324401142d,
                    0x58cf2ceb44823513,
                    0x2b5b6b9983ea6e82,
                ])),
                Felt::new(BigInteger256([
                    0xa900888b454b3613,
                    0x947f0869cc5f22b0,
                    0x9dba8b92924437a0,
                    0x297c5a2761387912,
                ])),
                Felt::new(BigInteger256([
                    0x0329e2001eca71b2,
                    0xcf993b00a7715e7a,
                    0x7875c79c78a13dd6,
                    0x14b69cb62a6a1bba,
                ])),
                Felt::new(BigInteger256([
                    0x9697e0a929cc8cd4,
                    0x2c40b75ae4e0621e,
                    0xefd3386f4b541b41,
                    0x1898881385b0f8b0,
                ])),
                Felt::new(BigInteger256([
                    0xc1a296b4e2eb47a6,
                    0xf2a9b722d9450672,
                    0x36461becd2735307,
                    0x37fc9cf5de7000ed,
                ])),
                Felt::new(BigInteger256([
                    0x3edfb31ac739be7c,
                    0x8b94a21615a01aa1,
                    0x1809cbe387c0213f,
                    0x21e31684bf4d01ca,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3aef26ee5987a540,
                    0x1307c74fc428e0fc,
                    0x07d17d1548d82444,
                    0x1390a767e4502e35,
                ])),
                Felt::new(BigInteger256([
                    0x47126e787855bc44,
                    0x21c2e04d5d7c2dfd,
                    0x5f6977708da45a31,
                    0x10aaac3b962dfca7,
                ])),
                Felt::new(BigInteger256([
                    0x4caaa761394857b1,
                    0x63fff763fbcbf7ab,
                    0x1d8b5a59fa8f2c23,
                    0x0334f5defed3495d,
                ])),
                Felt::new(BigInteger256([
                    0x90d0695af2fe072a,
                    0x31cf96dcb9482200,
                    0x6fa2d19e77cf67b9,
                    0x31a7dca02a2bd696,
                ])),
                Felt::new(BigInteger256([
                    0x7bd3d235eb15df7a,
                    0xb4293473b9e7c5b0,
                    0x631f92ab7b4438f6,
                    0x3a253df96c560821,
                ])),
                Felt::new(BigInteger256([
                    0x1f81b644df4d2332,
                    0x07fa61a5a899a382,
                    0xd82cbbea6e9f4fd1,
                    0x01c0d113e356c3f0,
                ])),
                Felt::new(BigInteger256([
                    0xe5019e981bdc8473,
                    0x5ef6bb4d11967d6e,
                    0x7b0bc099f5a6b46f,
                    0x06a0ca275140679a,
                ])),
                Felt::new(BigInteger256([
                    0xaa70545f81e29469,
                    0x7499f0bc7c83f926,
                    0xdf64ec3c74af4d41,
                    0x0a2778890c6e8c2e,
                ])),
                Felt::new(BigInteger256([
                    0xfcca39b3b557f674,
                    0x493ea1df2d8a8da3,
                    0x898758632a0d2f6a,
                    0x1c0ea1e283e4a5b8,
                ])),
                Felt::new(BigInteger256([
                    0x054f1738e60ec7f2,
                    0x8de2de429e1d27ba,
                    0xa9048b4dc8d50604,
                    0x31cad56f04c488ba,
                ])),
                Felt::new(BigInteger256([
                    0x058b3b938acb6cfc,
                    0x04696ae6a320dc21,
                    0x9c0cfcad495f0b94,
                    0x125aebd6c4b09fa9,
                ])),
                Felt::new(BigInteger256([
                    0xd8ab5d82025f702a,
                    0x0ce5fc7f64e7dc10,
                    0xbc872b9c222b74b8,
                    0x05526979ecb34dca,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x296caa46b9fcca96,
                    0xf0ec191551ac8c72,
                    0x370ff2d27a2b65e3,
                    0x0a709adaabc85794,
                ])),
                Felt::new(BigInteger256([
                    0xa76cab1aba42b9b4,
                    0x98dcf8281f0ff0ee,
                    0x693cafeeff1a72ba,
                    0x00fb53198bd1b142,
                ])),
                Felt::new(BigInteger256([
                    0x5535ca898bbff6a2,
                    0x7f2e6904a0a66a13,
                    0xb8cf43ec01e6f293,
                    0x1863d5d4321c09df,
                ])),
                Felt::new(BigInteger256([
                    0x653e797b41f3a072,
                    0xde176e08169f0f36,
                    0x6450f2bae729bd35,
                    0x150a058888cff502,
                ])),
                Felt::new(BigInteger256([
                    0x1d15619712e063d0,
                    0x778e8365df4cf473,
                    0x5b5bc65e7d18a683,
                    0x072a7f3b2116acc1,
                ])),
                Felt::new(BigInteger256([
                    0x5986e86670bd619d,
                    0xca0a475d87ccb3da,
                    0x802a416309077e5c,
                    0x1e0fbadefa3b334e,
                ])),
                Felt::new(BigInteger256([
                    0x8bf6608d7a86bfda,
                    0x8cc937704cdb0fa1,
                    0xe942b440f59a2f69,
                    0x2e94b8aee7003a3a,
                ])),
                Felt::new(BigInteger256([
                    0x138ad4f3cd0c2090,
                    0xc9810832785ccfb3,
                    0x7f6c019633898af5,
                    0x09688a652cded2b6,
                ])),
                Felt::new(BigInteger256([
                    0x1e2d83721fd11433,
                    0x7dcc698ffe3fd02b,
                    0xdcc7511b468dfa45,
                    0x0ecfc686b041dbf8,
                ])),
                Felt::new(BigInteger256([
                    0xdacd48d1220e489e,
                    0xe1803d8fe420d61b,
                    0x6116f1496e69ef15,
                    0x3df3696e42a9c1cd,
                ])),
                Felt::new(BigInteger256([
                    0xd42b234b2b4bb488,
                    0x959b8476e77c8eef,
                    0x83b09310d460fa2a,
                    0x29614f98197bc3f4,
                ])),
                Felt::new(BigInteger256([
                    0xa8f5b3b15968be04,
                    0x0916837bdf82d5ed,
                    0xe51f7160381b84cd,
                    0x3af904855ca2427f,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xbcd22e4d4965f613,
                    0xe16f09e586c9ef15,
                    0x7cd3a00a4c7b1f02,
                    0x24a37064eaa0adf0,
                ])),
                Felt::new(BigInteger256([
                    0x26303cc93c26fbd5,
                    0xc0b73a3a562e4298,
                    0xf8e7658d98cfee31,
                    0x293486ed230ec7ba,
                ])),
                Felt::new(BigInteger256([
                    0x86d74514d4a60e0a,
                    0x7dc03f3b428dd26b,
                    0xc8ce19f74a9da990,
                    0x36d3c04102ad2457,
                ])),
                Felt::new(BigInteger256([
                    0x4f50eef8d2834827,
                    0x054a88efb7ba1db4,
                    0x11c3777454421c97,
                    0x290b05e28b08314e,
                ])),
                Felt::new(BigInteger256([
                    0x289a0e05ca7f8488,
                    0x0c37dc27ae95da46,
                    0xdb9a1c933b4279fa,
                    0x18b1f4c4776bfe27,
                ])),
                Felt::new(BigInteger256([
                    0xf69fb77bfd54ac27,
                    0x1a06d75fa4e1023d,
                    0x0e623c7526989caa,
                    0x3e0700709bea55c3,
                ])),
                Felt::new(BigInteger256([
                    0xd50e01874dc33cd3,
                    0x9fdf7296f803c122,
                    0xf129d40c04ab7ed2,
                    0x2bbc1738fcbe2182,
                ])),
                Felt::new(BigInteger256([
                    0x0e16d5ff7c32fda0,
                    0x1d0db98907afaccc,
                    0x79ec4fb16da80572,
                    0x1b1c2f356e79d893,
                ])),
                Felt::new(BigInteger256([
                    0xe3a9af98cf2c2b3b,
                    0x0f8380c87b316b9d,
                    0xb53a1be3a67a3e31,
                    0x2f276fe9f98bc71b,
                ])),
                Felt::new(BigInteger256([
                    0x7795e5f61bba4f18,
                    0x3cac51330559522d,
                    0x04f0aae4084ccb18,
                    0x29972882c654483d,
                ])),
                Felt::new(BigInteger256([
                    0x59a158ab26411ddd,
                    0x492aaa34953d0a47,
                    0x564ad5a4289d6a1c,
                    0x35c1d041ec9a76a7,
                ])),
                Felt::new(BigInteger256([
                    0xd821c1291b6e90af,
                    0x1b07fb6e2d77a9fe,
                    0x1bfbc9fa55d923b4,
                    0x031b6d212b3af220,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x48723304d66f2a65,
                    0xdd688f99f9521872,
                    0x807673f26f47a8e1,
                    0x0d767d31e20476ff,
                ])),
                Felt::new(BigInteger256([
                    0xe8262da993075eb2,
                    0x11aed0e0d237069d,
                    0x96d6f3360773b4d4,
                    0x01728d194027bd67,
                ])),
                Felt::new(BigInteger256([
                    0xc0ab6f962f49a245,
                    0x1bdb961ceb3b0f0c,
                    0x812716c6dff70514,
                    0x1a9302c895b5dbf3,
                ])),
                Felt::new(BigInteger256([
                    0x9f10c37ff0ec96a7,
                    0xb81101c7bd562706,
                    0xce28eebd025c174e,
                    0x31d7f9c5e22fec72,
                ])),
                Felt::new(BigInteger256([
                    0xe9ca5aa7a75172de,
                    0xbcc1d54274fcc455,
                    0xc5047ca7e29484be,
                    0x388ea8e4ee5aa265,
                ])),
                Felt::new(BigInteger256([
                    0x68674041ac3d297b,
                    0xa9b03c907e2715c6,
                    0xde57d8be3ea7f237,
                    0x26693fd948a7897b,
                ])),
                Felt::new(BigInteger256([
                    0xb84d69709ffbe738,
                    0x09b4c7cd8d22fdb0,
                    0x0c9b7fd7f52cb1e0,
                    0x2543fdf456e1c7b3,
                ])),
                Felt::new(BigInteger256([
                    0xdf0819a83489eb81,
                    0xd69960fce583fc95,
                    0x31083437c3bb4bc8,
                    0x080139929a91f31d,
                ])),
                Felt::new(BigInteger256([
                    0x96c7dc13640170ac,
                    0x50a21b05f890f0e0,
                    0xed646b5f7eaefb23,
                    0x3f0c9a1ac9b04356,
                ])),
                Felt::new(BigInteger256([
                    0x4667611fd16f9e8f,
                    0x6dcac476d98311e9,
                    0x40701b84a9f247b0,
                    0x0c515deff9cd989e,
                ])),
                Felt::new(BigInteger256([
                    0x1a2bb0f4ccbc4038,
                    0xbfb8b7ea927eefb9,
                    0x68befb39ff931271,
                    0x2665ee57c19aae5b,
                ])),
                Felt::new(BigInteger256([
                    0xb173c64a49af7288,
                    0x4efa866055d88d82,
                    0xe1a0e098f2f38aac,
                    0x23800f7721902d8e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x83b9316a2e8796e8,
                    0x1390ae17e3bfeddd,
                    0x9fe7011973bd1f5c,
                    0x1a7aa56de28d809c,
                ])),
                Felt::new(BigInteger256([
                    0x0cebc051fa0affda,
                    0x309b81ca9b782e8b,
                    0x57a43b13a77328eb,
                    0x318205f9dfb4ce5a,
                ])),
                Felt::new(BigInteger256([
                    0xe54a8544e7ff439f,
                    0x291bc58e1b046cc1,
                    0xfd12252768d9cc76,
                    0x38c361fcca8798f4,
                ])),
                Felt::new(BigInteger256([
                    0x76a2c431873e9dc0,
                    0x10e4fecac5db82f3,
                    0x17ce9ef55297562d,
                    0x1972a3c321eb119e,
                ])),
                Felt::new(BigInteger256([
                    0x2072296696aec22c,
                    0xc3efa52c04efec1a,
                    0xfa19ec0f5fc74a4e,
                    0x0734f96df0a3d87e,
                ])),
                Felt::new(BigInteger256([
                    0x280fa89914aa0698,
                    0x962cc9cf0e3aca4f,
                    0xad776ce807e5b5a4,
                    0x2e005dc0caaab1c3,
                ])),
                Felt::new(BigInteger256([
                    0xcf0412ce53d437b4,
                    0xf3d7240bcae8145d,
                    0x8c360dc159e513e7,
                    0x2e24d5210fab2728,
                ])),
                Felt::new(BigInteger256([
                    0xe98318399b9bc93a,
                    0xf56995fd1c302912,
                    0xce3ae8207c5610a2,
                    0x33b3d0ecb2648ea2,
                ])),
                Felt::new(BigInteger256([
                    0x7400993f47b1e4a6,
                    0x1b80be05bb74c597,
                    0x4cfe52235023d75f,
                    0x16940c5a29f9e8ac,
                ])),
                Felt::new(BigInteger256([
                    0x2c3abb907e2c662d,
                    0xcab03ddfa61006e7,
                    0xafbae0a278f05238,
                    0x1e14ddb4ff589b6a,
                ])),
                Felt::new(BigInteger256([
                    0x8289fc927879a4d1,
                    0x16432e7dca59895f,
                    0xc800e3f847215257,
                    0x191886e172579fde,
                ])),
                Felt::new(BigInteger256([
                    0xc1f0efa949914b98,
                    0xe595886c3f6d5ce5,
                    0x20a321d403b9163b,
                    0x22d7dd1216d68153,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xeb95aa9d9d6042fd,
                    0x02398367b24f9a70,
                    0x93e169239b20ea19,
                    0x1dccc505fce1718c,
                ])),
                Felt::new(BigInteger256([
                    0xb48a562431e5652f,
                    0xdb0d95a00c360b0a,
                    0xade35f2d6d4f278e,
                    0x15271665f3338153,
                ])),
                Felt::new(BigInteger256([
                    0xd1c2d90c166686f7,
                    0x493b0387d69236f5,
                    0x2c770cafe1a09fa0,
                    0x1ec45614dd9d0d61,
                ])),
                Felt::new(BigInteger256([
                    0x57fb55b69e2cdc0b,
                    0x9f0638bb0c689d25,
                    0xe3d20620c7909ef5,
                    0x19689ead19cabafb,
                ])),
                Felt::new(BigInteger256([
                    0x1f3f16ab5a28116f,
                    0x547aa02a4203fdfb,
                    0xc4f87009ae328568,
                    0x0eaad67fc7f124cb,
                ])),
                Felt::new(BigInteger256([
                    0x6e88cd0059fed12f,
                    0x9b95f01471a39bc7,
                    0x1d2b10eb7e030c5c,
                    0x079eaa48181f771c,
                ])),
                Felt::new(BigInteger256([
                    0x3b9d28f0ef92ca6b,
                    0x86cf338cc8f8a4f0,
                    0x7431aed4a8055cb4,
                    0x1bbbfbf2361c3924,
                ])),
                Felt::new(BigInteger256([
                    0x03e76875bb9a99f8,
                    0x321b7f2a9397c196,
                    0x5c642d6f69a0a765,
                    0x0dd36e5a8cdb5699,
                ])),
                Felt::new(BigInteger256([
                    0xcf87b3dd86a0413b,
                    0x7a8eed8cd38e0a3e,
                    0x6af677ad1d998902,
                    0x02fadeda4855c397,
                ])),
                Felt::new(BigInteger256([
                    0xf11280bd6077fc31,
                    0xc12ec7ba5d531f31,
                    0xfc05f20d015ea21a,
                    0x002b885f7a82dbf0,
                ])),
                Felt::new(BigInteger256([
                    0x83fc437a3ae834e8,
                    0xde30dd275ae02e43,
                    0xf436e4034c1e08ed,
                    0x06ab67a266f198d8,
                ])),
                Felt::new(BigInteger256([
                    0x5cb725a4c4369173,
                    0x8c0362e73bb7d54d,
                    0xef07e4a585da13b8,
                    0x2ef34a26b04bce2d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2933bd419b07ad04,
                    0x3711feb9f7bd8d1f,
                    0x83a26ad391f81dda,
                    0x3daaab73d7522735,
                ])),
                Felt::new(BigInteger256([
                    0xe5246d543bce838f,
                    0xcd29e68f7433370e,
                    0xdff45b1f4c63da41,
                    0x0cd73ac885fa1e07,
                ])),
                Felt::new(BigInteger256([
                    0x4d5cb1b5f6c73388,
                    0x115afa804dfc9993,
                    0x8bb67e3e6ad84f2e,
                    0x2c22383a3ea919d2,
                ])),
                Felt::new(BigInteger256([
                    0x1ba645b59ae476ad,
                    0x3282e8f88857c688,
                    0x0335ea1d04bf8a60,
                    0x262b1283631d63ed,
                ])),
                Felt::new(BigInteger256([
                    0x8ef7c315d249cee1,
                    0x7bf687eab14a12c6,
                    0x566bb3355f91c09f,
                    0x076418555f143aea,
                ])),
                Felt::new(BigInteger256([
                    0xc2e618b9bf81957b,
                    0x0ca6c2378db7d347,
                    0xb5128d8cf981f28b,
                    0x1d1d1f9558b851bd,
                ])),
                Felt::new(BigInteger256([
                    0x80bd9a0d3116da0c,
                    0xcc7db9556843e8bb,
                    0x5f5cfb7aa2777f5a,
                    0x328b3ff26050e061,
                ])),
                Felt::new(BigInteger256([
                    0xde996f53b0f42c2b,
                    0xf8fdfc0f8170084e,
                    0xe732927f1c39c507,
                    0x0b9a7a0217274a44,
                ])),
                Felt::new(BigInteger256([
                    0x51439abcb84da139,
                    0xe2e88d5c5bc0f1c7,
                    0xbda956ab6243e65b,
                    0x0ed4d4f7669f2e8b,
                ])),
                Felt::new(BigInteger256([
                    0x5b5a5aa223a041b0,
                    0x43f9aadfebef7fd2,
                    0x932543919c672969,
                    0x05755a0afaa9362b,
                ])),
                Felt::new(BigInteger256([
                    0x89cf5ec77ff72be5,
                    0x175280c435085df7,
                    0xc269df37ac78cbb6,
                    0x2879abb81f07bd52,
                ])),
                Felt::new(BigInteger256([
                    0xdd3da268819ef48c,
                    0xe6b4ca77c4148d62,
                    0xda9966fab2455470,
                    0x02b94610df40e3ec,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x9f42de107b64a120,
                    0x90d2e4acc3810fce,
                    0x8273fcdea62bfe78,
                    0x1e212894ebd94b94,
                ])),
                Felt::new(BigInteger256([
                    0x9e6b39af7dfb2791,
                    0x979f4c0fc6bc99fb,
                    0x775714181e5aee75,
                    0x3f8dcfcaada5969f,
                ])),
                Felt::new(BigInteger256([
                    0x604bacd907834ca7,
                    0x043b0deb54605422,
                    0x65d86b9ded9459ec,
                    0x0b931c38e45bf0f2,
                ])),
                Felt::new(BigInteger256([
                    0x624090029e777faf,
                    0x2ae7c5cc10a19a64,
                    0x927f8c5c037a3b19,
                    0x0b742944b2e14bbb,
                ])),
                Felt::new(BigInteger256([
                    0xf0835e8cda94065d,
                    0x5ce7acc006e18006,
                    0xc6db9e7c55662584,
                    0x02e01dd5367095db,
                ])),
                Felt::new(BigInteger256([
                    0xff2b256798a0807e,
                    0xc9966625246cc9dd,
                    0x88de410a91fccdfa,
                    0x1dcdff462ea3b2db,
                ])),
                Felt::new(BigInteger256([
                    0xf6fcec79767e6bb2,
                    0xf3d01df6e0b7bea3,
                    0xb82e43926d3e7980,
                    0x0be8cf51d94656fd,
                ])),
                Felt::new(BigInteger256([
                    0x7f4e94c8c6f67d70,
                    0xefc32d8563d244b2,
                    0x07258999086aae56,
                    0x3531318bf1d96c6b,
                ])),
                Felt::new(BigInteger256([
                    0x9f9a65ec3937062e,
                    0x151852275919b256,
                    0xb0f02e482c9c2fa5,
                    0x0db2cc432c5acf3f,
                ])),
                Felt::new(BigInteger256([
                    0xd4d486038663215d,
                    0x0014ce0406b4c890,
                    0x7154355eacd27a52,
                    0x3a78fccb1dea5862,
                ])),
                Felt::new(BigInteger256([
                    0x4b669b543fce9ac5,
                    0x0e4b5ff5150f4a34,
                    0x6261bd941bc6bda4,
                    0x2a2ae6df6942c941,
                ])),
                Felt::new(BigInteger256([
                    0x242c4f3920d26c25,
                    0xd947ed7658f402b3,
                    0x60e3a56ff6413fc0,
                    0x16750a518bb15a58,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x9babad6f3205dc26,
                    0x29f520cc439c3476,
                    0xb7832aee260c8a1f,
                    0x06231a193e71a144,
                ])),
                Felt::new(BigInteger256([
                    0x5bd4416e5d60159c,
                    0x8c5d30565ed5e9b1,
                    0x9a4946b6591b9ed1,
                    0x0fe8d0782fdc390e,
                ])),
                Felt::new(BigInteger256([
                    0xa0179f9bd3e249b5,
                    0x3dae842dc4082fa7,
                    0xec775a7efe50d6f5,
                    0x107d01bacb1ebb3d,
                ])),
                Felt::new(BigInteger256([
                    0x8b2ecf44e33fe8c7,
                    0xbb8c538b2833ba6b,
                    0x9d2c611ff0fc88f4,
                    0x255ce1b4400ea936,
                ])),
                Felt::new(BigInteger256([
                    0x4cf1461eaaf3f94b,
                    0xa453671b5f22ef39,
                    0x9ab01dec192d27ce,
                    0x31da46acaf065a33,
                ])),
                Felt::new(BigInteger256([
                    0x2e3da9eb295551c8,
                    0xfd1136ad739aca92,
                    0x179275be70d39751,
                    0x1af9e0a87e1cd7b9,
                ])),
                Felt::new(BigInteger256([
                    0x7b3f39d6934ecdea,
                    0xf6e375953b7f7833,
                    0xca09acfd98c0f8cf,
                    0x340206ab3207d6b5,
                ])),
                Felt::new(BigInteger256([
                    0xcbb4808c3966387b,
                    0x0abd5aa29c82be6b,
                    0xbe557202294d7137,
                    0x03c74d14b92cf6d2,
                ])),
                Felt::new(BigInteger256([
                    0xcf7ba482135c09c6,
                    0xee046295acd4ac04,
                    0x14d0647450492bfa,
                    0x3a152893294000d8,
                ])),
                Felt::new(BigInteger256([
                    0x95c9429cce000e30,
                    0xd65422d7de95c7a2,
                    0xd53be752b5491995,
                    0x0dd262864dabc496,
                ])),
                Felt::new(BigInteger256([
                    0xb636a4368aa5b1e7,
                    0x78e66c3046f0654c,
                    0x6e4754f65a961fc2,
                    0x0f487dbbc4d9eae9,
                ])),
                Felt::new(BigInteger256([
                    0xc2a5912e0a40f1e5,
                    0x976c310921dd9034,
                    0xf5e40b0b551f53fd,
                    0x1a18d84813926e62,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5ee9feb5090c01ae,
                    0x318993cf4d755642,
                    0xe28bea2e04e70f33,
                    0x2742c54cc7bfdef0,
                ])),
                Felt::new(BigInteger256([
                    0x6f19967996295e1f,
                    0x72e753f4b84902fc,
                    0xf108bc394dc6c32f,
                    0x249d4f30ed3861b2,
                ])),
                Felt::new(BigInteger256([
                    0xc3e7e73e69774390,
                    0x7e288e5088f7de0e,
                    0x2316d574ddccfcde,
                    0x1bbbb733509898f2,
                ])),
                Felt::new(BigInteger256([
                    0xa6f3aa0ef190d69c,
                    0x196dce4cf70a14a9,
                    0x292c0e20c313bcd8,
                    0x3a2b292ff59ce205,
                ])),
                Felt::new(BigInteger256([
                    0xe7a75484b4f5498b,
                    0x0ee23582e37d2c65,
                    0xdad48865faddea28,
                    0x3d147d47175b5cf0,
                ])),
                Felt::new(BigInteger256([
                    0xfaff919e99709b76,
                    0xb76b0ce1a24299e4,
                    0xccd7170e9f6e5ee6,
                    0x2f1345b4430a1520,
                ])),
                Felt::new(BigInteger256([
                    0x000305bb701fe0a8,
                    0xddddfdec50d7ff21,
                    0x36824119bc5b4860,
                    0x16b1e7ea09314bb9,
                ])),
                Felt::new(BigInteger256([
                    0x62fdb9571d8aa319,
                    0x5f6c85ceb714a10a,
                    0x53cfb37c536be4ee,
                    0x36eb5023e0633671,
                ])),
                Felt::new(BigInteger256([
                    0x32ef990859e410c1,
                    0xdd0922f887adf399,
                    0x0603413d21d51f65,
                    0x14992efc3a9b420e,
                ])),
                Felt::new(BigInteger256([
                    0x1a7d6928a52c0119,
                    0x77a6dab1c37d98b6,
                    0x59e9ea33561277b3,
                    0x1ede141c1d5ae3e0,
                ])),
                Felt::new(BigInteger256([
                    0xe43ec912fae67904,
                    0x6b8c0935c485a3b4,
                    0xed9117897d3be18f,
                    0x00f48e4cd98ced30,
                ])),
                Felt::new(BigInteger256([
                    0xa616870e00128f37,
                    0xcb184fb642257b93,
                    0x5d118ff88c52aa15,
                    0x30ae8218c7216070,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x32e3259e6af0cb01,
                    0x050c7695f5f53032,
                    0x414a5135ae61bbc2,
                    0x141c72151cb8c55f,
                ])),
                Felt::new(BigInteger256([
                    0xc80e67175100cfc8,
                    0xcbed7d27633a6b82,
                    0xa7491479651b6981,
                    0x1852ee4f17337aa3,
                ])),
                Felt::new(BigInteger256([
                    0x369ac6a24ada33dc,
                    0xeaf2b97bd6c85851,
                    0xe668a3e029c26a6f,
                    0x0d47c80d9409544b,
                ])),
                Felt::new(BigInteger256([
                    0x9ee89d96683c6443,
                    0x11b81f40b3626773,
                    0x3e8cdc71535ed635,
                    0x20b1b5f91a7a9f5c,
                ])),
                Felt::new(BigInteger256([
                    0x4295809cd28f9174,
                    0x111cc21fed232a27,
                    0x6609bc175c7e0510,
                    0x3f2e1fe2a1f2abff,
                ])),
                Felt::new(BigInteger256([
                    0x8d12b942fda14d49,
                    0x979a8ba0d5241e69,
                    0x9c385700f103ee53,
                    0x2a89a872c3e36c53,
                ])),
                Felt::new(BigInteger256([
                    0x891cdb2da6893bd0,
                    0x83f5b728886b3208,
                    0x36e167b881cc0ea2,
                    0x0bfce20c73fa3a9d,
                ])),
                Felt::new(BigInteger256([
                    0x2070f3019e5c357a,
                    0xa7aeb568eaf84e18,
                    0x69b81b8858da40e4,
                    0x2841022d5866849b,
                ])),
                Felt::new(BigInteger256([
                    0x712ec888dae11691,
                    0x581c6510e29c25d5,
                    0xdf99d6928156964b,
                    0x2243af0d6cb2991c,
                ])),
                Felt::new(BigInteger256([
                    0x2a31b9e2877a98af,
                    0x9fe7aa8409193463,
                    0x658aae11b0370905,
                    0x3a8f970a4fb70114,
                ])),
                Felt::new(BigInteger256([
                    0x1b640139d8b84d50,
                    0x6e3551faf2e86dd1,
                    0x6a2eeb821aa942ae,
                    0x3363d433905fbf63,
                ])),
                Felt::new(BigInteger256([
                    0xef4d2db2d2ff4530,
                    0x02d9a5bacbcc9649,
                    0xac2eada7246514a5,
                    0x2c7212c4021d04c7,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xeb638a7669edeb7d,
                    0xd598caed37e10f32,
                    0xde4e9c9926a35193,
                    0x2bf1868e68898996,
                ])),
                Felt::new(BigInteger256([
                    0x6fc008eefdae6dd6,
                    0x9ce4f2ee3ca5c5b6,
                    0xa2d209d577407415,
                    0x13b6940da3db4faf,
                ])),
                Felt::new(BigInteger256([
                    0xcd1f7ded69488a10,
                    0xb3d259f1faeb8e6d,
                    0xca99ef5e43548016,
                    0x169280e3535552e5,
                ])),
                Felt::new(BigInteger256([
                    0x0c7fd4effbb490a9,
                    0xdde0892c6e00bb24,
                    0xc00c757dc89f7562,
                    0x187ffc980f4fe237,
                ])),
                Felt::new(BigInteger256([
                    0x75740db278eb0b5f,
                    0x9b51a81b33acb8de,
                    0x8a949d49c85bc62d,
                    0x36958fe892549aa9,
                ])),
                Felt::new(BigInteger256([
                    0xe882900a1a7a1460,
                    0x9c3b89383385439b,
                    0x7d7f8934e29626e0,
                    0x36fe2b3395ac25da,
                ])),
                Felt::new(BigInteger256([
                    0xa230db8bc1c53921,
                    0x803ec66c918ef56b,
                    0xf0999b884930c944,
                    0x3d26df4b96a46f27,
                ])),
                Felt::new(BigInteger256([
                    0xb740524dbc28b1d1,
                    0x07673f31594ed674,
                    0x6f12231ddc9950ae,
                    0x30964896148dc819,
                ])),
                Felt::new(BigInteger256([
                    0xacf982c278159853,
                    0x8d28ac0036a11a31,
                    0xddd6f08f40dcd40c,
                    0x19a31f213d140a70,
                ])),
                Felt::new(BigInteger256([
                    0xb2694c29a032bcc6,
                    0x4c1f5e8974dbec86,
                    0xb0588d940cc24a05,
                    0x100beb8a35bd6674,
                ])),
                Felt::new(BigInteger256([
                    0x96e199bb44e35915,
                    0x49e2adbeee6747ce,
                    0xc9a70cd1b0b4eabf,
                    0x28f3243d7c88fa46,
                ])),
                Felt::new(BigInteger256([
                    0x753b4b8f80be8a0d,
                    0x20fa408b494f9cd8,
                    0x60d2db710f9fca84,
                    0x2e3aeb6daa831b98,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5f0b614dbf38311e,
                    0xa7dce5aef361b5ab,
                    0x021bba7ae8c78185,
                    0x3b3810239574336f,
                ])),
                Felt::new(BigInteger256([
                    0x7ffbcd41ac205016,
                    0x768cec414a049cf1,
                    0x6e26a9408f1c3ae1,
                    0x0c9cae8431d2d340,
                ])),
                Felt::new(BigInteger256([
                    0x5fe1a1ac748ce329,
                    0x983684395abf01b9,
                    0x385ff10d18849865,
                    0x1e4ecc097a5bedb0,
                ])),
                Felt::new(BigInteger256([
                    0xdaf57a7d0b8580ff,
                    0xa1a07f6c7147f2db,
                    0x2d6fae5a97bcb865,
                    0x0492aeb03f7c61fd,
                ])),
                Felt::new(BigInteger256([
                    0x83b3c949c55b434f,
                    0x6f4aa80e45a1cf33,
                    0xe40ae1a073423fe6,
                    0x128bad9fe1a95312,
                ])),
                Felt::new(BigInteger256([
                    0x52d07ad6dd42c5eb,
                    0xc2c3531b9ecf7644,
                    0x1dffc889712f137f,
                    0x1d064adce6a98f74,
                ])),
                Felt::new(BigInteger256([
                    0x5d98046682a32504,
                    0x3f6311936e79e1d2,
                    0xe92018834fbdf8cc,
                    0x0997e9fd880ac686,
                ])),
                Felt::new(BigInteger256([
                    0xa45ecba87d7a83ff,
                    0xec273c8bc5fee07f,
                    0x4a722c2ea2dadf9f,
                    0x1af36636a7e34be7,
                ])),
                Felt::new(BigInteger256([
                    0x76c45320b3665790,
                    0xa22316f0827f07e5,
                    0x58c42a23c4462f2b,
                    0x134937961436ab69,
                ])),
                Felt::new(BigInteger256([
                    0x60b91a7dc7f10f79,
                    0xa27c2e9b5a233247,
                    0x7f12c9614cca2a99,
                    0x1c26debf5ceb9937,
                ])),
                Felt::new(BigInteger256([
                    0xf8cc707558b527c5,
                    0x3bf6727dc01013df,
                    0x546901c64b5251a5,
                    0x218c106ebf00dc16,
                ])),
                Felt::new(BigInteger256([
                    0xe3a754d32302875e,
                    0xaf944eb11e729f7c,
                    0xb7ca6638e315924e,
                    0x1b31a0046ca69922,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xd7c47fde626ed022,
                    0xbf6e396196f1fec5,
                    0x8cd223edb218768c,
                    0x2f6d82ec3a210269,
                ])),
                Felt::new(BigInteger256([
                    0xc8fe9245aab355e8,
                    0xf5238a41709d6f85,
                    0x6b2bd1282aee8c76,
                    0x02cacf02f4b205f8,
                ])),
                Felt::new(BigInteger256([
                    0xe8cf6f45f512f461,
                    0x774bb872257be85a,
                    0xc8b240832e31cc98,
                    0x2ad845bea23dcb52,
                ])),
                Felt::new(BigInteger256([
                    0x38b0c062d37b1dbc,
                    0x02e1a6a51884c22e,
                    0xb58bcb9ed0c78843,
                    0x237a9f8ae305bf47,
                ])),
                Felt::new(BigInteger256([
                    0xa0315749b9ac85d5,
                    0x5e1baaa7575e8636,
                    0x20a98ac10c15ccf1,
                    0x37e15abd864a0114,
                ])),
                Felt::new(BigInteger256([
                    0xcbd2d39fe3d16f81,
                    0x8ac7533eda2eaff4,
                    0x8e5c9d5f5b53081b,
                    0x336a897579e783e8,
                ])),
                Felt::new(BigInteger256([
                    0x5b4dccddfda3f5a5,
                    0xff145fc9d0200f1a,
                    0xcb211eec09565b4a,
                    0x12b89f30ef1b3783,
                ])),
                Felt::new(BigInteger256([
                    0x3b56e69afc8eb37e,
                    0xb010a2fe5d82210c,
                    0x90c0bd955a805773,
                    0x1b33dcd39e4b2a3e,
                ])),
                Felt::new(BigInteger256([
                    0x40a3b3563cbd4795,
                    0x84a576de668f5406,
                    0x2076b73a961562cc,
                    0x33cd013552ba8639,
                ])),
                Felt::new(BigInteger256([
                    0x65b70a64245c26c9,
                    0x72fe396e1bcd892e,
                    0x25107bc06769ef67,
                    0x1c730f68d970f8cc,
                ])),
                Felt::new(BigInteger256([
                    0x70b9ce3cefd7b042,
                    0xab9ff69cf6751674,
                    0x7732bb4035f5584b,
                    0x1a1af887f913a50a,
                ])),
                Felt::new(BigInteger256([
                    0x7fb27fc7069e0fcd,
                    0x2b95f0b989e0272e,
                    0xc8b3c202ff30d2c7,
                    0x2dab191a1c4f9f0a,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
