//! Implementation of the Anemoi permutation

use super::{mul_by_generator, sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 384 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 1 element (32-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= mul_by_generator(&y2);
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += mul_by_generator(&y2) + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies an Anemoi permutation to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Applies an Anemoi round to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xf3f453efa9460f22,
                    0xccbba9bb38369db4,
                    0x9e0f49578aa16723,
                    0x1666510bf0d90b9e,
                ])),
                Felt::new(BigInteger256([
                    0xc048d5de6b9cfc01,
                    0xbf282a515df9706b,
                    0x5a0039a66c0bc03c,
                    0x10b53c12d4a6b697,
                ])),
                Felt::new(BigInteger256([
                    0x59cfe2dc2c9c8987,
                    0x4203a7a700f82e4f,
                    0x4a855394db53535e,
                    0x0d7c1698dd2c569e,
                ])),
                Felt::new(BigInteger256([
                    0x71a0c4c51582b1f4,
                    0xb0706f3ce22e4c64,
                    0x836a8c22a335508a,
                    0x3e91023b2ea2a404,
                ])),
                Felt::new(BigInteger256([
                    0x339c588fb2c4ccaf,
                    0x5dca5a30e3ea9dac,
                    0xc467561511051099,
                    0x0e3ebe6aa73a2a11,
                ])),
                Felt::new(BigInteger256([
                    0xc2fdfa7726d251c8,
                    0xf1f992b6ee71bbca,
                    0x8d42b33a301e9937,
                    0x28f95d358634e408,
                ])),
                Felt::new(BigInteger256([
                    0x7f19852eba59ab82,
                    0x478c6357814e7c36,
                    0xcee5621e8d2e29a8,
                    0x10ae30ee6fd20215,
                ])),
                Felt::new(BigInteger256([
                    0xc03cc634e7403e8d,
                    0xf38c61bc0d66cf51,
                    0x5587a2310c1a44a0,
                    0x0417e9ed4c1e83a0,
                ])),
                Felt::new(BigInteger256([
                    0x956de0c8dc412e7a,
                    0x9b297ce1e49074f2,
                    0x78dbd24fbe24c298,
                    0x39b0e1538b08dbdc,
                ])),
                Felt::new(BigInteger256([
                    0x8443c5894ed5f2ee,
                    0xf599b429a4449049,
                    0x1693799059df5ce2,
                    0x093eddb74e653148,
                ])),
                Felt::new(BigInteger256([
                    0x5c5407639654094a,
                    0x17a863e8848673c0,
                    0xcae8d8bf75baca63,
                    0x22b62aaa56617c75,
                ])),
                Felt::new(BigInteger256([
                    0x1534e6a75a11578a,
                    0xa2bf189a3fd2f281,
                    0xabaa64a747bd2057,
                    0x0a7b9b5ebebe9dd0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2af532d6eeb389b5,
                    0x013ff6caa5f44a3e,
                    0xc51dbb59fdc308e9,
                    0x0a6374b3c86d895d,
                ])),
                Felt::new(BigInteger256([
                    0x9b09003f59ce154d,
                    0x13e8ed62329d80c3,
                    0xc9f651af7e8c4698,
                    0x144b513d864814c5,
                ])),
                Felt::new(BigInteger256([
                    0xa6b3e96d1f8d47ea,
                    0x5524b05c0a2acc2e,
                    0x2da1d33ec865ef81,
                    0x111d18d2d128aabc,
                ])),
                Felt::new(BigInteger256([
                    0x79ef55bf789c4a6a,
                    0x54f8d039154f0b97,
                    0x9b95634cce28b339,
                    0x3e0bf751eb592bb5,
                ])),
                Felt::new(BigInteger256([
                    0x06b047e39c67bba2,
                    0xa68b99e48b965a57,
                    0x6c6cdc6bc888c378,
                    0x015b7ed15c6b2787,
                ])),
                Felt::new(BigInteger256([
                    0x03623eebebdeccb7,
                    0xb0954bebb4d2a498,
                    0x0c312c3c3ea0a9b1,
                    0x0667d6b43a8d0ea3,
                ])),
                Felt::new(BigInteger256([
                    0x5ca9672a6f712420,
                    0xdf6aff1773c2a0cf,
                    0x353775799215c0a0,
                    0x05d06280391814dd,
                ])),
                Felt::new(BigInteger256([
                    0x9c47cf18a19d4d58,
                    0xe935dcac78fec64e,
                    0xa13b041c63505186,
                    0x00b3221b44cbfe18,
                ])),
                Felt::new(BigInteger256([
                    0x7be9a3108894caaf,
                    0x6d1ea3c925e35ed4,
                    0x9554d8cf559821cc,
                    0x3f8be996af239149,
                ])),
                Felt::new(BigInteger256([
                    0xdbcd8d08fb3e62e7,
                    0x8143109cb85b0e53,
                    0xc128c4a94e146653,
                    0x1e8297b6d9ce2e22,
                ])),
                Felt::new(BigInteger256([
                    0x3ae51be007b59826,
                    0x6fe28a6ba2c65525,
                    0x989fdd9d9245f3a3,
                    0x004518843a8db3f6,
                ])),
                Felt::new(BigInteger256([
                    0xff9300b3a1ab74f6,
                    0x5953b39ea3fd42da,
                    0xed3aac932a211de7,
                    0x3ce2915426d55214,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x9836f9b01ffc9122,
                    0x568218bc2a0b0a2a,
                    0xfd8cd5838fca35c5,
                    0x245b0ca6399dff2b,
                ])),
                Felt::new(BigInteger256([
                    0xee66b998cd7733c6,
                    0x9f2e20533f66d7f4,
                    0xb808ba96437b33df,
                    0x2fe5dcbb741877e0,
                ])),
                Felt::new(BigInteger256([
                    0xfd6f5a060c47aeb6,
                    0x2c2f76a4665dd561,
                    0x22e611117c63337a,
                    0x21d8627787d90398,
                ])),
                Felt::new(BigInteger256([
                    0xf06bc0fee9e1532e,
                    0x81fda84caf32f8e5,
                    0x55058a301f04e676,
                    0x0c2d0e33a1dc6507,
                ])),
                Felt::new(BigInteger256([
                    0x165a91a82dd2662b,
                    0x1a360554156f2b97,
                    0xb20ef6a504b4ad00,
                    0x33f51fb967f4aee0,
                ])),
                Felt::new(BigInteger256([
                    0xd488dbdc96e6a842,
                    0xb2261be9fbfb8642,
                    0x18fa5b30e0b712ac,
                    0x3755bbd9faf8dcc5,
                ])),
                Felt::new(BigInteger256([
                    0x56eadf1d94f27a39,
                    0xa643e88663dbd340,
                    0xad7dc9b549a1c663,
                    0x0c7b4f9dd274d955,
                ])),
                Felt::new(BigInteger256([
                    0xf9a3af351db8b503,
                    0x4276eb380d11801e,
                    0xf94630830a256390,
                    0x04cefa139c2277c3,
                ])),
                Felt::new(BigInteger256([
                    0xf9c2384bc8942ad0,
                    0x343c6883c9e9e0f7,
                    0xae2df7cb9d3dd1eb,
                    0x0fe1f1e36ff6856e,
                ])),
                Felt::new(BigInteger256([
                    0x9ff111c557ee26f5,
                    0x1a2d65d025a13954,
                    0x82a4e133ae2ca330,
                    0x1c01b8f2e132b6b4,
                ])),
                Felt::new(BigInteger256([
                    0xef4e65350875e009,
                    0x62d8ac6d1a09857b,
                    0xd0a3bcaf0707bcc5,
                    0x29279ae3e86d419f,
                ])),
                Felt::new(BigInteger256([
                    0x9213fb556a37a337,
                    0xb605aedd817dc1a3,
                    0x2b745205084b31b6,
                    0x3035b6aba73bd037,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf97c918f9d3886d1,
                    0x1182c1e8313e2460,
                    0x918d9b1c23a70a2c,
                    0x1ba59c3f4d341c01,
                ])),
                Felt::new(BigInteger256([
                    0x6702258318f1ae87,
                    0xab49592c1e0e21c7,
                    0x7471a93df63f7555,
                    0x2244523ea74a17bd,
                ])),
                Felt::new(BigInteger256([
                    0x1ac53ac6348f207e,
                    0xd70e8b29f57cbc7b,
                    0xc0d314e7f4da52a2,
                    0x2a2b5346e47730c1,
                ])),
                Felt::new(BigInteger256([
                    0x24c58a4e74d783ad,
                    0x3c8aa5eacdd84280,
                    0x862d06155749cf6f,
                    0x3bd2afdf323764e2,
                ])),
                Felt::new(BigInteger256([
                    0x959990cd2edef9d6,
                    0x16b2d373922e9c53,
                    0x2813a09597fb7696,
                    0x0a6d4ad7900f1e00,
                ])),
                Felt::new(BigInteger256([
                    0x915621dd45ec5792,
                    0x5df3e5d09a3d6038,
                    0x6460ebc1dc190208,
                    0x141dd79e1aeeb0a9,
                ])),
                Felt::new(BigInteger256([
                    0x627cddf8247e6f3f,
                    0xcb080a5434d35eaf,
                    0x92322e7a51995f10,
                    0x09ff2432c4bf0142,
                ])),
                Felt::new(BigInteger256([
                    0xcd3117fb533a72ed,
                    0x2e0ace81a6a17f23,
                    0x522f3a9a6bfb0435,
                    0x3dc5fb4a90771824,
                ])),
                Felt::new(BigInteger256([
                    0xe5b0a8d1afe84733,
                    0x609e444b08021153,
                    0xe25c8b9c13372591,
                    0x2e049f3a8cf9530f,
                ])),
                Felt::new(BigInteger256([
                    0x73ae05d02f0dec63,
                    0x3c62967b3535f478,
                    0xb06192f2febc7a7e,
                    0x1a9330ffb6313f2c,
                ])),
                Felt::new(BigInteger256([
                    0xaa40bac159fe0c5d,
                    0xf5682ef999595ccb,
                    0xec8841386dbf2f0c,
                    0x0e7df4420de34429,
                ])),
                Felt::new(BigInteger256([
                    0xa44946c62e42bd18,
                    0x5b81aa2dc67785d4,
                    0xef48cd9b3a12c034,
                    0x28ff28f72d67207d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa7fa4eb7b4039820,
                    0x36586da5565567b1,
                    0x98569e367dc3360b,
                    0x150812ee3e51d3ea,
                ])),
                Felt::new(BigInteger256([
                    0x40966da697687650,
                    0x59e7e57310578920,
                    0x52020eb2b3ae29e9,
                    0x3ee24e028120d2fd,
                ])),
                Felt::new(BigInteger256([
                    0x6e03d2ccdb9c223d,
                    0x601002a96b3de820,
                    0x97bdca1937119f5a,
                    0x3e47a14405747428,
                ])),
                Felt::new(BigInteger256([
                    0xcd4b6aaa3436a3c6,
                    0x23a5d5e4e44e3862,
                    0x7aea3758b944b6f2,
                    0x29a20d437a0681ab,
                ])),
                Felt::new(BigInteger256([
                    0x03da4750ea3500db,
                    0xbb516ae78cbebe1a,
                    0x0ff89a2ee26e79af,
                    0x3a13232f13f0f416,
                ])),
                Felt::new(BigInteger256([
                    0xadaa8dafe2bfdc43,
                    0x669235aec4695b11,
                    0x79c768d73b028f23,
                    0x2ffc04dc9913dfe7,
                ])),
                Felt::new(BigInteger256([
                    0x404ebb3366bf95c0,
                    0x849ade837f84b242,
                    0x546ba79553eceeb9,
                    0x071f812a034995e5,
                ])),
                Felt::new(BigInteger256([
                    0x13696b4138a11973,
                    0xfc6033c78d92414f,
                    0x38e96b7e886edc5e,
                    0x166792453414eae9,
                ])),
                Felt::new(BigInteger256([
                    0xa35c6d740af736dd,
                    0x78444e76ba0082b3,
                    0x001e7a3059131234,
                    0x2f07c881814f2234,
                ])),
                Felt::new(BigInteger256([
                    0x498f72d7572292e8,
                    0x00bd16fcd700d715,
                    0x7983f5c04ec7db29,
                    0x3bc87b0efb563048,
                ])),
                Felt::new(BigInteger256([
                    0x981a34e55b7b5fa4,
                    0xbc989f8ca4855fdd,
                    0x72ee6e53643a05eb,
                    0x2e2de994c1bc8216,
                ])),
                Felt::new(BigInteger256([
                    0x039e1591332c15ba,
                    0xdfbbed96d7f1d9c9,
                    0x3f5d694ac4d386b9,
                    0x32dce89dbe24f07b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x12c27446e9dec6b3,
                    0x4f021e66e78d7ce1,
                    0x9f6ed6d61a5c8b37,
                    0x000e1445a97fc1f7,
                ])),
                Felt::new(BigInteger256([
                    0xda02b508a0f22387,
                    0xb3af5c6cd7e6b83a,
                    0xbec4a2178cdf9422,
                    0x0b097b178d5ac3a7,
                ])),
                Felt::new(BigInteger256([
                    0x1c7bc8c6739f8c1b,
                    0x51046ef7b57e7bc9,
                    0x73aa66dd0a842bff,
                    0x1fd655be8b7d18d1,
                ])),
                Felt::new(BigInteger256([
                    0x0cc6d083bdf15f60,
                    0xcdc6b84674897691,
                    0x77904c518960b626,
                    0x0ee45417c55d6075,
                ])),
                Felt::new(BigInteger256([
                    0x0bf0afc4475f70e9,
                    0x9088a572e1af1e12,
                    0xbd03bc25d0ed2714,
                    0x1a36d4703addb8b5,
                ])),
                Felt::new(BigInteger256([
                    0xcf3b3bcdd3b0d5ce,
                    0xdc1427e04c0fded9,
                    0x6ff17d95d96093b1,
                    0x1837b285c68b882d,
                ])),
                Felt::new(BigInteger256([
                    0xc6a7766db1abe6e4,
                    0xb677ed8127a476c3,
                    0xc0d5000036cd47d9,
                    0x1c3ebf920fd0a740,
                ])),
                Felt::new(BigInteger256([
                    0xcffd449226a1c64e,
                    0x2ebe19be1e702f38,
                    0x7c8976fb86d35557,
                    0x1f8ff7d00e1efba4,
                ])),
                Felt::new(BigInteger256([
                    0xa8fe7235b657198f,
                    0x742c4b5724f2f8db,
                    0x5f86d36e0056817f,
                    0x0b7610907cc0aad5,
                ])),
                Felt::new(BigInteger256([
                    0x124b48853293e99a,
                    0x7e1ef352dec78ee9,
                    0x9f391db59f64db07,
                    0x03422560013c6b88,
                ])),
                Felt::new(BigInteger256([
                    0x38508970b0a73cd7,
                    0x76f9077f12023038,
                    0x7789c0ef6e467512,
                    0x048f09808be4adee,
                ])),
                Felt::new(BigInteger256([
                    0x4f18cc92d06c8ef7,
                    0x2564fbc15ddf2df2,
                    0xe1efb6d9ddee85a5,
                    0x2eef84af6a28c87f,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x123bd95299999999,
                    0xb83c0a9bfa40677b,
                    0xcccccccccccccccc,
                    0x0ccccccccccccccc,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xa942fcc6b6fc9019,
                    0xe30fee4001297b6b,
                    0xc81bbbb990652d5f,
                    0x151360a4ca1bade9,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
                Felt::new(BigInteger256([
                    0xc1f5f40ca5f0c922,
                    0x8ed096798f9a2565,
                    0x343bf2efffdc45e4,
                    0x136f8d515fc00212,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0x2daf6d68ef718427,
                    0x5061c937d5b3a764,
                    0xf8541bb755f5c730,
                    0x24e19c62db751b35,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
                Felt::new(BigInteger256([
                    0xffc6f91ea63fca57,
                    0x291c6ce7a87d6cc6,
                    0x0dde5b4ffa4ac0ea,
                    0x0d38cb1a91ae29c0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0xeb95ce3a99999981,
                    0x819db2fb145092b5,
                    0xccccccccccccccc9,
                    0x0ccccccccccccccc,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
                Felt::new(BigInteger256([
                    0x311bac8400000004,
                    0x891a63f02652a376,
                    0x0000000000000000,
                    0x0000000000000000,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x95832574ea982dce,
                    0x34232bfb112218d1,
                    0x41238e97f86a0aae,
                    0x2346ad672079e314,
                ])),
                Felt::new(BigInteger256([
                    0xc90a13f21ffdc396,
                    0x2b4dd86fe78fff68,
                    0xacae1657e3f095ef,
                    0x1850cd3b1f3155c4,
                ])),
                Felt::new(BigInteger256([
                    0xf52bc2c022e3e83d,
                    0x3e6e019827a2b41e,
                    0x6d6008a328fa38fe,
                    0x1b9ced2142ceb72d,
                ])),
                Felt::new(BigInteger256([
                    0x6fddd68c15696081,
                    0x6d8002e574acfd64,
                    0xbc39c93239b2efa2,
                    0x1513e04c03159467,
                ])),
                Felt::new(BigInteger256([
                    0xdde39fb6a8d05b68,
                    0xcac32320b450bb21,
                    0x86650ab7078d3c6d,
                    0x0f19d26cb68e0aea,
                ])),
                Felt::new(BigInteger256([
                    0xa42fa0f88f35c20d,
                    0x5cca71ae8ecd0c9e,
                    0x9c82fa4dcb935590,
                    0x33a0238cdcfd55f4,
                ])),
                Felt::new(BigInteger256([
                    0x957e73912a913227,
                    0xde207647e291684e,
                    0x41d62e9d0cfebacf,
                    0x12faae6175d41fe7,
                ])),
                Felt::new(BigInteger256([
                    0xda85c9d6b5951070,
                    0x765dd5fd3d5c690e,
                    0x8e7f54c5396eb8bc,
                    0x30ef74fefe309cb2,
                ])),
                Felt::new(BigInteger256([
                    0x2eae94382e6fb8e3,
                    0x185eaed9a471d3a6,
                    0x1cbb921fd3dc6a25,
                    0x2822a92de74fce61,
                ])),
                Felt::new(BigInteger256([
                    0xb73268946a6ae416,
                    0x6f3824873733fc71,
                    0x54986e517b853289,
                    0x0fe39ed081108c3f,
                ])),
                Felt::new(BigInteger256([
                    0xb4b7a48df8deb034,
                    0x87b806b15bc9450e,
                    0x2135625a1598d8ae,
                    0x1b6b6fafb68e6f48,
                ])),
                Felt::new(BigInteger256([
                    0x46910aadea473ab7,
                    0x6883b2675b08a29a,
                    0x1360f231d557f877,
                    0x3d8f8267fdedd970,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xd691e13a2b7f01b7,
                    0xbbf436b1b4f9a272,
                    0xcaff1afdd027d1e8,
                    0x1d285137785ce64c,
                ])),
                Felt::new(BigInteger256([
                    0xa702a308817bebdd,
                    0x5a89b4388d70633e,
                    0x8a72cb6ebaf7a899,
                    0x01de21e6fecf7f0c,
                ])),
                Felt::new(BigInteger256([
                    0xb5c9d7492d37b9ae,
                    0xc0a55d4dff1af19a,
                    0xc10936c36b15f07c,
                    0x3a0b680ee0f0df2a,
                ])),
                Felt::new(BigInteger256([
                    0x0a68c69cb09bdbec,
                    0xb8afbe2759960d8c,
                    0x9845538ff4359dd6,
                    0x093b0a38f0f2dd18,
                ])),
                Felt::new(BigInteger256([
                    0x018b13375cfcaccc,
                    0x1ab8cd4c08afe9c3,
                    0xdfc3d3a00e8ad1d4,
                    0x03865f103a676eb9,
                ])),
                Felt::new(BigInteger256([
                    0xe7736adcd6bcf086,
                    0x2ebf6ccd38199da5,
                    0x7b3803038aa864d2,
                    0x00d682c2c1167c33,
                ])),
                Felt::new(BigInteger256([
                    0x0e523c40b218dd25,
                    0x7617447efa00e07f,
                    0xbe805e97b0f57e51,
                    0x1edb43373d3c8ee0,
                ])),
                Felt::new(BigInteger256([
                    0xee0c6e68544f4cab,
                    0xec1fdd9a24fc54fc,
                    0x7e67c5e1cb29371e,
                    0x0b852eadba5dbb28,
                ])),
                Felt::new(BigInteger256([
                    0x704d06af7156c55b,
                    0x3735e4a8ae1e66fb,
                    0x81efcc34483b9d50,
                    0x09afa7e7216a5924,
                ])),
                Felt::new(BigInteger256([
                    0xb7a455b2408fc0ea,
                    0xa4db3c6eb7f495ed,
                    0xa6f91c8d64fc9236,
                    0x23a641503da81f0d,
                ])),
                Felt::new(BigInteger256([
                    0x0935ebe50a7f20df,
                    0x2d6f4ed39c1476b0,
                    0x47657d4931ffb61a,
                    0x11bc3141daaf60ea,
                ])),
                Felt::new(BigInteger256([
                    0x8254f907e87d08a3,
                    0x04b6a6b9d4b66ffb,
                    0x8c6508340452bbf4,
                    0x05a1183b318ff369,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb6386bfba7c62d91,
                    0x31f2f63f22574531,
                    0xa36823f445c1d4a3,
                    0x365e9df4d3ebeed9,
                ])),
                Felt::new(BigInteger256([
                    0x17ad5c68f2dd2677,
                    0x6cc2de5a91218373,
                    0x9477acc915d2e9de,
                    0x16db743168cc14df,
                ])),
                Felt::new(BigInteger256([
                    0xb10c2ab885d56dec,
                    0x6a19fc6d39fbcb5e,
                    0x9c5bfae2ae6712a8,
                    0x2bdd98d7345ccd8d,
                ])),
                Felt::new(BigInteger256([
                    0xa1d1c198de0a11b1,
                    0xecee5e13391a18da,
                    0x5460d2583498e520,
                    0x371bbf3f08f53c5d,
                ])),
                Felt::new(BigInteger256([
                    0xffcf7699b5cfb298,
                    0xe994e91280e9560c,
                    0x2f4b1483cc6b0c6b,
                    0x028442b41e785870,
                ])),
                Felt::new(BigInteger256([
                    0xf5c1f81c55dcb202,
                    0x3c9610163a55b6b6,
                    0x9e4dac50c7fb22c4,
                    0x22386d0dab6fb755,
                ])),
                Felt::new(BigInteger256([
                    0x643300f9e4e771b2,
                    0xdf41afd2a86b9eed,
                    0x5fb4a47d3d11fc2c,
                    0x1f62c03fd29ef930,
                ])),
                Felt::new(BigInteger256([
                    0xafc33fdb15e9d70b,
                    0x46883001bbfe47c9,
                    0x658912a1a1925270,
                    0x1d796b4f3e5d528e,
                ])),
                Felt::new(BigInteger256([
                    0xc9050a213aa985e4,
                    0x1789c322eb847948,
                    0x471b3f5061e3292c,
                    0x3b21afce6820ad45,
                ])),
                Felt::new(BigInteger256([
                    0x1b648f3cae70733c,
                    0xd0d9f8e346e7b3c5,
                    0x5f4089cd47385c6f,
                    0x11a21e8ee834cdc2,
                ])),
                Felt::new(BigInteger256([
                    0xfcf2defeac079aa7,
                    0x8d9bb93186b0acfd,
                    0x726db8dfaa9551bd,
                    0x3c8a6192c334f6bf,
                ])),
                Felt::new(BigInteger256([
                    0x4598192b8b023e3f,
                    0x1dd931ed1accfa97,
                    0xd45af0b1c7f4554e,
                    0x04a91f3f771c85f0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x1924183bd308b28a,
                    0xd1b7a1912381516e,
                    0xa3e5ef73e4dc2ded,
                    0x3f59a0fcb6ac6e02,
                ])),
                Felt::new(BigInteger256([
                    0x2dda59246605b1bf,
                    0x13f91d458da410c8,
                    0x01eaabe64fc8a511,
                    0x345f4ab0a85de5a6,
                ])),
                Felt::new(BigInteger256([
                    0xa0d111397633ef73,
                    0xd1ae86f45e69800d,
                    0xcd8314fb0876dbaf,
                    0x1e275f7fe73928a5,
                ])),
                Felt::new(BigInteger256([
                    0xa62491d09260601b,
                    0xe109ce720db646a1,
                    0x0013a6cf9c4c37e3,
                    0x3ee32cba976ebe07,
                ])),
                Felt::new(BigInteger256([
                    0x18f66251a801a2d1,
                    0x10e2c8d4683ead39,
                    0x0c6d3bc2946daa2e,
                    0x3425551ca2ebcabf,
                ])),
                Felt::new(BigInteger256([
                    0x7f112f70dc52649d,
                    0x52af1a7f3f476136,
                    0x657e4ffbe8d1e3c1,
                    0x239b7ac7823f58b5,
                ])),
                Felt::new(BigInteger256([
                    0x3f98997d4c975193,
                    0xbdc9fa318c6c6eb0,
                    0x80300079fec714ef,
                    0x23f06f6b224e4b6a,
                ])),
                Felt::new(BigInteger256([
                    0x7ac22aefbd9fe519,
                    0x8954e7d34cbb3b6a,
                    0xa6d65fd553f76d17,
                    0x1cc59f69f4c24a33,
                ])),
                Felt::new(BigInteger256([
                    0x910b0337f8c257e8,
                    0xb011848c3996609a,
                    0x5a9873bba6691f64,
                    0x3c75da61f990cede,
                ])),
                Felt::new(BigInteger256([
                    0x50a4e55c524e97d3,
                    0x60da2f4360d16aa2,
                    0xfb0df9b6307a980a,
                    0x1fcf9fb5a914ee6d,
                ])),
                Felt::new(BigInteger256([
                    0x5e79718809e5558e,
                    0xf233e99bebdd3441,
                    0x85d15f7c5477ccb4,
                    0x0dea4ec86f8907fb,
                ])),
                Felt::new(BigInteger256([
                    0x3a66906423d56672,
                    0x8c2b12ff01106181,
                    0x94aec92514d112aa,
                    0x2509e146669805eb,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xbcf06f156cd0f990,
                    0xb7d47ed16fff6728,
                    0xc853ca8090f97416,
                    0x159cca66037052c0,
                ])),
                Felt::new(BigInteger256([
                    0x89ab478467293157,
                    0x0fc8ea6446057f18,
                    0xcd186d22290ca605,
                    0x1b92eb2c0d9a1a93,
                ])),
                Felt::new(BigInteger256([
                    0x913f58659cc5fdb4,
                    0x5372cf28d295b5f1,
                    0x1bf8778dbc483b78,
                    0x2684cbc3b9f6d1e6,
                ])),
                Felt::new(BigInteger256([
                    0x56b5f9b0a6381732,
                    0x5466ab648a514907,
                    0xe8ab815abb1f2ffd,
                    0x188a072092376d5e,
                ])),
                Felt::new(BigInteger256([
                    0xd636668b19180446,
                    0x345d7dcd3b968cbf,
                    0xda1d6f94dfbbb45b,
                    0x0a84284bae7f4c57,
                ])),
                Felt::new(BigInteger256([
                    0xe5726feea4358b41,
                    0x9e5e29a27ab389a5,
                    0xc0ad8ed10eac4d84,
                    0x350e57e3480d3412,
                ])),
                Felt::new(BigInteger256([
                    0x7a9109a74aebf993,
                    0x1d01d7c9c7246318,
                    0x496bfd9c47ebfefb,
                    0x0e667d8cbbb87822,
                ])),
                Felt::new(BigInteger256([
                    0x7d7a07709ba80bc6,
                    0xe4f8adbd78ff8fa3,
                    0x46e284489f7bcf83,
                    0x2ec3e7030cac605b,
                ])),
                Felt::new(BigInteger256([
                    0xe0129ededf78d0c4,
                    0x26a009dcfe4dacf8,
                    0x936487ed99397174,
                    0x1135fd43a57856b2,
                ])),
                Felt::new(BigInteger256([
                    0xc36d81c784262905,
                    0x705f2761fb3f0ba3,
                    0x5b1211feb2d30687,
                    0x10811a0f8d752bff,
                ])),
                Felt::new(BigInteger256([
                    0x67da998dcc0aa071,
                    0x97d13579176284fc,
                    0x6ec377924b5585d0,
                    0x3407c97c3fde17cf,
                ])),
                Felt::new(BigInteger256([
                    0x2f539b06f82490f4,
                    0x22bdf3d7ea4c496b,
                    0x2624673823f91d30,
                    0x1c2ad32fae52dd6e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xc6a5991ec08c3559,
                    0xb561a5cadf821a5b,
                    0x24b8c902e1d0134b,
                    0x02d2026342231241,
                ])),
                Felt::new(BigInteger256([
                    0xa090794027fdc4ab,
                    0x5359f011301cac65,
                    0x59f893a20ce0471b,
                    0x294c08cb6af77a6a,
                ])),
                Felt::new(BigInteger256([
                    0xcea3ac1a66a9b994,
                    0x788e830a35badf1c,
                    0x4091d103ada1c3e8,
                    0x0664eccd6461547e,
                ])),
                Felt::new(BigInteger256([
                    0x75c5b59e8829a672,
                    0xbafc3d9b38def996,
                    0xaa9f64309ad6a3a9,
                    0x32f8522c2ffa78f7,
                ])),
                Felt::new(BigInteger256([
                    0x214eb7f820dce8f0,
                    0x5826484a7530cd48,
                    0xf73547f1d2d5fe66,
                    0x1737bbb13c25647d,
                ])),
                Felt::new(BigInteger256([
                    0xc1c70087228e52be,
                    0xb9dd2b2a97c958d1,
                    0x3a6ccbfe5902c8e7,
                    0x2ad1dcb31b9b266d,
                ])),
                Felt::new(BigInteger256([
                    0x6b23a807f98770f7,
                    0xa7f75166f36ed3d7,
                    0xa8c5c2e92b08be71,
                    0x2b8843f9260e25ed,
                ])),
                Felt::new(BigInteger256([
                    0x74f1e60b5eeb4967,
                    0x6d01c253e5434fa4,
                    0xbf3aa48cad4f52c2,
                    0x2a21be1ec7c75e95,
                ])),
                Felt::new(BigInteger256([
                    0x14738f38a702ca81,
                    0x9b8ee568d119d1fb,
                    0x20ab0659864909f4,
                    0x0edd6a477cbd01af,
                ])),
                Felt::new(BigInteger256([
                    0xf73a8ff7306fe56e,
                    0x235e7169a021479f,
                    0xd903733ce87cef38,
                    0x0f4051da8c3704d2,
                ])),
                Felt::new(BigInteger256([
                    0x1f7d9a14a65e1447,
                    0x2d2138c2485fb380,
                    0xfe265f6dd702e3c1,
                    0x0898dde3d731ddf2,
                ])),
                Felt::new(BigInteger256([
                    0xeb164794d512ef32,
                    0x2b14dba27872cb6e,
                    0x622bb21ed3f4e388,
                    0x039d67e9e6b08754,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xc8b36384b8574a55,
                    0x85b42d715174e5ea,
                    0x6bcdb96e79c49c98,
                    0x0b60de3060dd5ced,
                ])),
                Felt::new(BigInteger256([
                    0x1a71472742141b2b,
                    0x2f7eba364902305b,
                    0xd7d63d19c477539f,
                    0x33e4f0b629fc74c8,
                ])),
                Felt::new(BigInteger256([
                    0x96908e4707140dfa,
                    0xd6f095facff2b3cb,
                    0x85e961915757a482,
                    0x0bbf37edd679f5d4,
                ])),
                Felt::new(BigInteger256([
                    0x4de784050035863f,
                    0x56147c1d8b041bcc,
                    0xb81c4af1013654f5,
                    0x1cd29ef4ebb4d266,
                ])),
                Felt::new(BigInteger256([
                    0xdd4095b24bcfe5a8,
                    0x4aad06a20de4c6f3,
                    0xfae1a12b57e7da8f,
                    0x14485860bb4842f2,
                ])),
                Felt::new(BigInteger256([
                    0x1b672cff6faa9cda,
                    0x095b12893cdc23be,
                    0x4f0135878ab4f817,
                    0x3498bde080b89d06,
                ])),
                Felt::new(BigInteger256([
                    0x374dedd3ba02fb25,
                    0x99fab40e6f4a1ba1,
                    0x93e5b94e7047eee8,
                    0x227e01737d3a45a7,
                ])),
                Felt::new(BigInteger256([
                    0x96ce3f3d29ab4b96,
                    0x6ad1882ff7675a67,
                    0xa10f059bc0ff968c,
                    0x01b3b95dbbf2f6c1,
                ])),
                Felt::new(BigInteger256([
                    0xc7e3fc47d116e832,
                    0x80d395de3f295170,
                    0x6d738871f8f0f6db,
                    0x02bdf0cd767897a7,
                ])),
                Felt::new(BigInteger256([
                    0xd54125ba6468cecd,
                    0x7aeadfdbd45669a8,
                    0xef376022ebe0201b,
                    0x38ff94b824e0e756,
                ])),
                Felt::new(BigInteger256([
                    0xda22c54b9e4394a9,
                    0xff3edbdd00a9531d,
                    0xf71d52536f1d0ba5,
                    0x197b942d5d8df7c3,
                ])),
                Felt::new(BigInteger256([
                    0x1080ad62e487ac52,
                    0xe80ae4b4ee305e98,
                    0xcc1298c457844a32,
                    0x2a5ae1483d1a17a0,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5f0faa892011a51e,
                    0xac86f78ece0fe2ea,
                    0x5f56111fb0716041,
                    0x2010a32451c63448,
                ])),
                Felt::new(BigInteger256([
                    0xb028ec0bb1ac8d31,
                    0x76a24d4ca6cd4a87,
                    0xe84410c6fd1e256e,
                    0x323cd2b4c5b77546,
                ])),
                Felt::new(BigInteger256([
                    0x903ddfc2b0e74131,
                    0x7382ce1fba11ae60,
                    0x7f21d981ad004e2a,
                    0x0531a763e51a4ac1,
                ])),
                Felt::new(BigInteger256([
                    0xd94ccfd735f52a59,
                    0xb8cc61a99f005c43,
                    0xdcc94b45841210ea,
                    0x3f9d7ac3ca7987c9,
                ])),
                Felt::new(BigInteger256([
                    0x4c89a7850758d4bd,
                    0x25865c64546a0396,
                    0x8c4b68135119cebe,
                    0x022735957e1614c2,
                ])),
                Felt::new(BigInteger256([
                    0x87854ce442035906,
                    0xf8f024a639c1c934,
                    0xbd2ab886bc4a8835,
                    0x384cb1517490de34,
                ])),
                Felt::new(BigInteger256([
                    0xb99991218dff834c,
                    0xc18e9ace4665503a,
                    0xbf63e5785895566b,
                    0x2ad02b864dd765f7,
                ])),
                Felt::new(BigInteger256([
                    0x4e50c03e332dfe31,
                    0x653a473d07b7ea36,
                    0x9a97262897eb5551,
                    0x155e78c8bfb69d2d,
                ])),
                Felt::new(BigInteger256([
                    0xe57753ea5099f293,
                    0x09a05e706eafa508,
                    0xda4305fb0cc265a5,
                    0x1001599681e9adb2,
                ])),
                Felt::new(BigInteger256([
                    0x0cb1e0caa41cd04c,
                    0x4eeadad0825d0830,
                    0xaa0ed35792814e19,
                    0x056b1b493ad28b25,
                ])),
                Felt::new(BigInteger256([
                    0xbdbd9caf18b3c548,
                    0x1e9f3fc694aa3d04,
                    0x66ab19a7af66eac6,
                    0x084d9a69853800a7,
                ])),
                Felt::new(BigInteger256([
                    0xa259cd84c22a6bca,
                    0x514a898bb0fe04df,
                    0x8c4c04914487c81c,
                    0x3d2fa790308ac593,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x521da478abdb1721,
                    0xf53fe9e98e46672b,
                    0xb159badb751be603,
                    0x2b44209bc9a947b8,
                ])),
                Felt::new(BigInteger256([
                    0xe4e8293318eb8f99,
                    0xed60897089ea4860,
                    0xec33aab38eba88de,
                    0x03cf9d9b8e6bd378,
                ])),
                Felt::new(BigInteger256([
                    0x8f1aa80a230e36ae,
                    0x5b3c05c4f6e85e2f,
                    0xaa7a5531c6ff170e,
                    0x3afdf2c6fbbee661,
                ])),
                Felt::new(BigInteger256([
                    0xe3bfbb668f28b0f9,
                    0x483be2d3779e49b5,
                    0xfca823dfa5dcf701,
                    0x210bc1ae5d156071,
                ])),
                Felt::new(BigInteger256([
                    0xda9dfac40c8fbc23,
                    0x6e1dcdc94eed6ace,
                    0xa48c09317223758e,
                    0x37fce0651da7e39a,
                ])),
                Felt::new(BigInteger256([
                    0x4afa540f479e6795,
                    0xbee253c37394a313,
                    0xd69f22601142907a,
                    0x3ff6b45e230bc4ee,
                ])),
                Felt::new(BigInteger256([
                    0xef9012ed65363a49,
                    0xc76ed7d70f5f34be,
                    0x285e0bb7c6074ea8,
                    0x2593d42967efb6aa,
                ])),
                Felt::new(BigInteger256([
                    0x3042439825385ad3,
                    0xe94a3c62c1ae9085,
                    0x1d5324f741e78ee0,
                    0x3e8c9f586c9877e7,
                ])),
                Felt::new(BigInteger256([
                    0x1606a8ea7af30dc4,
                    0xafd1b7b2ad6b545e,
                    0xf0bbb2c74c624d7b,
                    0x162e66f29e54eefd,
                ])),
                Felt::new(BigInteger256([
                    0xa882d4c122965eed,
                    0x722c64e35a18c19d,
                    0x9a33fe8492e8f8f6,
                    0x2ccc096a335b7c3d,
                ])),
                Felt::new(BigInteger256([
                    0x1f63c7179a7a282e,
                    0xf52f285a3bd55684,
                    0x3c4778ad4eeae8ec,
                    0x30db1d96820db1f6,
                ])),
                Felt::new(BigInteger256([
                    0x2c2c03ace166223a,
                    0x20ff5238a7e55160,
                    0xaeae182dd47633b6,
                    0x36adea7a08f8627d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x375210353fafeaf0,
                    0xb0e0ba4c807bc616,
                    0x0c22d44eb436450b,
                    0x1815f6a47581ddaf,
                ])),
                Felt::new(BigInteger256([
                    0x37f024c3d21e8530,
                    0xdd39bc9082023f81,
                    0x88406ad3b94f0b5b,
                    0x0297123fb3388726,
                ])),
                Felt::new(BigInteger256([
                    0xb429cec546f02c77,
                    0x7fb88acbc8d32488,
                    0xfac5d4d918a468d5,
                    0x31f6dbda85fbfa81,
                ])),
                Felt::new(BigInteger256([
                    0x425e118ab16df538,
                    0xf1ce79d554df9c57,
                    0x62de63e6199fb238,
                    0x24d3a9c54b9bd49b,
                ])),
                Felt::new(BigInteger256([
                    0x4ab37faa01302042,
                    0x752758ca86953162,
                    0x24b4cad27e88f180,
                    0x2d662ff1afb222fb,
                ])),
                Felt::new(BigInteger256([
                    0xa1329c11c8e1febe,
                    0x966cea7c36fd57aa,
                    0x82b1dee731d88ebe,
                    0x2fe49a5fe77b3118,
                ])),
                Felt::new(BigInteger256([
                    0xc21df0733617f643,
                    0x1ebc7e7292d4df1d,
                    0x0683f61730e0be76,
                    0x06033aef370a1419,
                ])),
                Felt::new(BigInteger256([
                    0x9ad010d4e3f1a599,
                    0x8f60358a487042f4,
                    0x6288ffff456c485a,
                    0x00aa523366390569,
                ])),
                Felt::new(BigInteger256([
                    0xd3d1050d3ae2c085,
                    0x3a8454ddd0170d62,
                    0x8bf3224f230dc660,
                    0x2eee9e8c3e10046f,
                ])),
                Felt::new(BigInteger256([
                    0x760ba8cd0e6c3cb0,
                    0x74da7bef753f9c11,
                    0x2833ecf30034ef4a,
                    0x3b3016703e2e2740,
                ])),
                Felt::new(BigInteger256([
                    0xf80190865dea742d,
                    0x7d19bf92678fab37,
                    0xa70e2d7e3d25411d,
                    0x08ed6bb30ad47a12,
                ])),
                Felt::new(BigInteger256([
                    0xf6b5d8b44e19fec4,
                    0x86fc9b4ecf6acde7,
                    0x684e7ea309193adb,
                    0x25fd357cb39bd7dc,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf2ef5c6a7d742a8d,
                    0x56a21947b02410aa,
                    0x8c9b58164cc9555e,
                    0x18481a576bbd7084,
                ])),
                Felt::new(BigInteger256([
                    0x3d41c3de652f0060,
                    0x334d7bcfa56f096c,
                    0x8cd01ac6eb3e9116,
                    0x01bd4cc3e7f70c46,
                ])),
                Felt::new(BigInteger256([
                    0x8724f0c390bd4886,
                    0xe5c3a5fe367fae2c,
                    0x0733c0d9690abc77,
                    0x021a3180b7564af0,
                ])),
                Felt::new(BigInteger256([
                    0x37f0b480def49403,
                    0x52ca3c4593651157,
                    0xe35fc2f575115e19,
                    0x337feca6714bfeea,
                ])),
                Felt::new(BigInteger256([
                    0xc1658fc3d8a48a82,
                    0xa1073b8be035c37e,
                    0x65c195f4df16d887,
                    0x0efea6486ad04483,
                ])),
                Felt::new(BigInteger256([
                    0x63906761fa10d6f3,
                    0xa2756af6e3770991,
                    0xee79ba4417b3a759,
                    0x0b9065410281013c,
                ])),
                Felt::new(BigInteger256([
                    0x13c9b951e85cca44,
                    0x8c348627fa74bd6f,
                    0x87c7ca5dd90aa9c7,
                    0x1bce691da5ee5368,
                ])),
                Felt::new(BigInteger256([
                    0x7c46e7689a0f42b2,
                    0xed42d2be78f88e87,
                    0xb103137d7488ec4b,
                    0x331f61333c0946b9,
                ])),
                Felt::new(BigInteger256([
                    0x52be63347084fc91,
                    0x75327808a0984aeb,
                    0xb7218e7af42ee81c,
                    0x2f3e363ac20b15c5,
                ])),
                Felt::new(BigInteger256([
                    0xebbff4d59743e7dd,
                    0x3660e173f6590144,
                    0xa8b5b5567258c56d,
                    0x3c9fcfd87cb35b9c,
                ])),
                Felt::new(BigInteger256([
                    0xedebde2d7de93d66,
                    0xa0d0b93ee74004db,
                    0x6379984147e0e235,
                    0x11a0d7ab4daa0227,
                ])),
                Felt::new(BigInteger256([
                    0x983ce6a95590f03b,
                    0x0ca52d066b531056,
                    0x07b69db5edcc89bf,
                    0x35f34e3333c60385,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x6d269e2b122bc0d1,
                    0x960b8ab8a2880b51,
                    0xd56aa34143511943,
                    0x3f4a489274d6b584,
                ])),
                Felt::new(BigInteger256([
                    0x3cea86094852117f,
                    0xda5065601ed17d9b,
                    0x4852b15ce43836e9,
                    0x0028350f346fa306,
                ])),
                Felt::new(BigInteger256([
                    0xabd4f0e13080f13a,
                    0xa981e4bf68c838ed,
                    0xcfadf0b62058f44b,
                    0x288f26e270f6a8f0,
                ])),
                Felt::new(BigInteger256([
                    0x60b9556ddcd904a8,
                    0xe8de6ba62cbe35b5,
                    0x0f6ff8296198cc4c,
                    0x2e433799d680acd0,
                ])),
                Felt::new(BigInteger256([
                    0xf3d83d4b1e5a5f76,
                    0x68e635461a981930,
                    0xdbcb7edb49378aaf,
                    0x1b52e27c10da9054,
                ])),
                Felt::new(BigInteger256([
                    0xc2ad7ca7475e3ba3,
                    0x4c8a3c8f1e6dec8a,
                    0x74eef59817466e46,
                    0x3a4d8b2d39392c75,
                ])),
                Felt::new(BigInteger256([
                    0x923fad136adaada5,
                    0x13f368be4a84dcf0,
                    0x66ade3dc9cb6b34d,
                    0x296f4a4aedd5084e,
                ])),
                Felt::new(BigInteger256([
                    0x06ecac6b85c7b672,
                    0x0a8be3d5913c8ad6,
                    0x449dd6c041240089,
                    0x042c57f327ed9a85,
                ])),
                Felt::new(BigInteger256([
                    0x9b928dc2f2e31bb2,
                    0x44494f67e5e3f455,
                    0x13796f770c3c4835,
                    0x367b960c147f596e,
                ])),
                Felt::new(BigInteger256([
                    0x71294407959b4bd5,
                    0x05bfa4ffd4caa40e,
                    0xb044b81d1111c202,
                    0x2a30c079b497482c,
                ])),
                Felt::new(BigInteger256([
                    0xf347126d5cf7b384,
                    0x85e67da2f02780f2,
                    0x60e430e7d389b9a9,
                    0x0c20e07eba54adf5,
                ])),
                Felt::new(BigInteger256([
                    0xc0b351091e7c3eb2,
                    0xd3b769430705e6b5,
                    0xe92a4736cfa95c53,
                    0x10ff020848ecb643,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::new(BigInteger256([
                    0xb61d70d0ffffffb1,
                    0x6c36ca390b1fe3a1,
                    0xfffffffffffffff5,
                    0x3fffffffffffffff,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xe6a41be4298cd1c5,
                    0x0b5ec99392c66a47,
                    0x7640ae0640e146eb,
                    0x36cc1faa69d7f9b3,
                ])),
                Felt::new(BigInteger256([
                    0xeabb9557f96920ba,
                    0x722c8487bdf922a5,
                    0x837368680f35e544,
                    0x327e518a79812c4d,
                ])),
                Felt::new(BigInteger256([
                    0xf939f499cf90cf3a,
                    0x9533b6c7659cba7c,
                    0x94b973e586bc6e36,
                    0x280fd2bdd7279285,
                ])),
                Felt::new(BigInteger256([
                    0xbd46a40df13f4773,
                    0x964536348bd21e68,
                    0xa9dfed55c2b20757,
                    0x065cacda85666b09,
                ])),
                Felt::new(BigInteger256([
                    0x1e8f905611763981,
                    0xc818990f685940b6,
                    0xdadda0e21dc42b39,
                    0x2243450dbd298573,
                ])),
                Felt::new(BigInteger256([
                    0xe0825c54d27971bb,
                    0xd58d930866ee57b0,
                    0xd3ce6a41c4bce9bd,
                    0x14747af7b7acdd53,
                ])),
                Felt::new(BigInteger256([
                    0x6a92887d73c33341,
                    0x26b5e31c99191b62,
                    0x2c5d4b70914a28c3,
                    0x3819282738263b8f,
                ])),
                Felt::new(BigInteger256([
                    0x34fada1b3e7bd378,
                    0x2c8722a8840b3958,
                    0x1c2402cf479e9489,
                    0x284826a28240e99d,
                ])),
                Felt::new(BigInteger256([
                    0xa21a38b94f314015,
                    0x09e1694a7ccea76a,
                    0x5023b0b3bd4d7fdf,
                    0x347a1631a1389c50,
                ])),
                Felt::new(BigInteger256([
                    0x7089afdbc768c282,
                    0xb3ee621b03853874,
                    0xc1ab187d7f6d0fb1,
                    0x15d28f9b2fc31db0,
                ])),
                Felt::new(BigInteger256([
                    0x10a84d6f0b89b0f0,
                    0x15a347651d588b46,
                    0x6fb85351249dbe9b,
                    0x12cf32b3b1c7f375,
                ])),
                Felt::new(BigInteger256([
                    0xa5b974535b162bb4,
                    0x88ac2afeae294f7c,
                    0xd62f09070445e1e3,
                    0x0df50cae727d0553,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x563058e26d18dd11,
                    0x9b61e5e3bfe1da26,
                    0x649e370ac418eed3,
                    0x3ce88ae822864604,
                ])),
                Felt::new(BigInteger256([
                    0xd7603ea92c513c28,
                    0x1975a3be1b4d1a0c,
                    0x1cc96dc64ad8cbe8,
                    0x18c70a2b34103b2a,
                ])),
                Felt::new(BigInteger256([
                    0x62749c42cf57d68a,
                    0x2e0aea50c3132676,
                    0x43bef9647675ae05,
                    0x3a37a82037454eb9,
                ])),
                Felt::new(BigInteger256([
                    0x901fb3ae2168e7b1,
                    0x2ab967a1178d3963,
                    0xa20c8e58cb698977,
                    0x05475abe288e1337,
                ])),
                Felt::new(BigInteger256([
                    0x93d7c7a1288695e1,
                    0x1be45aad8687ef9d,
                    0xb0e99a3e8c9ef9c6,
                    0x3b4240b13734096e,
                ])),
                Felt::new(BigInteger256([
                    0x5342f2c474967a9d,
                    0x2011ee67a3c43847,
                    0x6b874ad1930cbe76,
                    0x0ed9117794cac0d8,
                ])),
                Felt::new(BigInteger256([
                    0x5b69645bf1bea578,
                    0x9f228bf10baefcf9,
                    0x4786847183f43f6d,
                    0x09a6d8d7ccba2e9f,
                ])),
                Felt::new(BigInteger256([
                    0x3c2f53c9408d4778,
                    0xec3e6f5cab139667,
                    0x460198dc0a064483,
                    0x395b90b1120bfe05,
                ])),
                Felt::new(BigInteger256([
                    0x1e0b8a3b1ecf8c81,
                    0x8954f566b5a6bf17,
                    0xd5b37341b5fbf757,
                    0x3b68cfef5313987b,
                ])),
                Felt::new(BigInteger256([
                    0x43fd841ebd43525b,
                    0x857a19de35d85089,
                    0xdb2779390c2fdc3b,
                    0x0bf10b5788a31438,
                ])),
                Felt::new(BigInteger256([
                    0x5d925295f4e2651d,
                    0x2240d49caac59b77,
                    0x3ece2f1390d8bc33,
                    0x3509cab20a997588,
                ])),
                Felt::new(BigInteger256([
                    0x0baf57c94beffb82,
                    0xedfc18e5644251b5,
                    0xdc1f069e68fe5b98,
                    0x1e810fa83beddd8e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4220caa5571928c6,
                    0xb30414b58bcbf475,
                    0xce13f0da92883eb9,
                    0x3bf5397426355fbc,
                ])),
                Felt::new(BigInteger256([
                    0xb527a6b288ed5a5e,
                    0x518f965b2b3ae456,
                    0x780c9d4f24d291a6,
                    0x054ea07f813cf099,
                ])),
                Felt::new(BigInteger256([
                    0x1f96b71ce72c8b94,
                    0xcad4d860c31be938,
                    0xef39c4a4aa3b63f1,
                    0x330d7bcd84d060cf,
                ])),
                Felt::new(BigInteger256([
                    0x2798fceb70ef1664,
                    0xf2fbf98d6270ef0b,
                    0x8658d44b93d6ecbe,
                    0x3aff0650b91a3962,
                ])),
                Felt::new(BigInteger256([
                    0xca897338c5a8deb0,
                    0xc2cce004cbdab493,
                    0x805b8828e3cd18de,
                    0x363ab4fdf099902b,
                ])),
                Felt::new(BigInteger256([
                    0xfb13ad35e19ee5db,
                    0x297c6d1f2e56ba45,
                    0xc10e1ca438b001b0,
                    0x17c983af0a4e5872,
                ])),
                Felt::new(BigInteger256([
                    0x8bbc2f47381b2ee0,
                    0x361710858a4e1b09,
                    0x296375354d2b4575,
                    0x1168263e49aed7e8,
                ])),
                Felt::new(BigInteger256([
                    0x649b0eeacbf1b273,
                    0xe04d8946a1d6e4e7,
                    0x7447946d8776b2a0,
                    0x237253ea0efc6bd2,
                ])),
                Felt::new(BigInteger256([
                    0x6084495f91e7ef97,
                    0xd7dc9a95277b18cc,
                    0xbb03d81a8b2752f1,
                    0x15d5bd7e450921cc,
                ])),
                Felt::new(BigInteger256([
                    0x1ce16a5b76a9e2e4,
                    0x703122a81bb3247e,
                    0x2a3ebcdf6c769d50,
                    0x0e273d28c104ac76,
                ])),
                Felt::new(BigInteger256([
                    0xebe866b2edde6fb4,
                    0x9ff6e3c45eecc513,
                    0x5ea52a8f49cbb74c,
                    0x35c019113d20d5ce,
                ])),
                Felt::new(BigInteger256([
                    0xfe0bc1fed268d050,
                    0x38eb282dd61c258c,
                    0xc62e2f8cbe156cba,
                    0x1636e0cf3d0bb542,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb24f1d8367936416,
                    0xe73a74a71ec35639,
                    0xd7e17ccdc1b163c3,
                    0x063ad180c47b7c43,
                ])),
                Felt::new(BigInteger256([
                    0x48df79fe9ca28da2,
                    0xa357776a103f17ee,
                    0x14beeb054b76b8db,
                    0x189c76eb2143b2fc,
                ])),
                Felt::new(BigInteger256([
                    0x5d70a42e4a9d3335,
                    0xbc39fff2cf3ac83b,
                    0x44babb53522ac7ea,
                    0x2687bda8fd777bc3,
                ])),
                Felt::new(BigInteger256([
                    0xb01ef288d03d6225,
                    0x09b80a036b201602,
                    0xca192fe230f111ef,
                    0x3afc05c62bc98468,
                ])),
                Felt::new(BigInteger256([
                    0x09dd233b5ce09229,
                    0x65ccfb90d09da164,
                    0x23e45196c734b651,
                    0x06b13d222827e9e9,
                ])),
                Felt::new(BigInteger256([
                    0x55fb90ee18f4b6b3,
                    0xdcc8e8bec74662e4,
                    0xdd41fb82ebe1bd51,
                    0x2022a7b226ce872e,
                ])),
                Felt::new(BigInteger256([
                    0x391ac2b48cd4ac41,
                    0x8846ccd551877397,
                    0x33f0dcdab0707e1d,
                    0x26e44fe7566d17c8,
                ])),
                Felt::new(BigInteger256([
                    0x47132cf8019805ad,
                    0xaf73d24a24282c96,
                    0xba5560b89404cede,
                    0x3ee9e1e8e3b37e4e,
                ])),
                Felt::new(BigInteger256([
                    0x81ac89ce040d4549,
                    0x3de8e13a9e0e2e81,
                    0x569d3c8e4998ead8,
                    0x2b0d60a0b37baef8,
                ])),
                Felt::new(BigInteger256([
                    0x0ce75cae5b0a1acd,
                    0x28bf427b815c74fb,
                    0x5a03c7a19f145464,
                    0x11673a29a7d7a58e,
                ])),
                Felt::new(BigInteger256([
                    0x084d7ad9972dd05b,
                    0x404e9616dd4ecb4c,
                    0x7992afa9065e1f06,
                    0x073ad79a8d72aea0,
                ])),
                Felt::new(BigInteger256([
                    0xd6156b33ae930d9a,
                    0x75be0a30a3094d60,
                    0x62d3ec19489bbdd2,
                    0x10cc1df3bbf93559,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x045e6811284912c2,
                    0xcee726c0cc962888,
                    0x50280ca03115bb00,
                    0x3eaf4d2763feb745,
                ])),
                Felt::new(BigInteger256([
                    0xcb93bdd6c86960fe,
                    0xfbfcdd666fa49840,
                    0xc92e302e73130eed,
                    0x25d475ab31680f50,
                ])),
                Felt::new(BigInteger256([
                    0x8ea3aadeb441aed8,
                    0x015a4217235e18af,
                    0xe1a887d6dd9552eb,
                    0x14aff650fd949896,
                ])),
                Felt::new(BigInteger256([
                    0xa816a29ef9f70293,
                    0x31ffa1e443fb7dc5,
                    0x3242f30adce1c265,
                    0x1b9fd4e7666e0838,
                ])),
                Felt::new(BigInteger256([
                    0x9c7e87efed3bc546,
                    0xb480f348b535fe7a,
                    0xa58f199755bea743,
                    0x29df11098cdd3899,
                ])),
                Felt::new(BigInteger256([
                    0x814434cb58a947cd,
                    0xc0858c6146a6e5ae,
                    0x11bcb89d4e438b85,
                    0x0cf0b0d9bada5800,
                ])),
                Felt::new(BigInteger256([
                    0x268c7581e6065b25,
                    0x7600ae5e1dffc89a,
                    0x456bf5c19a8458ed,
                    0x13576356914a7dff,
                ])),
                Felt::new(BigInteger256([
                    0x227c92b8fdf3e100,
                    0x71e29cc14120bc14,
                    0x7617ec32edc755d2,
                    0x36521aa99cb3cf51,
                ])),
                Felt::new(BigInteger256([
                    0x2fc853df5cbd57d7,
                    0xd1da6385ad4523ca,
                    0x024b0885e78ffa22,
                    0x3a6661f4b5d99a38,
                ])),
                Felt::new(BigInteger256([
                    0x2af85fa8b2fdf52a,
                    0xb78406d188c1c9b6,
                    0x4e7deb7405f04396,
                    0x3f72d43d19cbad55,
                ])),
                Felt::new(BigInteger256([
                    0x7a81ef96b5fa6c81,
                    0x4c9f057d11c33549,
                    0x1f73f8afe02ec13e,
                    0x00fcd113d779592d,
                ])),
                Felt::new(BigInteger256([
                    0x4eba6bdca7fe7670,
                    0x64ef2e64ba4018df,
                    0x20ae0a2fedb309a2,
                    0x2affb7eed5dc69c9,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x64257a45a35dfbb1,
                    0x2a81fddc6daa8080,
                    0xd31a433f08b3a955,
                    0x189c802c01c8e306,
                ])),
                Felt::new(BigInteger256([
                    0xfe6fc9b85aa53d8f,
                    0xe2dbda854fd4ba0f,
                    0xfea9257c568079cc,
                    0x000df8004778b322,
                ])),
                Felt::new(BigInteger256([
                    0x7b01117192a92fd4,
                    0x924f657bdb345516,
                    0x234194456498e18b,
                    0x0f65dbdce1bb1653,
                ])),
                Felt::new(BigInteger256([
                    0x81baaa65a69d1917,
                    0x53264604d225c9e1,
                    0xe763ffe73516d333,
                    0x29cbd0821257bd5c,
                ])),
                Felt::new(BigInteger256([
                    0x8a184726dd1ef58f,
                    0x2c8c124d4adf3b7c,
                    0x5d4aa831a6a3afae,
                    0x347f2ba4b62bc306,
                ])),
                Felt::new(BigInteger256([
                    0xb5d25c10fadf49db,
                    0xc289ea70e0045f6d,
                    0xd5fe41bb27ed3b11,
                    0x278e7360a4dc30dd,
                ])),
                Felt::new(BigInteger256([
                    0x91de9a94c6e8cf03,
                    0xffc2d3ad4bb3d766,
                    0xe25ced6b895376da,
                    0x3754795243234578,
                ])),
                Felt::new(BigInteger256([
                    0xa47f3657524a27ba,
                    0xfffadf2d49c45299,
                    0x282c52f76cfa2c39,
                    0x3141834cb0824d32,
                ])),
                Felt::new(BigInteger256([
                    0xc9196a6047aba860,
                    0xf091f023e763cd4a,
                    0x334d1ca7559011c6,
                    0x2acf0c4543a65756,
                ])),
                Felt::new(BigInteger256([
                    0xbc7b4a111336265b,
                    0xe0d221a536132f2d,
                    0x138afcb7217f271d,
                    0x37ad924b0e7f576c,
                ])),
                Felt::new(BigInteger256([
                    0x5d44a41900112eae,
                    0x46641e12190d288c,
                    0x22482b30ab505613,
                    0x3c9ab1b5e578707a,
                ])),
                Felt::new(BigInteger256([
                    0x12e8fc37a778e039,
                    0x83f1f2ab6edb7b16,
                    0x023d8946467f5ec3,
                    0x1c6fd4f47ed17b33,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
