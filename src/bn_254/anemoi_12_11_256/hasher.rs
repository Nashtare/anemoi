//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 31 == 0 {
            bytes.len() / 31
        } else {
            bytes.len() / 31 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 31-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 32];
        for chunk in bytes.chunks(31) {
            if num_hashed + i < num_elements - 1 {
                buf[..31].copy_from_slice(chunk);
            } else {
                // The last chunk may be smaller than the others, which requires a special handling.
                // In this case, we also append a byte set to 1 to the end of the string, padding the
                // sequence in a way that adding additional trailing zeros will yield a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 32];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 31 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn merge(digests: &[Self::Digest; 2]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        // 2*DIGEST_SIZE < RATE_SIZE so we can safely store
        // the digests into the rate registers at once
        state[0..DIGEST_SIZE].copy_from_slice(digests[0].as_elements());
        state[DIGEST_SIZE..2 * DIGEST_SIZE].copy_from_slice(digests[0].as_elements());

        // Apply internal Anemoi permutation
        apply_permutation(&mut state);

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        // We can output as few as 2 elements while
        // maintaining the targeted security level.
        assert!(k <= NUM_COLUMNS);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger256;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger256([
                0x3630d013a74b05cb,
                0xe8e787701575b607,
                0x5209da6be83b026a,
                0x1b798c94ffae66e0,
            ]))],
            vec![
                Felt::new(BigInteger256([
                    0xffde3543a033d160,
                    0x6b417a4170fd37c7,
                    0x9d2c0a8591b5a905,
                    0x155eeed725c47487,
                ])),
                Felt::new(BigInteger256([
                    0x392a1cbb3bbc520e,
                    0x6f0659b5cf2eafe6,
                    0x05b1723a4313f62c,
                    0x0786152e9f6dc88b,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xe030a50050f33318,
                    0x457ec9f737be5c58,
                    0xcf53071a8e028207,
                    0x233a3010ebd526d2,
                ])),
                Felt::new(BigInteger256([
                    0x237dc198c21d2b0b,
                    0x90506bdca2b3e73d,
                    0x1b4cc906701c06f7,
                    0x2db4cbb4f5ebd5c2,
                ])),
                Felt::new(BigInteger256([
                    0x7325223df0ed7797,
                    0x954348610c651ee0,
                    0x1b4b266147514682,
                    0x08a2e12c4e444bb7,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x0fdb3ce1768e35f6,
                    0x0197bbd3a1c61121,
                    0x5e8e61f3d8dc1230,
                    0x1d6d6c681819e3cc,
                ])),
                Felt::new(BigInteger256([
                    0xf57212bf44653bb5,
                    0x013f16912beeec9a,
                    0xbc910b5e27d821b3,
                    0x2cf0e1dba5468834,
                ])),
                Felt::new(BigInteger256([
                    0x3510caf151e266f0,
                    0x4f0e97da5c90adba,
                    0xbf9bd359a131b4bc,
                    0x14b7c006db7d706b,
                ])),
                Felt::new(BigInteger256([
                    0x056d8ac168f989ea,
                    0x453c9c542eac06ed,
                    0xcafd6ad4d107c6ad,
                    0x1bc673e4652ac3d4,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x38f45484bfb8be12,
                    0x6fd415082797e679,
                    0x6b9e6c7490b6a289,
                    0x0dee294937847a27,
                ])),
                Felt::new(BigInteger256([
                    0x434dd0eca3137150,
                    0x55e0653d0d48c7ec,
                    0x15745efa328555ef,
                    0x304d88b46d444edd,
                ])),
                Felt::new(BigInteger256([
                    0x89d973c4f65a6cf9,
                    0xebb862557d407eec,
                    0xa73ca410ad38beaf,
                    0x1df2c66413611da3,
                ])),
                Felt::new(BigInteger256([
                    0x56d1aa198280b983,
                    0xee9d2f104de6a771,
                    0x822f259f1dbfec86,
                    0x2c9120a51f381a09,
                ])),
                Felt::new(BigInteger256([
                    0xfcabfe0817ea6604,
                    0x00e238d9e3265b72,
                    0x3a13b62985c3124d,
                    0x13025cc26d2dc56b,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x883025455ee5c8ff,
                    0x855eee93366aecb2,
                    0x767e5ae1308bd5a4,
                    0x3027e527bab78d30,
                ])),
                Felt::new(BigInteger256([
                    0x94a9d61a27658381,
                    0x08db8ef1b9a01923,
                    0x2fd6f3d1c6447324,
                    0x0472b7111465668e,
                ])),
                Felt::new(BigInteger256([
                    0x89c55750ce876e43,
                    0x72e4d4f207e82d12,
                    0x222b93aa1bb1aedd,
                    0x2efd482d910448ab,
                ])),
                Felt::new(BigInteger256([
                    0x100d4d9c3b3a2442,
                    0x944838d7a8f349f2,
                    0x256815b9492996cb,
                    0x19b92f460df4bcb8,
                ])),
                Felt::new(BigInteger256([
                    0x6f1e3e2dc175dbd1,
                    0x4a7e1fce8cdecfd0,
                    0x24444a72baf2dcbb,
                    0x2edfd5df73952386,
                ])),
                Felt::new(BigInteger256([
                    0x3dc24e61e404f595,
                    0xc6dfb5d9c6fed3c4,
                    0xfaf93a53462eb354,
                    0x1bf5c30f208b8faa,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x8f0d5c1de364d70b,
                    0xf7e2e9e163926afc,
                    0x6834e70d583bce0b,
                    0x05b51966a73f1fc9,
                ])),
                Felt::new(BigInteger256([
                    0xb04c80250a89a470,
                    0xb815b2872338d83f,
                    0x15e942c2605c2117,
                    0x07fba0559e3952f5,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x8768b49e9d539f5a,
                    0xa83df4cff4b0302e,
                    0xd7ac3392eed2aedb,
                    0x2d054e1f7194a304,
                ])),
                Felt::new(BigInteger256([
                    0xa5572e17a84b8943,
                    0xb5ca4af368b484fd,
                    0xcc5da5db40167802,
                    0x2b15810392e1b7a5,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb39372c4a9bafe3a,
                    0xda1863dd7daf9435,
                    0x2d4f2c27181e4e60,
                    0x0ebcb36addf0dad3,
                ])),
                Felt::new(BigInteger256([
                    0xf545ca5b820ebe07,
                    0x333950778a5bfe66,
                    0x5c8d1518d2b6700a,
                    0x1d1f68d6d817bca6,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x64e786cf2fe705cc,
                    0x91c75182cbc07167,
                    0x904bae485e40bd52,
                    0x25144de1bb3669f1,
                ])),
                Felt::new(BigInteger256([
                    0x143c15ad74be6858,
                    0xe6d0fcd834c7cfab,
                    0x8f13f286f2a1cbd1,
                    0x2d9c222dbd9566e1,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0635c7ad476c1d49,
                    0xfaf7ef673cc8746c,
                    0xb2246aca9240b78e,
                    0x1fcc88a043b37bbb,
                ])),
                Felt::new(BigInteger256([
                    0x50fc3b18482a6f60,
                    0x39980decc530b90f,
                    0xf74890bba59ce333,
                    0x0172a96904eb4e4c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe8ac72fa2aeecd58,
                    0x150aed71df8bce3f,
                    0x1d18d03952d1015f,
                    0x3055a338e21a2b25,
                ])),
                Felt::new(BigInteger256([
                    0x409c12f442b316f0,
                    0x97a4f94a0afdffcc,
                    0x5e43e7cdd3a8fffb,
                    0x0eb50734a255725e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x101e0e396f0385b1,
                    0x03070982767bb75b,
                    0xecbaeb451aa9203a,
                    0x306442bb38312941,
                ])),
                Felt::new(BigInteger256([
                    0x6d598375c70656c7,
                    0x76e40730a8adb452,
                    0xc3637b128418922c,
                    0x15d5e243b759b11b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0faafcb0730ab892,
                    0xa88342ee69e9e1e9,
                    0x26eb3ae082281385,
                    0x15794c1b8daef283,
                ])),
                Felt::new(BigInteger256([
                    0xc0f5a95075791f08,
                    0xecf29406c31cfcc5,
                    0x0a936776f56f2de7,
                    0x11ec3db8cf0613b1,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa5a988eadbc582c0,
                    0x6b52e00f04920533,
                    0xf2daa57ba652ce50,
                    0x118a7baff2979beb,
                ])),
                Felt::new(BigInteger256([
                    0x554f4bf72234f4e8,
                    0xfecc8871e7dfdaa7,
                    0x25868f240331bb13,
                    0x06c67024c2f80b9f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa31aeb00f8479bd6,
                    0xba06ca3f802fcaad,
                    0x20911426a854985d,
                    0x234147f2595fa8f0,
                ])),
                Felt::new(BigInteger256([
                    0x74f863f5f61fad45,
                    0x557989ed7604a119,
                    0x826e62b5556713c1,
                    0x2bc166e6ffd19859,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x922527e915dd527b,
                    0xc470fd255b8fbded,
                    0xdeb3f89f7cafa79c,
                    0x2877a9d3c09a6c76,
                ])),
                Felt::new(BigInteger256([
                    0xbabf3f8c6714c441,
                    0x677e3f5d81ef1c61,
                    0x9062d573ba0920f2,
                    0x1a84f4891a7d7fac,
                ])),
                Felt::new(BigInteger256([
                    0xcf1cef3c93407d0e,
                    0x28bfca7e72fdd3ee,
                    0xfa22df4c0f771efe,
                    0x00b470ccae65b608,
                ])),
                Felt::new(BigInteger256([
                    0x06849fb818ffcfc6,
                    0xc1fe2496bc198a65,
                    0xcf7751027c4969e6,
                    0x21a0602763ed6947,
                ])),
                Felt::new(BigInteger256([
                    0xb3d502633a036d28,
                    0x26ef4bc9746cf01e,
                    0x3d7b586faefb5b59,
                    0x1e98503df0dfe6fa,
                ])),
                Felt::new(BigInteger256([
                    0xa9ce60c15aaba296,
                    0x2d73e01a5ad6e893,
                    0x7d36d41928140623,
                    0x26e2afa779eefe79,
                ])),
                Felt::new(BigInteger256([
                    0x8d5b63eaf3929a02,
                    0xcbb0687c2937791e,
                    0xe309b5fc07d0ffd9,
                    0x287c306df9dfac4e,
                ])),
                Felt::new(BigInteger256([
                    0x5ea60bfdc9003380,
                    0xbbdae77ecccb9aed,
                    0x634c15209bb4a6d4,
                    0x15f2d85e04b7b359,
                ])),
                Felt::new(BigInteger256([
                    0x3e514604e011db46,
                    0x3cbf05ad2c348e46,
                    0x269df38c1c538ffb,
                    0x21f6ae21c94203c2,
                ])),
                Felt::new(BigInteger256([
                    0xa66d7cb3606f0803,
                    0xa6b45133df1f41a9,
                    0x4d999e8be8a5b6d8,
                    0x1ccef5594b18d767,
                ])),
                Felt::new(BigInteger256([
                    0xbe1dc910dc172543,
                    0xa19a08afa63aca90,
                    0xfeab722c1b07c3d5,
                    0x0adac81e80bb2aa9,
                ])),
                Felt::new(BigInteger256([
                    0x5257401754d6751d,
                    0x40afb3babc3cc35b,
                    0xecc348326e5e99fd,
                    0x2ee5a296a6db9ee6,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xef753a3a293c25a9,
                    0xafe510a2a1095749,
                    0x01b840e5f2d1a6e2,
                    0x08a906a9cb7228a1,
                ])),
                Felt::new(BigInteger256([
                    0xcff1cc255047c2a7,
                    0xd72c03ba9e1b347f,
                    0xfb0a99589e25b528,
                    0x2d6efcddff765cf8,
                ])),
                Felt::new(BigInteger256([
                    0xef4e0c0f99466b92,
                    0x60903d1347775ed9,
                    0x1df40ad07527aa43,
                    0x16ad5c2666ccfc3a,
                ])),
                Felt::new(BigInteger256([
                    0x1544f732eee52ee0,
                    0xee0ceadb4a82127a,
                    0x469cc38ec65f956e,
                    0x1bae3f881cd95eec,
                ])),
                Felt::new(BigInteger256([
                    0x9766f6bf4c6e9011,
                    0xd98688a8b841384b,
                    0xdff843c9e72cf176,
                    0x2f6e0a35838d4932,
                ])),
                Felt::new(BigInteger256([
                    0xf9e4fea9f22976f9,
                    0xea77220e6c4826b4,
                    0x7f4465c2972e38ca,
                    0x0c4218649e1e5d89,
                ])),
                Felt::new(BigInteger256([
                    0x5ac307385e227298,
                    0xa0e0d7f7b3908326,
                    0xefea803aed05299f,
                    0x179efdb83ae6998c,
                ])),
                Felt::new(BigInteger256([
                    0x7b030e13f0fdcaec,
                    0xd7078b4c4439ddb6,
                    0x4af0472332c6fbf4,
                    0x20c2cb47f38be991,
                ])),
                Felt::new(BigInteger256([
                    0x7226be1047687bfc,
                    0xb6b1d74707b4a0a0,
                    0x2d370c5b9a4d9368,
                    0x1740895a243a5cf1,
                ])),
                Felt::new(BigInteger256([
                    0x465a5dec1c697ac8,
                    0x18725fb0a103a506,
                    0x018f1ee162ca8255,
                    0x1c8c34b281416766,
                ])),
                Felt::new(BigInteger256([
                    0x6891c315191de879,
                    0x7e9efa2f401ef56d,
                    0x5dd9cc905ba2278d,
                    0x0f6b1d93e8715998,
                ])),
                Felt::new(BigInteger256([
                    0x07c0758252e11c37,
                    0x7b8d7063ae2a6483,
                    0x4f5fac6bbd8a6772,
                    0x10cfec57353e9968,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xafeb1da9746b3a85,
                    0x19663159621a434f,
                    0x3d2adf4285816fa6,
                    0x0745513c2a67da64,
                ])),
                Felt::new(BigInteger256([
                    0x40cf6f2ef7b2b7dc,
                    0xc69cdb15bd4e62da,
                    0xe9211b90d2577188,
                    0x1cbd3d0e31b4b0ce,
                ])),
                Felt::new(BigInteger256([
                    0x9d3a708c6e64b6cf,
                    0x50d454936e795c95,
                    0x71e21aaf936b38ab,
                    0x15741e464484451d,
                ])),
                Felt::new(BigInteger256([
                    0xc8faf9d6c4b36e92,
                    0x2a251423406e3664,
                    0xfeb1f009a7cd80ea,
                    0x14be1683c9efac43,
                ])),
                Felt::new(BigInteger256([
                    0x05d4d8e59c043b41,
                    0x17b882910f018ec9,
                    0x9e038fc595a6a2cf,
                    0x0635793d8b00a524,
                ])),
                Felt::new(BigInteger256([
                    0x5227272e99a89cd4,
                    0xbdcfaae3a782a77c,
                    0xd88bd96ad062f42b,
                    0x24aa124e5e0d9d8f,
                ])),
                Felt::new(BigInteger256([
                    0xc41d93f5554efad9,
                    0xe576fb08e597cdae,
                    0x9c8c847555956580,
                    0x18ca38304f46f26d,
                ])),
                Felt::new(BigInteger256([
                    0x611c60e5b86e990e,
                    0xf855dc7e8035d683,
                    0xd5d7784df1dfc79f,
                    0x1979e820cb354142,
                ])),
                Felt::new(BigInteger256([
                    0xdaa6aa784ca8dde1,
                    0xf0ea562bec26fdc8,
                    0xe6b3f6404b05aada,
                    0x10a7f2b004d4a79a,
                ])),
                Felt::new(BigInteger256([
                    0x635501b055af8759,
                    0x06e71bfa860e3be5,
                    0x431af2bb08dc9e05,
                    0x15b5e852fd416f42,
                ])),
                Felt::new(BigInteger256([
                    0x4bfbfeb113db6ffd,
                    0xc1e54d5875fee6a3,
                    0x6061864402b67a4e,
                    0x0dd691ada23c8fe2,
                ])),
                Felt::new(BigInteger256([
                    0x5ef9fa555574568c,
                    0x88c770f1b8154a76,
                    0x4ed0789f5117445b,
                    0x0d92accb94eb90e0,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x148c07e16ab08cfc,
                    0x8e4c80320f99b108,
                    0xa99a9528920e0fb9,
                    0x17ace32fcd7b2f03,
                ])),
                Felt::new(BigInteger256([
                    0x209b943c2d9f299c,
                    0xcd9ad2d7b72d11f9,
                    0x47b1d76d0670e82c,
                    0x2aa2f844a2686493,
                ])),
                Felt::new(BigInteger256([
                    0x0083edf25563a742,
                    0xd424c850e91f9d04,
                    0x62c95b0ca1ddd390,
                    0x09e0ac7f73737fdb,
                ])),
                Felt::new(BigInteger256([
                    0x7e1c12f5aa04d64b,
                    0xef50d158738585a5,
                    0xda495197cdf4cd82,
                    0x245aecc0132832b0,
                ])),
                Felt::new(BigInteger256([
                    0xf9fcb8fd39cc53f4,
                    0xc5a9eb81c1c8ce80,
                    0x12e66bd09b5f0219,
                    0x202ba5eafc8385bf,
                ])),
                Felt::new(BigInteger256([
                    0x235a81baa66516fc,
                    0x8d23fdc5561dde48,
                    0x6e67023780b1b8f9,
                    0x2d1f87c67075125e,
                ])),
                Felt::new(BigInteger256([
                    0x54453cc6d547bbda,
                    0xc07139431505d8c7,
                    0x0d6cff21f1a23f57,
                    0x250fab619e6deaa4,
                ])),
                Felt::new(BigInteger256([
                    0x177d083c8d272c07,
                    0x4e2c68730895a6e2,
                    0x698dffd41ce62cac,
                    0x2b898c3617ed76ba,
                ])),
                Felt::new(BigInteger256([
                    0xe934a4c7708bca02,
                    0x892905da9f1e5c7e,
                    0x4e7eeb86d6df40d9,
                    0x0ddcd4ed51b678d2,
                ])),
                Felt::new(BigInteger256([
                    0x6e4bfa59f49ed26b,
                    0x38212b47c1a89b49,
                    0x4c6547f34a4f98b4,
                    0x1e77783a73c739e8,
                ])),
                Felt::new(BigInteger256([
                    0xc083bd30e9bdea10,
                    0x2e2994aaa2540803,
                    0x5359ba128b974826,
                    0x2e0f0466a84f1bdc,
                ])),
                Felt::new(BigInteger256([
                    0x62e4ae7d5efa0b56,
                    0xa4e5c15c69ec07ef,
                    0x81060bd80e9e1b81,
                    0x0b043b247d52dbfb,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xbee1cfd86df81569,
                    0x01f78e2fae9a732c,
                    0x03abfc0f06560c9b,
                    0x2949d70a396a0523,
                ])),
                Felt::new(BigInteger256([
                    0x99ac5200f830b89d,
                    0x995449401f3e3d5e,
                    0x05a8626a5640c599,
                    0x2ac6011eb57148d1,
                ])),
                Felt::new(BigInteger256([
                    0x9bb86cb8d8cb1e43,
                    0xc41bba829875306e,
                    0x4f619af218445eb5,
                    0x20e527c5928f73bf,
                ])),
                Felt::new(BigInteger256([
                    0xd1afd59348a4db25,
                    0x00b67f9022fb0c0e,
                    0xa4049c6f7a243af3,
                    0x09d57f1c91930521,
                ])),
                Felt::new(BigInteger256([
                    0x8275dd3463da71a7,
                    0x103de761fad88ded,
                    0x434d8ac7905e374d,
                    0x15979d040d5333b8,
                ])),
                Felt::new(BigInteger256([
                    0x75814afb67dae8b2,
                    0x8870d1dafc4d76c5,
                    0x950a1567dcd15dc5,
                    0x1fb602b209832fc4,
                ])),
                Felt::new(BigInteger256([
                    0x552b1bab14a708e9,
                    0x2042dcdce36939e9,
                    0x8d9692cbcdac6b43,
                    0x16b806999b136d35,
                ])),
                Felt::new(BigInteger256([
                    0xc39210a138e98a54,
                    0x79cda53ff5014761,
                    0x559a5675b230ab3e,
                    0x1be798e9acd373f1,
                ])),
                Felt::new(BigInteger256([
                    0x08479fa78a79d238,
                    0x5f0db8be88746603,
                    0x93c0e8e01d2c1ce4,
                    0x2a555d4e065f2067,
                ])),
                Felt::new(BigInteger256([
                    0xe96c7ff3261314f8,
                    0xfac4315d48aafe28,
                    0x7c1d04ad1ddb36f9,
                    0x09ca6a8c9385be00,
                ])),
                Felt::new(BigInteger256([
                    0x85cd77fc81e651e5,
                    0x996d220cda3116e1,
                    0xe1e277825f260f12,
                    0x24a457f787bf1ebc,
                ])),
                Felt::new(BigInteger256([
                    0x3bdad99ccf8067af,
                    0x9f43aadd58ba97d5,
                    0x762bf3851f7a40fe,
                    0x2d7edbea0f5ad386,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x3214ae6c9d23a108,
                    0xdbcdab0a8dc5212c,
                    0xdfdb1804d5a7c281,
                    0x279f2af55d951e16,
                ])),
                Felt::new(BigInteger256([
                    0xebffe47553e8dc1d,
                    0x8d628eedf75bd1a1,
                    0xefd29f0808f891b6,
                    0x20d38071aa040274,
                ])),
                Felt::new(BigInteger256([
                    0x3977b59ac9543db5,
                    0x96ccbb4ef1539cc6,
                    0x273e19945874da00,
                    0x127777036b8f509d,
                ])),
                Felt::new(BigInteger256([
                    0xde28d50fc642ff56,
                    0x8a11d1408ca349e7,
                    0x833b0495867d7d0c,
                    0x15498f2627b328b0,
                ])),
                Felt::new(BigInteger256([
                    0x8bc09621ee5b4999,
                    0x21d8a4db5a6ef982,
                    0x7c5669db7ca286a1,
                    0x13ff88296e932d38,
                ])),
                Felt::new(BigInteger256([
                    0xcd6406d28a8dc1f3,
                    0x804d1f00d9766715,
                    0x71f412b512b15a02,
                    0x2a7005aa8451d2c5,
                ])),
                Felt::new(BigInteger256([
                    0x8d53938b24c2ff65,
                    0x4502bf008509e45c,
                    0xf358f55f3aff780c,
                    0x1a31b5739264b643,
                ])),
                Felt::new(BigInteger256([
                    0xe70c6d063bdccfcf,
                    0x00430a6689556c1b,
                    0xb0e184c90c575793,
                    0x01a577fbcc20ea2b,
                ])),
                Felt::new(BigInteger256([
                    0x8ed7288c6274a352,
                    0x892f8b923d36e5dd,
                    0xb036ecd2512c148c,
                    0x2607350bfb6b78c3,
                ])),
                Felt::new(BigInteger256([
                    0x77045e8702b9dc24,
                    0x9a147804d48db48f,
                    0x0330cad825b4baad,
                    0x11389d4318878e83,
                ])),
                Felt::new(BigInteger256([
                    0x594174ee1076f202,
                    0xd4218977f55457a7,
                    0x35f9548b62a9e139,
                    0x0b1180093f05fe25,
                ])),
                Felt::new(BigInteger256([
                    0x77c7a18a05a24290,
                    0x88e07b9ccd5f2a74,
                    0x93a69d8034de0441,
                    0x0bab6628481471e5,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x9ea91ae6b23566a5,
                    0xe69a70f0a7e2d6f2,
                    0x59087b9ef816c8f2,
                    0x302a28458faf9c71,
                ])),
                Felt::new(BigInteger256([
                    0x8407a15a816737d3,
                    0x05f431a352020583,
                    0xdc93f8467af14504,
                    0x2662ce432b521b13,
                ])),
                Felt::new(BigInteger256([
                    0x5475512498226773,
                    0x76a57a6b12349069,
                    0x56c28c0633919c75,
                    0x280e21b571fbe7d3,
                ])),
                Felt::new(BigInteger256([
                    0x37c8850f0ca870f5,
                    0x1184ee240c5bf5c3,
                    0x15c35e16dec445f0,
                    0x2732e5db223bbe69,
                ])),
                Felt::new(BigInteger256([
                    0x8ee8d9903fd198a4,
                    0x83de61e958e076a0,
                    0x404e1127ba0f3d94,
                    0x2c1a93dba91e9487,
                ])),
                Felt::new(BigInteger256([
                    0xf92589c1afed58c1,
                    0x034a6076b72fb347,
                    0xa8f0a0e793dab626,
                    0x181dfb5ea568fbaf,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa8a6e34e303570dd,
                    0x2dd6dfb639a234c8,
                    0x42e70e61d3f8b837,
                    0x20949e28683fd160,
                ])),
                Felt::new(BigInteger256([
                    0xe75480f2f8279cba,
                    0xa1d7141e4b803f6a,
                    0x7a7e7d227f894a4c,
                    0x1d10c6829eea9f12,
                ])),
                Felt::new(BigInteger256([
                    0x630b118a9e8a5290,
                    0xc08261992f7ab057,
                    0x2a069081e83cefad,
                    0x028f1e98e4718765,
                ])),
                Felt::new(BigInteger256([
                    0xb503bde32ccd0d93,
                    0x0d0d57e40dda291d,
                    0x55bb87ea8fe83302,
                    0x230f15eee7d4b21f,
                ])),
                Felt::new(BigInteger256([
                    0x499b755582426eb9,
                    0x98dce58818a5a5b6,
                    0xa66b26db13e7bc04,
                    0x0129fba60b9ab700,
                ])),
                Felt::new(BigInteger256([
                    0xd01d6bbda7692469,
                    0x464ed1220cb59745,
                    0xe081903493c59bb9,
                    0x050baf7d13f5d07a,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x1b5e7053ee81b2a2,
                    0x0f2652727f4646fe,
                    0x9ce4b10c57c021c4,
                    0x1473e3154cd3a4be,
                ])),
                Felt::new(BigInteger256([
                    0x439aabe6bf47e01c,
                    0xe969b13bc5c4cdd2,
                    0x8aa8a1073a6d78ec,
                    0x288bc7a2fef8ae2b,
                ])),
                Felt::new(BigInteger256([
                    0x22aef9862bb61f89,
                    0xc6da96032d613589,
                    0x2935c5c1d84325cc,
                    0x13c217dff04059ed,
                ])),
                Felt::new(BigInteger256([
                    0x9412e3e754de9ae6,
                    0xebf21b4d1dd18914,
                    0x07ecfc7ab28e5940,
                    0x2e6ff3072b8e5a94,
                ])),
                Felt::new(BigInteger256([
                    0xfc01d3fcc2fc331a,
                    0xd73ce2e37df9a89e,
                    0xa46eccce47ffffc8,
                    0x1a800d03eb62d70f,
                ])),
                Felt::new(BigInteger256([
                    0x695e1be67514bcd7,
                    0x5426f790a800e01d,
                    0x5620e47258b70495,
                    0x04db275256ba72de,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xab8ab82a38a977a7,
                    0x3464a2638e470380,
                    0x6d93bca987f68fe1,
                    0x2042489b2cc8d6de,
                ])),
                Felt::new(BigInteger256([
                    0xcefe06bd0a4065e9,
                    0xc14a9d7eec01311b,
                    0xa1df8bbec27916b4,
                    0x0732ae1b89dd7ec4,
                ])),
                Felt::new(BigInteger256([
                    0xdab8954e308b8146,
                    0x1b2b56668bad717f,
                    0xa33f4906dd2e9d0f,
                    0x21f72bce05a16d96,
                ])),
                Felt::new(BigInteger256([
                    0xf233d0a572e87ffc,
                    0xf02d61b8a7bd8340,
                    0x9f091a783d949904,
                    0x1e67295f11fffde6,
                ])),
                Felt::new(BigInteger256([
                    0x83e1723f82ca6e1a,
                    0xdebc6df0ced0d3b7,
                    0x9f0172d7dc1f9416,
                    0x203d5bed82700595,
                ])),
                Felt::new(BigInteger256([
                    0x8b4d4267d2897efa,
                    0x826f0bf8c29d9ae9,
                    0x5b69b7f70cb2ea56,
                    0x22af0b04070e3063,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x85e11d91dc5b7d9d,
                    0x331b0bf9c8305f3b,
                    0x584b84d9e6694270,
                    0x095c9c196847bf2d,
                ])),
                Felt::new(BigInteger256([
                    0xead776dfc7ec2268,
                    0x37c80f98c4658340,
                    0xc180b3b3d06b7a67,
                    0x01f755ef6034db08,
                ])),
                Felt::new(BigInteger256([
                    0x3807442ef2d0a486,
                    0x2e56857a95e74f19,
                    0x419b4e2a07191545,
                    0x01c0ee6bd9c41615,
                ])),
                Felt::new(BigInteger256([
                    0x65526c2b9dcb4bf3,
                    0x343a4ff3f122c8f6,
                    0x7055da40fd2e943e,
                    0x2159f81fe1d7b109,
                ])),
                Felt::new(BigInteger256([
                    0x324e2aab01de2974,
                    0x2dc73ef02377c16f,
                    0x544ace9c831b9aae,
                    0x210b07147666c73b,
                ])),
                Felt::new(BigInteger256([
                    0xea71f2480b17cdee,
                    0xd6757f4c4cdf0917,
                    0xe1dccc23a8e7b261,
                    0x24a2eec507119e3f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xef05bab139c68b76,
                    0x3ec19983759f57f6,
                    0x1af26430b3d8d845,
                    0x222cad8bbf81b867,
                ])),
                Felt::new(BigInteger256([
                    0x4f609b0374b08c3c,
                    0x6c13ed9e55f55bb6,
                    0xc3caebd8aca7e39f,
                    0x13707d930039f8f8,
                ])),
                Felt::new(BigInteger256([
                    0x149d3d56c458a66d,
                    0xd0d36c76857557ed,
                    0x2686707c2e6e92c8,
                    0x149ae31e017615d4,
                ])),
                Felt::new(BigInteger256([
                    0x01a08f9462e820ed,
                    0xfe1811a72b3213d3,
                    0xdaca2445d608f9e5,
                    0x0d5207d33406e3a9,
                ])),
                Felt::new(BigInteger256([
                    0x387f83f2a2c94ee2,
                    0xc08ae7de9c39e86b,
                    0xbaf1b9188b89aee9,
                    0x1c1bca64b3ac6e4f,
                ])),
                Felt::new(BigInteger256([
                    0x50faa18405c5c127,
                    0xe7e7535da82d0dff,
                    0xe3f17099aa87a95e,
                    0x2c54549d9b287c6f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xde7ff50e56fe4f19,
                    0x08c19330fbaa80b9,
                    0x32ca182a78f781da,
                    0x2a3fb2f2b76a7fcc,
                ])),
                Felt::new(BigInteger256([
                    0x9b6a0f60c4ad7998,
                    0x4d9e9f2a00f51208,
                    0xb70a08659f911bd8,
                    0x247e5bf071f1e98b,
                ])),
                Felt::new(BigInteger256([
                    0xcc88b865ca6b49be,
                    0xe68d816de4eb3faf,
                    0xe3f24c6432198261,
                    0x241a92a80116bde8,
                ])),
                Felt::new(BigInteger256([
                    0x619553416fb01d06,
                    0xbe29af61a86afe34,
                    0x92a5a118b3ec218d,
                    0x20ca6d783a85a7c1,
                ])),
                Felt::new(BigInteger256([
                    0xd0690abbd992cd4d,
                    0x93a24d45246ab941,
                    0xaaf5976bedf83002,
                    0x16ed1f07d8481e7b,
                ])),
                Felt::new(BigInteger256([
                    0x51b1c26ab5b18d0b,
                    0x7a7571519dc3bfed,
                    0xc59c54f3b8ef293d,
                    0x0d3573cb6d46c0d5,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa68c81ef21e2a7c5,
                    0x7072971dd2eeed55,
                    0x5147f8d7c61147f8,
                    0x18bd8bab440a8b20,
                ])),
                Felt::new(BigInteger256([
                    0x99db7cee84ca5c7f,
                    0x7ec22a6d6e07189b,
                    0x987f289a9d0e2fa5,
                    0x0201cd14ccae5aa6,
                ])),
                Felt::new(BigInteger256([
                    0x188ceab64d820f2a,
                    0x7c5e7a61519cbbef,
                    0x4bc0d350f216c56b,
                    0x22dc75837d5a4af1,
                ])),
                Felt::new(BigInteger256([
                    0xed3d04f9f136fcb2,
                    0xf535e892625b3ea8,
                    0x938d4a7f5bb872bd,
                    0x244d31ccde4cb65d,
                ])),
                Felt::new(BigInteger256([
                    0xa843448f76758d30,
                    0xdfc629ff06be264d,
                    0xf859fb4d7c2987b2,
                    0x05c57c034da89947,
                ])),
                Felt::new(BigInteger256([
                    0x0aba56a11735af40,
                    0x559b47774bf5975c,
                    0xebcecfe64a15310a,
                    0x266a7542004a6015,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0179536151877798,
                    0x31c9e47661863fb1,
                    0x831f06079344945a,
                    0x220bfc74e95e41eb,
                ])),
                Felt::new(BigInteger256([
                    0xbfb82af00121a55c,
                    0xae1f409c07bb6382,
                    0x5883b2874cdc1078,
                    0x2274cb9016e241b8,
                ])),
                Felt::new(BigInteger256([
                    0x4b0290271e47bdff,
                    0x2dd57a77446dceab,
                    0x9631a5797ffc23fc,
                    0x23701e9cbf3e5523,
                ])),
                Felt::new(BigInteger256([
                    0x6141b5b73d02ee01,
                    0x5d620c729a51a88d,
                    0xcdf87b8f4b844886,
                    0x022868db2755800f,
                ])),
                Felt::new(BigInteger256([
                    0x16bd7d612ffd468a,
                    0x94c4a382e747e748,
                    0x74689e7adce567c2,
                    0x136034d74298ad4d,
                ])),
                Felt::new(BigInteger256([
                    0x44358da8204c4407,
                    0x07ebd87d9c813d9f,
                    0x19fe264fc254c50b,
                    0x28cb65dd2f65adfe,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xa920478a70854137,
                    0x535682a8131cdfcd,
                    0x6e75448f7fb5d070,
                    0x2883465da3fadf79,
                ])),
                Felt::new(BigInteger256([
                    0xbffa9e0f0f83cf6d,
                    0x709764b3e6f5ed6e,
                    0xfc55d62b42a6aa91,
                    0x21c46287ff074da9,
                ])),
                Felt::new(BigInteger256([
                    0xfe47c4b0d90f434a,
                    0x7249380b5edae3e1,
                    0x66b766c25dc475c8,
                    0x1d0b760a18f8566c,
                ])),
                Felt::new(BigInteger256([
                    0x0f9d19800e0aa101,
                    0xf1c7d50676737e2e,
                    0x1328a65c09eb7010,
                    0x299e53ada65583cd,
                ])),
                Felt::new(BigInteger256([
                    0x0ad045a16d861bfb,
                    0xe5f4d37ef59373b9,
                    0x798a770941b6061d,
                    0x1d07861344934943,
                ])),
                Felt::new(BigInteger256([
                    0x13c59c8db5aeb373,
                    0xb157dd2a02e3422d,
                    0x24f0d4773385124e,
                    0x15701d903a8d2f83,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x12527d1aaa8440ac,
                    0x6d40f5b0573fc146,
                    0xd15ed9ac068b5c2c,
                    0x1bc58b27b268302a,
                ])),
                Felt::new(BigInteger256([
                    0xb84e420691a7ea89,
                    0xaa79d6ddd8068f86,
                    0x7408a0a03817150c,
                    0x08242c563bb9e88c,
                ])),
                Felt::new(BigInteger256([
                    0x036dadfec052f54d,
                    0xba6d41a7bf0ae1c2,
                    0xbbbc394b0bdb608c,
                    0x291e9936942be1de,
                ])),
                Felt::new(BigInteger256([
                    0x85952ae7803ee69c,
                    0x18b936600adea1ea,
                    0x65c02d69a2e7fb35,
                    0x0dbd544cffdb66e5,
                ])),
                Felt::new(BigInteger256([
                    0xdc56965e3513ea84,
                    0x0ce667736a46b879,
                    0x301b7e0bb46a25b8,
                    0x218db9ef2776cda6,
                ])),
                Felt::new(BigInteger256([
                    0x5ff7de145368c205,
                    0xd2537ba2c6522b20,
                    0xf3d7e8bd09657de9,
                    0x03645fdf014e7fbc,
                ])),
                Felt::new(BigInteger256([
                    0xbe5c0eb21fafd5cd,
                    0xe4469b5db75834bc,
                    0xf2e6a30409face10,
                    0x157a7c7e9aef747c,
                ])),
                Felt::new(BigInteger256([
                    0xcff7faaaa648b771,
                    0xb048b52fe8c7df69,
                    0xe5dee07a161be386,
                    0x08d5b9b5555075e1,
                ])),
                Felt::new(BigInteger256([
                    0x581b1bf0993bb0df,
                    0x4223da03ac956cba,
                    0x8a3863c30fc0ca21,
                    0x0733b3ac8dafe01e,
                ])),
                Felt::new(BigInteger256([
                    0x2bd018287a17b679,
                    0x82e3f7fa6e64e60b,
                    0xff152b2d1b9bb102,
                    0x2dc7e932d2647d11,
                ])),
                Felt::new(BigInteger256([
                    0xfc825132a69abc1f,
                    0x885507ec9af337c8,
                    0x26a55295c6d34e9a,
                    0x169fb87488e106f8,
                ])),
                Felt::new(BigInteger256([
                    0x779d07efbd140cc9,
                    0xd908ae15bf3bc64a,
                    0x29d8f848d9c0975d,
                    0x13fb4984b56c7b7d,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x6f4242d9e426e931,
                    0x3a64896cb2dfd173,
                    0x36fdf224b425fead,
                    0x13d32bb4b50054f2,
                ])),
                Felt::new(BigInteger256([
                    0xe6ef6cf2a36ce5b2,
                    0x165d9300682e04d5,
                    0xc4637d02f9bab46e,
                    0x138710983d77173c,
                ])),
                Felt::new(BigInteger256([
                    0x36cb8bee7148ee8b,
                    0x780a3d942c32fd6c,
                    0x0bb805f8f7d9897a,
                    0x24e7cc6595ce36d6,
                ])),
                Felt::new(BigInteger256([
                    0x2cc2b590b187c793,
                    0xd3a10ec2235500c8,
                    0xcbe643a020e653c2,
                    0x1699f3efb7243d28,
                ])),
                Felt::new(BigInteger256([
                    0x4e751d2a11267fef,
                    0x25ebbb0bd23ef654,
                    0xb0ff3a2aecb3d2ff,
                    0x1e217fb518fe126c,
                ])),
                Felt::new(BigInteger256([
                    0x3c78d59b6ad8d95b,
                    0x06f3b49ce9fcc6fd,
                    0xecc6de03ce881e41,
                    0x1027d7bab5d9bca8,
                ])),
                Felt::new(BigInteger256([
                    0x51d281870ed3664b,
                    0x20ad0548bfefb1ae,
                    0xf59c3335869aea05,
                    0x039bbee8800a4c70,
                ])),
                Felt::new(BigInteger256([
                    0xefe9c0292b05f03b,
                    0x294d27fbee3137d3,
                    0xf758165fcdcca044,
                    0x2aeba5f44f5b1537,
                ])),
                Felt::new(BigInteger256([
                    0xbb787aa4dade5ff7,
                    0x0d954dd5e6415afa,
                    0xbdab135eb493dfcd,
                    0x1adb01679a8c3f02,
                ])),
                Felt::new(BigInteger256([
                    0x4cd0d32579d99e46,
                    0x12df73c7126f3248,
                    0xdb35681b07f9f011,
                    0x20c5f810e9588b62,
                ])),
                Felt::new(BigInteger256([
                    0x228ea3807508eb5d,
                    0x7b2d50c63b5f1741,
                    0x963daacf0749d49d,
                    0x2007d43631456d48,
                ])),
                Felt::new(BigInteger256([
                    0xfab694e2e2735b11,
                    0xf1928bd1f8931ec1,
                    0x54455e7728fa7cab,
                    0x154ee8ec209701cd,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x3efef7c77b6546b0,
                    0x74e965bf6502d0df,
                    0x9a75d380954cfd12,
                    0x2b6bfedb312c81f1,
                ])),
                Felt::new(BigInteger256([
                    0x2b47fe3a593acb19,
                    0xae01a388430d4799,
                    0x193924289a1a3142,
                    0x2455b55ad124684b,
                ])),
                Felt::new(BigInteger256([
                    0xaa7b690b223f617f,
                    0x9e0c5fa360102296,
                    0x1f08581d709302bc,
                    0x19d87cad10a18d91,
                ])),
                Felt::new(BigInteger256([
                    0x00577591ed0a67f4,
                    0x17e9bb915c84a60e,
                    0x3501f67cbaf3015d,
                    0x2d0b41c79e181259,
                ])),
                Felt::new(BigInteger256([
                    0xc21674d304df11fd,
                    0xbbb24ed419b0e8b0,
                    0x67e324dc23d6ab9f,
                    0x0d92f6483db3fc50,
                ])),
                Felt::new(BigInteger256([
                    0x16a248af012e26ae,
                    0xf092a9bb19a3af27,
                    0xff62e4d788206ed9,
                    0x2ff3eb50789b9d73,
                ])),
                Felt::new(BigInteger256([
                    0x25f4154099cae547,
                    0x291732d40ba1353b,
                    0xf7e222afb8fe8013,
                    0x1f58197675232434,
                ])),
                Felt::new(BigInteger256([
                    0x2109e1316d2655de,
                    0xf536035a9dfe0535,
                    0x591559a18264d6a5,
                    0x192ac230f012c7f2,
                ])),
                Felt::new(BigInteger256([
                    0xe6a94bd8c0d27057,
                    0x91f2656b7337bab8,
                    0x048b6fa64a406cb8,
                    0x0c42e7604e49a121,
                ])),
                Felt::new(BigInteger256([
                    0x4e8dcb08ede31846,
                    0x44a2686d7e76cbc0,
                    0xa131746ac690f6a1,
                    0x19b55ee1f8660837,
                ])),
                Felt::new(BigInteger256([
                    0x2dcdcbac9b1ba0bc,
                    0xbd24563fe9dfaa94,
                    0x88403a7b0ba7021a,
                    0x106948e7b70d9a96,
                ])),
                Felt::new(BigInteger256([
                    0xe32f5ca900c1256a,
                    0xd9819c1f0bc656b5,
                    0x152d19e1ea0bbbd1,
                    0x2c7e20de7acb7e5e,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x9cffaa9cff821d39,
                    0xad62b1d729d05202,
                    0xb0ff31a5a3298cbb,
                    0x17716abf5504d86d,
                ])),
                Felt::new(BigInteger256([
                    0xb2fa86a2c963eead,
                    0xefd3235f2c544a5d,
                    0xb397eac3674d71f1,
                    0x2379de153652d5b8,
                ])),
                Felt::new(BigInteger256([
                    0x9ee6ceb075a8f620,
                    0xc4fbcb9fb1421692,
                    0xdaead4d1682d800f,
                    0x153116e6eb3e6f5b,
                ])),
                Felt::new(BigInteger256([
                    0xa0c87d94e7838810,
                    0x860070d286b98ab7,
                    0x0a0641321c1cf6ef,
                    0x1f71744329983e14,
                ])),
                Felt::new(BigInteger256([
                    0xe0ba24f0d26d6cf7,
                    0xbf7e062ffd2c6ca7,
                    0xc15f707f98afa1ed,
                    0x153bdbb11be4e91b,
                ])),
                Felt::new(BigInteger256([
                    0xf2979a6737718f6c,
                    0x02403a78c26e5047,
                    0x2e3087a8774a7ef7,
                    0x29355b9ba3b56405,
                ])),
                Felt::new(BigInteger256([
                    0x19c592b30b859760,
                    0x067197b44a898fdb,
                    0x1d926fa487b5e60e,
                    0x269d08d867557288,
                ])),
                Felt::new(BigInteger256([
                    0x9e62be96cf59f4b2,
                    0xa53f73ae2fe9f03d,
                    0xbfc219f52e8af4a4,
                    0x02f32707a596db3d,
                ])),
                Felt::new(BigInteger256([
                    0x6752ad6ce7422228,
                    0xa68c22a435beda90,
                    0x367cde7f9a327395,
                    0x257d76e328e36220,
                ])),
                Felt::new(BigInteger256([
                    0x0374eea459736dfe,
                    0x24a4f6be3b498c6b,
                    0x667d597dd7a19aaf,
                    0x0dc6ecea9a26ac0a,
                ])),
                Felt::new(BigInteger256([
                    0xc0cd00e0f5d28541,
                    0x7aa4e877a9917185,
                    0xd757b0400228d861,
                    0x072a51ef25cbe210,
                ])),
                Felt::new(BigInteger256([
                    0xa9d3416890ed7481,
                    0x3a06c3a6af9c1945,
                    0xf437a90591de0887,
                    0x0e301c390fd6a02a,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x2e94bd022d1e773f,
                    0x6f144add3175987c,
                    0x1533ad286515fe40,
                    0x2914dde314b029a8,
                ])),
                Felt::new(BigInteger256([
                    0x84d07d33a5c09cb1,
                    0xab0c6bf2700ed660,
                    0x63875a8265a69247,
                    0x1e4be85e79ee76b2,
                ])),
                Felt::new(BigInteger256([
                    0xbe175beeef15c391,
                    0x0b56e0c77e3f4d55,
                    0xd98fa10bf935878e,
                    0x0a0d8d19fe033427,
                ])),
                Felt::new(BigInteger256([
                    0x497df9c0cac76df8,
                    0xcfa12d3f9bab6a82,
                    0x75320ce6e6240e7d,
                    0x2cf5998d2e15afef,
                ])),
                Felt::new(BigInteger256([
                    0xcbdb11c702fdf809,
                    0xdda22d99a5d5a24f,
                    0xf03d92d2018c68c7,
                    0x0d34839e4d6a60b8,
                ])),
                Felt::new(BigInteger256([
                    0x26b9b756ef40a7d2,
                    0x205c4eeadb351cfc,
                    0x333490130150dd8f,
                    0x0667a440b1943ac8,
                ])),
                Felt::new(BigInteger256([
                    0xb95975faa759d0cd,
                    0xa4084e7630c5fd4c,
                    0x7a56c5752c2c90f5,
                    0x08f9fd8d8b42534e,
                ])),
                Felt::new(BigInteger256([
                    0x22f3498cfb3987c9,
                    0x7b97a76eadc9866f,
                    0xde88b7ab48e57410,
                    0x1b68f79e3f7767e2,
                ])),
                Felt::new(BigInteger256([
                    0x0c6ee83f4b5a6e0f,
                    0xaf3ddc99efd6bc34,
                    0x7e1c93ac7840054d,
                    0x282ea0c59f632441,
                ])),
                Felt::new(BigInteger256([
                    0x105a600cc20d323b,
                    0x80984e8b31c01025,
                    0x2ece327569b202d5,
                    0x2e1a36bd9b8aa7f9,
                ])),
                Felt::new(BigInteger256([
                    0xbe6365b87cd5fe49,
                    0xae1448b0b971c28d,
                    0x9683b1262e560cf3,
                    0x02573ae324ca69da,
                ])),
                Felt::new(BigInteger256([
                    0xe72f20ea34149a93,
                    0x3eeb29fc07a6ed44,
                    0xf384005ed4949d27,
                    0x165f8ebe0ec4ede7,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xade0ae0d390885e2,
                    0xb3dc398fdbe4eb1b,
                    0x8b2831be156d27f9,
                    0x2e6ef3be70353339,
                ])),
                Felt::new(BigInteger256([
                    0xc306a965a7913e9c,
                    0x858bf31a723f1ce4,
                    0x3746642ef0113e19,
                    0x1afe3b937723756f,
                ])),
                Felt::new(BigInteger256([
                    0x05acba66e2651d57,
                    0xc2bc8ca35ab91cd5,
                    0x5cdaf06f5d4cede4,
                    0x27bc78f2b39a0ccb,
                ])),
                Felt::new(BigInteger256([
                    0xa70d5055718c26ac,
                    0x3011ade81365b8c0,
                    0x3dda09cda053fdf8,
                    0x2d681247598c0c04,
                ])),
                Felt::new(BigInteger256([
                    0xe36b721010fdeed8,
                    0xe3508c898b8fbc5f,
                    0x4c5ed79a53adc682,
                    0x04aa3733b569dd6d,
                ])),
                Felt::new(BigInteger256([
                    0xdf0c6255a318be6e,
                    0xc202569995184189,
                    0x23d2c280bd54f2c4,
                    0x0623ea9ec7220ca2,
                ])),
                Felt::new(BigInteger256([
                    0x87bde97695ebc749,
                    0x3a5c4d1ef5469777,
                    0xa7005b40b7cff899,
                    0x0c5cb95f0daeb70a,
                ])),
                Felt::new(BigInteger256([
                    0x649f0367d9cac286,
                    0x5ef41d44356832a6,
                    0x452c2d32b0eddc97,
                    0x2df1333dbdeb0afe,
                ])),
                Felt::new(BigInteger256([
                    0xbc6c4521e6f461af,
                    0xd3e42316e1ae3667,
                    0xa515967be23557b6,
                    0x1c50aec66adcc838,
                ])),
                Felt::new(BigInteger256([
                    0xbf31c3b430fe9794,
                    0x41aa3d5bb1a8a029,
                    0x7d4b5390ef2a2521,
                    0x139127250aebd2c7,
                ])),
                Felt::new(BigInteger256([
                    0xfee8f1f475be237c,
                    0xf49a63e2b3618541,
                    0x7efbe3490aecd11d,
                    0x0bea361045c7c08a,
                ])),
                Felt::new(BigInteger256([
                    0x1d382b6ae7118f04,
                    0x060fde790bd2665c,
                    0x7d11b95d7e4e9a19,
                    0x1cc59f18d0f5c37a,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x09c62d6dd92f6c2e,
                    0xb21b7822421448e2,
                    0x7f788d5fe2b4f241,
                    0x238a40f0e866d878,
                ])),
                Felt::new(BigInteger256([
                    0x3cb497fd8d0306fb,
                    0xebc0ab1b44aa1974,
                    0x2aa76bd7ea8d905e,
                    0x04eb1297309394d9,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x554d6a2e51023226,
                    0x873626d781c28ad6,
                    0x1358c5bed01d63e9,
                    0x244db867584c0fc6,
                ])),
                Felt::new(BigInteger256([
                    0x30551e7cf3e0d16f,
                    0x5db1d292fd9e3541,
                    0xf86b4f8b21b5c0aa,
                    0x14c73d7bb9838182,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xfdeeb1c004b707fe,
                    0x15bc60c7c22f5a98,
                    0xb238fde5f681eefc,
                    0x1251b98647453591,
                ])),
                Felt::new(BigInteger256([
                    0x04eb1f9db0be3a92,
                    0x9201598823256c77,
                    0x30663c3dc4317e65,
                    0x2b729389a00fdb74,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x91e3a78a3b056c79,
                    0xff49919817e1b39d,
                    0x3f33ed1b3e42104b,
                    0x01ae3370f27709b7,
                ])),
                Felt::new(BigInteger256([
                    0x105e8db377356798,
                    0x9c65a09eedea84b9,
                    0xe40218778b3f41b2,
                    0x17e4940bc1ba0ce4,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x8eb8f8b03ee2d9b0,
                    0x0100ded820c74896,
                    0x9170978ec35a8731,
                    0x03575d6add9657c7,
                ])),
                Felt::new(BigInteger256([
                    0x073cb0b30b46227b,
                    0xac8a4a36c0caa23f,
                    0x6cd0ed28a143bb6b,
                    0x117ab743f37dec28,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x064d4b2e7b66c629,
                    0x8da4e56b9fd16005,
                    0x016ff05cac1e20b0,
                    0x06e91cb54caee0ba,
                ])),
                Felt::new(BigInteger256([
                    0x92d7d5b04a2a1bef,
                    0x4e66f9bb26405572,
                    0x75827db5e6bf40d3,
                    0x247ff5873b073a03,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf0a3eda67de09626,
                    0x30634ef539364c7c,
                    0x8f4553d367a49a0c,
                    0x2b2e71aec6270388,
                ])),
                Felt::new(BigInteger256([
                    0x59e7559741e06edd,
                    0x11de580d1bafc813,
                    0xe7f842d78793dbe2,
                    0x044e3ab35a081076,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x63db8e079a1b0a41,
                    0x195cb40f28c1a42e,
                    0x2b6d8f7cbcc8ec05,
                    0x0f38f3d368239a25,
                ])),
                Felt::new(BigInteger256([
                    0x551803f4c16c602f,
                    0x7302c3a2706fa9d2,
                    0x59433b30a6263921,
                    0x098ac514f3fcb218,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x224a4579ce98c953,
                    0xcf0bcdeab8bddc13,
                    0xb735e56b53a9e832,
                    0x1035727d8631ec75,
                ])),
                Felt::new(BigInteger256([
                    0x9e523d8914e89287,
                    0x739ac2ef0f7337b6,
                    0x63eee0c680324a18,
                    0x2810e7ea2a72566d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x8ac3b96572cb8364,
                    0x3282394cdc6fca96,
                    0x52de1bff44588120,
                    0x1dd2eb05115ce2db,
                ])),
                Felt::new(BigInteger256([
                    0xdf642b1e51f6886b,
                    0x283801bc42ea9544,
                    0x0df25343b741ef91,
                    0x1d5c6f98ca3d1878,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 6));
        }
    }
}
