use super::{sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 1 element (32-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= y2.double() + y2
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += y2.double() + y2 + sbox::DELTA
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x675c78a2b0b9bba6,
                    0x3f70ef4e8d819145,
                    0x36865c7a3406a136,
                    0x182b95e5f8b35c9e,
                ])),
                Felt::new(BigInteger256([
                    0xcc95ef6e883875f6,
                    0x2034787f4e8ab9dc,
                    0x772996523cc1ad6e,
                    0x01d697b87bd7de39,
                ])),
                Felt::new(BigInteger256([
                    0x98a6403742fa78ba,
                    0xfd9e80c922df2271,
                    0xf28dfa30b0fa741c,
                    0x0c40f468991c66bc,
                ])),
                Felt::new(BigInteger256([
                    0x79aabcd06d312e48,
                    0xa9deeda10d96ac14,
                    0x774cefdf852df598,
                    0x0dc9c7a750960a04,
                ])),
                Felt::new(BigInteger256([
                    0xbf562f661c410854,
                    0xa74d0a790ced45dd,
                    0xc7c7bb2d6c15fc6c,
                    0x301640d734d9cf78,
                ])),
                Felt::new(BigInteger256([
                    0x3b0d56a6f3f5adab,
                    0x2fa25dbcfd42cf38,
                    0x3421b43fdec2a5e2,
                    0x200994e682df8d9c,
                ])),
                Felt::new(BigInteger256([
                    0x7692d897fdb7a8b8,
                    0x36f9f322dafcb311,
                    0x343e59e982c31c53,
                    0x1b165178535ddaf2,
                ])),
                Felt::new(BigInteger256([
                    0x9a760eef20cae92a,
                    0xe80e0eccce900cee,
                    0x3cb382c8ad73292e,
                    0x163b2235fb4e2581,
                ])),
                Felt::new(BigInteger256([
                    0x7e654e1b4d5f67ac,
                    0x203c4e2302d8f87f,
                    0x52432c50763be766,
                    0x0b075d0c9ee45996,
                ])),
                Felt::new(BigInteger256([
                    0x9b74d7d78637898e,
                    0x05d81994bba74b68,
                    0x522db48b209d6845,
                    0x2ba9f5a1920e59c3,
                ])),
                Felt::new(BigInteger256([
                    0xe8378e087ed4bc33,
                    0x05cab23bb9bf704d,
                    0x5cd7f9018d8a6d4f,
                    0x1d5e3cf120881995,
                ])),
                Felt::new(BigInteger256([
                    0xb60250d82cf2f845,
                    0x0a68063314372dd4,
                    0xf3877fe96b4836a7,
                    0x13439febdfeef2ee,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x409ec10349947ed6,
                    0xc9f933840aeb718b,
                    0x491527f6402fb9c2,
                    0x1205721bb83e3aa6,
                ])),
                Felt::new(BigInteger256([
                    0xe2fc1449e773d40d,
                    0x17eb5a13330fb2e0,
                    0xb456d900094b6892,
                    0x0ccc2f1cba2b0774,
                ])),
                Felt::new(BigInteger256([
                    0xb812b7dd30538cab,
                    0x0315c025f60be2d6,
                    0xf7e790a21cbd765c,
                    0x0b42e745d7f49f69,
                ])),
                Felt::new(BigInteger256([
                    0x0b718f9105dae0c2,
                    0x55829054edf23fc6,
                    0xb04e51272e9832ee,
                    0x11e9605e73035a02,
                ])),
                Felt::new(BigInteger256([
                    0x34739417d9938ce1,
                    0xb332dc0ff334a2a4,
                    0x9b6606b0fd535b24,
                    0x02c6ad49a3045d85,
                ])),
                Felt::new(BigInteger256([
                    0x74e3ff762ffc1acc,
                    0x3d70ae881421db27,
                    0x6a4cde463ed55151,
                    0x2d998d0bceb6be40,
                ])),
                Felt::new(BigInteger256([
                    0xe3bbe4eb68951d27,
                    0xa50fc2f4fd60f40d,
                    0xbeac5181472c0d98,
                    0x1a77bcb493328f6a,
                ])),
                Felt::new(BigInteger256([
                    0x09e9bdb79f612c46,
                    0x97b4175b710bd75c,
                    0x1312fbb1564ab560,
                    0x2e6785cd12029029,
                ])),
                Felt::new(BigInteger256([
                    0x0c282ca58f621752,
                    0x0bd42f99b1b0e226,
                    0xb853559fc14e032e,
                    0x1835e4b80d16a570,
                ])),
                Felt::new(BigInteger256([
                    0x4e6ea3b942eb2652,
                    0x04590c6dcc13b74f,
                    0x995f2c66356b6036,
                    0x2a933e1b6854ee68,
                ])),
                Felt::new(BigInteger256([
                    0x6382b448d282e10f,
                    0x4b1387f8ba898f98,
                    0xc1e0fea5b2759ff3,
                    0x0d9ebfe826df5308,
                ])),
                Felt::new(BigInteger256([
                    0xa64e72e95499c647,
                    0xce306f2519c3593e,
                    0xf988a03c580dca47,
                    0x252e2245d6cdba37,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xd76c8aa6e460f419,
                    0x5eb65d40c0ed3321,
                    0xdfcdc662eb843444,
                    0x03e37fa98b5cf2a3,
                ])),
                Felt::new(BigInteger256([
                    0x6dee910fd2a734eb,
                    0x7974002f20e54512,
                    0x5b6981db56b6a5fc,
                    0x1fd024a88f3e64aa,
                ])),
                Felt::new(BigInteger256([
                    0x3ff1de52d288b423,
                    0x9ddaf1f1a86856c3,
                    0xc29f09355179bbad,
                    0x25ee1dd12b07e37b,
                ])),
                Felt::new(BigInteger256([
                    0x94e1c80e6c4eae45,
                    0xc10127126bf5d10e,
                    0xb2dd5f47b1569e93,
                    0x203956f46a29adfb,
                ])),
                Felt::new(BigInteger256([
                    0x8fab685e5a80a70a,
                    0xf56eeea685b712a6,
                    0x0bf35e8a6ca2bb4f,
                    0x0828d78e9361439a,
                ])),
                Felt::new(BigInteger256([
                    0x44f19cdc42505008,
                    0x6308c095f8248fe6,
                    0x2f465f2b73b09cdf,
                    0x2d2356ad1e397525,
                ])),
                Felt::new(BigInteger256([
                    0x2ffed65829088873,
                    0x3f0bc3ddc6ea19a4,
                    0x172a29e22a2c327f,
                    0x0f78e57a2873218e,
                ])),
                Felt::new(BigInteger256([
                    0x3cc9b16015bde018,
                    0x246e00e5b5e6cd88,
                    0x259480533a6faa19,
                    0x1d0a3a8ca0ca1c58,
                ])),
                Felt::new(BigInteger256([
                    0x83c8ff56c909d52b,
                    0x26978995c7c272bf,
                    0x9db7b788e46f8166,
                    0x0ce92076857e89a7,
                ])),
                Felt::new(BigInteger256([
                    0xd0a4626686df7b0b,
                    0xd3208d42cb507b20,
                    0x3f40d28b3028e796,
                    0x13e4391bc07a5214,
                ])),
                Felt::new(BigInteger256([
                    0x054e512f0797eb26,
                    0xa7b7aa0b27c6b40d,
                    0xe4db94f21fb0825b,
                    0x2bf5f12b62bd6ccd,
                ])),
                Felt::new(BigInteger256([
                    0x3bb091f677e35cee,
                    0x89aa10da13e89c25,
                    0x984a5b0ac3cd6e63,
                    0x1c7c9c0aa77b4b11,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x22c1a84f6d386a58,
                    0xa7900932c37fb899,
                    0x72ce407d4298507f,
                    0x0ee36b2b1d0340e8,
                ])),
                Felt::new(BigInteger256([
                    0x5edb843d7b5002b9,
                    0x9ed7dbbd49f0e1f8,
                    0x3f97e650efdb50aa,
                    0x05e4e6dbe1646bb2,
                ])),
                Felt::new(BigInteger256([
                    0xb124eecd1ce2dd34,
                    0xe8917b3b76bbd306,
                    0xf436af6e1b633bdd,
                    0x218194277ddf5c1e,
                ])),
                Felt::new(BigInteger256([
                    0x3d1750c832c6900c,
                    0xe5aeb060909da5eb,
                    0x3e0b2fe64b38e059,
                    0x018af640600337ec,
                ])),
                Felt::new(BigInteger256([
                    0xf61441ef39d92ee7,
                    0x83e8dd4a43b5ca45,
                    0x30b0edcb155f6265,
                    0x101ca02836ea4447,
                ])),
                Felt::new(BigInteger256([
                    0x1654d004c4292aca,
                    0x48c1a2c4b7f40373,
                    0x59d9e01f73538f11,
                    0x271139c6cf005531,
                ])),
                Felt::new(BigInteger256([
                    0xe32c604db072f185,
                    0x2f1c417e25eabb40,
                    0x9e094208091de355,
                    0x185a43dccdb2bda7,
                ])),
                Felt::new(BigInteger256([
                    0x6195679b915d85c6,
                    0x5587d3874f2c4e09,
                    0x7209c583b0dc91bf,
                    0x0b135f24c4c0998a,
                ])),
                Felt::new(BigInteger256([
                    0x2406f9257d47a4a5,
                    0x23b463120cf5b3b4,
                    0xe11cfa7866f71bd6,
                    0x094d18988feda956,
                ])),
                Felt::new(BigInteger256([
                    0x7524c70e18cb91a1,
                    0x7cc1fa4ed9f4cde7,
                    0x6bafc7a556830e85,
                    0x1eaff57c197e0d5c,
                ])),
                Felt::new(BigInteger256([
                    0xb6813abb66f24104,
                    0x42087c138f1d5142,
                    0x2a5e123b7511d354,
                    0x07e3a117ba8babdb,
                ])),
                Felt::new(BigInteger256([
                    0x632df155f5aefce2,
                    0xd86db4d988fe89d2,
                    0xd6fa748dae643948,
                    0x15a9dff0ec59be96,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4663a73ef95999cf,
                    0x9d68fc019558f6ca,
                    0x900140f6545640df,
                    0x09d94ad172aec15f,
                ])),
                Felt::new(BigInteger256([
                    0xff0ad011304c5e80,
                    0x80c71dc260e97cc5,
                    0x0f87d42766129521,
                    0x033ded48b53734df,
                ])),
                Felt::new(BigInteger256([
                    0xf28e5fc4ae5bb181,
                    0x67703467f2b8b606,
                    0x96211a39009efac1,
                    0x0cd837f92b920a54,
                ])),
                Felt::new(BigInteger256([
                    0x677ee3794eac7c88,
                    0xfd6453d3ce179364,
                    0xba49f068d58f18eb,
                    0x13027a0f93f7af0e,
                ])),
                Felt::new(BigInteger256([
                    0x1151c6074bfe0fc4,
                    0x9d0e03eceaa5308a,
                    0xda3c6e4cbd9ce1c7,
                    0x1035aa52442403e5,
                ])),
                Felt::new(BigInteger256([
                    0xf289f3bc683bcee4,
                    0x5433db3559edf533,
                    0xc4351d594edda46d,
                    0x05a03523684a9cf3,
                ])),
                Felt::new(BigInteger256([
                    0x5af4275a8b1b2985,
                    0xfe75b34264e4cb9f,
                    0xf413c5f456ea9c96,
                    0x0d52e2ec3bcfa844,
                ])),
                Felt::new(BigInteger256([
                    0x8458531b833c8276,
                    0x1354e731d03c0b48,
                    0x5380be03f8e7fd58,
                    0x2dc864219508c157,
                ])),
                Felt::new(BigInteger256([
                    0xf14258d8ecb319f2,
                    0xc827ef5d6d284f80,
                    0x8aa004598cf21565,
                    0x019cc783f29fb0c3,
                ])),
                Felt::new(BigInteger256([
                    0xc06d95fb8c0b6247,
                    0x86907fda9bd7ed74,
                    0x816f9cc6babf212c,
                    0x075f5bb1ca09be11,
                ])),
                Felt::new(BigInteger256([
                    0x226aefb4ace28bfd,
                    0x3ff9d8bb5c50866a,
                    0xa2e4b829bb09b26f,
                    0x19382baaa0c0f06b,
                ])),
                Felt::new(BigInteger256([
                    0x6fd9637db337a8d9,
                    0x1a85901f6814f075,
                    0x3801316f72565bc9,
                    0x218f558247967c32,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe8380ebac027ca40,
                    0x6b9ec9840a4cc37e,
                    0x7a0d97209cdc490f,
                    0x0904140db133804c,
                ])),
                Felt::new(BigInteger256([
                    0x2e36f78186cc8854,
                    0x64e14c92421b5906,
                    0xe6672b4ab4d670f3,
                    0x20323ffac20587fd,
                ])),
                Felt::new(BigInteger256([
                    0x7f391ff5f85ef8ea,
                    0xe8d8b2f0914a0e27,
                    0x09e6cb3af903ca1b,
                    0x1037c87ba42a5aff,
                ])),
                Felt::new(BigInteger256([
                    0x533dec9b31f620b3,
                    0xecfb8cb53979a2db,
                    0xdb3015dd82a39440,
                    0x1445c3c0000ea111,
                ])),
                Felt::new(BigInteger256([
                    0x4e1cb5e210a3dde8,
                    0xf449d4e768231144,
                    0xfa420e91a1af7101,
                    0x1d7cb88197fa0ab0,
                ])),
                Felt::new(BigInteger256([
                    0xad28d76ebc60bc1a,
                    0x52af551014bf8156,
                    0x9ee53b500de4c251,
                    0x1026c5a6034cbaed,
                ])),
                Felt::new(BigInteger256([
                    0x4d4b19c08a7ba93b,
                    0xbc281311f2dfd61c,
                    0x07482febb33c2173,
                    0x011766ec4539c4f1,
                ])),
                Felt::new(BigInteger256([
                    0xbcf429bc702d45ae,
                    0x283a06148002650d,
                    0xae49c95b3e773b6d,
                    0x06ee9ab9c5794cde,
                ])),
                Felt::new(BigInteger256([
                    0xdaa2517f5892e055,
                    0xf10a5525777848e0,
                    0xfe9010950ae0f385,
                    0x2cdb87e7a3a9a63a,
                ])),
                Felt::new(BigInteger256([
                    0x2442e41d95a7704d,
                    0x2995c08698317226,
                    0xef3c381e6b071224,
                    0x27912543aad056ce,
                ])),
                Felt::new(BigInteger256([
                    0x130229febc2ee4cd,
                    0x88689ff84380cfdd,
                    0x69cbeb19edebced0,
                    0x0b26545e9ce969f1,
                ])),
                Felt::new(BigInteger256([
                    0x0d5f6e56e193e937,
                    0x8c6d4c6022754017,
                    0x31cc35e8cea4af27,
                    0x06618d387a866232,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7593b0de495f76d3,
                    0x8c79a4b584f60289,
                    0x5746975f325038ac,
                    0x0f63b75b9aeec0f2,
                ])),
                Felt::new(BigInteger256([
                    0xec71160cf7e53453,
                    0x49b4c4f17fb61394,
                    0x5549a3c04a094158,
                    0x08af21f3e4005a4d,
                ])),
                Felt::new(BigInteger256([
                    0x90d171093b8bec16,
                    0x6f8861248eeae78d,
                    0x58a4cacfb5f2fe63,
                    0x027263343729307a,
                ])),
                Felt::new(BigInteger256([
                    0xe716066040a05dfb,
                    0x85c1ea13a1dc1d26,
                    0x42f7a38213fd2ebc,
                    0x2c378d61ead3f7d4,
                ])),
                Felt::new(BigInteger256([
                    0x5cbf5d81ddb567a0,
                    0xc9b307244a177e36,
                    0xcf87937f3b3f7dee,
                    0x2c7f677725d3ebc9,
                ])),
                Felt::new(BigInteger256([
                    0xb13b5a2fdeb007ff,
                    0x73b583b669b0f7f5,
                    0x640ffcf6a0bb3211,
                    0x2081f1f718296b95,
                ])),
                Felt::new(BigInteger256([
                    0x7986101bbdfbb236,
                    0x30fd54aa7e6198f7,
                    0x61cf38bb3b0dc419,
                    0x14a7ee61321567a0,
                ])),
                Felt::new(BigInteger256([
                    0x33bb73732d4712f9,
                    0x7368432787a60593,
                    0x8f38a3fa27483d16,
                    0x2ab4efe37c227c04,
                ])),
                Felt::new(BigInteger256([
                    0xf8b0ba10d750ce0d,
                    0x5d8aeb899543b53d,
                    0xf837ea79dc3a0474,
                    0x24b04fb9fefd1245,
                ])),
                Felt::new(BigInteger256([
                    0x414c383c0a450a55,
                    0x2a338633edb9fb44,
                    0xc44a3fb437f127ef,
                    0x24195dd9970a2cfb,
                ])),
                Felt::new(BigInteger256([
                    0x9bc9f2cc4e0b8003,
                    0x175767c119a1ba34,
                    0x0f505a7b807ba1f2,
                    0x22a09bd81b8a931b,
                ])),
                Felt::new(BigInteger256([
                    0x9f5e9237caa73934,
                    0xe4d708e9cdc5284d,
                    0x076240b53c7130a2,
                    0x1e3673c0e9c26e54,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x66832dc175bad034,
                    0xde698bc51cc61682,
                    0xe279ff0f878933a2,
                    0x0b61b2621614c07b,
                ])),
                Felt::new(BigInteger256([
                    0x90bac9471b26b2b4,
                    0x2a85f96b0aafca91,
                    0x06b709c91335c823,
                    0x07cfb6342fbc5299,
                ])),
                Felt::new(BigInteger256([
                    0x87ea3590e885a99a,
                    0x70f85132620603b6,
                    0x74ed219c37193cc9,
                    0x291544ed4a5ee486,
                ])),
                Felt::new(BigInteger256([
                    0xf976896d7253f105,
                    0x06959703f441e178,
                    0x75c3a8db108adfda,
                    0x20e157c3965badcd,
                ])),
                Felt::new(BigInteger256([
                    0x0f7b02e3020329d1,
                    0x11e272e3c3f265ca,
                    0xebd766c46a7903e7,
                    0x0544deabbd1d119d,
                ])),
                Felt::new(BigInteger256([
                    0x518fad602ffdd909,
                    0x9dbb73f299862301,
                    0x1ec5ab551c42a330,
                    0x1e18474ef98b4735,
                ])),
                Felt::new(BigInteger256([
                    0x6c3caa5c0152f5fc,
                    0x586fd93974e9849b,
                    0xeb852756c5bf0e28,
                    0x0d1cf81323700be2,
                ])),
                Felt::new(BigInteger256([
                    0x24550a2346c7cda9,
                    0xea2fab2d205d7857,
                    0xedd32ee5ef3fc20d,
                    0x1ff666e6acc8f16e,
                ])),
                Felt::new(BigInteger256([
                    0xa1c025bbb8a8a0d2,
                    0x55a1e209794026a2,
                    0xa52c5a066fdedfa6,
                    0x024549981fd7ff40,
                ])),
                Felt::new(BigInteger256([
                    0x2ef3ba0106d590c4,
                    0xcbafcf00a0c5f0d2,
                    0x28a8cfa84282b604,
                    0x1e0fca154e5e17b2,
                ])),
                Felt::new(BigInteger256([
                    0x5fab74cd3a1b7dad,
                    0xb1a7f2c2049b02d7,
                    0x7a9d50d0b6cc4c48,
                    0x1b3ed6b367b88764,
                ])),
                Felt::new(BigInteger256([
                    0x21a2dbf0a7783074,
                    0x833fab90b8cce7cb,
                    0xcc4150b38f68d30c,
                    0x02dbe9a7d47559bd,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xfbd74195207f6f32,
                    0xb62265cd94eaf684,
                    0x28e7b34f041e8667,
                    0x2671b59048ea18cd,
                ])),
                Felt::new(BigInteger256([
                    0x42a76a2d8a42fc66,
                    0x5f8bdb449971472f,
                    0x2ded27a7200f21c8,
                    0x10912200f019725d,
                ])),
                Felt::new(BigInteger256([
                    0x45a81cc8cb8dbaa6,
                    0x4cab1dc147ef39ce,
                    0x65cdbb31ea3497ac,
                    0x1085137c453f873e,
                ])),
                Felt::new(BigInteger256([
                    0x3c62c0a947d971ed,
                    0x8e0fb7740ae8d653,
                    0x1a0af3b6c481449b,
                    0x0bee0f2280bf5382,
                ])),
                Felt::new(BigInteger256([
                    0x1fc18cc69798718e,
                    0x379e8df405d44172,
                    0x533b2d30152e9b63,
                    0x17c66e2a6587630e,
                ])),
                Felt::new(BigInteger256([
                    0x6eca9b51e8b4cf49,
                    0x5aca865670ebad82,
                    0x931b33c3b54a5d80,
                    0x171e2dd8c9a33a9c,
                ])),
                Felt::new(BigInteger256([
                    0x8d5c6150236c1683,
                    0xca430568818b02ab,
                    0x6392adeafbd41bd6,
                    0x160fca8562f2a3c1,
                ])),
                Felt::new(BigInteger256([
                    0xda8328b78c7bc802,
                    0x6479609910e23074,
                    0xdf986714469a32a5,
                    0x1944b623b30d50d4,
                ])),
                Felt::new(BigInteger256([
                    0x9867556c2139d684,
                    0x4f91e226989a6f59,
                    0x7ca6621f7e203217,
                    0x1a173156c72e7335,
                ])),
                Felt::new(BigInteger256([
                    0xdbe37197dfdaf657,
                    0x53e964f54012d015,
                    0xe2b2d34b99c87f15,
                    0x23b66767ce1d0b53,
                ])),
                Felt::new(BigInteger256([
                    0x6e54aa136c9520d1,
                    0x33b91ebdc2a4ef69,
                    0x73f6d6a9424596a4,
                    0x010ff7379af60f2b,
                ])),
                Felt::new(BigInteger256([
                    0x6fabca3c66bd17aa,
                    0xc8786076c12fdd61,
                    0x198e8e34d47efafa,
                    0x168b5dadb53f3587,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x9970bf4c2667374b,
                    0xb72ec62903d7e609,
                    0x69db96e8de850de9,
                    0x2fc251935bf7ee2f,
                ])),
                Felt::new(BigInteger256([
                    0xf9920bc02da4124b,
                    0x580e5a3b31196548,
                    0xbe1f2782464c6455,
                    0x15bfd523d99455ba,
                ])),
                Felt::new(BigInteger256([
                    0xfeadb8cbfc3e2aa5,
                    0xbbc9b9ad3387e95b,
                    0x343385f97caeea24,
                    0x0c4ec087632a3777,
                ])),
                Felt::new(BigInteger256([
                    0xc1119de92f7187a9,
                    0x222b4ba1bfc6dbf4,
                    0x21ac0d82db2c44e1,
                    0x2861dfd6e305656b,
                ])),
                Felt::new(BigInteger256([
                    0x8923c4ec5d38a5b9,
                    0x91d1a4de2464f1b8,
                    0xeea9fec9a542cefb,
                    0x11840e73a63579a3,
                ])),
                Felt::new(BigInteger256([
                    0x4b4b9bc35a82681f,
                    0xbf46d67023ffa018,
                    0x931a81e0d6e73e27,
                    0x16574395c12a28bf,
                ])),
                Felt::new(BigInteger256([
                    0x22ba9158452ae1ab,
                    0xad0d104ba99b60d2,
                    0x72029524ab2c1b86,
                    0x179da26d8bbfd805,
                ])),
                Felt::new(BigInteger256([
                    0xe10cfc63417eec35,
                    0x12b2cf89c47cfea0,
                    0x351466e1ec3f2b0c,
                    0x0280fa1cdd96580a,
                ])),
                Felt::new(BigInteger256([
                    0xaf874eb7193efc42,
                    0x4e08dc4eaf5b69c4,
                    0xd192e240034e18f9,
                    0x2617c49da96f91ab,
                ])),
                Felt::new(BigInteger256([
                    0x2d73f8772fb6da43,
                    0x78b75dbdfbd5cce4,
                    0x8539d674f8a15003,
                    0x19560bb79507eb75,
                ])),
                Felt::new(BigInteger256([
                    0x59e249b691a8b76d,
                    0xcadd4b0f59c1a193,
                    0xac7c35d57296d4c1,
                    0x2d26bdc4f7079cbc,
                ])),
                Felt::new(BigInteger256([
                    0xc49de697133b83e3,
                    0x2ce063550f6d4c89,
                    0x68a67c33dbf416e2,
                    0x2f085a036a572991,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x52c7f2afcc77b194,
                    0x6623184470398ce0,
                    0x32aa4687f03b6bd5,
                    0x13df60e0e8324f48,
                ])),
                Felt::new(BigInteger256([
                    0x3c5943541836c34b,
                    0xe6e7720aac48ee0b,
                    0x18cd995eb54fad13,
                    0x156bfe72a8a5a9d5,
                ])),
                Felt::new(BigInteger256([
                    0x1c6b191a97af63b0,
                    0x0b3efeedd769039d,
                    0x49f33e4c620862d6,
                    0x1d7d88be2c1a1ed8,
                ])),
                Felt::new(BigInteger256([
                    0x1827b818d01559ff,
                    0xd71e17676524fea0,
                    0x379f49aeabea1dd4,
                    0x2195a41c32b7c8aa,
                ])),
                Felt::new(BigInteger256([
                    0x0ebf29d934a2bcf3,
                    0x14c3bfbbd586c9a5,
                    0x6c103d0547cfeac2,
                    0x007c39c7fb3c4926,
                ])),
                Felt::new(BigInteger256([
                    0xef9089409f77d767,
                    0x4353ab16540c8fef,
                    0x2ed4d560ca9042ea,
                    0x2326e77d9bf27c7a,
                ])),
                Felt::new(BigInteger256([
                    0x112823b78d4567db,
                    0x12a04ce88501f50b,
                    0x1cf49029f1fa1bfa,
                    0x16eb1e540c85598d,
                ])),
                Felt::new(BigInteger256([
                    0x8587e080c9e1a897,
                    0xc64f4099a48c0d63,
                    0x6c9e995d69f717e1,
                    0x0dcf1b2353afa00a,
                ])),
                Felt::new(BigInteger256([
                    0xe82eaea8a59b6fe7,
                    0xfae8d8864fd2ae02,
                    0x37a5038e3496ead6,
                    0x006fc633a34ce0d5,
                ])),
                Felt::new(BigInteger256([
                    0x6ca4bd162e0e023b,
                    0xb8db1be64646dfeb,
                    0xc4916c3e46ce5875,
                    0x234c1ff4ecfe2642,
                ])),
                Felt::new(BigInteger256([
                    0xc7225c8431867965,
                    0x4e2f4cb7c8dc60af,
                    0xeea7d63d0f358240,
                    0x2cba5c5050cf7319,
                ])),
                Felt::new(BigInteger256([
                    0x811b132ba9a539ea,
                    0x81223b366a3f8579,
                    0xe98e7b27c3b5ba61,
                    0x207b8380c78756fb,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x53f43db285ab2b20,
                    0xc74d858987566734,
                    0x1b8861fb1818a6da,
                    0x0569f7720c6c66a0,
                ])),
                Felt::new(BigInteger256([
                    0xecdcddcba7a7edcf,
                    0xac88624844ec4fa7,
                    0x027333bcd387a9df,
                    0x2d1d4dc2e1e37391,
                ])),
                Felt::new(BigInteger256([
                    0x5675f7d42a8815f4,
                    0x357613496fc4f588,
                    0x7b40bb70e542b887,
                    0x27b3d5b7a146e8de,
                ])),
                Felt::new(BigInteger256([
                    0x460d8de534296a19,
                    0xbf2db9097c528a33,
                    0x1170a906efb3513a,
                    0x25e67c8a66d40ee2,
                ])),
                Felt::new(BigInteger256([
                    0x2d8039c031668928,
                    0x47ebf17afeb0c58b,
                    0x8fd1c4d59d694a7b,
                    0x2da0079ece75c47a,
                ])),
                Felt::new(BigInteger256([
                    0x3a5259af7ca22ab5,
                    0x882cd906f39a97ce,
                    0x6f408944f3caadb9,
                    0x2e5809ac53e13307,
                ])),
                Felt::new(BigInteger256([
                    0xba4c1b1b6d2a56e7,
                    0xeb8ae6e1fe732a65,
                    0xf4d718d47bb3c901,
                    0x035e63db5b12d1ae,
                ])),
                Felt::new(BigInteger256([
                    0x54719fba936a49c0,
                    0xb98035bd66fb4d0a,
                    0xf5f275cb6e26f4a6,
                    0x2db153a4aab81cc1,
                ])),
                Felt::new(BigInteger256([
                    0xbfdc47f8a6d797ed,
                    0x6259a89c5ba219a7,
                    0xd964bcea1ff7a322,
                    0x199e86bab97455ab,
                ])),
                Felt::new(BigInteger256([
                    0x0204833f78b64798,
                    0x2c279a057d237ee0,
                    0x7306b6b4a121ab6d,
                    0x1525cc58fee8ee8b,
                ])),
                Felt::new(BigInteger256([
                    0x5d695a82392b7c6f,
                    0xbcd11e923ce3fe35,
                    0x2d36df97b12b23e5,
                    0x02e1f152147fac36,
                ])),
                Felt::new(BigInteger256([
                    0x73ec0a5f9cef14a3,
                    0x88203cff693d58f1,
                    0x37d7d09bdfa40fcb,
                    0x29dc3616ec32e483,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x84ef4273561ad28e,
                    0x1069dbfc652d87d7,
                    0x1e8d1c6b9a6d1c7b,
                    0x1d85477ad984793a,
                ])),
                Felt::new(BigInteger256([
                    0x22d33eeac0632f4c,
                    0x308d480eb526a9a5,
                    0x5e3c44f316283bbf,
                    0x2034095c1e680728,
                ])),
                Felt::new(BigInteger256([
                    0x03fe3da3f8c24dd0,
                    0x9ca62f02758c7732,
                    0x71a3f2bb58171c33,
                    0x125b194a43940b14,
                ])),
                Felt::new(BigInteger256([
                    0x33919f4edd5f8b99,
                    0xbe78078de58b5594,
                    0x5f4161edd98fe37f,
                    0x176282de682fb8d6,
                ])),
                Felt::new(BigInteger256([
                    0xb316d3d1a0e2a3d9,
                    0xd6204b6fa489fd59,
                    0x0dec89e9df2acdbf,
                    0x1b3c705175a64e14,
                ])),
                Felt::new(BigInteger256([
                    0xd297be8d1edccb5d,
                    0x79017b0f8a67aedd,
                    0xa9a21aaf72e05a04,
                    0x059978872d078df7,
                ])),
                Felt::new(BigInteger256([
                    0xb88161702ffd8cae,
                    0x7a2ea2b8dc188540,
                    0xee099d63caf2d1a1,
                    0x21428057dcc93912,
                ])),
                Felt::new(BigInteger256([
                    0xc80ab06f349bfad8,
                    0xfaa89e1cd065f331,
                    0x140f65ea1a23d559,
                    0x2779638b1a190636,
                ])),
                Felt::new(BigInteger256([
                    0x9a8b28d97ca60a02,
                    0x467b071069afdcc6,
                    0x3f5498884734db77,
                    0x11d0787c95188285,
                ])),
                Felt::new(BigInteger256([
                    0x37b89629ec98168c,
                    0x2f3a632a47977bfb,
                    0xe4b06c3c90596d26,
                    0x2f67bf03d7ddc000,
                ])),
                Felt::new(BigInteger256([
                    0xc6e542c9c89a1e95,
                    0x965a0313fe7353e2,
                    0x046d0d24c1cf6510,
                    0x03170dcdd0725cfa,
                ])),
                Felt::new(BigInteger256([
                    0xff55ae249b4ca285,
                    0xee7e35381bb777d7,
                    0x3111e493a17d8805,
                    0x23209234543c44c3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xad77bb48311acddd,
                    0x58205bbc2aa21ef1,
                    0x1f876fffc2a60af3,
                    0x17767b0e2c6727fc,
                ])),
                Felt::new(BigInteger256([
                    0x4c543be46a03a1f5,
                    0x588256f3bec40256,
                    0x1dc95020ec4e00bf,
                    0x2b400c8f2adabb6e,
                ])),
                Felt::new(BigInteger256([
                    0x2edb208d69ff94e2,
                    0xcbc1b120ab66db4b,
                    0xc6f32ad32ba7f0da,
                    0x0e7d9578e3c1f966,
                ])),
                Felt::new(BigInteger256([
                    0x980b7b9f601e2b32,
                    0x4834983201367102,
                    0x99906342b901e1c1,
                    0x22d2477d028981a6,
                ])),
                Felt::new(BigInteger256([
                    0xbff8617b712a62b6,
                    0x9d4125cb5783d489,
                    0xc3935f8c9e96310c,
                    0x03315debd8729efb,
                ])),
                Felt::new(BigInteger256([
                    0xfa8a87e7528ea3d5,
                    0x6a0892b1e62a0303,
                    0x7d311e8387e2096a,
                    0x2acb09bbc9582394,
                ])),
                Felt::new(BigInteger256([
                    0x41ccb8f3813f61c2,
                    0x9d8aecfe41690038,
                    0xa4cbff1b452f0f61,
                    0x1373d0db5097b8ac,
                ])),
                Felt::new(BigInteger256([
                    0xe28843700b2dc42c,
                    0x40b0d35b6bd73783,
                    0xcaa4d95753465d12,
                    0x217b1b0e615a7646,
                ])),
                Felt::new(BigInteger256([
                    0x399006b8e8dc781b,
                    0x5cd83d1e1749ffcb,
                    0x60786a7bd6d39919,
                    0x1f0b896a604634bb,
                ])),
                Felt::new(BigInteger256([
                    0x324991042edba08b,
                    0x473a4faae10ac84a,
                    0x74fbe7ed65c93f5f,
                    0x15836920623dd758,
                ])),
                Felt::new(BigInteger256([
                    0x62273174b93568e0,
                    0x41f3733a38d72c70,
                    0x562c9d609772fdc9,
                    0x2c7de9cc0ddec16a,
                ])),
                Felt::new(BigInteger256([
                    0xe3756da72b675964,
                    0x4c90b6bbfd378f4e,
                    0xbe3bf8b310c85ffb,
                    0x2f9f40149966e3f3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x67aca7fb9bab1870,
                    0x39c7e62eafb27ced,
                    0xd929ec30a9933d9e,
                    0x204e77843f86d7a0,
                ])),
                Felt::new(BigInteger256([
                    0xf21ccf2e3b24b6d6,
                    0xa0c2c23c4c61e689,
                    0xa4f5fe38eb2791b0,
                    0x0d27696b516b61dd,
                ])),
                Felt::new(BigInteger256([
                    0xdc1a7acc9622539d,
                    0xc530671f7a91ab04,
                    0xa88331943ae04f75,
                    0x182785db7d8182f1,
                ])),
                Felt::new(BigInteger256([
                    0xb50f2f304dddb168,
                    0xd40f1d8c8f4ab150,
                    0x734953d98d348979,
                    0x20fb1ff4b4b40225,
                ])),
                Felt::new(BigInteger256([
                    0x56912783a2fd055b,
                    0x9f9790d280537813,
                    0xaab8b340c3453af8,
                    0x0d89689f1fa1318f,
                ])),
                Felt::new(BigInteger256([
                    0xc7d1fad1edea1cf6,
                    0xaa4d6643a6a60c6c,
                    0x594dbceef39df6ab,
                    0x13920143b6e4b3e3,
                ])),
                Felt::new(BigInteger256([
                    0xad9ecf3b4aabb01c,
                    0x7ae3e42b0b048bae,
                    0x8bf2c289612a6309,
                    0x155db259449bdd75,
                ])),
                Felt::new(BigInteger256([
                    0x933830c8be4a55c6,
                    0xbda64689473d4adc,
                    0x190e7ee156932d02,
                    0x0bca488cef49550d,
                ])),
                Felt::new(BigInteger256([
                    0x19c8b850288b72b1,
                    0x6d88dc14e7c3724f,
                    0x0bfda63bca95d2ca,
                    0x01fda1e4b7697bc2,
                ])),
                Felt::new(BigInteger256([
                    0x26fddd0d9c6fb0c2,
                    0x17d07f422d0d1a93,
                    0x0fa04ed21d647bdf,
                    0x1703eac6150af9d4,
                ])),
                Felt::new(BigInteger256([
                    0x8a5919c412163d08,
                    0xa8ec473ca9ce6adc,
                    0x40f8c8ae6f4fce5e,
                    0x100814a4e0acfbe1,
                ])),
                Felt::new(BigInteger256([
                    0xa6a68b697b8e1690,
                    0x2fa4f4bd549c8284,
                    0x97e33085a6d9cef6,
                    0x3015f5e19c1b8c5d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x82255be7a065e13e,
                    0x4250181f422c0036,
                    0xb8ef5b8c8a1f2a69,
                    0x18a4fa739951b8b9,
                ])),
                Felt::new(BigInteger256([
                    0x9ef645f2b3708e81,
                    0x83e45599b4ee78be,
                    0xc857cc550bde806f,
                    0x148ea77767a91890,
                ])),
                Felt::new(BigInteger256([
                    0x106072f6a2087eed,
                    0x70dc892a4bc4e61b,
                    0x8bc2fdad3444c962,
                    0x1ce1d09d9355eaf3,
                ])),
                Felt::new(BigInteger256([
                    0x5d30a9741d57cdac,
                    0xbe9950904c2b4258,
                    0x106359b572414550,
                    0x02d6c9510b5040a9,
                ])),
                Felt::new(BigInteger256([
                    0x38a066974e854f68,
                    0xb9b2facbff49f60b,
                    0xea36fd70aac57636,
                    0x08d8fa8470022457,
                ])),
                Felt::new(BigInteger256([
                    0x7c73cb7fa4b2e72f,
                    0x8dfc511c2295dfa6,
                    0xedccd7c038cac046,
                    0x14b1a0f1aabc0f20,
                ])),
                Felt::new(BigInteger256([
                    0x950f8ee078b93bcf,
                    0xcde5306edae11544,
                    0x95722c14ad00819b,
                    0x18b2c7adb4182574,
                ])),
                Felt::new(BigInteger256([
                    0xdad151ef868d0bef,
                    0x953c5726af8ac9e4,
                    0xb6290f8196c70028,
                    0x2d8d27f0c258750e,
                ])),
                Felt::new(BigInteger256([
                    0x48eb450863358c5d,
                    0x93d815a548ce9d76,
                    0x0f25bb7d77a86774,
                    0x15b343301323a4b1,
                ])),
                Felt::new(BigInteger256([
                    0xd6171603969466f7,
                    0x5f3607768875af0e,
                    0x20cf226bd5f45897,
                    0x2f5889a0e47dfdd9,
                ])),
                Felt::new(BigInteger256([
                    0xa0831ea4ed8b306e,
                    0x4c8805d3fe70639e,
                    0xeceea632af6bd846,
                    0x24a8d307d5e657ac,
                ])),
                Felt::new(BigInteger256([
                    0x32589b3ef40241c1,
                    0xcee0814781ea4511,
                    0x658b7c2400d6a4de,
                    0x0dddab7cf736218d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x27c6600003ffe763,
                    0xa07bafcd5591490c,
                    0x3cf7e327a1224d53,
                    0x1d2c5e02b7b2e31c,
                ])),
                Felt::new(BigInteger256([
                    0x913ae56c99fe8815,
                    0x9b024577d7294ff2,
                    0x63f8956da4fc0b0d,
                    0x15d6d4aa31ff6302,
                ])),
                Felt::new(BigInteger256([
                    0x93c851aa6f157325,
                    0x2c7ce9d287c8fa25,
                    0x8d938bd3fe402a01,
                    0x05caac11d1629866,
                ])),
                Felt::new(BigInteger256([
                    0x5e5d00e69c7deab3,
                    0x686381cea4d560d1,
                    0x76c9be12e2f2f152,
                    0x006a9767ec8f1bdc,
                ])),
                Felt::new(BigInteger256([
                    0xde70b3bcad2ba2e2,
                    0xaff46b598d059e9c,
                    0x91b7ca423052999b,
                    0x1f4efd8a3d1a8f04,
                ])),
                Felt::new(BigInteger256([
                    0x073277bd5b2cabdf,
                    0xa1a6581e87d18dfe,
                    0x3d5c436bb1318560,
                    0x2c81efd662c6e7f0,
                ])),
                Felt::new(BigInteger256([
                    0xe276112fc492509a,
                    0x4beac546b7131062,
                    0x3ca9ce6c32e4caf5,
                    0x1e1fb96948e7b8cd,
                ])),
                Felt::new(BigInteger256([
                    0x5df379fc47c29b5c,
                    0x4012ab4ad905f3fd,
                    0x6a2f15ab99754bfb,
                    0x1054710b9993eb3e,
                ])),
                Felt::new(BigInteger256([
                    0xc44bc6271d437a36,
                    0xa88a6b07c119bd40,
                    0xa66b0d9deda5a83d,
                    0x16b5286238577f56,
                ])),
                Felt::new(BigInteger256([
                    0x8fd963277bd2ab5f,
                    0x16b674da3588270c,
                    0xebc739260c5e07d1,
                    0x2b7757655abc62cc,
                ])),
                Felt::new(BigInteger256([
                    0x865baa82bba2b9dd,
                    0x935123e022ee1239,
                    0x25cff9c7f5ae6b4a,
                    0x255ab7838e8297e4,
                ])),
                Felt::new(BigInteger256([
                    0xe2a0a0b173c0e3ae,
                    0xcaab4b129dfe9b39,
                    0xa927174cabd3f769,
                    0x110e95f4b794b21d,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5c96e8bb9cbddd16,
                    0xaed1b12e8fdf0602,
                    0x16ab2f0d362d8f9d,
                    0x26c32c8493732194,
                ])),
                Felt::new(BigInteger256([
                    0x2bd2685e3a8f1459,
                    0xfade37ac874e690b,
                    0x5f06a77c1a693709,
                    0x16d336275a803ea7,
                ])),
                Felt::new(BigInteger256([
                    0xefdd4c4b56588398,
                    0x925558429ac87335,
                    0xdff3ac7235ee9428,
                    0x1497eedaabe7886f,
                ])),
                Felt::new(BigInteger256([
                    0xdfde6492c621fd23,
                    0x533c40e8266766be,
                    0x071b09f6504381ff,
                    0x2a417a36016aa3d3,
                ])),
                Felt::new(BigInteger256([
                    0x2d28b21d50b478ad,
                    0xf79e45a6096f5c2f,
                    0x513798603e9f329a,
                    0x0d4b4e14b8851063,
                ])),
                Felt::new(BigInteger256([
                    0x206dfde7a89304a0,
                    0x1a19d41cbee94eef,
                    0x7e6ca798a4a95cc5,
                    0x276ca3f52f4acbb4,
                ])),
                Felt::new(BigInteger256([
                    0x63e027d7026416cc,
                    0x7a0dc8119487e874,
                    0x1b02cdcd48926f39,
                    0x1c4231a0c41a9eb4,
                ])),
                Felt::new(BigInteger256([
                    0x1ed5b759e115df07,
                    0xe03ba79cac3d3548,
                    0x71f5d00774935a2b,
                    0x2c915e47d5f3c42b,
                ])),
                Felt::new(BigInteger256([
                    0x5c0f1de05fc2f5b1,
                    0x9d60218d84071e30,
                    0xebb9debf2a84fe2e,
                    0x2831ccee33c71268,
                ])),
                Felt::new(BigInteger256([
                    0x3613e48b69650493,
                    0x4c0ec6315fb8cc19,
                    0xe1800a8e347e1c80,
                    0x00e159f1aa854495,
                ])),
                Felt::new(BigInteger256([
                    0x18f0773bc5eb9ea5,
                    0x48a9ce5dc70454ca,
                    0xe03b68f80798f1db,
                    0x1ef355f5dd1ea9b9,
                ])),
                Felt::new(BigInteger256([
                    0xc3d9dda2fc4eb3bc,
                    0xdd4e5675a24a1357,
                    0x84162b10d13a27f9,
                    0x2ad851000b067777,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x4c207d4c68722428,
                    0xf0ea40dbab2a6f7a,
                    0x83f42af8a1a8f11e,
                    0x295d87cd9578fe07,
                ])),
                Felt::new(BigInteger256([
                    0xe76f9080afd7ad38,
                    0x6493f6263d065bf2,
                    0x6a4d875e487fe37d,
                    0x2fa5007561d810f5,
                ])),
                Felt::new(BigInteger256([
                    0xab8d9f78f0344630,
                    0x4bd7d7b596ae37da,
                    0x3c3bcfd014ae523f,
                    0x02c05c4beaeb2d79,
                ])),
                Felt::new(BigInteger256([
                    0x1b1d78352d5cb39e,
                    0x8c5ef7595d0e7b54,
                    0xea7b434d6cd7e9e0,
                    0x15207f310dc05a86,
                ])),
                Felt::new(BigInteger256([
                    0xcc0558a333408737,
                    0x7516d3f2341720ce,
                    0x8510a379be3a32e8,
                    0x2ec5b259811f4f50,
                ])),
                Felt::new(BigInteger256([
                    0xab154ee03c760f5c,
                    0x5fb7abf727bdc2e7,
                    0xa6233ce11be56ae1,
                    0x019361036ef87803,
                ])),
                Felt::new(BigInteger256([
                    0xa382c5339c075c2b,
                    0x93b8b698d87c8b92,
                    0xf8f95a65f0b6fa09,
                    0x065b7ffcbc2568f2,
                ])),
                Felt::new(BigInteger256([
                    0x9d8ab8ad35fec783,
                    0x1b882bcf65080299,
                    0x705cf06324778bc7,
                    0x2570d3528d6f2d2f,
                ])),
                Felt::new(BigInteger256([
                    0x94963f5514229258,
                    0xebe5d2ebb05aba6a,
                    0x70fee8e17e4cdbf8,
                    0x0c789c0e8ae67bc9,
                ])),
                Felt::new(BigInteger256([
                    0x554e0b0dc2c52f3b,
                    0xa839a5d7604116dc,
                    0x8c8f5b5c5f4412db,
                    0x284d87e6ac96504f,
                ])),
                Felt::new(BigInteger256([
                    0xe0d8caf039698b37,
                    0xf9c4a72657f8c37c,
                    0xb779c8c1253d540c,
                    0x1db71c8921c546cc,
                ])),
                Felt::new(BigInteger256([
                    0x782642e4ce5b85b6,
                    0x09599d252995bd1f,
                    0xa3f21c2efd8a4b6b,
                    0x09b39cb774265286,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2c5ee54309dfbb06,
                    0xd8252a4ff691c678,
                    0x8650a9584f211f5d,
                    0x26466581330b84fd,
                ])),
                Felt::new(BigInteger256([
                    0xdf70e78f078f64d6,
                    0xa9c5420c360a6209,
                    0xbbbaa25de5955830,
                    0x2dccf2b1a53715e5,
                ])),
                Felt::new(BigInteger256([
                    0x4cc35eedb3976945,
                    0x457adb0eb43e001a,
                    0x4c9bf30024f6a245,
                    0x1a2d22e7e5d490df,
                ])),
                Felt::new(BigInteger256([
                    0xfee44bbcce1075e3,
                    0x82972a4af71a45bf,
                    0xa60371190cbd37b2,
                    0x1f210f866850cb14,
                ])),
                Felt::new(BigInteger256([
                    0xd9618e51046c017f,
                    0x9b289a109c097831,
                    0xa72f396bbf669116,
                    0x26724469a74c2f5b,
                ])),
                Felt::new(BigInteger256([
                    0xa3523f4654e2ebd8,
                    0xbfb7d46d61daa775,
                    0x2c54e46185144dce,
                    0x0bb4d74939f80426,
                ])),
                Felt::new(BigInteger256([
                    0x2a021fd8479aee4d,
                    0xf98882a23662c69f,
                    0x1aa3bcfc18b46adf,
                    0x20c3b0bf92e0dc65,
                ])),
                Felt::new(BigInteger256([
                    0xaaaef6f0bbec5e0d,
                    0x8278ed2118098fa6,
                    0x6caf96a700175056,
                    0x2d936b0abd4c1f0b,
                ])),
                Felt::new(BigInteger256([
                    0xfe664b991dfb6582,
                    0xa3fec12d70556eb2,
                    0x75039f2b5a1585d3,
                    0x0b431a88379490f8,
                ])),
                Felt::new(BigInteger256([
                    0x4d475a70ed2731f6,
                    0x62efb9b6e775971b,
                    0xe22e7de6c92cade7,
                    0x2463cf92a026da6f,
                ])),
                Felt::new(BigInteger256([
                    0xedceec76b4d3a372,
                    0x5dd4ea964bc7e028,
                    0x36bbdb65a1279dcc,
                    0x251f14595e0f6d7c,
                ])),
                Felt::new(BigInteger256([
                    0x53c7a87af5955dfa,
                    0x463e0065641fb40b,
                    0xbc5c88ff77723c93,
                    0x0e6fa5670796e6df,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4112ea17cf336e10,
                    0xda133922ceeb784c,
                    0xefba8eb5f4310f8b,
                    0x2fd1916fba3bf8bd,
                ])),
                Felt::new(BigInteger256([
                    0x7faa5ecbf6047006,
                    0xbb246a99298e9287,
                    0xace5bec108b7913b,
                    0x2e900303906fa13c,
                ])),
                Felt::new(BigInteger256([
                    0x862cce182deb61ea,
                    0x4aa887fa1aa879b7,
                    0xda40f780a71f3fd6,
                    0x1d593f3e8945695b,
                ])),
                Felt::new(BigInteger256([
                    0xc7d2e6fd39660fc2,
                    0xc911f0b273ada637,
                    0x3fa19bd53d1c38d9,
                    0x099fdaa394820769,
                ])),
                Felt::new(BigInteger256([
                    0x4f765f3d9d772cb4,
                    0x61863dce13bf2ae8,
                    0xee816382c6ca83c1,
                    0x1161c2a5be974dc3,
                ])),
                Felt::new(BigInteger256([
                    0x25ed73db26e7554e,
                    0x00ecd3c7b0a0dba9,
                    0x41a7132b93c4757b,
                    0x2ef26c631c71efaf,
                ])),
                Felt::new(BigInteger256([
                    0x451302e0b9687b8f,
                    0xfad3b45e3219a182,
                    0x63cdfd00b0c79644,
                    0x1fa8e85a44c85ac4,
                ])),
                Felt::new(BigInteger256([
                    0x34b2545f3829c07c,
                    0xc37e60f49b343428,
                    0x155763bc310bd793,
                    0x077d0f21e6ee4ad3,
                ])),
                Felt::new(BigInteger256([
                    0x31af47280b2c61fd,
                    0x5c25d494f86dd605,
                    0x03162b06ebc4aa83,
                    0x00ebbb6dad063f4e,
                ])),
                Felt::new(BigInteger256([
                    0x88d8555bc93a2d5b,
                    0x655ccb2d5ee2d78e,
                    0x28c2b22630356d79,
                    0x21121730d3e8f99c,
                ])),
                Felt::new(BigInteger256([
                    0x0d5971930b0c8512,
                    0x7932c5263dd3fec1,
                    0x210ca48c5be23393,
                    0x21b3447ef2545f74,
                ])),
                Felt::new(BigInteger256([
                    0x6c87e993bf38f4bf,
                    0x5fd3b2ecf601d3ab,
                    0xa887c4cf93ad65de,
                    0x0ff1a5b1ee63810f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x64151df8012d2bae,
                    0x7a8f98b564608177,
                    0x3a1be72c9d64daca,
                    0x15410c96d186e44c,
                ])),
                Felt::new(BigInteger256([
                    0x7fa99beef60c9280,
                    0x469cf7f34135d3ba,
                    0x1e8b40f4102447e8,
                    0x05f09c63a23395ba,
                ])),
                Felt::new(BigInteger256([
                    0x6cbd8caed074aa91,
                    0x3b5f343a650a0a4d,
                    0x9e3814be77c98630,
                    0x00786ab9fc9f02df,
                ])),
                Felt::new(BigInteger256([
                    0x73af04e08c8e322d,
                    0x1095c30f5f2c7995,
                    0x5d34c8e6d74cc532,
                    0x0ce5f775705fd05c,
                ])),
                Felt::new(BigInteger256([
                    0x937fc08290fa740d,
                    0xa58d91e824dd3c0c,
                    0x37223fcfd9bddbb8,
                    0x0867ce84818b797d,
                ])),
                Felt::new(BigInteger256([
                    0x1610bf7816f25e0d,
                    0x3d14ed7420fbfdc0,
                    0x6478e39f6bf8f790,
                    0x2fdc19b33b06b9e7,
                ])),
                Felt::new(BigInteger256([
                    0x0cc0b018aeb05c7b,
                    0xd408af3eb97227e2,
                    0x6c6a4165cfa14877,
                    0x2922fcb63a0d18b2,
                ])),
                Felt::new(BigInteger256([
                    0xc67cbccd170821ac,
                    0xe779c765ea1d682d,
                    0x610c703db555e897,
                    0x0231ce0ff9338747,
                ])),
                Felt::new(BigInteger256([
                    0x8bf5e8b51131f269,
                    0x972189acb5615a92,
                    0xda155b47e9ab6f0c,
                    0x01a72b4820a3f37b,
                ])),
                Felt::new(BigInteger256([
                    0x24aae243069da311,
                    0xaf723a10b7bb2a00,
                    0xe7a88c9a5751464f,
                    0x15eab4be5cb62616,
                ])),
                Felt::new(BigInteger256([
                    0x2347b0bf388c1e56,
                    0x0a058214795bdb26,
                    0x774f86038607bc43,
                    0x29384fc8680b79f5,
                ])),
                Felt::new(BigInteger256([
                    0x221bb397b9222609,
                    0xd95c0c5fa50885a9,
                    0x5a73db0562a50cb4,
                    0x0a865664ac447db7,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x17eb16416d3ac491,
                    0xb120b9c032fe8e35,
                    0x3a6fe30cd6634854,
                    0x09b916bec65477db,
                ])),
                Felt::new(BigInteger256([
                    0x37199a7525bc2c7b,
                    0x2911a545ad24af2d,
                    0x51f229b3b9960e48,
                    0x1361c16d4c6b83a0,
                ])),
                Felt::new(BigInteger256([
                    0x431c884ce260c95a,
                    0x6d3f89ba2ce007a0,
                    0x4c2da7dca9f5f697,
                    0x16c16e8d15b5e0e2,
                ])),
                Felt::new(BigInteger256([
                    0x5d52a04243c09fcd,
                    0xd52736743e8ae5cd,
                    0x3743e39ecdc5c0bc,
                    0x26c098a709896f48,
                ])),
                Felt::new(BigInteger256([
                    0x8e56c276183ff2c6,
                    0xfa556fdcebe47a6b,
                    0x08e8dfe01a46f34d,
                    0x2830ba9bcb472cae,
                ])),
                Felt::new(BigInteger256([
                    0x9b5c34fa1b8e71ef,
                    0xca3ea2c62d32c15f,
                    0x8e99a21a406d8194,
                    0x0d8e3d3fdb11d9f3,
                ])),
                Felt::new(BigInteger256([
                    0xd59b0d287f5f75d1,
                    0x1ccd1c9641865b1d,
                    0x812abc55fd5f2b44,
                    0x042e1688d92d3ffb,
                ])),
                Felt::new(BigInteger256([
                    0xb8786490ab8b3448,
                    0xb4d92c416c77a83b,
                    0x2187625012891a9b,
                    0x0b2532fc56fc501e,
                ])),
                Felt::new(BigInteger256([
                    0x9a524e881efe513f,
                    0x19c3aa95267660ff,
                    0x7e4efd27d4bbd73e,
                    0x22db1be99acde707,
                ])),
                Felt::new(BigInteger256([
                    0xeb390752ef8a84bd,
                    0xfaf141656b99cc81,
                    0x50b029737c664738,
                    0x03bc66cb32ea6ced,
                ])),
                Felt::new(BigInteger256([
                    0x13fe96362fbac3e9,
                    0x445ddf0bdc722e91,
                    0x980b11134f8bcdb9,
                    0x2fc198b73d002565,
                ])),
                Felt::new(BigInteger256([
                    0x26da7dfa66be1d6c,
                    0xfe8066a28f4122be,
                    0x11be5f66099447d7,
                    0x2d3ebb8f5f5aef9f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xaa53a53553fb0890,
                    0x06424b5d44738b92,
                    0x1ad7a6a036749061,
                    0x0eb4c8d81f5b1f0e,
                ])),
                Felt::new(BigInteger256([
                    0x2ff5f79a1f18db17,
                    0x4f3a4b84870be6c8,
                    0x3d38a958246dcc67,
                    0x17f70f06de5f95fe,
                ])),
                Felt::new(BigInteger256([
                    0xdd482ba1fa17e972,
                    0x66107fb2eeff3fee,
                    0xdc24b188700014fa,
                    0x0a7d594405fa2a1a,
                ])),
                Felt::new(BigInteger256([
                    0xc59281f561069148,
                    0x26365b4d7465d42e,
                    0x5da9a6978cabc980,
                    0x223faf31b46927bd,
                ])),
                Felt::new(BigInteger256([
                    0x2fa75387e8680769,
                    0xbea94bed9c308b3a,
                    0x7661c083cca3e6c4,
                    0x241b2a5be1dc3a9e,
                ])),
                Felt::new(BigInteger256([
                    0xd4f7fb949c630e18,
                    0x85b04a1a34049e3b,
                    0x09ac89d2fbcc2819,
                    0x2429556810201ed0,
                ])),
                Felt::new(BigInteger256([
                    0xd9de11f26abc8925,
                    0x9938b71a2ccc5fbe,
                    0x15d9d7e71277b41f,
                    0x0e47a244bf31d6d7,
                ])),
                Felt::new(BigInteger256([
                    0x4ef748b987c77767,
                    0x933caebefbd2ec44,
                    0x9cb1e5accbf40430,
                    0x2485504c2947224b,
                ])),
                Felt::new(BigInteger256([
                    0x66b1a6b922795fbc,
                    0x45b08911b66cde00,
                    0xad7d5edc8179cda6,
                    0x0b8775abeba6b063,
                ])),
                Felt::new(BigInteger256([
                    0xff1e9576578c18bb,
                    0x6db9d4272d6fa216,
                    0x755fd7c803d6a616,
                    0x0ac97258e12523c0,
                ])),
                Felt::new(BigInteger256([
                    0x0317e02d86202b11,
                    0x1b44bc7d5778598f,
                    0x61538fb0c5180c11,
                    0x176137bcf6491bcf,
                ])),
                Felt::new(BigInteger256([
                    0xb179bfea49ed597f,
                    0xe3bafce2173a4614,
                    0xac112efa09f6bab2,
                    0x1c0d44e4e4e547eb,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
