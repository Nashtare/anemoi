use super::{sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 2 elements (64-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 13 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 13;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= y2.double() + y2
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += y2.double() + y2 + sbox::DELTA
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];
    state[0] = x[0] + x[1] + x[2] + x[4] + (x[2] + x[5] + (x[3] + x[4] + x[5]).double()).double();
    state[1] = x[1] + x[2] + x[3] + x[5] + (x[3] + x[0] + (x[4] + x[5] + x[0]).double()).double();
    state[2] = x[2] + x[3] + x[4] + x[0] + (x[4] + x[1] + (x[5] + x[0] + x[1]).double()).double();
    state[3] = x[3] + x[4] + x[5] + x[1] + (x[5] + x[2] + (x[0] + x[1] + x[2]).double()).double();
    state[4] = x[4] + x[5] + x[0] + x[2] + (x[0] + x[3] + (x[1] + x[2] + x[3]).double()).double();
    state[5] = x[5] + x[0] + x[1] + x[3] + (x[1] + x[4] + (x[2] + x[3] + x[4]).double()).double();

    state[6] = y[0] + y[1] + y[2] + y[4] + (y[2] + y[5] + (y[3] + y[4] + y[5]).double()).double();
    state[7] = y[1] + y[2] + y[3] + y[5] + (y[3] + y[0] + (y[4] + y[5] + y[0]).double()).double();
    state[8] = y[2] + y[3] + y[4] + y[0] + (y[4] + y[1] + (y[5] + y[0] + y[1]).double()).double();
    state[9] = y[3] + y[4] + y[5] + y[1] + (y[5] + y[2] + (y[0] + y[1] + y[2]).double()).double();
    state[10] = y[4] + y[5] + y[0] + y[2] + (y[0] + y[3] + (y[1] + y[2] + y[3]).double()).double();
    state[11] = y[5] + y[0] + y[1] + y[3] + (y[1] + y[4] + (y[2] + y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x1dee1eccec1d3612,
                    0x7f3a5320b01702d5,
                    0x4e37d761d498656c,
                    0x15badcd7648b61fa,
                ])),
                Felt::new(BigInteger256([
                    0x3405340d91113938,
                    0x6f04490a539de5eb,
                    0x36f4da0237914876,
                    0x2b2dcb3ca9aae0ac,
                ])),
                Felt::new(BigInteger256([
                    0x43019061943e3c9f,
                    0x341412ca4c7c1945,
                    0x6d550ef8724ae909,
                    0x02bc709e40501c0c,
                ])),
                Felt::new(BigInteger256([
                    0x79888b72f1da3f34,
                    0x796a4f2fac2cf83b,
                    0x0760d2d390db38fd,
                    0x07d23542adee4c88,
                ])),
                Felt::new(BigInteger256([
                    0x967d9370b0fe3b89,
                    0x0800f54e13c0a7ee,
                    0xa07ed522c2b86911,
                    0x0048076bad989c02,
                ])),
                Felt::new(BigInteger256([
                    0x7e3302a1332decd6,
                    0xd6d58f07ec9c80a6,
                    0x5af23737f9fbbad3,
                    0x2966cafd38c464c4,
                ])),
                Felt::new(BigInteger256([
                    0xb22e3a37f7dc5876,
                    0xc399e159146d6f2b,
                    0xe53e6b4174208f10,
                    0x0a03df70882b902a,
                ])),
                Felt::new(BigInteger256([
                    0x4daf694c2a3615bf,
                    0x2a21d5510fd60ad1,
                    0x925cea86fe6473ef,
                    0x1191395c3a7d19a7,
                ])),
                Felt::new(BigInteger256([
                    0x20762e42a811c3c7,
                    0x0fdde1f801364275,
                    0x50f11686342d7b7a,
                    0x1702f89c0f218c22,
                ])),
                Felt::new(BigInteger256([
                    0x229a65c71f586422,
                    0x2ee7547c38d75225,
                    0xd4ffe809421c526b,
                    0x2a891a099b97ec36,
                ])),
                Felt::new(BigInteger256([
                    0x072d4503aa463cd9,
                    0xace521fb96f93486,
                    0xbda2891d0ee7337f,
                    0x07bd9ee7fea22c3c,
                ])),
                Felt::new(BigInteger256([
                    0xc6f3abddfed17c97,
                    0x07d6c2e4dbc71469,
                    0x0b337e53e5c19921,
                    0x1918a19b4ae74af2,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x895414eb78ef8331,
                    0x9b7980a00d966f0b,
                    0xcb120cdbd95bb8a0,
                    0x2fd34d7cfa4ff40e,
                ])),
                Felt::new(BigInteger256([
                    0xdfeda270d2f2159f,
                    0x263250e3cfdbf715,
                    0x895352f519556a26,
                    0x292cfcaf2e0a2751,
                ])),
                Felt::new(BigInteger256([
                    0x0a970601fef5e4bd,
                    0xafe33375268128ea,
                    0x3d01ffc8c54ca1bd,
                    0x01d020443d5de355,
                ])),
                Felt::new(BigInteger256([
                    0xfb29448664623739,
                    0xc54400e6a8ed2bbd,
                    0xe61a49b0ff33dc6f,
                    0x2cb52c8bd3203ae9,
                ])),
                Felt::new(BigInteger256([
                    0xc87ec0864f593575,
                    0x872135fdda99a18b,
                    0x776e7e03c8c1bb33,
                    0x17c1712173f8a944,
                ])),
                Felt::new(BigInteger256([
                    0x08e38711191c79de,
                    0xacc4c021550d27ec,
                    0xc41f6fdbd99fe9c6,
                    0x0d9dd3add7bdaab2,
                ])),
                Felt::new(BigInteger256([
                    0x25a8f94e8b46d40d,
                    0x661b8ddf62a21d3c,
                    0x7ffcc69dcdfa0bfb,
                    0x1905d7ae940441b6,
                ])),
                Felt::new(BigInteger256([
                    0x1deb2e22934b216b,
                    0x3b0e4fc87ca5fb9b,
                    0xbe2234e342030124,
                    0x0bf2787c84a9f702,
                ])),
                Felt::new(BigInteger256([
                    0x0b57ec676a8cf49f,
                    0x774dd7fcacaa7f4d,
                    0xe0efa916b8126cea,
                    0x051ae8136afe6932,
                ])),
                Felt::new(BigInteger256([
                    0x95272977b90ac7d3,
                    0x31dd8a68a3d2acb5,
                    0x24f60ed3e8cafbcf,
                    0x1b3b0099268f66c1,
                ])),
                Felt::new(BigInteger256([
                    0xf23e16ec74ce9471,
                    0x45b025dc5f591a7f,
                    0xaf0d174fb3cd06ba,
                    0x28378e28adcb4f56,
                ])),
                Felt::new(BigInteger256([
                    0x40180e50d79560eb,
                    0x75cda73f04971680,
                    0x2b9668ab81aeb58b,
                    0x292dad3c456b6d78,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x98db5ca12be10dd8,
                    0x1b2abeace13d61ae,
                    0x6b4eb7eae53d5a14,
                    0x1e7082010d2dc127,
                ])),
                Felt::new(BigInteger256([
                    0x2f1ef760e154fd00,
                    0x0c33c9636512143e,
                    0x6cdcf37abb593556,
                    0x265e1e8d348daf69,
                ])),
                Felt::new(BigInteger256([
                    0x73183195100ac43b,
                    0xd580079ca5c743e4,
                    0x818f499e3d504659,
                    0x0f418acac04c919f,
                ])),
                Felt::new(BigInteger256([
                    0xb4d2e4cf7d6df7c9,
                    0xd0ec5b03d59b467c,
                    0x3ded42086a368207,
                    0x2b099492e26accc1,
                ])),
                Felt::new(BigInteger256([
                    0x0d9451602a0c295d,
                    0x1c0d49970fbcd563,
                    0x0ce3dfcc99161a72,
                    0x180f2e0e1d22f572,
                ])),
                Felt::new(BigInteger256([
                    0xcf2e073ead8ec6b8,
                    0x6eb2d62f42ab3a8c,
                    0x363bffe4049aa56b,
                    0x15acd599d4dfa7c0,
                ])),
                Felt::new(BigInteger256([
                    0x1185b2c284b1e19c,
                    0x77b8560221c6d863,
                    0x3842e6c177896ec3,
                    0x263ab012c878a98e,
                ])),
                Felt::new(BigInteger256([
                    0x18a0c19ec182d8c6,
                    0xafdb1c57bf4f576e,
                    0x7de65a7bc216adac,
                    0x01bc1e9254c1756c,
                ])),
                Felt::new(BigInteger256([
                    0xfb96192946de39ab,
                    0x00e500a198049dd1,
                    0xe93b1d37df3244b4,
                    0x238688162c672812,
                ])),
                Felt::new(BigInteger256([
                    0x8df5bf62afa5a732,
                    0x15af385a819f8006,
                    0x271eb10e22e305a2,
                    0x1ef01e142c37fbb1,
                ])),
                Felt::new(BigInteger256([
                    0xec39b7564984f858,
                    0x8b68cd19946ee8ff,
                    0x3ce49032e14d1bdc,
                    0x20f778d09b3ecc34,
                ])),
                Felt::new(BigInteger256([
                    0x41f4eb4735381c9f,
                    0x98d78d62fd6f7185,
                    0x4067a705877740de,
                    0x219ee6f19af86024,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x72a380289dcfd553,
                    0x17d544639e6f83ed,
                    0xe7236a5ea6c6085c,
                    0x1ceac4eba1f8c99b,
                ])),
                Felt::new(BigInteger256([
                    0x9827dceea91c3880,
                    0xf2a381b3b89d07a0,
                    0x59e5a964d2a95a27,
                    0x0f373fbac4bcbdd9,
                ])),
                Felt::new(BigInteger256([
                    0x508c036555ad31e4,
                    0x08dddf60590b7c0c,
                    0xfb30c3d7dfab39be,
                    0x044ce622de335d2f,
                ])),
                Felt::new(BigInteger256([
                    0xca7bd5d4bb9e888c,
                    0x07a7f5f72bde3334,
                    0x302821a631bf7136,
                    0x01bceceb3bc30016,
                ])),
                Felt::new(BigInteger256([
                    0xa4845b3329279fa0,
                    0xf0716b8ca593c091,
                    0x944cb750950b27ce,
                    0x05c7869a8188d393,
                ])),
                Felt::new(BigInteger256([
                    0x7ecfa76961abf568,
                    0x43184f590a28513b,
                    0xdd86bdd33d5dc5b8,
                    0x07219768958579cf,
                ])),
                Felt::new(BigInteger256([
                    0xea41ef382eecc115,
                    0xef1a6d2a563e63da,
                    0x59cf2a6b89cc78e4,
                    0x0a22e7236e3bf6e4,
                ])),
                Felt::new(BigInteger256([
                    0x8d82a79210636e43,
                    0x8d9d407597965075,
                    0xa7ee0f106a07e5a5,
                    0x2ad79aec7bbb1368,
                ])),
                Felt::new(BigInteger256([
                    0x8593e6e04450237e,
                    0xba1f4d1172c3c76e,
                    0x488dda693f6a4173,
                    0x238f93c566c0d05a,
                ])),
                Felt::new(BigInteger256([
                    0xf4954da604faa673,
                    0x47b9cb47fdd36add,
                    0x82fbb5b4d284402b,
                    0x2846ed812e5b7153,
                ])),
                Felt::new(BigInteger256([
                    0x72aa056d5e4e7625,
                    0x778c4fda29653ea7,
                    0x3e440c5708dc2f91,
                    0x19d4c98cd90482e0,
                ])),
                Felt::new(BigInteger256([
                    0xf833d742f1fdbed8,
                    0x817cd4bcd750bbbd,
                    0x34daf1d110443452,
                    0x015301db9297191a,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xeb8f7e0801e28ab1,
                    0x18ca75510fdac07b,
                    0xf59b14e938aa8afa,
                    0x0213c997d47c23c0,
                ])),
                Felt::new(BigInteger256([
                    0xf3f4accab429f845,
                    0x2622c11e87020f0d,
                    0x61e0e10f3983252d,
                    0x04d11a266cd50eb1,
                ])),
                Felt::new(BigInteger256([
                    0x3af76a597590e8d5,
                    0xcbffa3f9d3abfc10,
                    0x42feb89a14520559,
                    0x2a004fbd98c200b2,
                ])),
                Felt::new(BigInteger256([
                    0x93a262c9d2626cae,
                    0x78d08027ac809ad8,
                    0xe3f442bb1bab39e8,
                    0x1fbd268aeb9227e9,
                ])),
                Felt::new(BigInteger256([
                    0x8ed39ad5babcbb44,
                    0x8de5695e19248ba3,
                    0xcf40710715fe650d,
                    0x17cf1fb204088be3,
                ])),
                Felt::new(BigInteger256([
                    0xd89240070ce7239d,
                    0x1d746eef0950080c,
                    0xb3483ba9b804e184,
                    0x2fc6e4f033e03b8b,
                ])),
                Felt::new(BigInteger256([
                    0xcf92e4f17a41d03a,
                    0x0a57fade7887d603,
                    0x662c9c6d9593fa9a,
                    0x2146093442bab822,
                ])),
                Felt::new(BigInteger256([
                    0x26bda205ef34c336,
                    0x5637b9357b96dce6,
                    0x02d89a0c3f3b8003,
                    0x038326afe10ef7a9,
                ])),
                Felt::new(BigInteger256([
                    0x23d5c075cc3efd01,
                    0xcdc59f2237f89fda,
                    0x2a128cfbe321f018,
                    0x15a015d483f7f2b1,
                ])),
                Felt::new(BigInteger256([
                    0xf6a045edf7a3090c,
                    0x5f25c277efa93877,
                    0x40f3b8b141de36f5,
                    0x170ce262e9969dd9,
                ])),
                Felt::new(BigInteger256([
                    0x80b0f583a594dd23,
                    0xe0f8265b43a49e45,
                    0xe5af0b621096a6b8,
                    0x2c21b976f71d40de,
                ])),
                Felt::new(BigInteger256([
                    0x13a02b35dc805a7b,
                    0xdcd812c31b758d9b,
                    0xf18c79342063a86a,
                    0x0b6126915e28a3a1,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x26fccb8636914b1e,
                    0x5efdeaa1f9de7399,
                    0x7de67b415bfc56bf,
                    0x0dae835399922240,
                ])),
                Felt::new(BigInteger256([
                    0xe9c108406c0b1d6a,
                    0xd9e035df6e809058,
                    0x45f3fa2139f00217,
                    0x2d977754459dc4a6,
                ])),
                Felt::new(BigInteger256([
                    0x22b1a1d801a53d9a,
                    0x7d1d1113ebacfa17,
                    0x66dc16bc8f4409fb,
                    0x09917523a5a8e467,
                ])),
                Felt::new(BigInteger256([
                    0x213631596a671ccf,
                    0x5f4036728f7d41ca,
                    0x8c316c1b63b49813,
                    0x27198a0b31cba609,
                ])),
                Felt::new(BigInteger256([
                    0xd832fec172720d44,
                    0x9e9959a704e330cb,
                    0x39eee3260bcc87f9,
                    0x15153bcf7adbd199,
                ])),
                Felt::new(BigInteger256([
                    0x72183eb227f06744,
                    0xc83b9ecd244d0ef3,
                    0x0d067aebdb00e9ba,
                    0x131abe2c6d376acf,
                ])),
                Felt::new(BigInteger256([
                    0x0686fbc003776500,
                    0xccadf0131e93d714,
                    0x06b6a7e88c00e358,
                    0x00b7e66f766730b0,
                ])),
                Felt::new(BigInteger256([
                    0x1242a11c760dcdc7,
                    0xeb5c35036de08233,
                    0xdd76f2c6cbe02cc5,
                    0x166c06ccc29678b0,
                ])),
                Felt::new(BigInteger256([
                    0x67bd39624bf3b207,
                    0x6bfe9c47ec61b30e,
                    0xc867618af6d1908d,
                    0x298a1e98b7b0e54b,
                ])),
                Felt::new(BigInteger256([
                    0x49634d46bc5ee439,
                    0xcaa4e13b09c1ddde,
                    0x80a69a04c7c3c882,
                    0x26355c510da9e97c,
                ])),
                Felt::new(BigInteger256([
                    0x542e3f73c922ddab,
                    0x97b6ff8001df0b12,
                    0x4be43fad04097da8,
                    0x2e027e94a11a82e5,
                ])),
                Felt::new(BigInteger256([
                    0xddd3b17cdb3aff71,
                    0xb059b08880985885,
                    0x90d0eaf29948c0cc,
                    0x146d97abc82bcb2d,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::new(BigInteger256([
                    0xafd49a8c34aeae4c,
                    0xe0a8c73e1f684743,
                    0xb4ea4db753538a2d,
                    0x14cf9766d3bdd51d,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xbebb490c2e6f962f,
                    0x465ac2ad04e364b4,
                    0xff4b8beb7ecbd2f7,
                    0x1daa245477c958e5,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
                Felt::new(BigInteger256([
                    0xe07a0c33042f6fc0,
                    0xfbc9e1489023576a,
                    0xd40daa7093c5a810,
                    0x01eb281368a433ca,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0x9221c13bf351088f,
                    0x7ba14974192568d6,
                    0x764d83e12590a30c,
                    0x1efdfa43167d3d99,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
                Felt::new(BigInteger256([
                    0xa8fad3571dcabf05,
                    0x20a54df8cdb610bd,
                    0xb562a9b2221bf6a7,
                    0x113c1d95ad2f3ee3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0xc1291cac726de779,
                    0x730b09508e12a9ad,
                    0x965495beb3b74a80,
                    0x1c9527fa5aabb1b1,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
                Felt::new(BigInteger256([
                    0x68c3488912edefaa,
                    0x8d087f6872aabf4f,
                    0x51e1a24709081231,
                    0x2259d6b14729c0fa,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x70e158db3b3407f3,
                    0x8f929aa081d17d75,
                    0xd75689be8e30120c,
                    0x1505d42fd3e0c136,
                ])),
                Felt::new(BigInteger256([
                    0x83b3d20b26fb297a,
                    0x571e0fa6ccbf01f9,
                    0xd219b485da5d5d9c,
                    0x24218f328560fe6a,
                ])),
                Felt::new(BigInteger256([
                    0xc6951275ff93967e,
                    0xc38dae433581db54,
                    0xffd5b5888e688c6a,
                    0x21daa8439c303667,
                ])),
                Felt::new(BigInteger256([
                    0xe554ad81a56978f8,
                    0xb1c715a31c782647,
                    0xaabb6e282873570f,
                    0x24aca3a2225e2310,
                ])),
                Felt::new(BigInteger256([
                    0x98865f80266d9ef2,
                    0xdf960c87f7048dcd,
                    0xa904cf5b10e1dd11,
                    0x08ae85fb01cc56b1,
                ])),
                Felt::new(BigInteger256([
                    0x2138c6eb000e4d5a,
                    0x47149273769c3193,
                    0x54398e18f2e1e1db,
                    0x0f8845fc7559fe97,
                ])),
                Felt::new(BigInteger256([
                    0xe6ee43e63095f6a0,
                    0x80f5196fafdc48b0,
                    0x4cfdbc6748b206cc,
                    0x1207425b7dc92aad,
                ])),
                Felt::new(BigInteger256([
                    0x464dfde5cf8da20e,
                    0x056a365899df5fda,
                    0x3a6719730f8db2e0,
                    0x240f46e70253b2bb,
                ])),
                Felt::new(BigInteger256([
                    0x10fb2b88eb33870c,
                    0xde66d07fc324c75c,
                    0x3c3f105d2029c010,
                    0x0ccc8a446a7c652e,
                ])),
                Felt::new(BigInteger256([
                    0x52297d97a94afdd8,
                    0xd980663b19cc5a08,
                    0x590950f4c28c3abf,
                    0x16fb2a0b00d06aa3,
                ])),
                Felt::new(BigInteger256([
                    0xce0b6cf483db9def,
                    0x81912a842518a05a,
                    0x551c3c17c7b96535,
                    0x0a0b55f76ed9f6b8,
                ])),
                Felt::new(BigInteger256([
                    0xb2561619452228fc,
                    0x88d8e49932373e59,
                    0x4d89cf531369494e,
                    0x1c7dd40fd266f535,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x12ef542469a9fa09,
                    0xdcc4027ff5e01cb8,
                    0xeb94eaa837a1d98c,
                    0x162bde59a5be5a0c,
                ])),
                Felt::new(BigInteger256([
                    0xff8a7ce52f16d64f,
                    0x18a16b67285940c0,
                    0xd020537ebf517c82,
                    0x23bb5396e7516108,
                ])),
                Felt::new(BigInteger256([
                    0x6b6831cf991171a4,
                    0x7f74099ffbbc6963,
                    0xd114e1ba5a1c05d9,
                    0x0e91fc7a801cb5b1,
                ])),
                Felt::new(BigInteger256([
                    0x7615c5efc8eeefe0,
                    0x7ce11be9cbe562fe,
                    0x77378eaceac04e5e,
                    0x204d91abbc9af7c7,
                ])),
                Felt::new(BigInteger256([
                    0xd60d09ad31763086,
                    0x46583a4b962fc8da,
                    0xb307c59a5737b6e9,
                    0x0e2b5bde105ce611,
                ])),
                Felt::new(BigInteger256([
                    0xf78c61a615a9d540,
                    0xad7cb0737270a6cf,
                    0xcc825ee2ec018d67,
                    0x20ba9a78dec0bcbe,
                ])),
                Felt::new(BigInteger256([
                    0x601457a8b1f39ec8,
                    0x70e9d90928e794c2,
                    0xdb0e5d80ed080b99,
                    0x263f7a62a0d1c628,
                ])),
                Felt::new(BigInteger256([
                    0x70998aee1894640a,
                    0x3d0ee4b8cb272c07,
                    0x08a51e41f1598350,
                    0x165ca8be756e149a,
                ])),
                Felt::new(BigInteger256([
                    0x2eaab66aff9faad3,
                    0xde388f727362ce43,
                    0x69bd65f2582a8a99,
                    0x09acae4a34f81817,
                ])),
                Felt::new(BigInteger256([
                    0x98db0127ace10fbb,
                    0xb2f1e4ee935a7a02,
                    0x212c24d39d9871e4,
                    0x177310203d013eec,
                ])),
                Felt::new(BigInteger256([
                    0xefb7bc0dcadefc06,
                    0xe06ef3a865018d6d,
                    0x68457510c374c8c7,
                    0x2557bfcf9b140064,
                ])),
                Felt::new(BigInteger256([
                    0x2f9c8355763cc3b8,
                    0x485cd04816d39de7,
                    0xa3da129a90259b89,
                    0x11368116da059ab3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7564ac47498d103b,
                    0x57844ce1d0abe9ee,
                    0xbe19c51a842fc906,
                    0x263ba7589443fd92,
                ])),
                Felt::new(BigInteger256([
                    0x90339fe17dcfca3a,
                    0xeaae69a0953ed014,
                    0xedeb8d5fa77428b4,
                    0x05e3a68acb8cd829,
                ])),
                Felt::new(BigInteger256([
                    0x302170a3d44701fe,
                    0x16fd8a3446f56951,
                    0xe6d764a151bfadc8,
                    0x08d444a380613561,
                ])),
                Felt::new(BigInteger256([
                    0x89a612703446e6f1,
                    0x5cf12893a4d6ff7a,
                    0x2e29c80e56fdb7dd,
                    0x2f7a0dd7122d5a27,
                ])),
                Felt::new(BigInteger256([
                    0xbe33dd1fc4c869cc,
                    0xb041457641d9a172,
                    0x48d5adda14c2fd4f,
                    0x077b5414b4f32bef,
                ])),
                Felt::new(BigInteger256([
                    0xb956edf195317790,
                    0xd163547226e50e31,
                    0x10b9b251d8788ba2,
                    0x0e188fb4f0ec9d8a,
                ])),
                Felt::new(BigInteger256([
                    0xba77a0e13381e52d,
                    0x3c9c0ef7fa490fb4,
                    0x0fb98c649f926dcd,
                    0x01631b81e2184e61,
                ])),
                Felt::new(BigInteger256([
                    0xcae463720b52c88f,
                    0xd53da41d69045b71,
                    0xcda512a8e3e5ea2a,
                    0x129f2108bce98975,
                ])),
                Felt::new(BigInteger256([
                    0x3e3adfb466320641,
                    0x40cfc104bd0378f9,
                    0x3e1db02d41b23900,
                    0x1a484b41be61e818,
                ])),
                Felt::new(BigInteger256([
                    0x52d2dcfffb81dc41,
                    0x36dbf676d21c8c71,
                    0xdc6bb7a82f8ac7f5,
                    0x2132336ce65c593d,
                ])),
                Felt::new(BigInteger256([
                    0xb086334e9a8442fe,
                    0xc51d001309017857,
                    0x6dc797164de13edb,
                    0x23e865fe6228e4cc,
                ])),
                Felt::new(BigInteger256([
                    0x4005b68068b2dd2e,
                    0x0d6aae72d503e934,
                    0x737a621c3ab58a78,
                    0x1df81eb2b2c1d68b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xde9c6ffd7a3e1432,
                    0x1a1842768b612396,
                    0xbcd4d76273c5f059,
                    0x2c3cb3726dc5871e,
                ])),
                Felt::new(BigInteger256([
                    0x69e57fee8d8228d1,
                    0x9e98b1a53edc4e5b,
                    0x74c085216e16fc1f,
                    0x113c7e9a5fc8971e,
                ])),
                Felt::new(BigInteger256([
                    0x33f0d199ad9500c9,
                    0xcd33f49a22bc169b,
                    0xf30faec1a9535737,
                    0x0f9da92191c3c78f,
                ])),
                Felt::new(BigInteger256([
                    0xe5c09fa6d47c04be,
                    0x348cbb0de4341f5f,
                    0x3bbb25cd06d54a23,
                    0x28c220d17a98f9b6,
                ])),
                Felt::new(BigInteger256([
                    0xbc1d2670d5b54990,
                    0x6bdddbeb62ede369,
                    0x24b57db8c6da89fe,
                    0x10149fde7ea41bf8,
                ])),
                Felt::new(BigInteger256([
                    0xb8302a14e313491f,
                    0xf85a297b478396f9,
                    0x5db4a552b23104f1,
                    0x16d3678cf9f728c3,
                ])),
                Felt::new(BigInteger256([
                    0xdc8df70dca76367d,
                    0xcc6eed47481b56cc,
                    0x9b0ee6ab4c70f847,
                    0x1b9f9ad7ee1caba4,
                ])),
                Felt::new(BigInteger256([
                    0xb65508594a1701b4,
                    0x624b5a569246b2a2,
                    0x75abf0c6bfbb92e2,
                    0x072e2cbea10c20c0,
                ])),
                Felt::new(BigInteger256([
                    0xd16dedd7fa236256,
                    0xdad49156d309e226,
                    0x7e9d46ed43224534,
                    0x0aa77f77efdf75d7,
                ])),
                Felt::new(BigInteger256([
                    0x7ffbd6a1aad12531,
                    0xce7944e526a130d9,
                    0xf89dc529f023f4a8,
                    0x19ea210dec2b7c5a,
                ])),
                Felt::new(BigInteger256([
                    0xfdc4b428d7be949b,
                    0xd67a232beb37e741,
                    0x01ee9f2ab9800060,
                    0x1bb3e72e861afb65,
                ])),
                Felt::new(BigInteger256([
                    0x1569203f9dc6e50f,
                    0x7e84880cdd453024,
                    0x86611eb2b8622a82,
                    0x0b1e5c2aa06dfe8e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x96320e36cabbf9e5,
                    0x119d950e132d206c,
                    0xc0a5ade42c5f0d20,
                    0x0f5e0c7f6dc16e82,
                ])),
                Felt::new(BigInteger256([
                    0x474f44c5a5728c18,
                    0xefa03e6f0eda8c74,
                    0x50c6d806e606df4b,
                    0x0bba860d86387191,
                ])),
                Felt::new(BigInteger256([
                    0x7be8902fd3750341,
                    0x5c3bdc72e28d250f,
                    0xe861dca3c3b40bfa,
                    0x16ba77e5f88e41d0,
                ])),
                Felt::new(BigInteger256([
                    0x216db17e557d9eca,
                    0xc2b48276d0d01322,
                    0x9923257fe46b0857,
                    0x2e6783c4dd45d80c,
                ])),
                Felt::new(BigInteger256([
                    0x21d7d8ee9c8b57c9,
                    0x7ac768f4f75309f3,
                    0x01f26ec7018d2b45,
                    0x1356faba3d9e0d58,
                ])),
                Felt::new(BigInteger256([
                    0xc15365db0086e794,
                    0x3b5c1a4716754036,
                    0x18ed844065903185,
                    0x239b157fb90e825f,
                ])),
                Felt::new(BigInteger256([
                    0xa3d977c9555ee4a5,
                    0xf30254904ffd70cb,
                    0xf773f13fb43e9acb,
                    0x2ce52bca69443f7d,
                ])),
                Felt::new(BigInteger256([
                    0x3a3502c6772f8750,
                    0x9d1d95c72851e7d7,
                    0xd2a9cda670d907e6,
                    0x17846f06f95e9cfb,
                ])),
                Felt::new(BigInteger256([
                    0x37cde7118b2d2b8e,
                    0xb5ae0e00026a61b4,
                    0x93f5c7b7bd59b56d,
                    0x22b705d50d3929be,
                ])),
                Felt::new(BigInteger256([
                    0xd61512285c6b2fe0,
                    0xbc4f19c06baded01,
                    0x53ef76f120c82cb1,
                    0x16512abcc8ec6c2c,
                ])),
                Felt::new(BigInteger256([
                    0x2853d26483208b81,
                    0xd0e88d648e6d1b78,
                    0x8e759ec38e059d6d,
                    0x1458235fc3a00db0,
                ])),
                Felt::new(BigInteger256([
                    0x34885ba37da7e476,
                    0x69ade6e77f489ca8,
                    0x1e24c5f4915eb4b4,
                    0x050d0ea9e54e3f63,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdd81b7dd521231a4,
                    0x00526633b7406057,
                    0x5f22b778bd404b63,
                    0x08846b00ca381db5,
                ])),
                Felt::new(BigInteger256([
                    0x7f50caf5ff5a96ad,
                    0x8af5536714583a1b,
                    0x37bf5065318e7a9d,
                    0x01517460a29d5256,
                ])),
                Felt::new(BigInteger256([
                    0xffa7d40c4e345677,
                    0x4daab5dfbaf43d53,
                    0x6c68d3b6e05b019c,
                    0x1c1a3348aaa4f69d,
                ])),
                Felt::new(BigInteger256([
                    0xbc5df4799697b46a,
                    0x5ece064c3512c1e3,
                    0x1ade876af1f3196f,
                    0x14e34ba3f7d00c81,
                ])),
                Felt::new(BigInteger256([
                    0x905a761f0fcd5e9c,
                    0xb8006669cae6889c,
                    0xda912309df7012a4,
                    0x2c1bc1e555e0cfa2,
                ])),
                Felt::new(BigInteger256([
                    0x19bc362f25255aa7,
                    0xb3029092fe75af01,
                    0xb699dfa5ac2fa2bf,
                    0x014c1ec58531ed2e,
                ])),
                Felt::new(BigInteger256([
                    0xd6663451c1e9a938,
                    0x21c523011343cc91,
                    0xf84b9d10cb71cc28,
                    0x229fdb8bc5835e67,
                ])),
                Felt::new(BigInteger256([
                    0x1bde8d2a1c0cb78e,
                    0x139f00acd8caef3c,
                    0xcb651033f9943a92,
                    0x0b58efddd765ae81,
                ])),
                Felt::new(BigInteger256([
                    0x111f2ac3a3707f0b,
                    0xc155ef24d44b0dc2,
                    0xa8a0710d199e41bb,
                    0x304f5e9173470e04,
                ])),
                Felt::new(BigInteger256([
                    0xf0e00e42f0788ccf,
                    0xec78ff8f654115ac,
                    0x91ae48705823e1bf,
                    0x2819bd6818a2d38b,
                ])),
                Felt::new(BigInteger256([
                    0xace92e3add00576a,
                    0xd4f977334b7034b3,
                    0x1215581ee0392393,
                    0x13d196640cc21158,
                ])),
                Felt::new(BigInteger256([
                    0x19a2765062b6aa68,
                    0x2cc982fa3a8472de,
                    0x6523f2436f507415,
                    0x27f4ecf8e71d5b41,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xf189108332c23667,
                    0x1c87831b7bba9c9c,
                    0x2d90a1409f657faf,
                    0x25908fb3e2d1a0b1,
                ])),
                Felt::new(BigInteger256([
                    0x72f4f53095ff19cf,
                    0x689a64e635dd5818,
                    0xd0317e516af7d950,
                    0x1980ab8644b5bced,
                ])),
                Felt::new(BigInteger256([
                    0x4a4e37527659de88,
                    0x52064a2e44caf1da,
                    0xddf8cc6c34e675fd,
                    0x0433dd6ba0f4e748,
                ])),
                Felt::new(BigInteger256([
                    0x5f67eb195e990a3d,
                    0xe90fe6559bea1ce9,
                    0xc2631719967e9868,
                    0x026016e18a5b409c,
                ])),
                Felt::new(BigInteger256([
                    0xef03f339cc7e0e06,
                    0x510f22ad31c203b6,
                    0x4bc6cfcdec2dc73e,
                    0x0c7a69dc1c7228c6,
                ])),
                Felt::new(BigInteger256([
                    0x2db3c3bcccffa769,
                    0xa4007bfc49b473c1,
                    0xc0f9fe7fa6d6b44e,
                    0x09f4a64e195069ce,
                ])),
                Felt::new(BigInteger256([
                    0x883e520a7934ec6b,
                    0x546ed685049447ac,
                    0x0b1671bfc836355e,
                    0x2353ce93dc14b3a2,
                ])),
                Felt::new(BigInteger256([
                    0x3db187f47101ca85,
                    0x96904324193b994c,
                    0x0d355cdc320e98c1,
                    0x1a1fbb71c02f510a,
                ])),
                Felt::new(BigInteger256([
                    0xc5e57005dd0e3c0c,
                    0xc49737052a3efa3a,
                    0x26dbe8125a2810cb,
                    0x1d3480d6b53910ec,
                ])),
                Felt::new(BigInteger256([
                    0x533a809be39a0690,
                    0x3b2f4d611da567c2,
                    0x742b08cc5ce47c72,
                    0x2cf00cccc0d52118,
                ])),
                Felt::new(BigInteger256([
                    0xff71dd9c13bcd23e,
                    0x87341fb1851d59d0,
                    0x16cad35b648bbba8,
                    0x2caee7a4da103b5e,
                ])),
                Felt::new(BigInteger256([
                    0xff0d1a6c58f2baaa,
                    0x7ba547419ee89f70,
                    0x1f2d8648f5ed0183,
                    0x2b5aa6903cba47ab,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x304ce1fd1b032944,
                    0xbafcfe02168b1dc1,
                    0x94b273a7153b8345,
                    0x1bb2280ddba8a468,
                ])),
                Felt::new(BigInteger256([
                    0xe8390290bb7877ef,
                    0xa255ee2e99ece2fe,
                    0xb568e0c8aa4240fb,
                    0x0e61d90df66ce0bb,
                ])),
                Felt::new(BigInteger256([
                    0x5957eca4b1d3dfe5,
                    0xd87a56c59df553ef,
                    0x3d89b4641c991d4f,
                    0x15553b02e234a22e,
                ])),
                Felt::new(BigInteger256([
                    0xf11b29074fb27dce,
                    0x2cdad251592511ce,
                    0x2d55bfc924746acb,
                    0x02ce007352c9b619,
                ])),
                Felt::new(BigInteger256([
                    0x5ceb1c153ee57bfa,
                    0xc24e1c6aacc33cca,
                    0x7bbe476207dbbd6b,
                    0x277fd412c8f083ad,
                ])),
                Felt::new(BigInteger256([
                    0x1cce32f798077018,
                    0x15421d3c5e5b186b,
                    0x6b21689ed4f7615c,
                    0x2274124ecb852cd1,
                ])),
                Felt::new(BigInteger256([
                    0x9ce716d43400eb94,
                    0x5731499f1b94b8ab,
                    0x52d067fbdd993089,
                    0x256fa5e4adbe1d87,
                ])),
                Felt::new(BigInteger256([
                    0x61af7b4d5e01b721,
                    0xaa7c7c3deba1d290,
                    0xe436d2f03dbc2a08,
                    0x1286845a61b038e9,
                ])),
                Felt::new(BigInteger256([
                    0x5c8d11d89e4af7bf,
                    0xce37962b683e498b,
                    0xe085b47430c9a294,
                    0x00dce3b76c2ceb45,
                ])),
                Felt::new(BigInteger256([
                    0x22308c7f87515c2e,
                    0x83e5479356a69df4,
                    0x7d0789422ddfc50c,
                    0x2b112020b193a978,
                ])),
                Felt::new(BigInteger256([
                    0x0fb9109fd84a2f96,
                    0x7820962d49a0b94d,
                    0x903372760c8e96ff,
                    0x1814fd069c048526,
                ])),
                Felt::new(BigInteger256([
                    0x9e4bcaa26b18ad35,
                    0x3f679818a320d9c2,
                    0xe865f7c5a0ecbf42,
                    0x0a6b4261d3992f74,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x425113dd8ed0715c,
                    0x774ef55f98107a75,
                    0x0d5f99533334f82a,
                    0x1f2c2824a132e4b7,
                ])),
                Felt::new(BigInteger256([
                    0xfd2f0764984303d4,
                    0x42d193f2fcafa01e,
                    0x6661dfe0b02e3eab,
                    0x20f35f58a09c63c2,
                ])),
                Felt::new(BigInteger256([
                    0xb019a0131a8f6030,
                    0x79f90337a0c619f2,
                    0x35ee27e1a898c4bc,
                    0x04cfb9366bf42fb5,
                ])),
                Felt::new(BigInteger256([
                    0x6581d85f7faa85c5,
                    0x05c2fe94b8e804bb,
                    0x4dc5e35436668f08,
                    0x2d5cd4086a55dbe6,
                ])),
                Felt::new(BigInteger256([
                    0x891b5985e0a1a38c,
                    0x9538677ee116cb20,
                    0x8be627c0fe1b2a2c,
                    0x0beca31d7131cc6f,
                ])),
                Felt::new(BigInteger256([
                    0xc961142b71193b9b,
                    0x15dc43c5fca804d3,
                    0xb5cd0cbf25d368d3,
                    0x2cfd656bfbb20487,
                ])),
                Felt::new(BigInteger256([
                    0xc8c7c499f95e1e74,
                    0x0f9b246c1ae04633,
                    0x27aec99239c46960,
                    0x0453a602cb8e308b,
                ])),
                Felt::new(BigInteger256([
                    0x057fb25059c712c8,
                    0xef43d61d30781a98,
                    0x9af2e634e2659e33,
                    0x218eeaad16618dc8,
                ])),
                Felt::new(BigInteger256([
                    0x1a05729b8bbf26a3,
                    0x59b300a52158c9bc,
                    0xc93660160c244eb4,
                    0x2d796b3255e7b7b6,
                ])),
                Felt::new(BigInteger256([
                    0x35204d9e1d77f0fb,
                    0x37c38114675dc4be,
                    0xb5bfb207972376b0,
                    0x0293cc8275f43749,
                ])),
                Felt::new(BigInteger256([
                    0x6387be14e2acf0a6,
                    0xd390264913b6d4ac,
                    0xb6cb8207c47cc7cc,
                    0x22ddcb225e7fd282,
                ])),
                Felt::new(BigInteger256([
                    0xaf445131b0872953,
                    0x40cef0e29625ddd8,
                    0x68744294ad130dbb,
                    0x08c0f9e900ebc993,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5905d611b8bd0c4d,
                    0x96d1d1339857bcea,
                    0x3f90b3e1745731b2,
                    0x1d76ddd9c96d012f,
                ])),
                Felt::new(BigInteger256([
                    0xecdfbcb8c53f7679,
                    0xa831f47cb20fc1ce,
                    0xcfe997551ab8053e,
                    0x2f6a26691bd850b5,
                ])),
                Felt::new(BigInteger256([
                    0x28202ff5eb640b9c,
                    0x42b0bcca91748d61,
                    0xcea69a471459c6aa,
                    0x030a99bc4f13d1a9,
                ])),
                Felt::new(BigInteger256([
                    0x5252e832925b0fcd,
                    0x670be193360d699e,
                    0x66232b98d41772ec,
                    0x18f5db77e0b927dd,
                ])),
                Felt::new(BigInteger256([
                    0x97090832699f3edb,
                    0xc1df637d17eab448,
                    0xe060eac940c87e77,
                    0x0753f38844594aa7,
                ])),
                Felt::new(BigInteger256([
                    0x4d1ff2975ac787f8,
                    0xe9cb7473c5f876e7,
                    0xacac0b4efb0b398e,
                    0x25102bab6ad61a06,
                ])),
                Felt::new(BigInteger256([
                    0xe018ebada59887b9,
                    0xe5e7c0e6d9a4a045,
                    0x985e114509d1c3a5,
                    0x0ede783a0d03b68b,
                ])),
                Felt::new(BigInteger256([
                    0x136093d56ec76213,
                    0xfe6999d3e5945947,
                    0x3bd9ce82ae2aa0b6,
                    0x190b5ce2fd8021f0,
                ])),
                Felt::new(BigInteger256([
                    0x4e1aa45aa73ee106,
                    0xe8cf98437c6ffaa5,
                    0x2bb6e08c73186239,
                    0x04662e1d71fefc97,
                ])),
                Felt::new(BigInteger256([
                    0x61c9a1f400c58162,
                    0x01b5540784e5e8c7,
                    0xb03bb4057738fa7c,
                    0x28dda8b547e56e52,
                ])),
                Felt::new(BigInteger256([
                    0xf1c64690e9a097dd,
                    0x35f32096e583c771,
                    0x9e97758e317fdd00,
                    0x03f6babfecb5d519,
                ])),
                Felt::new(BigInteger256([
                    0x3a78de8f8478d577,
                    0xbd4fa6dd1915ad24,
                    0x2cccd566d033b6e6,
                    0x0fad186645302a2b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x349e3f58c10d8fa7,
                    0x698341ce79a70e4e,
                    0x28954de57d8269bd,
                    0x0c32517ef65ff270,
                ])),
                Felt::new(BigInteger256([
                    0x3b3b920ee8edcfeb,
                    0x642b49dd78dc03e7,
                    0xd9524fd9acca4f34,
                    0x1e8eb378971c6dac,
                ])),
                Felt::new(BigInteger256([
                    0x033cb8e6d995c22c,
                    0x05f99d7e76a523a8,
                    0x848ea8ed3c042481,
                    0x0d051e1064e439a2,
                ])),
                Felt::new(BigInteger256([
                    0xf11fea6b80ff3c39,
                    0xf67eef7d9b916ade,
                    0x58f82f8a7b30c481,
                    0x19a0d196a2e45623,
                ])),
                Felt::new(BigInteger256([
                    0x66ffdb0699030837,
                    0xed6d301b9683e066,
                    0xb4d9559e3e5ae80a,
                    0x079d30811ef3c219,
                ])),
                Felt::new(BigInteger256([
                    0x0914d76d790fe9b0,
                    0x355edcfc1c9e043e,
                    0xd907d43328ed1922,
                    0x2bd157abe90a01e4,
                ])),
                Felt::new(BigInteger256([
                    0x1318859f120bff71,
                    0x11b79d130380eee3,
                    0xc54d123c2dbe78c1,
                    0x2c8d52837ca8031b,
                ])),
                Felt::new(BigInteger256([
                    0x29cfe2f1a5fad0b8,
                    0x42afa29833fb4940,
                    0x5326d325cfed6893,
                    0x08e843fdf83ae50e,
                ])),
                Felt::new(BigInteger256([
                    0x250afe6682b6d5ba,
                    0x47e36c60803833b0,
                    0xfee95f05afc2d354,
                    0x23da8a8c16ef628c,
                ])),
                Felt::new(BigInteger256([
                    0xc1feccea8e1bed03,
                    0x15bc508f2ae8149a,
                    0x1331b7f03f966a63,
                    0x1d30809d0ff9d26d,
                ])),
                Felt::new(BigInteger256([
                    0x7ba175108974221c,
                    0xde73f8c5cdfa4631,
                    0x7f2346fa0680224b,
                    0x16084f2e3625932d,
                ])),
                Felt::new(BigInteger256([
                    0x8b9d934a2cf5d327,
                    0x1655a37da85e57b5,
                    0x0fb60fd1885673b0,
                    0x1f35a0b28f92c921,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x838d36e7835b9749,
                    0x9908c4c1c5e36472,
                    0xb23bbfeb48d65a13,
                    0x0c91359a378f4907,
                ])),
                Felt::new(BigInteger256([
                    0xf2cc3384b8b9ccd5,
                    0x8f14cbc53af901c7,
                    0x56a72b2d217f4384,
                    0x137578b38deb9c6c,
                ])),
                Felt::new(BigInteger256([
                    0x4feaa574bd25ec02,
                    0x315fec9d20f4a0c2,
                    0xa23a57c02232f423,
                    0x163c51ce9acfa298,
                ])),
                Felt::new(BigInteger256([
                    0xc549356ba4d0cd19,
                    0x7953c347ae7a608a,
                    0x0563f86b162ee453,
                    0x250cf8aa7477867f,
                ])),
                Felt::new(BigInteger256([
                    0xb9aae90cc18ef0e6,
                    0xac87b37181484a95,
                    0xa6418799e82add76,
                    0x123c7a3749c8bf7f,
                ])),
                Felt::new(BigInteger256([
                    0x62a04c176a477871,
                    0xb4e130768e7a4e7c,
                    0x897c8efb8347d8cc,
                    0x06355f32922b2419,
                ])),
                Felt::new(BigInteger256([
                    0xae5a22ce2018293e,
                    0x5423e1987dbadc70,
                    0xd2939325fac7cb8b,
                    0x2c6315b4e4dd50d2,
                ])),
                Felt::new(BigInteger256([
                    0xc263e4dbccfa40c3,
                    0xc99dc1a9b88b99c5,
                    0x260e975444ac36b4,
                    0x2d46c00fbe0b7f75,
                ])),
                Felt::new(BigInteger256([
                    0x195b5a2faf83d933,
                    0x37a2ecd0d0a1f6ec,
                    0x9d77c38514689292,
                    0x18afe542e1af3548,
                ])),
                Felt::new(BigInteger256([
                    0x631b98b6c81c1d86,
                    0xaf0517c9f0d0a2e2,
                    0x3aad4ba70918f0b4,
                    0x185f9af61dcbc767,
                ])),
                Felt::new(BigInteger256([
                    0xf35a33a8857a780e,
                    0xa8a8b87559be7535,
                    0x8d27a9342a5e6eb1,
                    0x2e7dbcdcc8196803,
                ])),
                Felt::new(BigInteger256([
                    0xad3c14e52dbe0f05,
                    0xa80eafe6b285e00f,
                    0xbb82e0b0b84f7e2b,
                    0x10cbd052324b57bb,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::new(BigInteger256([
                    0x56a68aa134bc1de1,
                    0xdbeb4a5c2953ec12,
                    0x67136824e1f2c19c,
                    0x26dbd2e1a2a54ee3,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x8dd07e4310b3523a,
                    0x2ebd4ae900dedcce,
                    0xc0b5d06682f2d934,
                    0x0dbbec58d529dbfd,
                ])),
                Felt::new(BigInteger256([
                    0x80601bd9a03cedac,
                    0x74b2816291381421,
                    0xf082a746881a4e96,
                    0x172aeda09da57d32,
                ])),
                Felt::new(BigInteger256([
                    0xb5f7bc092c497120,
                    0x047e20e00713b426,
                    0x8a123b65be0908bd,
                    0x258a2b2be6b5d92e,
                ])),
                Felt::new(BigInteger256([
                    0xf565acd825cab364,
                    0x6ade550068abc812,
                    0x41f4c18bbe7b1342,
                    0x08f7177872f3e4ca,
                ])),
                Felt::new(BigInteger256([
                    0x407a9804d6a76393,
                    0x08077fa6bb561faa,
                    0x20d5d77b25058670,
                    0x1e71c183ee024fa8,
                ])),
                Felt::new(BigInteger256([
                    0x27f1ab99dd243796,
                    0x5814fbf90e8a5cb4,
                    0x885987dece43dbf0,
                    0x2204620827c5957b,
                ])),
                Felt::new(BigInteger256([
                    0x65bc9f2d53fcbe9d,
                    0x1642a3625fc8547e,
                    0x45239b449be3cf74,
                    0x1757325c652e4c40,
                ])),
                Felt::new(BigInteger256([
                    0xe54313d68ce72751,
                    0x686fefff4af0d7a2,
                    0xce6a1a01bcb79088,
                    0x2581021873f4a8e9,
                ])),
                Felt::new(BigInteger256([
                    0x3afe20674c083abe,
                    0x61d8cd5cbfaa514a,
                    0xe3f6ec7847b7f5ec,
                    0x25bfd4dd5224da9c,
                ])),
                Felt::new(BigInteger256([
                    0x1512987e6c62f5f7,
                    0x4b63067f65937373,
                    0xf2fb0f7f566629d7,
                    0x24ae6e6d6a2b3afe,
                ])),
                Felt::new(BigInteger256([
                    0x6edd43c8d2822def,
                    0x18b1c5d12c6bdf58,
                    0xee37b9575217eb08,
                    0x28c8bff5dce3d958,
                ])),
                Felt::new(BigInteger256([
                    0x9a095da9005a2c16,
                    0x374f9527df0c4399,
                    0x058e951b1e821fd2,
                    0x2616c6285ad89010,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0d2193ec80875fc6,
                    0xfa324d98706d1cbc,
                    0x726c9042bd244ef8,
                    0x259835aba9bba1be,
                ])),
                Felt::new(BigInteger256([
                    0xa4fd2069a4d30729,
                    0x54421f8dd884d811,
                    0x124fb43d6b52c2c5,
                    0x084252a3672c8cab,
                ])),
                Felt::new(BigInteger256([
                    0xddfe363b95554b29,
                    0x2b2e54bc6ea37b04,
                    0x7f6ebaa50527e869,
                    0x154dcf0602cccf65,
                ])),
                Felt::new(BigInteger256([
                    0xe9ac11d9faa79eaa,
                    0x05e22ee78486567e,
                    0xbeb63a7d717a32e1,
                    0x14d488f71f89e125,
                ])),
                Felt::new(BigInteger256([
                    0xa81b4c215a3caa3d,
                    0x4c5b0cc3707189ab,
                    0x6c6bf07d263eada8,
                    0x2fb615d415bacf2b,
                ])),
                Felt::new(BigInteger256([
                    0x310b5810183bf620,
                    0x33b847dad8ced5b8,
                    0x648547ffb33e8808,
                    0x061eea397c1bff3d,
                ])),
                Felt::new(BigInteger256([
                    0xcf527a64ce08847d,
                    0x4205ca603f05867a,
                    0xc45e7aa57188e39c,
                    0x25b5db56bb2c9206,
                ])),
                Felt::new(BigInteger256([
                    0x649363e8f68794ae,
                    0x17719b1b8bfce636,
                    0x2c47fa5140e2fd41,
                    0x14a899ff044c29ae,
                ])),
                Felt::new(BigInteger256([
                    0xef41574e1148b6e1,
                    0x1c33d4c7287f1370,
                    0xbfb0f46562769311,
                    0x073642cbc87f722b,
                ])),
                Felt::new(BigInteger256([
                    0x8a37c45efe66945b,
                    0x31f6d94b53260bce,
                    0xd7dd3857b6da3fe9,
                    0x3019b3cf5b30e091,
                ])),
                Felt::new(BigInteger256([
                    0xbe99d0304c39a013,
                    0xdf9ddaf2e1997ee8,
                    0xc17994079e0b4029,
                    0x1f2ed0f48c5a719b,
                ])),
                Felt::new(BigInteger256([
                    0xc05fabe082480d9e,
                    0x94eed19799e64455,
                    0x4d995a8d5d7c0220,
                    0x1a9b61bd12647355,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7a1d0489594f64de,
                    0x924a2a99c6bf1154,
                    0xa72d4cdb7e33e499,
                    0x08dde5fabcd4de99,
                ])),
                Felt::new(BigInteger256([
                    0x7160558f44607917,
                    0xaa89da9d7e6ca27c,
                    0x36659e2d5134b98f,
                    0x04701140527fa9bb,
                ])),
                Felt::new(BigInteger256([
                    0x3f9ad44f364c2d75,
                    0x62398b1feead39c4,
                    0x0400aecb7faca20b,
                    0x26c563af73fccf36,
                ])),
                Felt::new(BigInteger256([
                    0x0d442a6312a31110,
                    0xf8abd4428fd99af3,
                    0x40ed2c2bc83e3672,
                    0x1aa66b8132401833,
                ])),
                Felt::new(BigInteger256([
                    0x4a50f47d94a5640c,
                    0x1e274e829519a9e0,
                    0xf8309c867f1adc05,
                    0x2e2835acbf94424a,
                ])),
                Felt::new(BigInteger256([
                    0x9c8d989f802cc68e,
                    0xee973e0fdc7eb858,
                    0x672a8b45018c847c,
                    0x08b376d21d72a7d6,
                ])),
                Felt::new(BigInteger256([
                    0x0545ef25008c64a1,
                    0x532702b0f419c063,
                    0x0712c88e78d91ae3,
                    0x059bd6dccaeb8791,
                ])),
                Felt::new(BigInteger256([
                    0x62aee36c48f3ad98,
                    0x3cf61e5f82162e0b,
                    0xeac2c9ec083754e3,
                    0x1783cb45618dd0f3,
                ])),
                Felt::new(BigInteger256([
                    0x27edc40289af385e,
                    0xe7a414784f02a1a0,
                    0xcf852881efb388c4,
                    0x25bb257dacd5fa45,
                ])),
                Felt::new(BigInteger256([
                    0x62fad45d8e0e3d4e,
                    0x5348920d8bbe2838,
                    0x7023990e63f31932,
                    0x2e88d13b834f45d8,
                ])),
                Felt::new(BigInteger256([
                    0xf62b76da54ba8eb0,
                    0xa625dba92e7d8501,
                    0x28360c513e2a191e,
                    0x21d1bd9a20114433,
                ])),
                Felt::new(BigInteger256([
                    0x1d15421138e62a09,
                    0xd5a510fbf0c0d701,
                    0x3774841675fc44e8,
                    0x185663db8ff09753,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xac59af311df96766,
                    0x93da6f684662fd35,
                    0x07152eccb51c0d07,
                    0x095644fb4169d650,
                ])),
                Felt::new(BigInteger256([
                    0xa69a0e8ab3a3b9c8,
                    0x5659e7bfa0ce33ab,
                    0xfc1b163e40aff4df,
                    0x20d51da521490c32,
                ])),
                Felt::new(BigInteger256([
                    0xb0c278a162901f96,
                    0xc83b022fff71e1b7,
                    0x49d63898e96a366d,
                    0x00f43e5ccedf09aa,
                ])),
                Felt::new(BigInteger256([
                    0x6cad76ecd8f8c903,
                    0x2fa4f0bacfd8a613,
                    0xff1fe107c803b36a,
                    0x20bd13642509013c,
                ])),
                Felt::new(BigInteger256([
                    0x000657fa95d079b2,
                    0xdd94ed38764ebc42,
                    0xc656bee852f9814e,
                    0x037e67657ea170f3,
                ])),
                Felt::new(BigInteger256([
                    0x5216181fa26e040b,
                    0x56627e8b1486a424,
                    0x15071b4bae0f0826,
                    0x02926ea3b843d9f3,
                ])),
                Felt::new(BigInteger256([
                    0x4a1fcea623da90b2,
                    0x4d19f8dbab629013,
                    0x12f491b18fd27c99,
                    0x2d23e4ca5ae41709,
                ])),
                Felt::new(BigInteger256([
                    0x9ef6d104600585f9,
                    0xd1135f03dccc9d7e,
                    0xc1ab90437b2efb49,
                    0x05bac9fb9e7e8e1a,
                ])),
                Felt::new(BigInteger256([
                    0x501da7ac10a2f961,
                    0xe71b8021101817b1,
                    0x165a986d50fa6984,
                    0x0c999bfe908b705e,
                ])),
                Felt::new(BigInteger256([
                    0x0a46d8459ef40ffd,
                    0x78e30e6b69ddc001,
                    0xbd5c25f9d69868d1,
                    0x2c7b169c2ec02e3e,
                ])),
                Felt::new(BigInteger256([
                    0x7bd013b1a59730a8,
                    0x69661402b3aef288,
                    0x461931d8a3798d77,
                    0x0ca4e6a4de12fdf7,
                ])),
                Felt::new(BigInteger256([
                    0x13e1440ba53c9ad7,
                    0x962a805be78ac15e,
                    0xec2bfb6bbdd6fd32,
                    0x281963be779aed14,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x1e46809799465567,
                    0xb1e416e24c8dba99,
                    0x5ebf42d9e963e3d8,
                    0x016295938cc8f9ce,
                ])),
                Felt::new(BigInteger256([
                    0xf9d03abcf0c96e79,
                    0x33b792e9d94535d9,
                    0xf20362d583f03e38,
                    0x07a8e59cc92fc8c1,
                ])),
                Felt::new(BigInteger256([
                    0x9b074e63a84f8410,
                    0xaf42d65bd1a580ad,
                    0xc8381b4a08b7d64f,
                    0x2d8fea1e78978a6c,
                ])),
                Felt::new(BigInteger256([
                    0x64488c03932af53c,
                    0xef3b20f4e6b65bb5,
                    0x1a5f4abd64dceaaa,
                    0x08dcc2cabc9ec464,
                ])),
                Felt::new(BigInteger256([
                    0xd0c8730a7af32a82,
                    0x18d155d7b69afe43,
                    0x57028f15962709db,
                    0x29fc56cf07d175b5,
                ])),
                Felt::new(BigInteger256([
                    0x7713922f8ae1633e,
                    0x1fca567c913f7bc6,
                    0x8f8dbcc6f06adebd,
                    0x22d951a9f820fe0c,
                ])),
                Felt::new(BigInteger256([
                    0xa25d015e479235b9,
                    0x6dff5a417deada38,
                    0x1a7ba82081099e76,
                    0x0eb9a3d661f6e9c6,
                ])),
                Felt::new(BigInteger256([
                    0x8978ec8c2a41726c,
                    0x4ff7ec79eb7ef221,
                    0x68a4c018d96eceec,
                    0x30439f867c5e3f46,
                ])),
                Felt::new(BigInteger256([
                    0x0aa5e6630ef4bcf8,
                    0x60c160851fe5433c,
                    0xcc228ca0b237a53a,
                    0x0203e1ccbbe7140d,
                ])),
                Felt::new(BigInteger256([
                    0x9791e58319540f1d,
                    0x9bfa6adb566e5990,
                    0xada205fdb38d757e,
                    0x2c9f50de4201f35f,
                ])),
                Felt::new(BigInteger256([
                    0x06cf016bc6302499,
                    0xc801179bdea613c4,
                    0xf1c6a0023acbe18a,
                    0x281f370a197b532c,
                ])),
                Felt::new(BigInteger256([
                    0xce774f82e843c0cc,
                    0xdeb8e398defadec5,
                    0x5078a527cd469a73,
                    0x2ae329c0b8a30e64,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xc672b1a560d6f6bb,
                    0x18f01d821fce8ca6,
                    0x7322ebee3ba608de,
                    0x249fff831d5b1c2d,
                ])),
                Felt::new(BigInteger256([
                    0x12eb9ac87f2ad9fb,
                    0x7020df72658b124f,
                    0x2d0732bc634fa0c0,
                    0x29e2e4478e4e7a34,
                ])),
                Felt::new(BigInteger256([
                    0xa67dc57d21f83f52,
                    0x4e6fab1359cd5c9c,
                    0xf18943472a251959,
                    0x1c113f7057764eb2,
                ])),
                Felt::new(BigInteger256([
                    0xada2ec10d1be1fba,
                    0x77bfb7b3043b6bf8,
                    0x857a2b0995af5459,
                    0x10258817911b52f7,
                ])),
                Felt::new(BigInteger256([
                    0x844b36ed8b0de5a7,
                    0xe41fd4e55cf6159e,
                    0x71b718e46e7ed5ea,
                    0x25f00804906ce2df,
                ])),
                Felt::new(BigInteger256([
                    0x158747f93170e5a3,
                    0xd6ec50ef4d30be91,
                    0x4e41c3b70bc75919,
                    0x193d3cb7f50748ca,
                ])),
                Felt::new(BigInteger256([
                    0x00fc67e0b92dbb6b,
                    0xa8ffbcce7b5ec56a,
                    0x2ccce8fb8302bd2b,
                    0x01ddb33821758455,
                ])),
                Felt::new(BigInteger256([
                    0x7ba7b74b7e0b1696,
                    0xfeada1054206843e,
                    0xa22ce3916936dc83,
                    0x176f4c43dba3c214,
                ])),
                Felt::new(BigInteger256([
                    0x6e030e8776d2e601,
                    0x2cbd522889caab43,
                    0x57afe30485c40c4b,
                    0x2c3643a7a10c14c8,
                ])),
                Felt::new(BigInteger256([
                    0x78fb7e75674d1861,
                    0xf254d939d1e9ac6d,
                    0x6ff2ade6eec52ea8,
                    0x1222eeca4cd844c4,
                ])),
                Felt::new(BigInteger256([
                    0x620ed74aa569e968,
                    0x4d917f7db4bc3f78,
                    0xd60de968e95eaeb1,
                    0x1316e4f4cce48ee1,
                ])),
                Felt::new(BigInteger256([
                    0x47e367aba40b3ec2,
                    0xa25183be75f4f251,
                    0x3ed2f140b4b676e4,
                    0x0dbfd64047152242,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
