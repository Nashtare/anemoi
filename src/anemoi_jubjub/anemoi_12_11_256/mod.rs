use super::{sbox, BigInteger256, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 2 elements (64-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 13 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 13;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2 + (y2 + y2.double()).double();
        *t -= beta_y2;
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2 + (y2 + y2.double()).double();
        *t += beta_y2 + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];
    state[0] = x[0] + x[1] + x[2] + x[4] + (x[2] + x[5] + (x[3] + x[4] + x[5]).double()).double();
    state[1] = x[1] + x[2] + x[3] + x[5] + (x[3] + x[0] + (x[4] + x[5] + x[0]).double()).double();
    state[2] = x[2] + x[3] + x[4] + x[0] + (x[4] + x[1] + (x[5] + x[0] + x[1]).double()).double();
    state[3] = x[3] + x[4] + x[5] + x[1] + (x[5] + x[2] + (x[0] + x[1] + x[2]).double()).double();
    state[4] = x[4] + x[5] + x[0] + x[2] + (x[0] + x[3] + (x[1] + x[2] + x[3]).double()).double();
    state[5] = x[5] + x[0] + x[1] + x[3] + (x[1] + x[4] + (x[2] + x[3] + x[4]).double()).double();

    state[6] = y[0] + y[1] + y[2] + y[4] + (y[2] + y[5] + (y[3] + y[4] + y[5]).double()).double();
    state[7] = y[1] + y[2] + y[3] + y[5] + (y[3] + y[0] + (y[4] + y[5] + y[0]).double()).double();
    state[8] = y[2] + y[3] + y[4] + y[0] + (y[4] + y[1] + (y[5] + y[0] + y[1]).double()).double();
    state[9] = y[3] + y[4] + y[5] + y[1] + (y[5] + y[2] + (y[0] + y[1] + y[2]).double()).double();
    state[10] = y[4] + y[5] + y[0] + y[2] + (y[0] + y[3] + (y[1] + y[2] + y[3]).double()).double();
    state[11] = y[5] + y[0] + y[1] + y[3] + (y[1] + y[4] + (y[2] + y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0x811a5737933cb580,
                    0x6c3a587ca6537422,
                    0xbab046a5ff0b223e,
                    0x16a4ae2494e6fca9,
                ])),
                Felt::new(BigInteger256([
                    0xd7099456e4c9d2bd,
                    0x3b7bc9bbafd17759,
                    0x2dbd848811a28f2d,
                    0x429f7f2d0c5cfac2,
                ])),
                Felt::new(BigInteger256([
                    0xd6e90570d33aa3e7,
                    0xe6b4ce0f2b268899,
                    0xd21c527ac9bb6767,
                    0x10fe158170e8cdf6,
                ])),
                Felt::new(BigInteger256([
                    0xee169f37a9a57274,
                    0x3e66d796c32f805f,
                    0xb87a25a5b29fdd66,
                    0x404548b918c33422,
                ])),
                Felt::new(BigInteger256([
                    0x68af29d308e43620,
                    0x0f1f10b77cd97be8,
                    0xe0a3e641754832d8,
                    0x538e2981b359c04d,
                ])),
                Felt::new(BigInteger256([
                    0xb196badc9833f1a3,
                    0xbc1f34845ed6a4c6,
                    0xb793bc60f413ac07,
                    0x2cf9a26ff531a2d6,
                ])),
                Felt::new(BigInteger256([
                    0x47667bbc46088684,
                    0x2a7a6abdfa885502,
                    0xfb5984b712d8ed7d,
                    0x713f74a6c4b6f159,
                ])),
                Felt::new(BigInteger256([
                    0x7a38b05d4959d4a5,
                    0x31ac9dadc7f8b379,
                    0x05d36e1ae9a69d12,
                    0x4b37727f68b65fbf,
                ])),
                Felt::new(BigInteger256([
                    0x567eafd51f9fc83f,
                    0x651135ecba98e559,
                    0x1564d696bfbf244d,
                    0x532cc9c957a1c4b1,
                ])),
                Felt::new(BigInteger256([
                    0xc954d302cd22f546,
                    0x9a66abb266b36d5a,
                    0xf8c14502c3776b79,
                    0x2e93e05ce0c9de20,
                ])),
                Felt::new(BigInteger256([
                    0xd42eb0b265fd3d4f,
                    0x124845679a479238,
                    0x5443991415aa207a,
                    0x72f235300f956db0,
                ])),
                Felt::new(BigInteger256([
                    0x3e9c3f7dc72d4a2d,
                    0xfb4338fa4f81e294,
                    0xf84899f50e92f7b9,
                    0x2b721fbc15df66af,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x794c399812e15619,
                    0xc954be246ac609e6,
                    0xa15fc3fed22467de,
                    0x39e5e3230e02c6c4,
                ])),
                Felt::new(BigInteger256([
                    0x83dbebac7d679a5e,
                    0x0179330484d01f8f,
                    0x572762205e2bbcc8,
                    0x263f595642cd503c,
                ])),
                Felt::new(BigInteger256([
                    0xf0881b451f250a5b,
                    0x15f5fdfe1cfed0aa,
                    0xff930f701bf5ebd5,
                    0x13bdb892b95ac8e6,
                ])),
                Felt::new(BigInteger256([
                    0x77cb9e4929d5ca59,
                    0x6c41b0c36675839d,
                    0x727ed78fdafeb19e,
                    0x0f75ccac3a870cee,
                ])),
                Felt::new(BigInteger256([
                    0x40e83b0a41be8bd2,
                    0x4222cbf7ab3c20f1,
                    0x4c536e4a4d56f69c,
                    0x0f4ab3551ee81551,
                ])),
                Felt::new(BigInteger256([
                    0xea3c0d1401441fb7,
                    0x203fb6b588a6d1b5,
                    0x20c821ae871a7380,
                    0x06d66fcba267a0bd,
                ])),
                Felt::new(BigInteger256([
                    0x1adf1abefaca9a13,
                    0x5a185db4b396d619,
                    0x8dd10510baf6abb3,
                    0x121ad87e2418aaab,
                ])),
                Felt::new(BigInteger256([
                    0x56c6acf01ad83b2a,
                    0x0095b87af40e06e9,
                    0x8661542cbb38142e,
                    0x6fae01d8cd87b422,
                ])),
                Felt::new(BigInteger256([
                    0x0ce5167dec092732,
                    0xaa4e36bfc6c75e4f,
                    0x8c436f331805ef61,
                    0x6d12ede16564b24f,
                ])),
                Felt::new(BigInteger256([
                    0xdace55406458fd9f,
                    0xdbe27255215cd886,
                    0x290e6b8bac541193,
                    0x3061b7fd96abe6d0,
                ])),
                Felt::new(BigInteger256([
                    0x6c8c1d8650b2f5b9,
                    0x40f58fb214e43b73,
                    0x52b5a2829eeea324,
                    0x59bf3dc702dc2285,
                ])),
                Felt::new(BigInteger256([
                    0xc092bfae5532a253,
                    0x3146e043207fc30a,
                    0x735b5166fbc070d6,
                    0x0bb38962cc5a6d68,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x9610ab4e8ebd3611,
                    0xf49325fab5e9d8b0,
                    0x2296b0a18580c154,
                    0x6f406d02b1122426,
                ])),
                Felt::new(BigInteger256([
                    0x378c7184f29b4ae3,
                    0xe3883a37028ee411,
                    0xcf8e20888d067429,
                    0x688c879e6e22eba6,
                ])),
                Felt::new(BigInteger256([
                    0x3b1fff41167969b5,
                    0xc7b6a27ee53db4d7,
                    0x09941458a920848d,
                    0x43c61499f964d216,
                ])),
                Felt::new(BigInteger256([
                    0xf88b0c3852522c30,
                    0xfef4ed6527c66cd3,
                    0x17bb3d7083d6bb6c,
                    0x5e696de868c7cd90,
                ])),
                Felt::new(BigInteger256([
                    0xd4644c17fb5ae2e7,
                    0x8940f2e4c85ea822,
                    0x3e551da967ccbcf0,
                    0x6870377f4b03c5fc,
                ])),
                Felt::new(BigInteger256([
                    0x5098936d1812ff5a,
                    0xbeac22cdf0aaffff,
                    0xaf507ebd00e166fc,
                    0x101f167257c55aa4,
                ])),
                Felt::new(BigInteger256([
                    0x6058fd5ba8896535,
                    0xe98823392505b899,
                    0x349cb0daf6a4230e,
                    0x3015786629eacae7,
                ])),
                Felt::new(BigInteger256([
                    0xb32e5d49e972b7bc,
                    0xcad530ff635527bb,
                    0xb98e80abc6674252,
                    0x2a5f5d120dad5c54,
                ])),
                Felt::new(BigInteger256([
                    0x1989fbb80ff1dc03,
                    0xff620f87f9ca9e5f,
                    0xf187ddd78c4103c4,
                    0x243cf546587aabe8,
                ])),
                Felt::new(BigInteger256([
                    0x4e600fa875dd43d8,
                    0x08a4f85ec8ccfcae,
                    0xfbb026c289e84b18,
                    0x26b60e5e7a2660ba,
                ])),
                Felt::new(BigInteger256([
                    0xf460e1e084415f5c,
                    0x8c7373e1c7183ff3,
                    0xa0b62be541bfbdcc,
                    0x0d0c40ec05b480bd,
                ])),
                Felt::new(BigInteger256([
                    0xaf2847c091ab217c,
                    0x9e721cfbeed7226a,
                    0xbc1d25bc3cedb1e2,
                    0x65efac8cbecef7c5,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf9a0ebed0eec21d7,
                    0xe980b430830a25ba,
                    0x3728ed0dd6e26f8a,
                    0x106054c8afc8c7d5,
                ])),
                Felt::new(BigInteger256([
                    0x8a44c6ed0fd2b76f,
                    0xe111930d2e0ff8ef,
                    0xd77dae6db0c1dc1a,
                    0x649201af28cc2737,
                ])),
                Felt::new(BigInteger256([
                    0x58f02b595d542990,
                    0xb3de7e3aa01d5858,
                    0x84dc5e2f7a9d2e4e,
                    0x42bc44c324d0ca8f,
                ])),
                Felt::new(BigInteger256([
                    0x5ebb3f9521867210,
                    0x54ac860be0ec55c5,
                    0x74e723697ba8fc16,
                    0x52611747c21e2544,
                ])),
                Felt::new(BigInteger256([
                    0x44cfe0675f4d6858,
                    0xa959940225a8ad8c,
                    0xf1462f06e0e18a91,
                    0x2f040d621c38ce19,
                ])),
                Felt::new(BigInteger256([
                    0x6443fdd8b25e1a38,
                    0x052b7614b59a2b8e,
                    0x497027752a8d6e64,
                    0x33732de53ee7093b,
                ])),
                Felt::new(BigInteger256([
                    0x4ff27abb1077a5e8,
                    0x2c6c84b790fc52bc,
                    0x5bee3a4fda14b46c,
                    0x5ebe143718da4757,
                ])),
                Felt::new(BigInteger256([
                    0x492ab04d8c1a78b5,
                    0x2e778fecaf1b830c,
                    0x3df9c68db3f0b50c,
                    0x4d54d5d12ad6ef07,
                ])),
                Felt::new(BigInteger256([
                    0x7273842050da32d9,
                    0x5c0c7b5435339266,
                    0xf6e2666e2f41ebc9,
                    0x5b7781e3e0eeb396,
                ])),
                Felt::new(BigInteger256([
                    0x6b6100e0e284d897,
                    0x80fc28addb84cdfa,
                    0xa190fb1b790e2028,
                    0x607dface2a31c876,
                ])),
                Felt::new(BigInteger256([
                    0x4ea7365673ac2946,
                    0xbacb96ff79ad5a51,
                    0x9da5b18f3cf55612,
                    0x377879370e2895a1,
                ])),
                Felt::new(BigInteger256([
                    0x0f0d64508ca7a7ee,
                    0xe1a4eea665850118,
                    0x735b8c3d051a5fa3,
                    0x4495cb521e44785b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb5eb534ba6949112,
                    0x6fb8da6c3bbb5794,
                    0xfa7f9825e06f6e4c,
                    0x062426d6ce316203,
                ])),
                Felt::new(BigInteger256([
                    0x9f7558658127afbf,
                    0x350dc73e70bfe6ac,
                    0x487a5b9673bed8a4,
                    0x0ff3e44b64c43239,
                ])),
                Felt::new(BigInteger256([
                    0x2914a7c5bfbfc64e,
                    0xb1fbdb7b6134bdc2,
                    0x0a06380ccd248649,
                    0x6251085f4a4cd712,
                ])),
                Felt::new(BigInteger256([
                    0x26920b28310676fa,
                    0x418372b93f0c7ffd,
                    0xe1377d8d63502f8b,
                    0x6fd2ba0374191628,
                ])),
                Felt::new(BigInteger256([
                    0xb444d21625b17f9d,
                    0x127c58be9ee8e76b,
                    0x78bb4aea43df81aa,
                    0x6fe99776d2a4c959,
                ])),
                Felt::new(BigInteger256([
                    0x773934a4acb8d094,
                    0x349d4c6b18d6b944,
                    0xb139794d081963a2,
                    0x3d684839c835104a,
                ])),
                Felt::new(BigInteger256([
                    0x655d4e791b0f4000,
                    0xcecc68129963158a,
                    0x0e7b37c8608a3f1d,
                    0x71e0a38999617afa,
                ])),
                Felt::new(BigInteger256([
                    0x631c798b7fac89af,
                    0x1ef43ebebf7c06f7,
                    0x08f6c3d05cd397c3,
                    0x0d8674f7d8af80dd,
                ])),
                Felt::new(BigInteger256([
                    0x1e135e6299e9fe50,
                    0xa2e50a0330445d6d,
                    0x90fa942668bf0e86,
                    0x123986034b09af1c,
                ])),
                Felt::new(BigInteger256([
                    0x982510c7a0e1eac9,
                    0xe59078192e0cc28e,
                    0xfea5fd794ab0edb5,
                    0x4e28f39985a58fd4,
                ])),
                Felt::new(BigInteger256([
                    0xcf584ecf0cb5f861,
                    0x6d3e622d1d7c5753,
                    0xee66cdd038a5da14,
                    0x34d94359b48ead45,
                ])),
                Felt::new(BigInteger256([
                    0xcd0780de88915153,
                    0xb49088afa05c5e01,
                    0x087578a822c2cfb5,
                    0x4fdba7d21024f1dc,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdf0f063c362d4d12,
                    0xf243f59574c16a5b,
                    0x1c1a1a6d9b3db555,
                    0x5939bc14abaf241f,
                ])),
                Felt::new(BigInteger256([
                    0x81a4d35ba7a36e59,
                    0x6764f4b4ee5b380a,
                    0x8e27d21f9c60c706,
                    0x34e2d214ac5223c7,
                ])),
                Felt::new(BigInteger256([
                    0x8f10adb6997fb6dc,
                    0x7d2d185dc7c82663,
                    0x79ccc89d3ad0462e,
                    0x204e94effb2b8ac2,
                ])),
                Felt::new(BigInteger256([
                    0xa3381ed55f82b4a4,
                    0x78f5667e52d43c4c,
                    0x8d9a9c8f890abba1,
                    0x676807c557bfc98e,
                ])),
                Felt::new(BigInteger256([
                    0x104283b658c62c48,
                    0x12db475751f6642d,
                    0xa3e0431bcac4835d,
                    0x5886a60f18d72c1e,
                ])),
                Felt::new(BigInteger256([
                    0x20159fd1a9ba6b14,
                    0xb7ca8fae0438e7c8,
                    0x8474cb7b5df24ea3,
                    0x530733cde5ed3c72,
                ])),
                Felt::new(BigInteger256([
                    0x4cb74b009d99828a,
                    0xecc6d720b2724f96,
                    0x7cdc566d3e04a398,
                    0x1a05fd63e959b566,
                ])),
                Felt::new(BigInteger256([
                    0xd95fea21fd8202ab,
                    0x59c9af8e8bff1349,
                    0xd455e148870bb74c,
                    0x1ac570fcae44a643,
                ])),
                Felt::new(BigInteger256([
                    0x231281c344c8e50c,
                    0x891bc709050cd2a5,
                    0x90234ef7bac5b68f,
                    0x3b4c75d755bd7af3,
                ])),
                Felt::new(BigInteger256([
                    0x1f5e6672f61fb335,
                    0xb60617804233840f,
                    0xba7c51a52c6aac45,
                    0x0d7460835472b9a1,
                ])),
                Felt::new(BigInteger256([
                    0xd9bb670fda2b6791,
                    0xc1c336343683ed87,
                    0x95bdb5456a0f4ff0,
                    0x1225e7503cd485cc,
                ])),
                Felt::new(BigInteger256([
                    0x661fa2c94a264e3c,
                    0xf87969a8313a2f3b,
                    0x071ebe904267eb89,
                    0x336c8eeb693b6b64,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6dadb6db6dc,
                    0xe6b5824adb6cc6da,
                    0xf8b356e005810db9,
                    0x66d0f1e660ec4796,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xd99f4a8fe00e11bd,
                    0xe12a753d82b33b30,
                    0xba87bf86c47e6f0b,
                    0x58de312b5993b67f,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
                Felt::new(BigInteger256([
                    0xb4c1972e044567f4,
                    0x8e14aacbecb9fb59,
                    0x2c0f182612f81cd9,
                    0x34d6a5db27797543,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0x34413b9512617cf9,
                    0x7e6bdaab3f8443c5,
                    0x752178862c9a6ab7,
                    0x3dde7b14d2951772,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
                Felt::new(BigInteger256([
                    0xbdf2fa0b931e7a04,
                    0x60f39c6eae7a9a3c,
                    0x34e97cf1bd62a467,
                    0x13b9e8a487cc4745,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xdb6db6ecdb6db6ca,
                    0x035ffa14db8a4eec,
                    0x5ea2264f581fdd5a,
                    0x401b2e0d73d97883,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
                Felt::new(BigInteger256([
                    0xfffffffd00000003,
                    0xfb38ec08fffb13fc,
                    0x99ad88181ce5880f,
                    0x5bc8f5f97cd877d8,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7885eea007359719,
                    0x8001f24088b02599,
                    0x264ab9d5996253a2,
                    0x492173d165679be4,
                ])),
                Felt::new(BigInteger256([
                    0x4bc65ee2dcc5acf3,
                    0x62cb351094fa6bcc,
                    0x70d6e87832e76c70,
                    0x4043bfa4db122dc9,
                ])),
                Felt::new(BigInteger256([
                    0x0431e9f4f6e94f37,
                    0x91e1301301bfcfe7,
                    0x6db049cf5708ac92,
                    0x669086a67063edec,
                ])),
                Felt::new(BigInteger256([
                    0x3556961dd66a81c4,
                    0xff80d73a3d7c5f4a,
                    0xedb1214353ee3279,
                    0x56ff24833dfcb1eb,
                ])),
                Felt::new(BigInteger256([
                    0x8678e50ed1d6a4c1,
                    0x1925fc4517b4ce29,
                    0x5efd62e46a90393b,
                    0x693803ec34f356a1,
                ])),
                Felt::new(BigInteger256([
                    0xda36c326d905e433,
                    0x4d88d471d585320d,
                    0xa0de088cdee95fdd,
                    0x329983a7be527d30,
                ])),
                Felt::new(BigInteger256([
                    0xb77cba447921f24c,
                    0x73d3f65abf35d008,
                    0xfcb8d1630624b8f8,
                    0x3bddc7cefbba36b3,
                ])),
                Felt::new(BigInteger256([
                    0xfe2a7c9605435b23,
                    0x01b19c4b91a3c7d4,
                    0xd4746310bd1ed35a,
                    0x177e78be7aa6fffd,
                ])),
                Felt::new(BigInteger256([
                    0x36351a2109799c1d,
                    0x9f899de6e9cb01e0,
                    0xea8db5dcb36eab61,
                    0x04d97eb376ef77e7,
                ])),
                Felt::new(BigInteger256([
                    0xe6a4ff838d6a72cc,
                    0x7df28c32155ec977,
                    0xece2db6bd75f42d2,
                    0x5c3b4dbc1dc9edba,
                ])),
                Felt::new(BigInteger256([
                    0x922ae8c04bb6cfb2,
                    0x39e45d4eec4d6f7e,
                    0x92232463a3557036,
                    0x40d473f70a557a8c,
                ])),
                Felt::new(BigInteger256([
                    0x0f98d1c41e001280,
                    0xb1b511816e595b86,
                    0x28c7177055f867ee,
                    0x6c4cf11ce4b21f45,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xe939081f9c3f487d,
                    0x5db0a240c332a95a,
                    0x0eb41be50adb07de,
                    0x1ae5c758b4743fac,
                ])),
                Felt::new(BigInteger256([
                    0x0051dd5ef750d80d,
                    0xf41389152745b87e,
                    0xdffc49615d6b14ab,
                    0x2c92248c1d1bb049,
                ])),
                Felt::new(BigInteger256([
                    0xd8f1ba36a07b2bac,
                    0x50cd4e35f8c5cbaa,
                    0xe6733ab50d8b5dc8,
                    0x111cc493e418ad96,
                ])),
                Felt::new(BigInteger256([
                    0x2976dd32a0f175ba,
                    0x03d6311156107f8c,
                    0xe0958c56d9edd332,
                    0x4a6b7f0ea957f3bd,
                ])),
                Felt::new(BigInteger256([
                    0x6d457838c0463130,
                    0x7049cdba31ff8027,
                    0x7dc0b8dd8f811a4a,
                    0x710d9c94608d3e02,
                ])),
                Felt::new(BigInteger256([
                    0x418ff3dde61ff10d,
                    0x9fb32ed11ac50abf,
                    0x41b947656260cbda,
                    0x2296742a6c8c0edd,
                ])),
                Felt::new(BigInteger256([
                    0x5ced531796d25f9e,
                    0xb78c19e0258c6b5d,
                    0x682d45ab30c999d4,
                    0x4ad26242d12f5298,
                ])),
                Felt::new(BigInteger256([
                    0x079dfe4b8d85fa41,
                    0xbf856736569f6a17,
                    0xd79f82ce36debb0f,
                    0x59b1fd8541977bce,
                ])),
                Felt::new(BigInteger256([
                    0x825f3c1fd82bec1a,
                    0xc92ebba299dc3b69,
                    0xbfb475e6f83aa3ea,
                    0x668c6e791f1d3e28,
                ])),
                Felt::new(BigInteger256([
                    0xf24bcbbf7b6517f1,
                    0x6ce8729f92ee6c01,
                    0x46d7a0bed8dcb4b3,
                    0x0a3eebf8ab446045,
                ])),
                Felt::new(BigInteger256([
                    0x888120f344600d80,
                    0xdc10d4c69f9f0a48,
                    0x0d910fdc5bcf5a35,
                    0x5cf6f95a43b6357e,
                ])),
                Felt::new(BigInteger256([
                    0x9ae98bc0e79a7f69,
                    0xbaf462cdf5722f7d,
                    0x8bbcf599dbfd146c,
                    0x0d2ac97454d165c9,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x1071fbf68922b192,
                    0x7ab5a7f83636ea53,
                    0x03f5c06e555a66b6,
                    0x4945c52bb352a709,
                ])),
                Felt::new(BigInteger256([
                    0x5e5890991c0fd8c5,
                    0x92885713bb093581,
                    0x2a6b5b6833cb0788,
                    0x07a8334955a537a0,
                ])),
                Felt::new(BigInteger256([
                    0x78dfd357cf9d6966,
                    0x7610e36726cdf279,
                    0xf70e5547b69703a1,
                    0x32fb171418e9e3f8,
                ])),
                Felt::new(BigInteger256([
                    0x19fc7b97a1b28a63,
                    0x85474cf28dee5597,
                    0x080327f1be8ba89d,
                    0x3539fd8fac64d83a,
                ])),
                Felt::new(BigInteger256([
                    0xe441a16427eec9b1,
                    0xd526f95899cff549,
                    0xefe7389af7c539e8,
                    0x4835fa1a3498dca2,
                ])),
                Felt::new(BigInteger256([
                    0xccbaed86d58239c5,
                    0x8c96c93f30943f70,
                    0x1dccb7384b079a68,
                    0x0686cde0f8fa2bdb,
                ])),
                Felt::new(BigInteger256([
                    0x195c29c63cdc3c49,
                    0xbabb1a7a1cb954a6,
                    0x36282d960aa11ecf,
                    0x66b5f3903d7e5877,
                ])),
                Felt::new(BigInteger256([
                    0xcb82ed76a65cfff5,
                    0xb378e6d05b160121,
                    0x2c46706e3b6ad4ba,
                    0x0dd1df175e84309b,
                ])),
                Felt::new(BigInteger256([
                    0xc458a62edfea2c64,
                    0x7c348c0b3666730e,
                    0xdf7b7183feec4fc0,
                    0x6a263840dc89181b,
                ])),
                Felt::new(BigInteger256([
                    0x5776e2ee3551d2f4,
                    0xd0879a6e61918d4a,
                    0x5ebc9aec5a67fd37,
                    0x2eaa6fd78e4bed79,
                ])),
                Felt::new(BigInteger256([
                    0x3429b9f887a64f5f,
                    0x1f20903122e0f973,
                    0x988c401b88fa372c,
                    0x2468939b4e21e173,
                ])),
                Felt::new(BigInteger256([
                    0x0582db02dd24f0ab,
                    0x5201f6b526d1ac48,
                    0x826cde526722af34,
                    0x4585b82bbafc8638,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x96d8aea7d0b29881,
                    0xcfebd067fb3ddbda,
                    0x4612e58b8c7a7ade,
                    0x488d645ed77c817c,
                ])),
                Felt::new(BigInteger256([
                    0x9ac559df608c0d61,
                    0x95d64c297e4e8273,
                    0x79fb9c2c21b7aad2,
                    0x66dede0088b7883f,
                ])),
                Felt::new(BigInteger256([
                    0xbd6c98bfe28d64df,
                    0xe4968d7fa1dbdb3b,
                    0xa0f127a48bb326aa,
                    0x40bfa9beff98ea60,
                ])),
                Felt::new(BigInteger256([
                    0x13555c19d80da456,
                    0xff4cae96a4aec7fe,
                    0xd0a58213342be4d5,
                    0x403acc4719d77b63,
                ])),
                Felt::new(BigInteger256([
                    0x658110964e0d3c84,
                    0xc673780bd317f37d,
                    0xc3ee9ddcd53688c6,
                    0x1125dbbe2a086cb7,
                ])),
                Felt::new(BigInteger256([
                    0xed330f025344fb94,
                    0x821ad40c0f933654,
                    0x49aa78ee32c12b5d,
                    0x34cc921f3e94e446,
                ])),
                Felt::new(BigInteger256([
                    0x85c1bb73126151ab,
                    0xe65af77c645f9ebd,
                    0x8496b042d6dcac03,
                    0x6c9acc169d6f6441,
                ])),
                Felt::new(BigInteger256([
                    0x962edf66748a0589,
                    0x888985b3ecbee0d1,
                    0x8f9a9c94a46ac06f,
                    0x6872d1531cf70555,
                ])),
                Felt::new(BigInteger256([
                    0xd4d20268b05b24a9,
                    0xe99fbb71570118ea,
                    0xfd228d77b361c254,
                    0x581137116e3c26db,
                ])),
                Felt::new(BigInteger256([
                    0x39e970ee3c7d4e84,
                    0x3f02c99d12219657,
                    0x1977feba4d02d855,
                    0x43a25f8aec39f73b,
                ])),
                Felt::new(BigInteger256([
                    0x88b8352148f1dd77,
                    0xd51701c7cbaeddb7,
                    0x5f3a3e87db4c66ca,
                    0x099bbec367f39732,
                ])),
                Felt::new(BigInteger256([
                    0xa8f9a620641dc1c8,
                    0x81c175ba1b5a1178,
                    0x33b9a6d82c4106f6,
                    0x3fd6fbd2d0d95366,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2c1d1f210d7666d2,
                    0xf22d7d467c9cab73,
                    0x075ad1f28a86878f,
                    0x1da9d448af0a8bf5,
                ])),
                Felt::new(BigInteger256([
                    0x55b5d90874d98c7e,
                    0xad649fc0f10a6a78,
                    0xd2091f46475e02ef,
                    0x605acf75b38dc227,
                ])),
                Felt::new(BigInteger256([
                    0x15e5adc6b9fe21a7,
                    0x3358e5e0203115d1,
                    0x93bb9133d35e56e3,
                    0x1441f3960644eb24,
                ])),
                Felt::new(BigInteger256([
                    0x87c101673ab62ae7,
                    0x187518d3ea20fa14,
                    0x2aa878a194855fec,
                    0x415d686ffd231353,
                ])),
                Felt::new(BigInteger256([
                    0x73d69df517ed7965,
                    0x70d6f9cc52d6520c,
                    0xc4423229554cfdff,
                    0x5a683f437849a2c2,
                ])),
                Felt::new(BigInteger256([
                    0x974c10f023b448ad,
                    0xca4eb15ff92505f6,
                    0x99b490fba8d9c1cd,
                    0x4e74ba94ba207ea1,
                ])),
                Felt::new(BigInteger256([
                    0x1e2e7c8d3bf61632,
                    0xac1c5cf547d729a2,
                    0x616153f7e987265d,
                    0x0b4e31b7f658029f,
                ])),
                Felt::new(BigInteger256([
                    0x5301cd2a0cf5d70f,
                    0x4c2804d837cc0483,
                    0x4c003ab36dc41b88,
                    0x2aad2fe88f31cd55,
                ])),
                Felt::new(BigInteger256([
                    0xc2fea6c48fe604ef,
                    0x1b2edc5adf8a9963,
                    0x93248c4e2efb8fb3,
                    0x30fdf82697589fee,
                ])),
                Felt::new(BigInteger256([
                    0xe7bb85102c9fcda9,
                    0x89b308444ebe87cd,
                    0xbe4ff0593e054619,
                    0x1ac891aadf6999b8,
                ])),
                Felt::new(BigInteger256([
                    0x4120b38fd5526060,
                    0xa63d8149033b6b88,
                    0x33356747a0f8ce4d,
                    0x55c9b72b6d900e8d,
                ])),
                Felt::new(BigInteger256([
                    0x9aa5840f0f33900c,
                    0x43e8262a39e46123,
                    0x14f10a2a0d418a23,
                    0x3e36ab3537aecc21,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0cd5ca361a2adbbb,
                    0x799d660222b4509d,
                    0x500fdc03e2609668,
                    0x1827bc42f9920406,
                ])),
                Felt::new(BigInteger256([
                    0x18d52f31c9d771a1,
                    0xf99deb6a3c9b655c,
                    0xcdbb062213a1fb4a,
                    0x56396d893afb0fd8,
                ])),
                Felt::new(BigInteger256([
                    0xc5a751f543eb2567,
                    0x163ea86547c96ec8,
                    0x16adc8a3c0db7edd,
                    0x51398f223920370e,
                ])),
                Felt::new(BigInteger256([
                    0xdbdb70c33d155654,
                    0x66a32cf1982ff724,
                    0x29bc7487033e502e,
                    0x48031da600530a7d,
                ])),
                Felt::new(BigInteger256([
                    0x60cc8370b7d9b92c,
                    0x4fb3eafdec950fb0,
                    0xd7da5d06bb4bebcf,
                    0x4355b8288c68fc32,
                ])),
                Felt::new(BigInteger256([
                    0x337bd71f3d75e62d,
                    0x1bc625503e8d7689,
                    0x68f6c3b8c3a54c53,
                    0x28e31e7e29a6c431,
                ])),
                Felt::new(BigInteger256([
                    0x9b9583d019193366,
                    0x40a0c891e9ae31b1,
                    0x2c8058a3cd25a450,
                    0x220d38870a6e42ee,
                ])),
                Felt::new(BigInteger256([
                    0x7b9616e95811ed09,
                    0xea27d329fc371470,
                    0x92ecf4577bd69d9d,
                    0x4ced6489e2a8add0,
                ])),
                Felt::new(BigInteger256([
                    0x7b88d9bd55cc0f08,
                    0x6bd4a9800a10d44d,
                    0xb7eb4c504a64fc4e,
                    0x346c9c7d901b53e4,
                ])),
                Felt::new(BigInteger256([
                    0x176716684edc84ed,
                    0x8289e4199184884d,
                    0x39b42f40f2de39e0,
                    0x1dc83a95af8da97c,
                ])),
                Felt::new(BigInteger256([
                    0xd22fa7b84b32c93d,
                    0x2c39c86b4aaeef33,
                    0xf067bb4898d97779,
                    0x0342485d23d63f54,
                ])),
                Felt::new(BigInteger256([
                    0xbb86ace4993a0c1b,
                    0x2eeb308303a080e6,
                    0x9c0db3e176495821,
                    0x31c84ba4abaa0f29,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xa33ab510b2bb2dae,
                    0x7bab6797221fbd8e,
                    0xd4c2fa691badc013,
                    0x6bedd664f4363ac3,
                ])),
                Felt::new(BigInteger256([
                    0x52647c617c220222,
                    0x4b83c505c47e263d,
                    0xc422d5f43a896952,
                    0x25ed9a3d4066129c,
                ])),
                Felt::new(BigInteger256([
                    0x7a0a72a3d82c21b1,
                    0xaf0bbdff65dfe687,
                    0xfc9ea01e34f0cc6b,
                    0x317312c0635205f9,
                ])),
                Felt::new(BigInteger256([
                    0xa69d86dede24c9cb,
                    0xbc1fa0a77e259c9c,
                    0x081668c1cbca4ba3,
                    0x561679309d3cb350,
                ])),
                Felt::new(BigInteger256([
                    0xd17a15036e2debb7,
                    0x1d704a63633ca744,
                    0xdb0aeb1bd636b772,
                    0x12e99824c3af6988,
                ])),
                Felt::new(BigInteger256([
                    0xeda66600c5736fc0,
                    0x6dee07e1780a1bc0,
                    0xbec98c26d739a6c8,
                    0x2ded83ca7e48628c,
                ])),
                Felt::new(BigInteger256([
                    0x2222f9ecfa68f680,
                    0xb666738a52c2aac3,
                    0x87571bca9acf3b5b,
                    0x04d574a0601caeb2,
                ])),
                Felt::new(BigInteger256([
                    0xd4984765a9018904,
                    0x15f036103c1ff471,
                    0x4e60f6fd65b4084e,
                    0x2b139c4cc4a2e987,
                ])),
                Felt::new(BigInteger256([
                    0xee9840a9db29fc72,
                    0xa3982e6dd2e8c2f4,
                    0xbb18b0d2e4df7f66,
                    0x14289e2eb6fd834e,
                ])),
                Felt::new(BigInteger256([
                    0x88a7e46ef1378d5d,
                    0xce02405da973e6e5,
                    0x4d04986aff22f05d,
                    0x5cfd0ddd0a0f8a3f,
                ])),
                Felt::new(BigInteger256([
                    0xeab6bb335d5ae333,
                    0xd446c3df0728c09d,
                    0x83b6b80b443726a1,
                    0x571c55aa0e2576c7,
                ])),
                Felt::new(BigInteger256([
                    0x4b737a56eee1680d,
                    0x694b94803d16487e,
                    0xb153ec39841799e0,
                    0x398805919b62ad15,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xca6b84a3cca844b0,
                    0xf021378a119c45b7,
                    0x5bdc78b565ea686a,
                    0x1c74bdd646a5c09b,
                ])),
                Felt::new(BigInteger256([
                    0xd926e1264fa2bb64,
                    0xf5c0ec0874bcec0e,
                    0x23089356e1e049b6,
                    0x60191413ee2775bd,
                ])),
                Felt::new(BigInteger256([
                    0x275c4cda0a2161c9,
                    0xa5a1eb97b7b70d5d,
                    0x2aacf28dc6b35604,
                    0x568fd97082734fb1,
                ])),
                Felt::new(BigInteger256([
                    0x06e6aba4fbf0fe24,
                    0xb51d24ab579cef43,
                    0xf2bbbf183fd957bc,
                    0x113e063dbe491b02,
                ])),
                Felt::new(BigInteger256([
                    0x99ec7cc4c1e41fa7,
                    0xd0d5366476dd7c75,
                    0xbff78519b0c38c26,
                    0x3a9cea191fc9e8db,
                ])),
                Felt::new(BigInteger256([
                    0x5f0dd195b6e29f1a,
                    0xa5fec2e3fde92afd,
                    0xce0278e7fe9589bb,
                    0x16e3b115b45277e6,
                ])),
                Felt::new(BigInteger256([
                    0x8b5d2c120c26c65b,
                    0x0a1c03c0eec5970b,
                    0xf85468c4a3505542,
                    0x4bf71d2eb3725d43,
                ])),
                Felt::new(BigInteger256([
                    0xd97cc63ca9770f7a,
                    0x7024383425c069ea,
                    0xa27d028fccba339f,
                    0x3330ebdcb2fa3fdf,
                ])),
                Felt::new(BigInteger256([
                    0xe8000d5a815b45f2,
                    0x961668c8b7f2164c,
                    0x9f1f4263cef1a398,
                    0x3e70e1ab8f530871,
                ])),
                Felt::new(BigInteger256([
                    0x4a720eb812413efa,
                    0x07a811edc1257d46,
                    0xe9ed8454bbfa9e9f,
                    0x601288fc06229053,
                ])),
                Felt::new(BigInteger256([
                    0x6cc146c2754261b0,
                    0x2c582e9df2932db8,
                    0x3ddc808dbd98cdbe,
                    0x15b008069d048f9a,
                ])),
                Felt::new(BigInteger256([
                    0x73c54b4c8e930358,
                    0x034aa5b4cc16d31f,
                    0xa458137eedb19b42,
                    0x33bb8d8c45095169,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5e58e00527c2967d,
                    0x03588ddada3e97ed,
                    0x6f551279147ea502,
                    0x5b862fc3482be01e,
                ])),
                Felt::new(BigInteger256([
                    0xb3d137131ad8deb6,
                    0xce01baf8bc68ab36,
                    0xd0b23ee70a88cfa8,
                    0x3ea4f7eceb42e1aa,
                ])),
                Felt::new(BigInteger256([
                    0x3bafdf2e0116d935,
                    0xc953d59c33b550fd,
                    0x58b17d83b714aba1,
                    0x391b86535d616dcd,
                ])),
                Felt::new(BigInteger256([
                    0x2f04ece2e69827eb,
                    0x3da5a5e6f73f5622,
                    0x89cd0124406dc682,
                    0x536242343794de9b,
                ])),
                Felt::new(BigInteger256([
                    0xc458fe3a6f0b8e77,
                    0x7574300cb508b036,
                    0xaf6b74fae7bc49e1,
                    0x1e04470f2cb608fe,
                ])),
                Felt::new(BigInteger256([
                    0xf2aa9555a8632800,
                    0xe2a4e0ea607a3daa,
                    0xf2b15949aea6fd1f,
                    0x70f1446d43ea1974,
                ])),
                Felt::new(BigInteger256([
                    0x7e6414c13976b7cd,
                    0xaeeb182b58e2643b,
                    0xd31f951f47726542,
                    0x189201b9a23b7a32,
                ])),
                Felt::new(BigInteger256([
                    0xad8139bb04d144d2,
                    0xf9d6ef22b512c282,
                    0xc2db887c5c532e37,
                    0x2c6e586046484fc5,
                ])),
                Felt::new(BigInteger256([
                    0xbb430b54490914ae,
                    0x2a635191bc7372b1,
                    0xb1704e951109ede5,
                    0x04964ca80a987a42,
                ])),
                Felt::new(BigInteger256([
                    0x11c10cc7678c34d5,
                    0x5ad76cd329940291,
                    0x36e69408b347a8f3,
                    0x3211909d26c7b2bb,
                ])),
                Felt::new(BigInteger256([
                    0x75dc6d398b08b1ce,
                    0x61a65a6126ce51ea,
                    0xd5cc04b6dd926505,
                    0x601e278b4696d7de,
                ])),
                Felt::new(BigInteger256([
                    0x7c0c69fad8b1a163,
                    0x18cb67176815a87d,
                    0xac1498b56ffa31cc,
                    0x320b6c44c6b4d371,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5596f20956b6c311,
                    0x21579f526be43fe7,
                    0x36a82974733babb7,
                    0x62ddadd66f88b086,
                ])),
                Felt::new(BigInteger256([
                    0x9b5a2f30d5feda4f,
                    0x5fc5aa5a87af4a3e,
                    0x7eb005f97324eba1,
                    0x3eb20e97eb18c7fd,
                ])),
                Felt::new(BigInteger256([
                    0x889b678632ac09f9,
                    0x371eb6509e834634,
                    0xed47c827fd536df7,
                    0x5bd3ffaf38cacc96,
                ])),
                Felt::new(BigInteger256([
                    0x7a9bf5995a10a6f9,
                    0x42327d2549a89803,
                    0x18a52fd97d749e5b,
                    0x080f4921c06622c0,
                ])),
                Felt::new(BigInteger256([
                    0xcc8c3dca6d6fbb89,
                    0xabcd6ab320ee9eab,
                    0xb23ba840ccca4603,
                    0x6acbb3deed584916,
                ])),
                Felt::new(BigInteger256([
                    0xe9f2daa004874401,
                    0xb33b68cb06030b85,
                    0xe28fbf4f97acf08d,
                    0x69459a51e9b55e23,
                ])),
                Felt::new(BigInteger256([
                    0x8b66a34e81041f94,
                    0x011020101291c2c0,
                    0xf84c2fbfc7c8eaf2,
                    0x2669d898e38907b1,
                ])),
                Felt::new(BigInteger256([
                    0x3d992bad4902e86d,
                    0x1eb23b60fa51d8c0,
                    0x06d3c1ed3cf07b16,
                    0x0d7855c51703457e,
                ])),
                Felt::new(BigInteger256([
                    0x6a3aa858e8759463,
                    0xd3a10913c96e99cf,
                    0x00c3f22f27f98a5b,
                    0x030311c247cc65ab,
                ])),
                Felt::new(BigInteger256([
                    0x243ef1f3801bba7d,
                    0x16c952fb5b2707e7,
                    0xb459f9ef8120a23b,
                    0x44611c613e8f678d,
                ])),
                Felt::new(BigInteger256([
                    0x45d82c0d7b6937e1,
                    0xf979dc2c3125a694,
                    0x7407058b8985e79e,
                    0x129c6efd243b6395,
                ])),
                Felt::new(BigInteger256([
                    0xad9d0c4ba2abfe69,
                    0x4a96f424104ac53a,
                    0x1f6488b66d33d074,
                    0x53486e4f4075e813,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7c7260c13473c63e,
                    0x93fff03cb6db2256,
                    0x0a01688720a409eb,
                    0x72a5fdc9fd655b8a,
                ])),
                Felt::new(BigInteger256([
                    0xe61116b84cb3168c,
                    0xcb3f0c1f630d4add,
                    0xee7f92a7e1434e90,
                    0x1a452f4a4104789c,
                ])),
                Felt::new(BigInteger256([
                    0x2acc84c6ad40ecd7,
                    0x37460605dc2f2c0b,
                    0x4d061c842eed4b1f,
                    0x2e67223a1693e0e4,
                ])),
                Felt::new(BigInteger256([
                    0xa5573019224b66b2,
                    0xc52008e842a91a99,
                    0xca9d23c3668369e2,
                    0x0b889ba3680af390,
                ])),
                Felt::new(BigInteger256([
                    0x6ee1f4ba17e1e7c5,
                    0x2d52061c9e74aa27,
                    0x509ba116514ea18f,
                    0x436b231c4a368950,
                ])),
                Felt::new(BigInteger256([
                    0x31b198c1f348225f,
                    0x497dc0f226ebdaad,
                    0xe8051a91af8a03f0,
                    0x451c41100ea5f86a,
                ])),
                Felt::new(BigInteger256([
                    0xe2caabf23367b97d,
                    0x90af7c60d03ee3ac,
                    0x2b92aefafe5604fb,
                    0x2581bad607e8b450,
                ])),
                Felt::new(BigInteger256([
                    0x57464708b74f8bea,
                    0xcd4876c0db9093bc,
                    0x02e60963d41cf3fa,
                    0x16752f2aa367e22e,
                ])),
                Felt::new(BigInteger256([
                    0xfe0a3152448213b3,
                    0x13b2710d18769bc4,
                    0xc81e5799fce53dcc,
                    0x394faa4395a57a9c,
                ])),
                Felt::new(BigInteger256([
                    0x21290bb59d434506,
                    0x4f6abfe07c2cdba6,
                    0x633ca5227efceee6,
                    0x1b4ddac3770de7a0,
                ])),
                Felt::new(BigInteger256([
                    0xf0a9ddcbbf862074,
                    0xdade2d7d63d1e95d,
                    0x22a471cbeab97074,
                    0x0d492707b1fe3094,
                ])),
                Felt::new(BigInteger256([
                    0xbb97c7bca30407fc,
                    0x5833110693ca5626,
                    0xe6ad3fdc4e8eaafc,
                    0x467368f07d7b6adb,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb6988e15e7d84abe,
                    0x0725d28bbd06bc74,
                    0xd670d4457fc520bf,
                    0x095073d300502ee4,
                ])),
                Felt::new(BigInteger256([
                    0xbc3f6f0603b905c0,
                    0xbf131afb027a2c11,
                    0xf6df57f76b0c26f4,
                    0x1e8166d445fea7af,
                ])),
                Felt::new(BigInteger256([
                    0xf8f0a4ffc174327c,
                    0x80dd7278965f97f2,
                    0x420465b58215e123,
                    0x595d416b67844573,
                ])),
                Felt::new(BigInteger256([
                    0xc09aa1dd1bbb71c7,
                    0xba84253a4ed309c5,
                    0x0744019ad4dcd4fb,
                    0x22b5d4647164c9bc,
                ])),
                Felt::new(BigInteger256([
                    0x1ef7e27469661d37,
                    0x1ba43b441481456c,
                    0xaf75bcb469dc3c39,
                    0x47471e618c5d50de,
                ])),
                Felt::new(BigInteger256([
                    0x66d35b5593b6c655,
                    0xfca2166a76780689,
                    0x67ee1fb7de620f19,
                    0x5c83b453812c055a,
                ])),
                Felt::new(BigInteger256([
                    0x23f714940a9e327c,
                    0xee4a5ecffd04755e,
                    0x0dc2cba94d64afbf,
                    0x515bdc221f445fe1,
                ])),
                Felt::new(BigInteger256([
                    0x325c79c60509c775,
                    0xe2adfd0278df30cd,
                    0xa384fbb190819467,
                    0x6b76701314b3a202,
                ])),
                Felt::new(BigInteger256([
                    0x0c789b82a01d9b89,
                    0xa1d6266860b4473b,
                    0x1fcc8cb5c18c1fde,
                    0x090326f0b7c614a3,
                ])),
                Felt::new(BigInteger256([
                    0xe6f3cb2f864f2c4f,
                    0x1985657cce2993f3,
                    0xb433df354390a724,
                    0x17ec53850c59110e,
                ])),
                Felt::new(BigInteger256([
                    0x821ad92ba3cf2aec,
                    0xc68d2e69cf2b681a,
                    0xb3aad4e9a95b4b89,
                    0x1a2c6e3eff4c566c,
                ])),
                Felt::new(BigInteger256([
                    0xb7972551ae1c7aa1,
                    0xc6eeadf15dff66b5,
                    0x21c7386155c0b8e3,
                    0x0e10b058f2f6dda3,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::new(BigInteger256([
                    0x0000002bffffffd4,
                    0x9b67cf7c0048302c,
                    0x320ede9e582edf15,
                    0x13273db4d8ee7797,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger256([
                    0xa77d71f6f78ef51a,
                    0x4da96c5ad14d14ba,
                    0xd53c73f3118f7afa,
                    0x514262834eb8a145,
                ])),
                Felt::new(BigInteger256([
                    0x7dd01422b31870d9,
                    0x1734175a56c487d5,
                    0xc835afa79bf27096,
                    0x174ae1e1f116c3e6,
                ])),
                Felt::new(BigInteger256([
                    0x6a3044357d1c5eca,
                    0xb8f93d5233864538,
                    0x84934a4d733279a6,
                    0x63d84f0515a8ae0d,
                ])),
                Felt::new(BigInteger256([
                    0x462abfefe54c9040,
                    0x607886070bc61bc8,
                    0x32ad6020986660a9,
                    0x018de0bda261cba8,
                ])),
                Felt::new(BigInteger256([
                    0x3c47f233aa145035,
                    0x67420aea45f1cd03,
                    0x14cc0b18501cbf74,
                    0x1ce70c65f674b67c,
                ])),
                Felt::new(BigInteger256([
                    0x9a287b3c3910a1d1,
                    0x47a67809495900d9,
                    0x835257152973db36,
                    0x51ed281f1c58fc92,
                ])),
                Felt::new(BigInteger256([
                    0x4e166172561a8992,
                    0x2b9db0ba4a13f9a1,
                    0x0841d4dd411b98b3,
                    0x4fe057bbcf12760c,
                ])),
                Felt::new(BigInteger256([
                    0x0b72ce187a0dda2d,
                    0x5d0f16698cc89a2f,
                    0x6cf58ef2e5ddbda5,
                    0x4bbc20f8b21a9bea,
                ])),
                Felt::new(BigInteger256([
                    0x9ccfdf5874de1a71,
                    0x0495dcb8d1085c07,
                    0xb9316c015ad3e7de,
                    0x0ccb1d62923e76dd,
                ])),
                Felt::new(BigInteger256([
                    0xcbdcdedace9c9130,
                    0x209fd57e4457335e,
                    0xe05c19fa55acf2d7,
                    0x3ebf59ce5eceb9d5,
                ])),
                Felt::new(BigInteger256([
                    0xd1502685372e015a,
                    0xaa2ed4e30a244aa3,
                    0xa74d8a521828152b,
                    0x648d85e10c65bcb0,
                ])),
                Felt::new(BigInteger256([
                    0x3f6a1b2065d58a91,
                    0x46e71c993fce61bf,
                    0xf55b382db8fc6f8b,
                    0x65cc6769bcdac6b8,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7133544d3d3776d7,
                    0x592f9e4051c8032d,
                    0xf72a66cec3302225,
                    0x481c9cec6add8031,
                ])),
                Felt::new(BigInteger256([
                    0x16b357cbb3864dd1,
                    0xe65e62d26e020a53,
                    0x1fa2f82c4dccea98,
                    0x3a73a5215e6ba55b,
                ])),
                Felt::new(BigInteger256([
                    0x834293460462f709,
                    0xe6ba98ca801ac6ef,
                    0x65d25bdf0552a554,
                    0x2eb6ae0af10422d0,
                ])),
                Felt::new(BigInteger256([
                    0x1196e29fe0140179,
                    0xa19b3b7ea4b25813,
                    0x3b22b174354a273b,
                    0x62eceeb82af3b407,
                ])),
                Felt::new(BigInteger256([
                    0xab0de7083797581d,
                    0xa76901e820decb42,
                    0xe670548b72819a52,
                    0x2c2ba7b9ec194286,
                ])),
                Felt::new(BigInteger256([
                    0x106b73f3120651af,
                    0x8ad0a67ecbe8c570,
                    0xae1bb7a432118ec6,
                    0x506bcac8cedb6d29,
                ])),
                Felt::new(BigInteger256([
                    0xdae19bbe48674fea,
                    0xd6487c2d8093c0d8,
                    0xfe4739eede0681ae,
                    0x2bc5722cb67d198b,
                ])),
                Felt::new(BigInteger256([
                    0x19899f5b633bf3f6,
                    0x11ac3d460d999bfe,
                    0xaf8e194b20bb6051,
                    0x4a1ff015bd387742,
                ])),
                Felt::new(BigInteger256([
                    0xef681700bb4eb522,
                    0xd6236648df927ff8,
                    0xdd0e0d4748e3faa6,
                    0x30230a777abb1670,
                ])),
                Felt::new(BigInteger256([
                    0x2f3dca58c275cd8b,
                    0x3e0487c040ab7cd8,
                    0x859d1e28c72600b9,
                    0x039462edc65aa51b,
                ])),
                Felt::new(BigInteger256([
                    0x2c5af1aeb76094e2,
                    0xf4dba272812349da,
                    0x38668e33f9c06d24,
                    0x622af026a4f557ca,
                ])),
                Felt::new(BigInteger256([
                    0x1d087adf2472a00a,
                    0x5af1c53dc669d456,
                    0x623ba348bc3efe3a,
                    0x4a3f697c65b546bb,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x0709df5ffdcd58c5,
                    0xd22ae6dddae121c4,
                    0x27db0ebc70fdd17f,
                    0x5f9fe970ad8f6bf4,
                ])),
                Felt::new(BigInteger256([
                    0x815e00abc465b869,
                    0x66c1a60aa9eed769,
                    0x43fdc8a188dacdbd,
                    0x60c2569689d5729a,
                ])),
                Felt::new(BigInteger256([
                    0x910dc6b03e40752d,
                    0x960d624679b9fd67,
                    0x326d201e91c96301,
                    0x08baee8efa2e1b27,
                ])),
                Felt::new(BigInteger256([
                    0x2df679b27a9cf916,
                    0x3986a87f1b100d1c,
                    0x8f8ed71991ab8fa2,
                    0x530d3b4725edd036,
                ])),
                Felt::new(BigInteger256([
                    0xe5dff92f671d2245,
                    0x0dcb05bd63fbac4f,
                    0xc2745b57a06655a1,
                    0x3ecf4f6e2331c6bf,
                ])),
                Felt::new(BigInteger256([
                    0xe0652d234049ddca,
                    0x24deebd15149532e,
                    0x042671cd0f4eeb42,
                    0x3a90e1654569fff9,
                ])),
                Felt::new(BigInteger256([
                    0xd80faec144e234ec,
                    0xb2e86513a7434871,
                    0x2585600d8d00436e,
                    0x35e9e225419455dd,
                ])),
                Felt::new(BigInteger256([
                    0xa7c6c9e3f0af185e,
                    0xb50f5d76f5b2b139,
                    0x3101afde5f11dc8b,
                    0x0532e542a3e759c0,
                ])),
                Felt::new(BigInteger256([
                    0xbc6b6f9c30d17e29,
                    0xff5ebe30e0478f9e,
                    0x5439012102447ac3,
                    0x40a3450f1953e7be,
                ])),
                Felt::new(BigInteger256([
                    0x35ef81bbfdda323e,
                    0x6d1a133f1599560a,
                    0x93eb6fa8e4450a87,
                    0x195ff1823116fcff,
                ])),
                Felt::new(BigInteger256([
                    0x0bf028858cb1ad52,
                    0x7d390d3d8ac6db65,
                    0xd5c869ca6bb1ebfc,
                    0x09f3882859114b57,
                ])),
                Felt::new(BigInteger256([
                    0xda4b41a082e94f4c,
                    0x1ea319a71c37d9a5,
                    0xee556d08410a8cab,
                    0x1489efef3611c827,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xefa182f46b5698d4,
                    0x294bf34bbe92135d,
                    0xdd233bfcdb548bc5,
                    0x0be5dabcdcf7319e,
                ])),
                Felt::new(BigInteger256([
                    0x59426012eb88adb4,
                    0xc08952a32c668444,
                    0x666be3893eec357d,
                    0x6671a93c01994115,
                ])),
                Felt::new(BigInteger256([
                    0x60b756609cb3e0b2,
                    0x9aa0394cacabdd5d,
                    0xe31e10b0ac08b0a5,
                    0x58de63e8d1b28bc7,
                ])),
                Felt::new(BigInteger256([
                    0x97c3e4908df3ba1c,
                    0x2246410189c86960,
                    0x8925ba398707c28c,
                    0x4395a3d6cea121e5,
                ])),
                Felt::new(BigInteger256([
                    0xaf5d728ae7d6cda2,
                    0x9d8671345befea07,
                    0x698793640dc853fe,
                    0x6ba9be0ad03ec364,
                ])),
                Felt::new(BigInteger256([
                    0x645b371dfadc65ea,
                    0x35482238b8f8a31f,
                    0x8c50dbb42613b2a4,
                    0x31783fa95c621de4,
                ])),
                Felt::new(BigInteger256([
                    0xd46a6b6fd2e54148,
                    0xf9fd13145ab9af46,
                    0xc9b2c1e7920d5e65,
                    0x0f887927f6033c71,
                ])),
                Felt::new(BigInteger256([
                    0x410e8641a0a30093,
                    0xc83feda833ff64a8,
                    0x5ddd89b9153f8e63,
                    0x25ac85fff6f57002,
                ])),
                Felt::new(BigInteger256([
                    0x51e69c99c7697058,
                    0x34935b23a3ab6fcf,
                    0xc1926f3a6b69ec7f,
                    0x7033b2ca2db56a7b,
                ])),
                Felt::new(BigInteger256([
                    0x78acc671501f7b91,
                    0x76756539748a1f8f,
                    0xa233ab8ed6aed64f,
                    0x00c7d54b5002f2ae,
                ])),
                Felt::new(BigInteger256([
                    0xf305961d05911c82,
                    0x9e577e892639bc7b,
                    0x6d0691c51a51b6de,
                    0x30137275ca583fc7,
                ])),
                Felt::new(BigInteger256([
                    0x0792b5e4bcecbcf2,
                    0x4a864c3a2d53e4d8,
                    0x6cbd17c07c900eb7,
                    0x73b102b0e0cd11cc,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xccd922693d319321,
                    0xc373122fbaf79299,
                    0x40280c5a85d188a2,
                    0x22a9565176bc5ea0,
                ])),
                Felt::new(BigInteger256([
                    0x9f913f0fbb7d27d0,
                    0x01bdfb538cdc32c8,
                    0x3b37767246e98c8c,
                    0x13401105fecf7965,
                ])),
                Felt::new(BigInteger256([
                    0xb6326237b6c7fac8,
                    0x0c64b6da7a8d84bd,
                    0x724c9813d1fa423a,
                    0x6c36b2e270c90a9f,
                ])),
                Felt::new(BigInteger256([
                    0x1a38006874d9cc49,
                    0x711faf7349ba20c4,
                    0xa4e7a6c3722ff250,
                    0x6f4a50fb29cd0d2a,
                ])),
                Felt::new(BigInteger256([
                    0x6438c3200b5abf66,
                    0xc8ba9fbc53150f28,
                    0xeadbbccdf61c084c,
                    0x4b45d86412f523ad,
                ])),
                Felt::new(BigInteger256([
                    0xdf88fda7fd9d4fae,
                    0xbbafc2c47bc08bbd,
                    0x63c03e3fd4a918ae,
                    0x62dc9f35cb97ce19,
                ])),
                Felt::new(BigInteger256([
                    0x762a010d35367153,
                    0x615e44b8bc4c44c0,
                    0xd2c360943de12500,
                    0x608c879b0f5c3677,
                ])),
                Felt::new(BigInteger256([
                    0x592afb52f94bc0ec,
                    0x01325bd745ea4cf0,
                    0xe5e3e49f2cd9eaad,
                    0x20fc731b1ae5825c,
                ])),
                Felt::new(BigInteger256([
                    0x78617ba0430e951f,
                    0xa4098df2b8ff5b7e,
                    0x40d2e6c61d3dc2c7,
                    0x2ea07e1950bb07a2,
                ])),
                Felt::new(BigInteger256([
                    0x6ee40264e01d852c,
                    0x62cc6b1c3a034240,
                    0xa04a68c9355ab891,
                    0x28e6051891b12439,
                ])),
                Felt::new(BigInteger256([
                    0xe6267b699dd7cfd4,
                    0xab1c52221c695a93,
                    0xfb5415b687f0983a,
                    0x292b45b47558e75a,
                ])),
                Felt::new(BigInteger256([
                    0xd1b3b935bd0166bd,
                    0xe41413504fc9c915,
                    0xc27723a3eea0ba00,
                    0x12bff95c9005abe8,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x63e003e22422e714,
                    0x0fbd7c8beb5465d6,
                    0x59d28945a22b7e8c,
                    0x530491c53d85203c,
                ])),
                Felt::new(BigInteger256([
                    0xbc93a0a60f9ba282,
                    0x5a2e297595e5a279,
                    0x81038d471ca3c7c1,
                    0x6424a0ed6df7d7b1,
                ])),
                Felt::new(BigInteger256([
                    0xac37bc2a05ccad6a,
                    0x811941adbca262dc,
                    0x57039134c223747f,
                    0x0a24b3c1db4e058b,
                ])),
                Felt::new(BigInteger256([
                    0x714fd7cf7afd5894,
                    0xb78b5f8c4d8684b4,
                    0xd9b5f05aa60332eb,
                    0x422587c9d71065d6,
                ])),
                Felt::new(BigInteger256([
                    0xfae5a859313381d4,
                    0x6f8330de94d38403,
                    0x5212ff06ae49ecd0,
                    0x2969d059877aad0e,
                ])),
                Felt::new(BigInteger256([
                    0xb2c142918f98d467,
                    0x9d3a5d6a99a13c6d,
                    0x9f1c6eb1f46c2356,
                    0x6caa5ca3fc27af76,
                ])),
                Felt::new(BigInteger256([
                    0x69da119d6d9527a1,
                    0x1981300a44e11216,
                    0x43787153fbdfaaa7,
                    0x27eb51d245d46a01,
                ])),
                Felt::new(BigInteger256([
                    0x3a17c90e1d9ddc40,
                    0xdcdd2ee8dabf8605,
                    0x8fc73c54dde00628,
                    0x3c00ea7406446627,
                ])),
                Felt::new(BigInteger256([
                    0x66526c9638cf1b85,
                    0x8885d0614c07c514,
                    0x5ad502623282c16d,
                    0x51b022c1cad63b87,
                ])),
                Felt::new(BigInteger256([
                    0x171af002cc5c6e55,
                    0x5b3291b6c03f4a05,
                    0xfe6f71a143040759,
                    0x5b4497d660853c4b,
                ])),
                Felt::new(BigInteger256([
                    0x33ea243bbeb550ad,
                    0x1513d7432a50b7d0,
                    0x20f4734a6b069e25,
                    0x22f2c3976f44e23d,
                ])),
                Felt::new(BigInteger256([
                    0xef9dab6850f43426,
                    0x57f3d0ac1082cc76,
                    0x619705095b92af46,
                    0x3f18bb1f947f70d9,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
