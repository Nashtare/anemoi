//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 31 == 0 {
            bytes.len() / 31
        } else {
            bytes.len() / 31 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 31-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 32];
        for chunk in bytes.chunks(31) {
            if num_hashed + i < num_elements - 1 {
                buf[..31].copy_from_slice(chunk);
            } else {
                // The last chunk may be smaller than the others, which requires a special handling.
                // In this case, we also append a byte set to 1 to the end of the string, padding the
                // sequence in a way that adding additional trailing zeros will yield a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 32];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 31 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        AnemoiDigest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        AnemoiDigest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        // We can output as few as 2 elements while
        // maintaining the targeted security level.
        assert!(k <= NUM_COLUMNS);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger256;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger256([
                0x75839cd3eed19bda,
                0xb153209f905283e8,
                0xdc40d293932398a5,
                0x402966633410675d,
            ]))],
            vec![
                Felt::new(BigInteger256([
                    0x422852ae0f8f9a94,
                    0x7149b0681ce9fda6,
                    0x14e11c4318be534b,
                    0x15914f7cefdc7b31,
                ])),
                Felt::new(BigInteger256([
                    0x61b408097533488d,
                    0x406b1df1f1bf1182,
                    0x1c0c5c4ae13bea6a,
                    0x10597f71dd722ab5,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xea5b05f7204a8e6a,
                    0x2c491efdbfddbf8c,
                    0x1d22f0857bb5bd58,
                    0x5b84680e7c964bbe,
                ])),
                Felt::new(BigInteger256([
                    0xb87c3bfcb5e037f1,
                    0x718c005d86f9e362,
                    0xa8d507cdff7d3b76,
                    0x43416ca23daacf4f,
                ])),
                Felt::new(BigInteger256([
                    0xbbf1835c02b07380,
                    0x755e3b6965c88712,
                    0xa4b2eb5a789fec6c,
                    0x10cd7e08f47ee1ca,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x872daca1a8e8cec2,
                    0x3df372328730e29b,
                    0xacf7dc98fc00c488,
                    0x2c771296d059b766,
                ])),
                Felt::new(BigInteger256([
                    0x4ed034c5e09665a2,
                    0x5a3a7a6cae5aedfd,
                    0xce3e8809826f1969,
                    0x6d2579571685901f,
                ])),
                Felt::new(BigInteger256([
                    0xae13c66553981db4,
                    0x18427f227e98272a,
                    0x3b3741650fd53d65,
                    0x0edc0c435e7ff37c,
                ])),
                Felt::new(BigInteger256([
                    0x8d1353ac21ed6000,
                    0xf951bb6a65d90a64,
                    0xec26dff8b231a6f8,
                    0x6b1f675d39db64ad,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x84c27668f69930e2,
                    0xf9930fd967ea9bdd,
                    0x2b46c27538351193,
                    0x0628cec59203275b,
                ])),
                Felt::new(BigInteger256([
                    0x6d9bd3abf50968ab,
                    0xd48d704a3058b8be,
                    0x304033c2c620718e,
                    0x5e33e200708cef4b,
                ])),
                Felt::new(BigInteger256([
                    0x7096f28b4b5cc518,
                    0x8fe40ec2e1b0ef8c,
                    0x4768f746afbf6c53,
                    0x068ad54a1b5ad4f0,
                ])),
                Felt::new(BigInteger256([
                    0x8d4be326739ed263,
                    0x236c3ec3fab84a56,
                    0xbf95827fb1fe8a31,
                    0x21fbc105473390bb,
                ])),
                Felt::new(BigInteger256([
                    0xbbbd528d7b8c2370,
                    0x7581737eeb2dd644,
                    0xd22178005b195236,
                    0x4792014f7764f97f,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xc13bc6d422e71d9c,
                    0x42e1c9bce43d63bc,
                    0x7294d4a891c311e7,
                    0x4831c7159770b380,
                ])),
                Felt::new(BigInteger256([
                    0x335047235939dfad,
                    0xebcdd3aee2618ea7,
                    0x1ae7c00f700e9126,
                    0x50fd09514073a9fd,
                ])),
                Felt::new(BigInteger256([
                    0xddec947575ea3491,
                    0xe53f2384f4c57cbe,
                    0x888b8e48fd92f785,
                    0x3c9e97df8423a8ab,
                ])),
                Felt::new(BigInteger256([
                    0x434bd89acbc3f152,
                    0x1949c560e9e42110,
                    0x33c79961a01323d3,
                    0x43239d63cb0683c6,
                ])),
                Felt::new(BigInteger256([
                    0x0ce7012250a990a5,
                    0x2d03a42d9e439107,
                    0xd5e14c235e3df949,
                    0x68f4261b8e983dd2,
                ])),
                Felt::new(BigInteger256([
                    0x8a50eb8222e32b9c,
                    0xc63ebd900796a36b,
                    0x8e1fe328a47cf26a,
                    0x20fb22e9687154dd,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x6b528a89d3136b01,
                    0xddcbfb5069da937b,
                    0xa277d392d104a53d,
                    0x58b1f30d2ba42cca,
                ])),
                Felt::new(BigInteger256([
                    0xb84522afe29b5670,
                    0x51045079fdacd39e,
                    0x167402fd4da54d23,
                    0x017fd8302c769db3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4541039bf1d08081,
                    0x3039dff2e8704feb,
                    0x0b1d6c1a728bf6db,
                    0x4991aef860ce19b7,
                ])),
                Felt::new(BigInteger256([
                    0x624bf11a36debf45,
                    0x2c549c637df799a2,
                    0x5ff99a7b9636373f,
                    0x3afec1cf7336c696,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x4fe319e94c0c7f11,
                    0x4395f8e4c4983b10,
                    0x61705b4000b5b22e,
                    0x5617df1cf9ced947,
                ])),
                Felt::new(BigInteger256([
                    0xce727d8f67b72cdf,
                    0x02ea2eda5b4f8652,
                    0xf1e5b480b956be64,
                    0x642733e88792f1dc,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2d652ac3a8aa9c46,
                    0xaa86cf63b315d914,
                    0x8891a3f3d19a3b3b,
                    0x024b808ba79570cb,
                ])),
                Felt::new(BigInteger256([
                    0x070f230b3886d548,
                    0x3082881624c5715e,
                    0xc8c81deaef3f2967,
                    0x088c3efaf6a5a870,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xbe8dff48a10a8822,
                    0x24a701760beac3b5,
                    0x29aade912dbb2cfb,
                    0x00fb8ad2a9016d23,
                ])),
                Felt::new(BigInteger256([
                    0x4fbffc27319fa19a,
                    0xd713f1b9bfd754e0,
                    0xd440adc3dc6a7ead,
                    0x32fd5b23e8e6afad,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x96774f9e9d69e3c6,
                    0x46486ab35de39999,
                    0x23ced40f2e0d647f,
                    0x50f86e586c131857,
                ])),
                Felt::new(BigInteger256([
                    0x95f66c4c47fce293,
                    0x546a09d1d2431213,
                    0xf0d961893e43e09c,
                    0x186511caee319d97,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xce7926c9693399ff,
                    0x09ce6c98d4aac13b,
                    0xd7ace4a64398d650,
                    0x3e227b028572f073,
                ])),
                Felt::new(BigInteger256([
                    0xe4a367c261a6989c,
                    0x86643be1474ac23b,
                    0xdc878381d787814c,
                    0x5fce74021025618c,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xc3600035131faab5,
                    0xb018aada29aeb714,
                    0x9f68fe398cc9fbfe,
                    0x224a57c2564f4b63,
                ])),
                Felt::new(BigInteger256([
                    0x07f1fdd483ebedf0,
                    0xcbf7ee839e67f468,
                    0x13567c5c67f0ca0e,
                    0x1dcf1c6100dc03f3,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xd6f130e910f2f13b,
                    0xf7e50ccbbb0d795d,
                    0xba5ea21c0872e2a3,
                    0x405a1436e945372e,
                ])),
                Felt::new(BigInteger256([
                    0x1f59e68cd6d5b91f,
                    0x4e2de92ae930afa8,
                    0x3303a701d33a1b88,
                    0x2f1beeafd44f1f61,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2aea0ae92a992867,
                    0xb5da89d2484b2de7,
                    0x709e6f51302ce274,
                    0x3fd7c2e44b689250,
                ])),
                Felt::new(BigInteger256([
                    0x774b52619545b5a5,
                    0xb59007373b498196,
                    0x88848b1f2e8e6013,
                    0x35c0ceb90f9d5ecc,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x76f4b4c14a1254af,
                    0x329807fad4f47669,
                    0x1bba21f76d15e4ad,
                    0x1b7c7df7f6388164,
                ])),
                Felt::new(BigInteger256([
                    0x3b290448f9f315ef,
                    0x43b50d01771c5f81,
                    0xe7417cc27ba3b03c,
                    0x2985b26c6b805566,
                ])),
                Felt::new(BigInteger256([
                    0x1d4c45ae234136e3,
                    0x7e5499a3f4bbb2ac,
                    0x6fddb8627ec8940f,
                    0x3c621da8e6e25132,
                ])),
                Felt::new(BigInteger256([
                    0xdd02acfd5a963068,
                    0x7d477e14ad17683e,
                    0xf548439b14d678a1,
                    0x136469693f534080,
                ])),
                Felt::new(BigInteger256([
                    0x9841b6f2d52da0cc,
                    0x0afd36ed4da1c390,
                    0xfa37304e61388f6f,
                    0x4f53690adf9c2476,
                ])),
                Felt::new(BigInteger256([
                    0xd00c1596668ba2d0,
                    0x136b27020e3e26dc,
                    0x4835b24688fdde6a,
                    0x51d2059cba61fd29,
                ])),
                Felt::new(BigInteger256([
                    0x8505d2151848a969,
                    0x8500206d1b6d721a,
                    0xeb1d6cf0ee3f4013,
                    0x3b1589c4c2220d73,
                ])),
                Felt::new(BigInteger256([
                    0xcce0f0d69e795220,
                    0xb1aba17e33bf7a09,
                    0xcc1456114a95f627,
                    0x2f680066dc71483b,
                ])),
                Felt::new(BigInteger256([
                    0xbe674b78a24e9dd7,
                    0x4e43de400ab9baf3,
                    0x07946bcc73c913b8,
                    0x3628e46e1212e927,
                ])),
                Felt::new(BigInteger256([
                    0xd6eb4d144da53d9b,
                    0xcd8309a8c6bd7018,
                    0x4bce32f3fdd8c3bf,
                    0x73c88e131b543be9,
                ])),
                Felt::new(BigInteger256([
                    0xc04b72f9eee87383,
                    0x73851c9a574a3d4e,
                    0xcf8a52597aaad769,
                    0x0920610e6657b429,
                ])),
                Felt::new(BigInteger256([
                    0xbb78fb0439739ff6,
                    0x59c7518d3418346d,
                    0xb5fdeeae44bad065,
                    0x0c76f3bd07152d51,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x35eef6ebfb6c76c8,
                    0xb8cc1a9e31cb39ab,
                    0x109bb11b09aac31e,
                    0x310d318f90664d85,
                ])),
                Felt::new(BigInteger256([
                    0x6e10a1d30c631d8c,
                    0x9f8c981036aef287,
                    0x697accb2356dcbbc,
                    0x63e30d1704524cfb,
                ])),
                Felt::new(BigInteger256([
                    0xbfaf28bd9b001b87,
                    0xb02b6d7a2fe9f90d,
                    0xa2d1d5892ba4632b,
                    0x1c25632f940d99c5,
                ])),
                Felt::new(BigInteger256([
                    0x34ca4e356aeec127,
                    0xafc13a6d627abb0f,
                    0x9bcee1356a10258b,
                    0x0e9a284e06499def,
                ])),
                Felt::new(BigInteger256([
                    0xdcea9924f1df0726,
                    0xd2245bdd88c4aa95,
                    0xd36978152ae6c691,
                    0x4acb167eace47472,
                ])),
                Felt::new(BigInteger256([
                    0xd7d41f84f11c9097,
                    0xa32b91ebddf21935,
                    0x8754c1a8ed46159d,
                    0x197402d381976130,
                ])),
                Felt::new(BigInteger256([
                    0x7274069a59549962,
                    0x7df9efef0b077593,
                    0x7b09d615b3a3ee68,
                    0x0deae401573e0511,
                ])),
                Felt::new(BigInteger256([
                    0xfcaf77ca289e5a67,
                    0x102b894d9d01d5c0,
                    0xffd4e0a43f379402,
                    0x6986bfbbf80e3131,
                ])),
                Felt::new(BigInteger256([
                    0xc9f822efbd96153f,
                    0x4f9bc11fe52dfedd,
                    0x1fdce86776221991,
                    0x2424146e26e5233a,
                ])),
                Felt::new(BigInteger256([
                    0xe15c30ff6d571532,
                    0x73f71f774e241b9e,
                    0xd5331f3b79b1363e,
                    0x61a095c3d24eb128,
                ])),
                Felt::new(BigInteger256([
                    0x6290809818da9c9b,
                    0xe81fab81180b53c5,
                    0xb0b5a3b2f2e87f4c,
                    0x6aa84165e00a71ed,
                ])),
                Felt::new(BigInteger256([
                    0x35a7b44764622ea0,
                    0x1c585e56654439bc,
                    0xca5b62b86d407b01,
                    0x43886709776d9bf3,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xc6b0603b42823518,
                    0xa667d6401084e08f,
                    0x7ed21391a4952b98,
                    0x5e9e59751b9b0e81,
                ])),
                Felt::new(BigInteger256([
                    0x4eea434bba3de16b,
                    0xcbe592ed8ce5d558,
                    0xe5213501d0c061d2,
                    0x668d1ca3860df017,
                ])),
                Felt::new(BigInteger256([
                    0xeee415a6c2bb842e,
                    0xd6ea2d6f08e9b812,
                    0xd6f93bec1721da44,
                    0x42f19bc40865e8b9,
                ])),
                Felt::new(BigInteger256([
                    0x3f3c2f27d27dad5d,
                    0x6aa867df4fbe7796,
                    0x17e878aa92484953,
                    0x0188ff63f0153ad8,
                ])),
                Felt::new(BigInteger256([
                    0xd846b6392caf9014,
                    0xbe52d9510f7a1d9c,
                    0xc94555062cc58115,
                    0x4ac6b031fce956f2,
                ])),
                Felt::new(BigInteger256([
                    0xa7b82107c632c7ba,
                    0xda08696a4db5299e,
                    0xc99fc0dc04e1f44b,
                    0x39bbd2192a84e5af,
                ])),
                Felt::new(BigInteger256([
                    0x30d95f97367be1c9,
                    0x34ba306f2f751a9d,
                    0x68e89453da4d4bd7,
                    0x171d99121fa7a4b2,
                ])),
                Felt::new(BigInteger256([
                    0x24adea229a4bea4d,
                    0x7d221857c57432dd,
                    0xbc5e6e945a2c1d95,
                    0x17d5d0ea5f85669a,
                ])),
                Felt::new(BigInteger256([
                    0xf97897c14199be26,
                    0x3646f4cc5ad0842c,
                    0xeea618f380c4277e,
                    0x1c81037d6a4b99a1,
                ])),
                Felt::new(BigInteger256([
                    0x99efe7bcea82bdbd,
                    0xfd4142c81296bea0,
                    0xbddb1f2665af8c5c,
                    0x4aa269e8e04dc455,
                ])),
                Felt::new(BigInteger256([
                    0xf2ad99e325ffc4b5,
                    0xdf53b539fef6a6b0,
                    0xbb00dbea1ec37793,
                    0x63c4796cd7e666e5,
                ])),
                Felt::new(BigInteger256([
                    0x1198b4ba84a234e5,
                    0x737505354eb42494,
                    0x8cb3b59b0c87fbe9,
                    0x1f7b2c9efb25c0b7,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x76e678200fc9b858,
                    0xe72fa5b21684d2d5,
                    0xab9bc64ead3e90ac,
                    0x245d5cb824298ad8,
                ])),
                Felt::new(BigInteger256([
                    0x078a065d0cbd57d6,
                    0x94ac8c9df9520710,
                    0x1577c2eb5b993be7,
                    0x1264f4467e88217b,
                ])),
                Felt::new(BigInteger256([
                    0xefe2361ac50957e1,
                    0x37cfd7c907d58086,
                    0xd99f1d13767a7c20,
                    0x66911fdb0e355093,
                ])),
                Felt::new(BigInteger256([
                    0x6ffe20173b47f028,
                    0x53c876202a9e9442,
                    0xc09611a31918e306,
                    0x1a379eef2bc2ef3a,
                ])),
                Felt::new(BigInteger256([
                    0x23f345307735c7d7,
                    0xea213e4f4acef37e,
                    0x136f5058cde68540,
                    0x4c5da3d5c59f9bb0,
                ])),
                Felt::new(BigInteger256([
                    0x14c62c624d318edd,
                    0x234fabbd7b70938d,
                    0x9ea8cae17ffab414,
                    0x05cdb19a136be5e2,
                ])),
                Felt::new(BigInteger256([
                    0x32ff8255998cd081,
                    0x3750f914031a40b7,
                    0x1862dee5d3d55988,
                    0x4249db1ca7c7d926,
                ])),
                Felt::new(BigInteger256([
                    0x94939afde6f130b0,
                    0xcc052beb2ffca2ee,
                    0xeb0417e0d40a5c37,
                    0x29e0404f8c635850,
                ])),
                Felt::new(BigInteger256([
                    0x0c03e17a2492af4e,
                    0xf44ca6aaf497267c,
                    0xa4eb07bb4d390354,
                    0x0870b0773952bf2b,
                ])),
                Felt::new(BigInteger256([
                    0xe76cb6499b22d9de,
                    0x178d32e4a19a0978,
                    0x283ebccf9f00ed9d,
                    0x706be5b2adea3461,
                ])),
                Felt::new(BigInteger256([
                    0xad621d80cc9698d6,
                    0xcecbc2320f54aa5d,
                    0xb6715f36c010286b,
                    0x2c22541ecca49d45,
                ])),
                Felt::new(BigInteger256([
                    0xa380ca89a650edf3,
                    0x175c3e27c11242c2,
                    0x1240c1c4cf97f4e4,
                    0x5beeb9613a88c3ac,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x90d3520a73af1e1c,
                    0x9733c5a409ed9a61,
                    0xc7c4d90c5d7ce640,
                    0x040627051809a330,
                ])),
                Felt::new(BigInteger256([
                    0x1dd1bb2c285f399d,
                    0x02787faff590c0cd,
                    0x64b1c607747d200c,
                    0x0ba92b6504f89472,
                ])),
                Felt::new(BigInteger256([
                    0x9643a12f0895b1a7,
                    0x82d370a821c07088,
                    0x88cc73a2b78cd87f,
                    0x7137c22a938502f4,
                ])),
                Felt::new(BigInteger256([
                    0xcf988f4fb241d271,
                    0x3c0e71bbbd33f6cc,
                    0xdb9150786bfe3e78,
                    0x23900bb01c165ea6,
                ])),
                Felt::new(BigInteger256([
                    0x960d3db1375102e7,
                    0xb98fdda027309ee8,
                    0x1a1235cdd716e641,
                    0x27535dac5bc8e0df,
                ])),
                Felt::new(BigInteger256([
                    0x7e17e7584cbe377d,
                    0x6278f11e57a80f3e,
                    0x81a9be88b93f4bd8,
                    0x362bc6c4bd0615ca,
                ])),
                Felt::new(BigInteger256([
                    0x0a53647bdf2c3263,
                    0x7a6ccf897870a538,
                    0x7d3909caf8675d3c,
                    0x27cd453eafab3133,
                ])),
                Felt::new(BigInteger256([
                    0x7206625d99eacc6d,
                    0x7ba3abffd4e333d2,
                    0x84b6c1a21e51eb17,
                    0x73942824d8216740,
                ])),
                Felt::new(BigInteger256([
                    0x33f3e0c47297b263,
                    0x7bbd4944300caf37,
                    0xda9b3ffcbf8185f1,
                    0x450640a926f7d679,
                ])),
                Felt::new(BigInteger256([
                    0xf602d1c50baae9c6,
                    0x70534ddd947104c3,
                    0x4e869c923610ff5f,
                    0x6f5ac707948a8ddb,
                ])),
                Felt::new(BigInteger256([
                    0x8dc981c096905bed,
                    0xd56b97672c7c8580,
                    0x6390e1db25db7ee2,
                    0x09ee613ccdaa8cd1,
                ])),
                Felt::new(BigInteger256([
                    0xbb65630532921abb,
                    0x8360a14ed4724621,
                    0x09fa8010bd2729b6,
                    0x16c0378cb4b46334,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x930e7c63f0c0e15c,
                    0x592fafbec650aac6,
                    0xd752432bfab5de63,
                    0x4f5a318910770f15,
                ])),
                Felt::new(BigInteger256([
                    0x98d6efcb580dd1c2,
                    0xc0a6418b495a2faf,
                    0x005d22422a82098a,
                    0x34c3276be1fdf665,
                ])),
                Felt::new(BigInteger256([
                    0x6f76ee0f6c5ca71f,
                    0x3085209e3334030d,
                    0x39e9b0be51e6c7fa,
                    0x21938266313bfc15,
                ])),
                Felt::new(BigInteger256([
                    0xbcaf903020634b8b,
                    0xee63939055c2f2af,
                    0xffec526a697ec349,
                    0x093f9358d80401c0,
                ])),
                Felt::new(BigInteger256([
                    0xe88aff14a69ba363,
                    0xc4e7db75128e4801,
                    0x34bdb666af34b5e0,
                    0x1c65f4f028ede26f,
                ])),
                Felt::new(BigInteger256([
                    0x8192e2f329ed13a1,
                    0xf45c3ed00d1cea57,
                    0xc4e889df1d18c837,
                    0x10796e492834bee3,
                ])),
                Felt::new(BigInteger256([
                    0xad9cfddae92dcc30,
                    0xb936007d45918bc0,
                    0x7dd5ce1d28d9ee48,
                    0x6549309733ca5d43,
                ])),
                Felt::new(BigInteger256([
                    0x128b8c4069ab1e36,
                    0x5be3611e35d7a59a,
                    0x7fa8a35e424f3918,
                    0x3fd6c2732e7f2d8d,
                ])),
                Felt::new(BigInteger256([
                    0xac74c12898e7da7f,
                    0x55502a4326122aae,
                    0x7a6558d8990e3c7c,
                    0x2b31c30c57b90c74,
                ])),
                Felt::new(BigInteger256([
                    0x18a579efd856e390,
                    0x4bdd9f24c8b2146e,
                    0x90df241c269a9afe,
                    0x6c74b511c70ffe3d,
                ])),
                Felt::new(BigInteger256([
                    0x01cdb45e29163760,
                    0x73f5f58c6c3bb82a,
                    0x3a556ec511d48992,
                    0x6a1f90cbc9a46e10,
                ])),
                Felt::new(BigInteger256([
                    0x1ae42722f7d3c7a4,
                    0x4ace037481348449,
                    0x2abc1298b6b46c74,
                    0x2c18f2b06dcfa1db,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x884b862fb4a22110,
                    0x4d9a8633143863e6,
                    0x3f1ca4efe602bc03,
                    0x38f9a20f47f1b14e,
                ])),
                Felt::new(BigInteger256([
                    0x773f99080f114ccd,
                    0x1b2faafa5c9da6a9,
                    0x0dd3a5d7a6a1aec9,
                    0x1c92df94fd40d070,
                ])),
                Felt::new(BigInteger256([
                    0x3684d4c718a4e1d9,
                    0xc6e8aab38764d416,
                    0x4e4943b31855e91e,
                    0x613cd913571f2cd5,
                ])),
                Felt::new(BigInteger256([
                    0x10074fe0083cf70b,
                    0xd0c813f65d07db6e,
                    0x0c8ca80b4d684836,
                    0x45a5e5ea66188fc7,
                ])),
                Felt::new(BigInteger256([
                    0xd66b9e03ded13509,
                    0xe0cfcc22ce98ff0e,
                    0x7132ce2af6dd05b2,
                    0x7311a800bf0583a2,
                ])),
                Felt::new(BigInteger256([
                    0x82e149ada1faf802,
                    0x0afd338b4797c374,
                    0xc1b19f43483bbd2e,
                    0x31662612fa66a44f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x99d138dd5089e30f,
                    0xb750b2800ce5bef5,
                    0x8e315cc547fcb2a4,
                    0x6d11b5c88245b9a3,
                ])),
                Felt::new(BigInteger256([
                    0xa85f88d7978fd672,
                    0x1bb16dfb0ab39234,
                    0xcb9945b7f29cd73b,
                    0x052e85148833aedd,
                ])),
                Felt::new(BigInteger256([
                    0xfcf77f76491a81f4,
                    0x325f0b27e2e6771f,
                    0x12f4573d41e331b8,
                    0x046fd37027da73fa,
                ])),
                Felt::new(BigInteger256([
                    0x76918a22d415ab3b,
                    0xe1580e06005a3187,
                    0xd30d77b9790875cd,
                    0x0a8bfe9ea3d50ca0,
                ])),
                Felt::new(BigInteger256([
                    0xa7b8a3895e67185d,
                    0x3795bea3e5bfe535,
                    0x601b7710921c7059,
                    0x369020e650c6dace,
                ])),
                Felt::new(BigInteger256([
                    0xe7d261800e92db68,
                    0x4ca6e09547d7a63b,
                    0xad64f798c2768eb6,
                    0x4c9f8ba51c7d2701,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb97bf86e1b018f33,
                    0x1357287cf4d86ff0,
                    0x55fc7cf8077944d9,
                    0x2408b9ee00b398cd,
                ])),
                Felt::new(BigInteger256([
                    0xfa78c0c10cd00876,
                    0x10fc86546aa2f8aa,
                    0x5f86326acc5c719b,
                    0x00e55b203b8c55b8,
                ])),
                Felt::new(BigInteger256([
                    0xbfebf6a0b7eb054f,
                    0x0f11da1fe5c9612c,
                    0x49cd4efbd633de1d,
                    0x6e28102f69d079c8,
                ])),
                Felt::new(BigInteger256([
                    0x2604954bed93785d,
                    0xcd1eb14c91a5841a,
                    0x503e0d027be56831,
                    0x203080691e728d68,
                ])),
                Felt::new(BigInteger256([
                    0xe16dbc5bdba5a046,
                    0x4cceb04bd204b05f,
                    0xb975d770c3c5ceb4,
                    0x543ae5f3bba3e4c1,
                ])),
                Felt::new(BigInteger256([
                    0xc0e9fbc51c5a9a72,
                    0x80b7ff47f650bda8,
                    0xbc0a5d9d5d4e2861,
                    0x5283fb1c35f9a87a,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x05b1f86356175908,
                    0xe9acc0f0454cddab,
                    0x066c3c56a4ab076a,
                    0x1d8d6604ce4f5ff9,
                ])),
                Felt::new(BigInteger256([
                    0x0b36f009c125eb7f,
                    0xf017da3241bcf478,
                    0x5feab57fb1aeba1c,
                    0x542b83f45fc78d04,
                ])),
                Felt::new(BigInteger256([
                    0xedb24ee93cf733a0,
                    0x138ea56d052236f3,
                    0x5265d0f494f94aa5,
                    0x519add8eff37a037,
                ])),
                Felt::new(BigInteger256([
                    0x16faf97810f50599,
                    0x7f2be01f72333140,
                    0xd7bba584f9bc5144,
                    0x28b8eb879db53c7b,
                ])),
                Felt::new(BigInteger256([
                    0x30052a0b81aeabc8,
                    0x7a90ae6b227578ce,
                    0x7df56983be832578,
                    0x5788c0d394615eec,
                ])),
                Felt::new(BigInteger256([
                    0x5b8f277d14c89a5e,
                    0x7cfd5bbac9dfb71a,
                    0xb25718894c79e720,
                    0x3aa90ddca898df4b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x8e66d8bb5ee6340f,
                    0xe020b1b8f48503d5,
                    0xf869d3a3c6f93cfe,
                    0x5dd227c0927ccd84,
                ])),
                Felt::new(BigInteger256([
                    0xd7514e18281bcedb,
                    0xc01c3135a787ffb1,
                    0x4030db4c2d32e22f,
                    0x2f356f56a5d9ebaa,
                ])),
                Felt::new(BigInteger256([
                    0x9208e2afa0af3d87,
                    0x47b0b920123b2934,
                    0x7907a9e345074655,
                    0x0c70d6af8b64c181,
                ])),
                Felt::new(BigInteger256([
                    0x48a37c9136379c25,
                    0xf3e3e9893738e919,
                    0x75dc070bc0c59432,
                    0x5d69875c3355099e,
                ])),
                Felt::new(BigInteger256([
                    0xea53c634b640ba5d,
                    0xe08dce8c1f39b016,
                    0x42ede42bad06c51b,
                    0x023662c610468e39,
                ])),
                Felt::new(BigInteger256([
                    0xa598323b271e9f23,
                    0x9a094ab32729ed66,
                    0x9561f17e3d9cbbe4,
                    0x3776ea286190f503,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x8a9636366758005e,
                    0xc015c84265858010,
                    0xacb47d85aa6a487a,
                    0x6ae3a1f96854542c,
                ])),
                Felt::new(BigInteger256([
                    0xb08707b01f80ad0c,
                    0xfba901616acef607,
                    0x97a0fb1707b409f1,
                    0x2dacbb89a4d46f6c,
                ])),
                Felt::new(BigInteger256([
                    0xf70d2a9c9e46fbb1,
                    0xab9be9e473186830,
                    0xa70bb9bbecbfe78b,
                    0x537c13d79e84ce6f,
                ])),
                Felt::new(BigInteger256([
                    0x55aced40af5c06c9,
                    0xf953bf33bc339e85,
                    0xe6e0789a350e2528,
                    0x4a2984471efbe55d,
                ])),
                Felt::new(BigInteger256([
                    0xb35d4efa3c44dab1,
                    0x068816c030bfc90d,
                    0x2bb7be22a7ccb19b,
                    0x6251714401ab3ba1,
                ])),
                Felt::new(BigInteger256([
                    0x9091454cfc728b0e,
                    0x79ed652b6a1ecdc9,
                    0x81a8bac55ade2367,
                    0x5bc8965f12b31761,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7733f22f9ed3fca7,
                    0x3cb1a665c857b267,
                    0x1e6f6b771b460d58,
                    0x71e0d31da44f189b,
                ])),
                Felt::new(BigInteger256([
                    0xed413bbb76af3ad5,
                    0x092da7f9e88b8401,
                    0x8dd1d3eef6934610,
                    0x34369f1f8718f00d,
                ])),
                Felt::new(BigInteger256([
                    0x4cd26cea8c152a36,
                    0x1f884e1afadd5790,
                    0x85ef9afd5a8bc806,
                    0x17384851c7ea543d,
                ])),
                Felt::new(BigInteger256([
                    0xdb7bbb487e5cbb9e,
                    0x7dedbf75a6d138fd,
                    0x494aad1f927796af,
                    0x3a09e0a2b09353a0,
                ])),
                Felt::new(BigInteger256([
                    0x9a9865d700a4cfd2,
                    0xe5619653db8ef160,
                    0x8db21934d742e085,
                    0x132ab0a8550d7a2f,
                ])),
                Felt::new(BigInteger256([
                    0x1156770c01515f9e,
                    0x868213f254db1dda,
                    0x268e7006766f7516,
                    0x356f09e65fd8bc4b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x596fca374b21f4f6,
                    0x9c89784a101c0256,
                    0xa0809fa0ff4c9306,
                    0x0f9c5e707e98e5c5,
                ])),
                Felt::new(BigInteger256([
                    0x3a81dcd94f7451d4,
                    0x0c7042eef132d00a,
                    0x05484f05094c2315,
                    0x5fef409ac7f980a4,
                ])),
                Felt::new(BigInteger256([
                    0xa8a9f2a11bdf8120,
                    0xa8a4a64f230570b9,
                    0xab1c15688ad4ce5d,
                    0x4a71ebd54da3582a,
                ])),
                Felt::new(BigInteger256([
                    0xf64f0582f99c46e3,
                    0xcccca2015feabea7,
                    0x5ddbf1ae842f2f28,
                    0x4b0ef63e2c753598,
                ])),
                Felt::new(BigInteger256([
                    0x7ab5257dae4a01cf,
                    0x163738175ed2083e,
                    0x00282f5bd52f055d,
                    0x21b671a153234112,
                ])),
                Felt::new(BigInteger256([
                    0x3941299247abc9cf,
                    0xd180a32b05bdb35c,
                    0xb5c1a49452b5fa91,
                    0x496f63e68852a66b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xf6139070545f1016,
                    0xc0af39fcdd8a12a4,
                    0x1cc67932af8ad3b0,
                    0x44576a4eaa04660d,
                ])),
                Felt::new(BigInteger256([
                    0x02cbdb5b82c83658,
                    0x80d6e5e32f5fd428,
                    0xf6d1721ab107ddac,
                    0x01f11a674ff05650,
                ])),
                Felt::new(BigInteger256([
                    0x7079afa805fbe941,
                    0x0c9b73dc3f580675,
                    0x0876b5d97bfb5f88,
                    0x726c4d7cc6d20610,
                ])),
                Felt::new(BigInteger256([
                    0x1f8e61a8dc0026e3,
                    0x476b55ff814d453f,
                    0xc7644dde99567ffc,
                    0x36e0d9922116d7a0,
                ])),
                Felt::new(BigInteger256([
                    0x3d84ec8c3ed5f790,
                    0xeac1e91c74211fc4,
                    0x8c82f01fd521745b,
                    0x6b8397cef7ddc99b,
                ])),
                Felt::new(BigInteger256([
                    0x428d7782e7d2f354,
                    0x6d498db553ce4a44,
                    0x6fe65a919aaee2f6,
                    0x302ed988fd8d7a01,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb986ba01923b0196,
                    0x8979ab48882fb1a7,
                    0xdbc17916821233cb,
                    0x484a08d33316a920,
                ])),
                Felt::new(BigInteger256([
                    0x0afbfdfc6b4f8b81,
                    0xf69042aa443fecb0,
                    0x0c249912c70d10f3,
                    0x52f736959473e73e,
                ])),
                Felt::new(BigInteger256([
                    0x248112b06f15ba48,
                    0x275b90ea23f94c07,
                    0x76bbfb74811897c4,
                    0x2ea64428afb17ff1,
                ])),
                Felt::new(BigInteger256([
                    0xb2f87fda5388d728,
                    0x294f67c65a466197,
                    0x42c5a3931ec736c9,
                    0x3813c00747a4913e,
                ])),
                Felt::new(BigInteger256([
                    0x0ea5b5cb2c1727e7,
                    0x19b120d41f0ffebd,
                    0xb5fce788a355f4fa,
                    0x1e8bcd906b52ccb0,
                ])),
                Felt::new(BigInteger256([
                    0xb297639cb024b2d5,
                    0x2872e82ece999f9c,
                    0xa43666e76d10abda,
                    0x6bad74c0bf28984d,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger256([
                    0xef7fcc3f21914fa9,
                    0xfb99e4b2c79d023f,
                    0xf4b04d40c8a6f07e,
                    0x060300dc0c9ec60a,
                ])),
                Felt::new(BigInteger256([
                    0x74c2360d08c2056e,
                    0xf67fc8c4b324d0a4,
                    0x5d6cacfc8e84db10,
                    0x0b30062c492055fd,
                ])),
                Felt::new(BigInteger256([
                    0xa9a552d0cc76a4b3,
                    0xb93e765ddac392f1,
                    0xce70eb2d76841f9c,
                    0x351ba0bff81fd3cd,
                ])),
                Felt::new(BigInteger256([
                    0x3a28e2d991713ddb,
                    0x2bce974a64e84a2d,
                    0xbe155feea115d61a,
                    0x71e4deffe9347e24,
                ])),
                Felt::new(BigInteger256([
                    0xbe0651a44c5f0b2d,
                    0xd0217f313cf14ffc,
                    0x023363df8033fe00,
                    0x2819a0aa54e4aae6,
                ])),
                Felt::new(BigInteger256([
                    0x127a92e3da215c87,
                    0xbcdb95a40b1180a8,
                    0x65a5f68c23df1369,
                    0x0121d65e6b46627f,
                ])),
                Felt::new(BigInteger256([
                    0x98ee6b96d2a7b6f5,
                    0x284d2c27d5c6e76b,
                    0x7b2bc23f138382f4,
                    0x7157bd9e9a09c0da,
                ])),
                Felt::new(BigInteger256([
                    0x155e59c393e2abc3,
                    0xfde9ef0008d63aed,
                    0xef0dbecd7661325c,
                    0x0355bdf1b0689d81,
                ])),
                Felt::new(BigInteger256([
                    0x48391bc9972c5378,
                    0x3a3deffa40f77f97,
                    0xe062f22feca3c713,
                    0x2e358223f97291a7,
                ])),
                Felt::new(BigInteger256([
                    0x2d35849fe3f55252,
                    0xfe50ea4d5817a702,
                    0x0293ce5c20011702,
                    0x210389a0074e6ef6,
                ])),
                Felt::new(BigInteger256([
                    0xec8fa7146d4f8d16,
                    0x3b0adcc36791f46b,
                    0x979ecce340a7bdf1,
                    0x67271cebaa251fd5,
                ])),
                Felt::new(BigInteger256([
                    0x600b541bfa71a3f3,
                    0x3c610c2dbe9ef199,
                    0xf766eece70340d39,
                    0x1c1e309ce47428a6,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x1e18e4e0d8c5e8f5,
                    0xda281c4bf3644630,
                    0x01d33c65cce47de6,
                    0x144ebc3fff474521,
                ])),
                Felt::new(BigInteger256([
                    0x02cc18197614f6e7,
                    0x18f596e809598774,
                    0xc798d2a5fea05086,
                    0x576f7ccbfb097d04,
                ])),
                Felt::new(BigInteger256([
                    0x78e7c0bdcb9e0899,
                    0x981670068128a57c,
                    0x62ee396c9379ad6b,
                    0x066c9f2515551ef0,
                ])),
                Felt::new(BigInteger256([
                    0x91f484e292521d1c,
                    0xaed2cb19ef477d39,
                    0x3b071728d8372a21,
                    0x26fad0979820d161,
                ])),
                Felt::new(BigInteger256([
                    0x975bc02733966650,
                    0x8a91685817cb8580,
                    0x1f2746593d103980,
                    0x563e17c4d3509284,
                ])),
                Felt::new(BigInteger256([
                    0x82c935a43dc7a0e4,
                    0x73f02fa0a4f7780a,
                    0x2f830fda26ef44f9,
                    0x371fb072bac99b3a,
                ])),
                Felt::new(BigInteger256([
                    0x55bd6f86bb508f31,
                    0x1979b8052b26ca7a,
                    0x8571c48a2536b005,
                    0x70a53953b7f51804,
                ])),
                Felt::new(BigInteger256([
                    0x06c31f8e394db4a5,
                    0xe382da96281d74eb,
                    0x433e31093c01d252,
                    0x5b3ab57e7b48a97a,
                ])),
                Felt::new(BigInteger256([
                    0x0dd01bbb5387fa3a,
                    0x268f02023528ca3d,
                    0x6ae2785c8fee733c,
                    0x5047eaf8cd7cd1e9,
                ])),
                Felt::new(BigInteger256([
                    0x2fc7f8e3d3f1fcb7,
                    0xdf3cf57172606f6b,
                    0xeafe932db90196bd,
                    0x5e792949fd92bdb7,
                ])),
                Felt::new(BigInteger256([
                    0x6c7423a70088b6c9,
                    0x236a52ed55591bc5,
                    0x399354711cb1f4af,
                    0x56b521af28adf145,
                ])),
                Felt::new(BigInteger256([
                    0x5aeb5ed873f268b0,
                    0x158adda925a9877a,
                    0xa198bff9d4e73575,
                    0x24f8ee5240eacbbb,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x81c328602e99c56b,
                    0xf2c451c4d7a4c9d5,
                    0x4502709452910738,
                    0x67d35b771c82787e,
                ])),
                Felt::new(BigInteger256([
                    0xc1a7fd1200e292cc,
                    0x6a471704fd948b60,
                    0x242f44c3aed78710,
                    0x31bd3de86885e316,
                ])),
                Felt::new(BigInteger256([
                    0x14e619a7e7873b87,
                    0xa7c35e30f06d98c4,
                    0xf60c167eb8ec334a,
                    0x2c31eedaa037ded0,
                ])),
                Felt::new(BigInteger256([
                    0x78585237e2c8351c,
                    0xce1c0e8323d32ff4,
                    0x979c9f273a0b77df,
                    0x449a46c613147249,
                ])),
                Felt::new(BigInteger256([
                    0x1b1626396a06d339,
                    0x2c08d9a0bad5c2ca,
                    0x36be4b66f2eb4ada,
                    0x19d851365fc6e42b,
                ])),
                Felt::new(BigInteger256([
                    0xc3c7e3725e8d6753,
                    0x7194012fa50c7e1e,
                    0x08f59fdf30e67fe3,
                    0x24ce870d45a1c2ff,
                ])),
                Felt::new(BigInteger256([
                    0x96e0dd2018807f51,
                    0x3cd436a1c08075e2,
                    0x2bb67480aa807aec,
                    0x1d739ff79dc7f8be,
                ])),
                Felt::new(BigInteger256([
                    0x75524c3fc842cd54,
                    0xce33797ef2624eaa,
                    0xf70f84f3ff7c4575,
                    0x6490449db8aeedc3,
                ])),
                Felt::new(BigInteger256([
                    0x07b3c66c936d25c3,
                    0x9c57461df95d0210,
                    0x2460c43865ad2839,
                    0x19cf5aa180adf579,
                ])),
                Felt::new(BigInteger256([
                    0x0cb1a3401604b625,
                    0xffe7fdf0a29867a6,
                    0xb31213ed20dc4a6f,
                    0x097d1e9793f2a971,
                ])),
                Felt::new(BigInteger256([
                    0xfe922032d10f452e,
                    0x7848b7a8f3e4349f,
                    0x5c78f99bcd49e326,
                    0x63169b5f045d48db,
                ])),
                Felt::new(BigInteger256([
                    0x9c975c38e7ec38b2,
                    0xf4c53619b7fe5458,
                    0x5bb234189d5b7cc7,
                    0x3aaafca621b7a1e6,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x77896f74f070a20d,
                    0x580d4a8fd2dbd000,
                    0x39c3ff46593e26a9,
                    0x2f782fde1481111e,
                ])),
                Felt::new(BigInteger256([
                    0x1f0fbf3fce3b200d,
                    0xeefa3eb7477cc383,
                    0x3fbf9e1816df9508,
                    0x57ff0868cb50a605,
                ])),
                Felt::new(BigInteger256([
                    0xb0e6d8512a5ff9a9,
                    0x51830022f66e9e3a,
                    0x456fc018de4ed4f0,
                    0x2bbab8ab5e93ed09,
                ])),
                Felt::new(BigInteger256([
                    0x387ad36fe0be4f9e,
                    0x1d4f15673015f334,
                    0x1b8fd2efb0c5686a,
                    0x06d5127c77765694,
                ])),
                Felt::new(BigInteger256([
                    0x5510f1b97891bb68,
                    0x5af2424e8eea4b05,
                    0x3be7395a95a95c4e,
                    0x3f5c0e4225e40a50,
                ])),
                Felt::new(BigInteger256([
                    0x600de1c9641da6ce,
                    0x612de090681fb679,
                    0xfad688ae180bb805,
                    0x3955cad33017d864,
                ])),
                Felt::new(BigInteger256([
                    0xedba9c42d502102c,
                    0x7afc78c937592f3e,
                    0x9de86dd35e72c680,
                    0x5b6081fbd958fd1a,
                ])),
                Felt::new(BigInteger256([
                    0x0de7b98213c7e7a5,
                    0xc3d493ba9df3fb35,
                    0x43ae03ec22012edd,
                    0x08de703672638fe2,
                ])),
                Felt::new(BigInteger256([
                    0x492178b6b19bd1a1,
                    0xb08f6e6dbf62358e,
                    0xe971928885880274,
                    0x2438d9d4dfecadc8,
                ])),
                Felt::new(BigInteger256([
                    0xd27c2d5c91ce7c3c,
                    0xe258b228f47cb08e,
                    0xa4adc5656b9964bf,
                    0x450ded48122d38f4,
                ])),
                Felt::new(BigInteger256([
                    0xc78cb4b8e8ccbe03,
                    0x37dd5b61128b7634,
                    0x59f40bdef4aaf3d5,
                    0x662e2546e4c79dca,
                ])),
                Felt::new(BigInteger256([
                    0x42cfe1c92d7bb374,
                    0xba42e9a0a04e65a6,
                    0x12b7b8183e2c1c7c,
                    0x12398dbf0e1f2023,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x590538071d1830ed,
                    0xd4d97a0939e3aa81,
                    0x11efabcacb47a796,
                    0x5fb601236a5c9a00,
                ])),
                Felt::new(BigInteger256([
                    0x7818694448fb2cf6,
                    0xf3a3cda09fef483a,
                    0xf155fbc21dd87a6e,
                    0x143ba4022a2de730,
                ])),
                Felt::new(BigInteger256([
                    0xcb3a08520fc977eb,
                    0x985488171ac5fb99,
                    0x925231629d81fc13,
                    0x3e698511a8db80e7,
                ])),
                Felt::new(BigInteger256([
                    0x5167b86bd9ca2546,
                    0x70e096e5ab57223d,
                    0xdcacd68aedca299f,
                    0x5041d738182816df,
                ])),
                Felt::new(BigInteger256([
                    0x3138c47712300332,
                    0x29cbe327a3ccbd44,
                    0x411ffbee40a1f77b,
                    0x48189c1944758a05,
                ])),
                Felt::new(BigInteger256([
                    0x38e7db37eb0f32db,
                    0x0e0324f751aa6115,
                    0x352eac2881950727,
                    0x03b8e2182eb3b981,
                ])),
                Felt::new(BigInteger256([
                    0xaaa2481adb4d52c2,
                    0x817e96425b3c3e78,
                    0x3e81a277f7b31497,
                    0x73b5db4676fbdb66,
                ])),
                Felt::new(BigInteger256([
                    0x404936258cd193f9,
                    0x411e7ad07c6b7283,
                    0x8e08396050200553,
                    0x5884cc2816c541ee,
                ])),
                Felt::new(BigInteger256([
                    0xa1a333daa3b395d6,
                    0x798570b6607f8863,
                    0xd82e4b10b8239c83,
                    0x3f41ca265923d0e6,
                ])),
                Felt::new(BigInteger256([
                    0xf9e1a20e2bf99cdc,
                    0xf4f77372f7ecc817,
                    0x9c97415030e81837,
                    0x37f2ff16c6727488,
                ])),
                Felt::new(BigInteger256([
                    0x8fec146a8639f7f2,
                    0x8eca54295aa697bb,
                    0x74683c3d1657057a,
                    0x1b1c786629e9208f,
                ])),
                Felt::new(BigInteger256([
                    0x1f75672a67f1294a,
                    0x6096e3b4e6ed400d,
                    0x55c3150afb1c466b,
                    0x0f05f2a384c2d970,
                ])),
            ],
            vec![
                Felt::new(BigInteger256([
                    0x8a091d12169a7186,
                    0x2a2751ce99e831ff,
                    0xf4865b29d7ff23fb,
                    0x1d3c476b1412c3c8,
                ])),
                Felt::new(BigInteger256([
                    0x80d5c9abc5702466,
                    0xb5ed5f5e56d50c90,
                    0xf3cff313bf5dd213,
                    0x2510d69f22d35904,
                ])),
                Felt::new(BigInteger256([
                    0x0726113577f76f2c,
                    0x1e42cf8cd3981e4e,
                    0xc1089c4aaed23b09,
                    0x4e3bf4332368d563,
                ])),
                Felt::new(BigInteger256([
                    0x648327c590382f37,
                    0x77d8ae1df94741bf,
                    0x489d96e7310ff256,
                    0x0aa85de10fecee62,
                ])),
                Felt::new(BigInteger256([
                    0x4960528c8f7e844b,
                    0x4605f924e9e3958c,
                    0x6e0c62b5ccf663d8,
                    0x6b8f3e69d2776fbb,
                ])),
                Felt::new(BigInteger256([
                    0x82e32ad70a3492b4,
                    0xd050b1114fd83da7,
                    0x24487f6802da76d3,
                    0x371e8286e6d41161,
                ])),
                Felt::new(BigInteger256([
                    0x1dbddac4256cae82,
                    0xa68c2eaf498614bf,
                    0xadea68e746cdf586,
                    0x2e51fd0a3a6f73c9,
                ])),
                Felt::new(BigInteger256([
                    0x854b39c36a2b6a3b,
                    0xa8d54e13ee9327fb,
                    0x1c138da4fd08cbb5,
                    0x3da3c1241092d528,
                ])),
                Felt::new(BigInteger256([
                    0x3eb0984cde36cea9,
                    0x37d11db73bb47e0b,
                    0xa7c070950b010171,
                    0x1e545f3d722bdf4a,
                ])),
                Felt::new(BigInteger256([
                    0xf3025b2caef20303,
                    0xc2fa6a9053f7410a,
                    0xed6a9e4cf1d34ebc,
                    0x25489829d0a39fd3,
                ])),
                Felt::new(BigInteger256([
                    0x68f6faf7e8434307,
                    0x90fa1871a9fb7ba5,
                    0x1a8b8c611d7867a6,
                    0x1b6669a5a32f6688,
                ])),
                Felt::new(BigInteger256([
                    0x313a1adee179c929,
                    0x19cbc02b81e554f8,
                    0x6b93da716be86bbb,
                    0x65b2a5d1c2541f21,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger256([
                    0x953bf8fcac1837f0,
                    0x4dd7b5036a397f0d,
                    0x982506bde1f1faca,
                    0x256cd47d0adb6735,
                ])),
                Felt::new(BigInteger256([
                    0x0a283296b9493bd9,
                    0xa3374e79013ee98d,
                    0xa8d8151e32a3dc28,
                    0x1fb1443f3422873e,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x3e815bddf80b7d5f,
                    0xcd87d848d58dbf4c,
                    0xce07530b125a7cb0,
                    0x342402cbd1498b23,
                ])),
                Felt::new(BigInteger256([
                    0x06c3747a7a385d15,
                    0x49b05c9652e569f8,
                    0x4c0bb50a2e1bdbbf,
                    0x5c5a0f584885e280,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5ad5ab6bae9234c7,
                    0x1b7a0ee5aca8257e,
                    0x2605cb5c97d119a5,
                    0x727e08bdfc8a7a0f,
                ])),
                Felt::new(BigInteger256([
                    0xe16751d216be1b45,
                    0x5ed336e8f2993a6d,
                    0x6bce9d0aa590022e,
                    0x7399d6a58ff88b9b,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x2369715914bd386f,
                    0x240e70c56ce6316e,
                    0xa38d9ec6ee859f83,
                    0x52c35d14384ae1d4,
                ])),
                Felt::new(BigInteger256([
                    0x7dc110ffe6e38b75,
                    0x988372097dd180d3,
                    0xb6c39b85ee431a7c,
                    0x439fd6057c782b83,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x6bb2e865d35ecd9e,
                    0x118f6816af222c16,
                    0x3466af7ff7f1273d,
                    0x363fdf3ac6d5c058,
                ])),
                Felt::new(BigInteger256([
                    0x3f664e2f36719bea,
                    0x6d717a63451d4c7e,
                    0x91d7d101e70a4ce4,
                    0x0c09215abe23af88,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x7a834bb1288893fe,
                    0x7193fb78288b50f0,
                    0xcc908a8c55d71a60,
                    0x3537c9b3f86ca644,
                ])),
                Felt::new(BigInteger256([
                    0x3d4faa3fe696242a,
                    0x0afa53f698efa2e4,
                    0x0b5c95aa18e47017,
                    0x5fe76fbd46d36066,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xb5716f2be5ef0062,
                    0x1e02eb5144ec0364,
                    0x70180ffd5736f3c6,
                    0x08ba97c64ea2a312,
                ])),
                Felt::new(BigInteger256([
                    0xd40d1866b741b3c5,
                    0x2752f996e11f3fbf,
                    0x81d745f6b786dd4c,
                    0x138b40f8e927f42f,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x5195dfb636932d07,
                    0x9902e3a2d24250ee,
                    0xbf9fbed48b390e5c,
                    0x0003220606d3dcc1,
                ])),
                Felt::new(BigInteger256([
                    0xb291a31b9e2b3cb7,
                    0x8f65dcb98efcc98e,
                    0x124ac8d5b07ab64d,
                    0x1c0985ecbc6c8858,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0xd08b28ebdebe6c39,
                    0x491120b9dc5c496c,
                    0x84d67327b0b35e0f,
                    0x1b62c80a546317bc,
                ])),
                Felt::new(BigInteger256([
                    0x47f19cde8d781a20,
                    0xa53e03436904966e,
                    0xb2e237c235a4357b,
                    0x0f8f6ef00fa47873,
                ])),
            ],
            [
                Felt::new(BigInteger256([
                    0x32aa47c537586e8a,
                    0xc42f69a177c9612d,
                    0xe132e77846fb425a,
                    0x1dcb69f3abe4d303,
                ])),
                Felt::new(BigInteger256([
                    0xe6a762d7e0c7595c,
                    0xdf6089f072f88ed5,
                    0xfd3e2fe2d13ed500,
                    0x17b93c18ad1f8ff4,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 6));
        }
    }
}
