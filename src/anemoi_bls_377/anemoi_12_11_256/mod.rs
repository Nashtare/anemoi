use super::{sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 2 elements (96-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 13 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 13;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2.double().double().double().double() - y2;
        *t -= beta_y2
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2.double().double().double().double() - y2;
        *t += beta_y2 + sbox::DELTA
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];
    state[0] = x[0] + x[1] + x[2] + x[4] + (x[2] + x[5] + (x[3] + x[4] + x[5]).double()).double();
    state[1] = x[1] + x[2] + x[3] + x[5] + (x[3] + x[0] + (x[4] + x[5] + x[0]).double()).double();
    state[2] = x[2] + x[3] + x[4] + x[0] + (x[4] + x[1] + (x[5] + x[0] + x[1]).double()).double();
    state[3] = x[3] + x[4] + x[5] + x[1] + (x[5] + x[2] + (x[0] + x[1] + x[2]).double()).double();
    state[4] = x[4] + x[5] + x[0] + x[2] + (x[0] + x[3] + (x[1] + x[2] + x[3]).double()).double();
    state[5] = x[5] + x[0] + x[1] + x[3] + (x[1] + x[4] + (x[2] + x[3] + x[4]).double()).double();

    state[6] = y[0] + y[1] + y[2] + y[4] + (y[2] + y[5] + (y[3] + y[4] + y[5]).double()).double();
    state[7] = y[1] + y[2] + y[3] + y[5] + (y[3] + y[0] + (y[4] + y[5] + y[0]).double()).double();
    state[8] = y[2] + y[3] + y[4] + y[0] + (y[4] + y[1] + (y[5] + y[0] + y[1]).double()).double();
    state[9] = y[3] + y[4] + y[5] + y[1] + (y[5] + y[2] + (y[0] + y[1] + y[2]).double()).double();
    state[10] = y[4] + y[5] + y[0] + y[2] + (y[0] + y[3] + (y[1] + y[2] + y[3]).double()).double();
    state[11] = y[5] + y[0] + y[1] + y[3] + (y[1] + y[4] + (y[2] + y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xf7774ac0702e4f3f,
                    0x50f0e8bac25fb3dc,
                    0xc44ded5825b83586,
                    0x54e878d61a2945b3,
                    0xe5ce5daab1173c9b,
                    0x00bfb974963ac809,
                ])),
                Felt::new(BigInteger384([
                    0x76b8779a7f465146,
                    0x56de93b431b0985d,
                    0x9ad78e783c64a666,
                    0x6b50c4f4914a86dd,
                    0x912365283302a781,
                    0x012bd59398ed127f,
                ])),
                Felt::new(BigInteger384([
                    0x154441f459315174,
                    0x56673dbcc77993f8,
                    0xcb87cea55adba803,
                    0x482d8a67d5ca23de,
                    0x437c0e5844f3c487,
                    0x019a493027f4fbf7,
                ])),
                Felt::new(BigInteger384([
                    0x672176946fa2111b,
                    0x8f3fc0e655d3dfff,
                    0x1647a893c454f5a7,
                    0xaa6d243cf72ed77b,
                    0x0679b25169b520e6,
                    0x00ca792fab9817b3,
                ])),
                Felt::new(BigInteger384([
                    0x120ab1ae0379245d,
                    0xc1dcc1367315be7d,
                    0x7d57e285a4dff123,
                    0x07606f456aa0c039,
                    0x5fa354cc6d6a1ba5,
                    0x00be28662590c64b,
                ])),
                Felt::new(BigInteger384([
                    0xaf5951661554d6b1,
                    0xa7d40845182dd381,
                    0x1caebec57bbe58c3,
                    0xc28ad658a9b20fc8,
                    0xe43c83f910897a6a,
                    0x00955314bf398a7a,
                ])),
                Felt::new(BigInteger384([
                    0x00150f8323691fdb,
                    0x607e26ba632c66c3,
                    0x5c97d4f9badda462,
                    0xeed46f0d1f822fd3,
                    0x1a9c415ede5009ac,
                    0x0145ca269e53fd94,
                ])),
                Felt::new(BigInteger384([
                    0x135df679166c885f,
                    0x449e38b963eba25d,
                    0xf7597b074b85aed7,
                    0xdf6e8007b5272605,
                    0xb24838145039e176,
                    0x005822fc24d1ed25,
                ])),
                Felt::new(BigInteger384([
                    0x08091af5ed62b6a6,
                    0x75c78130ff83dece,
                    0xfbfdacd7bb153686,
                    0x9cf79829efa8bc32,
                    0x4b4cca6d407144a3,
                    0x010ad2807839e0a6,
                ])),
                Felt::new(BigInteger384([
                    0xe5e5b5dd41ea55d0,
                    0x91d09738e1461503,
                    0x084e0118bc450a1a,
                    0x83272e55341afbcd,
                    0xc9dd0e7eb7366745,
                    0x0052a40622416087,
                ])),
                Felt::new(BigInteger384([
                    0x7897174d6b2c2d55,
                    0x4bddfd64b41a4ffd,
                    0x5c8a8d6a86c1d297,
                    0x657825a66db47ad1,
                    0xc8e08d32f438eba3,
                    0x00fa1369fecbbe86,
                ])),
                Felt::new(BigInteger384([
                    0xdc693564c0eaa50e,
                    0x53114a50bd7c0cfb,
                    0xab0e86ad40f7c5e1,
                    0x770e8947e12c26b0,
                    0x8ddbc3730608bf44,
                    0x0032362d3738ae14,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x0afa82d0009f980a,
                    0xb88cf3e5fd03d837,
                    0x387b8058b17cefb3,
                    0x476a9a979826c44d,
                    0x4ec3546c3dd5ad46,
                    0x005a585a0f3f2036,
                ])),
                Felt::new(BigInteger384([
                    0x800ec53a476dc34c,
                    0xa5a6456abce637a4,
                    0x14f78ac4475939d3,
                    0xc452ec2d069e8678,
                    0x79bfaabb05d929c5,
                    0x017d2827790f28f9,
                ])),
                Felt::new(BigInteger384([
                    0x61837ee512b34aff,
                    0x82f42babf493a6b7,
                    0xd6ee736a5d3717ff,
                    0x18266f5db3649eda,
                    0x3382274151c4fcc8,
                    0x00dc0998da733e0d,
                ])),
                Felt::new(BigInteger384([
                    0xf6e39393c56242c1,
                    0xf65c1fdf0a9b3df9,
                    0x057d4d7e29a4efee,
                    0xf24a031f150be123,
                    0xb08144a2ba216888,
                    0x005d3cf5bc082cb6,
                ])),
                Felt::new(BigInteger384([
                    0xe8d8ff69c492ebcb,
                    0x3c0420ffa9e3a0b3,
                    0x73daee5f4da19ad6,
                    0x3231a9cba684d9ef,
                    0x28b6fa575786a443,
                    0x002705668dfed004,
                ])),
                Felt::new(BigInteger384([
                    0xaf64dd9e933f2fa5,
                    0x47ef35941adc47a3,
                    0x594556a1400cbfc2,
                    0x1978351c5ee1942c,
                    0x25d75b1666b2873b,
                    0x0130ff5f8bc277ad,
                ])),
                Felt::new(BigInteger384([
                    0x528cd392baa15faa,
                    0x7bb7ed69da6ad17c,
                    0x751c5223ab6c5775,
                    0x065147c5ca6f1dec,
                    0x9e214437ec775d3a,
                    0x018197e50fa0fcc0,
                ])),
                Felt::new(BigInteger384([
                    0x2130d15664daa189,
                    0x4518ee3baf33e8ef,
                    0x82e0bde266e7f607,
                    0xb99c9f7b0594c66c,
                    0xc0de21d86058cfeb,
                    0x00891004a0c45c7f,
                ])),
                Felt::new(BigInteger384([
                    0x8a1537e5a939f3f3,
                    0xa0bd584cdab7b037,
                    0x4ec9b4595a6e9474,
                    0xa50ba9663bde6e3d,
                    0xb398a0a63e6233ef,
                    0x018d145141f530d5,
                ])),
                Felt::new(BigInteger384([
                    0x4ea0e742abcfd3f4,
                    0x3922d5ab78235d59,
                    0x4465b3727d5c26f6,
                    0x951da55d6864c7a3,
                    0xfb583666015fca02,
                    0x0162cc1ed8ebaed5,
                ])),
                Felt::new(BigInteger384([
                    0x5311e99843d95f07,
                    0xbfc39be6e0e79d1d,
                    0xe1bbdc4da479dd1b,
                    0xdce1c2ad7f949d51,
                    0x7eb845f9b865ee8f,
                    0x01557006a348e34e,
                ])),
                Felt::new(BigInteger384([
                    0xda5bc47888d2500e,
                    0xd3f4af808b1b451c,
                    0x65fb16af30fac9d0,
                    0x85055b681f163b78,
                    0xe00373c7ae0f09e2,
                    0x0041a6bcb5c149a4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x4a4c9732e8c8593f,
                    0x4cdafcd7d4bef929,
                    0x94e464d618f1a195,
                    0x93f633ddce68556b,
                    0x615c071e9cc4b28e,
                    0x001ee1a46731f6c9,
                ])),
                Felt::new(BigInteger384([
                    0x09679884fca00c13,
                    0x7d9ddbce0f7d48a7,
                    0x8d7f5f9e733922bb,
                    0x16c657450c243151,
                    0x43216fb40e54dc74,
                    0x005c93e9c31b2999,
                ])),
                Felt::new(BigInteger384([
                    0x2cd8962d7a75d4a1,
                    0x807489cc0d2fb7b5,
                    0x2fc91dba243f7c03,
                    0x5a2c56038c9e9268,
                    0x515232e7ae003b90,
                    0x0176f9cd8e4986dc,
                ])),
                Felt::new(BigInteger384([
                    0xe3fa008eea536538,
                    0xfcce3904c49d409b,
                    0x3cbf60ff2eacf3a1,
                    0x1c9531b8ba225975,
                    0xf001f61be612242b,
                    0x000253a7e1f6dd95,
                ])),
                Felt::new(BigInteger384([
                    0x4d26553b53585fb2,
                    0x0b17451930966608,
                    0xf286180bb5cbb78d,
                    0x47efdf05e1056d89,
                    0xf5c90220c916ee18,
                    0x0141acdb0959dd6b,
                ])),
                Felt::new(BigInteger384([
                    0x4dff966a2aeecfa1,
                    0xafa13cfffb6654c9,
                    0xb43f1dcb6724c9a4,
                    0x084132b3516a6670,
                    0xbc2b8fdf964cdf9a,
                    0x01864dd67328fd14,
                ])),
                Felt::new(BigInteger384([
                    0x58d23fcd9b1acc59,
                    0x1746cbd235eb8301,
                    0xfb5aa2dcca0ea9ce,
                    0x276b619b31f26c5f,
                    0x25eeda2ceb5a873c,
                    0x015752182f465fc1,
                ])),
                Felt::new(BigInteger384([
                    0x7067e33e65a6d451,
                    0xac3b24af580932cf,
                    0xbfa3b618db576a79,
                    0x7d1ab35095560f8e,
                    0x964e9f5d575633a6,
                    0x00f2a5cc0f4676fd,
                ])),
                Felt::new(BigInteger384([
                    0x08f23cb29b194bcf,
                    0x9248fd22e60b8f6b,
                    0xbf36fdf730780d11,
                    0x1e6dcf386205c414,
                    0x7a95a11fa61204b6,
                    0x00d29625c3854a61,
                ])),
                Felt::new(BigInteger384([
                    0x288204fb59b4afb4,
                    0xe2cae0323bac2f34,
                    0x55a955cad61c0654,
                    0x665698c4d62c0887,
                    0x991cef3906ad09dd,
                    0x008996cff657de62,
                ])),
                Felt::new(BigInteger384([
                    0x2ca303a8c4fcea43,
                    0x484f65014569d3d2,
                    0x22d19b5693b1a912,
                    0x4507e56df1abbbac,
                    0x0bdc339f8c59646f,
                    0x01449301c19038de,
                ])),
                Felt::new(BigInteger384([
                    0x1e81488cdf33b629,
                    0xcf08c54af772937a,
                    0x3885c23d541b4d64,
                    0x4b3a95c46c80db5d,
                    0x5918220adff224bc,
                    0x007c74aaa1115ae1,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x692f2077186d4ee5,
                    0x32854af790c9d3c8,
                    0xd53e8d53f5d558da,
                    0xbf0368d048e0be67,
                    0x5c9efb8d7ce82234,
                    0x00b1b2e26be35ee4,
                ])),
                Felt::new(BigInteger384([
                    0x47ee9a12b2482705,
                    0x3b4dcc5ee9eda7fb,
                    0xa63d9d8d9d6fda8e,
                    0x3652eb46e42f78df,
                    0x5e80203666d2acd5,
                    0x0159f94209f7f33e,
                ])),
                Felt::new(BigInteger384([
                    0xbcb7d9e500194cd8,
                    0xbb2216e4a10ba609,
                    0xace0d8504ee64af4,
                    0xd542f5a649e5c54d,
                    0x0f6500dc04cc07c9,
                    0x0105169577be0e31,
                ])),
                Felt::new(BigInteger384([
                    0xba1c12d8f380d869,
                    0xc5791a21a4c70771,
                    0x4e7c2a7c364d0418,
                    0xdff4c4a3ec3a9a0c,
                    0x320970649ff97506,
                    0x017479dba8cfda83,
                ])),
                Felt::new(BigInteger384([
                    0x48b21d1c606b5303,
                    0xdaf186463d471dc4,
                    0x11dccb72f118c7fa,
                    0xb8ce8f1be960bf9a,
                    0x9fc4eef17cc8052a,
                    0x01a868ac560d07ff,
                ])),
                Felt::new(BigInteger384([
                    0xe0953ceea10896ba,
                    0xa4a5584bb2240412,
                    0x768d26e0dec9e1fb,
                    0xca09fe18cb17c55c,
                    0x8954590423684a37,
                    0x00f1ebcd2efd4993,
                ])),
                Felt::new(BigInteger384([
                    0x877ec434718cd276,
                    0xbe5061c2b2b9c1cb,
                    0x517c925361578052,
                    0x460853a57bb8cf6b,
                    0x62a11428d4128c95,
                    0x001dc15507176b62,
                ])),
                Felt::new(BigInteger384([
                    0x740fddc279cdd806,
                    0x42363d3800122b0b,
                    0xccd8c5becfc5d140,
                    0xc7d012386a7e5186,
                    0xf13a9c32522b7f09,
                    0x0135ce068e64412e,
                ])),
                Felt::new(BigInteger384([
                    0x9ef8db00e9200b6a,
                    0xb1e56c2717ee742d,
                    0x9c7102e019485c71,
                    0x9e06b8bd38e68fa7,
                    0x8935b593406818c6,
                    0x01102a487ddd8df4,
                ])),
                Felt::new(BigInteger384([
                    0xf8adecd5369b16c2,
                    0xb25d395f911cd82b,
                    0x946ddd09567db464,
                    0x233c738b7f431c3f,
                    0x3049791dfcbbe638,
                    0x01617443dec3980b,
                ])),
                Felt::new(BigInteger384([
                    0x5a5eaa88a60d7c48,
                    0x2725a8a001a104ed,
                    0x9bf28766bcdb91b9,
                    0xd9a61d7fbbc88be9,
                    0x00adf61e24688159,
                    0x018fd30d39511256,
                ])),
                Felt::new(BigInteger384([
                    0xf954af6c1db0797a,
                    0x0a7b76bcc88cef79,
                    0x81031e28d8258eec,
                    0xdc88133fbdd20b98,
                    0x5a4dbb6b2e476f67,
                    0x0156f050ae540b8a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8c0cfad81fc20eef,
                    0xdb62e59fbb6e27c2,
                    0x8591505cb4e74667,
                    0x057f32101621dbb2,
                    0x6cc0f1819b9d6fbd,
                    0x00b5889783f461d0,
                ])),
                Felt::new(BigInteger384([
                    0x2739aad6beccbd64,
                    0x0cdbad5172da5bd7,
                    0x43bfa0f5ef87fd88,
                    0xd568a6f0a5f81e5c,
                    0xd418c47891c79f88,
                    0x00852fe3f2087f9a,
                ])),
                Felt::new(BigInteger384([
                    0x01f9983a0e0af509,
                    0x50652e88ea92de8c,
                    0x5777c0f0b9f84e2c,
                    0xee0ffff688d622b5,
                    0x0af379e073f67b75,
                    0x018d54e06201be1f,
                ])),
                Felt::new(BigInteger384([
                    0x50aeba7b86c88f88,
                    0x06943f558ca17877,
                    0xf25ce6473d753b41,
                    0xe03e147c5f884c60,
                    0x7d2e8169d2c50757,
                    0x000bdadb266807a8,
                ])),
                Felt::new(BigInteger384([
                    0x011c98da8aef9114,
                    0x3b2f0721335d0802,
                    0xb16a2a8e3181456d,
                    0x7095abe53ee0b77d,
                    0x64a938345053095a,
                    0x00fb7f5c36771e58,
                ])),
                Felt::new(BigInteger384([
                    0xd4530c7dfad4dd85,
                    0x46217efc987a143d,
                    0x0a1eb7bdb8007c2c,
                    0x31a0b7fbf4602763,
                    0xe70da57e8035b5ac,
                    0x005b2bc49575c411,
                ])),
                Felt::new(BigInteger384([
                    0x1a37a41dd7b3c139,
                    0x760f00c810e40646,
                    0x2e61202342792626,
                    0x9bd1d9094ff97fd3,
                    0xd7f4cc1ccdacb731,
                    0x00e4adeacc3bfd5d,
                ])),
                Felt::new(BigInteger384([
                    0x7865701165356fd3,
                    0x32877e7af5daf5a6,
                    0x144c6f199e948947,
                    0xb81c33b4f396c4f8,
                    0x6d4e599224d36926,
                    0x01279191ba56c54b,
                ])),
                Felt::new(BigInteger384([
                    0xf53a674c222d8f90,
                    0xf89a82ed9ac1c76f,
                    0xc705b6e6226b6533,
                    0xbfa0eb5bf819eb30,
                    0x2ad93bd74241e5b5,
                    0x019e13dee5712e23,
                ])),
                Felt::new(BigInteger384([
                    0x28adddfae79078c9,
                    0xff4974e104d991ad,
                    0x2c5e0f185a7f8c48,
                    0x9fb1506e6c4fcef7,
                    0x7493c5d413ef41e2,
                    0x01896db452fe5dbe,
                ])),
                Felt::new(BigInteger384([
                    0x5dfefad997b17718,
                    0x3a6f4f9a6093c9f4,
                    0x5fbe7efa636b01e4,
                    0x8a08d1311aba0cc4,
                    0xc0832ea7275d4fbc,
                    0x00f017c108353d22,
                ])),
                Felt::new(BigInteger384([
                    0xa5b8f518fe3f1a68,
                    0x6cf8e7f9d5735533,
                    0x0ae8c6555c42b9b7,
                    0xfed1e2fc01ed5607,
                    0x7634d21a094d5fec,
                    0x0151ef33e221a5c1,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xd4d7b89aab68cea9,
                    0x1c95f3880285fa4e,
                    0x3c4a33135451d389,
                    0x9d8ca8b0c5a31b6d,
                    0xee90640c14e09732,
                    0x00251bb5777ac324,
                ])),
                Felt::new(BigInteger384([
                    0x8cf7e7bcfae8380d,
                    0x16246057e45a8bf2,
                    0x37350dc2e10ba3ba,
                    0x65467c8d899f6769,
                    0x423cfe2dc890ef98,
                    0x0164c4261d2d5118,
                ])),
                Felt::new(BigInteger384([
                    0x3dfd6dda6b5b1df1,
                    0x529c054bc5c9768d,
                    0xd547bd3ddef341ea,
                    0x2c8b1211db5b2769,
                    0xa22914ce69bb2028,
                    0x00000aaed2a94144,
                ])),
                Felt::new(BigInteger384([
                    0xc3df74a9a5ce0cf9,
                    0xf9af2c698632fc75,
                    0xb320f536fb11641d,
                    0x828c2b5213fea0f9,
                    0x142c203d784aea04,
                    0x005f042a4c7fa651,
                ])),
                Felt::new(BigInteger384([
                    0x33c8d7c1d9b62334,
                    0x67aa2990a9c6e931,
                    0xa349f8fa9a9a83f0,
                    0xc55da2712398c9b8,
                    0xfd09151f15b3593e,
                    0x00b3b2cc7068a309,
                ])),
                Felt::new(BigInteger384([
                    0xe21b433024ae6d3e,
                    0xdf34ab1572da6281,
                    0x63f1f9498dbae6bc,
                    0x526953542daea5e5,
                    0x392e77e56a9556d7,
                    0x011cf3784b2350b6,
                ])),
                Felt::new(BigInteger384([
                    0xb50041929a04ee97,
                    0x1fc8105cc141b92b,
                    0x136cba6ff297330f,
                    0x9aea34a843a1ac3a,
                    0x98bdf119d02cd3c8,
                    0x008ffa3a5d15539c,
                ])),
                Felt::new(BigInteger384([
                    0xc44a09d9599eafe2,
                    0x59eb637a756fd98c,
                    0x51fb5027e77c0d74,
                    0x358d12b43b44199a,
                    0x05dbce646d703d81,
                    0x00b8900a4ecf873c,
                ])),
                Felt::new(BigInteger384([
                    0xfec3cf69f0abccb3,
                    0xe4f8aab0a7406de3,
                    0x9fe0c6f2ca4d6a83,
                    0x3779e9c2fa0e60cc,
                    0x1efb32aa7d0139ed,
                    0x00c3bf4d8bfc65e8,
                ])),
                Felt::new(BigInteger384([
                    0x4c8d5099dcb28767,
                    0x463c745188798820,
                    0xc131d14bb0fc05d5,
                    0x33febb574354013a,
                    0x5553b06b471d26ed,
                    0x00e72762eefc8c3e,
                ])),
                Felt::new(BigInteger384([
                    0xff4bf9c259064e5e,
                    0x7c47483025da4011,
                    0x5241f06b2d79ef15,
                    0xaa2a1c61e46d75f3,
                    0xcc32a8e071db112e,
                    0x01ae39af8deaa9c2,
                ])),
                Felt::new(BigInteger384([
                    0xbe98336298f73e1f,
                    0xa67da8926f2ea419,
                    0x03800e8ad543c598,
                    0x50e731fe1315b6b9,
                    0x7f8728bca9b8a46d,
                    0x01a3957608a7f88d,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x99c293892c9def56,
                    0x54a700bbda42e023,
                    0x8db017bb3a581268,
                    0xc2bc10de91fd541a,
                    0x944c59e318e10677,
                    0x00dd625847a35fa7,
                ])),
                Felt::new(BigInteger384([
                    0x5746cce5e109548a,
                    0x81a6b47128b1b413,
                    0xa22d33cf4d47cb58,
                    0x87be93455b7ef527,
                    0xed8892268f9358b8,
                    0x018d3820154bb022,
                ])),
                Felt::new(BigInteger384([
                    0x6fb701461ac1c3a0,
                    0x80b6c7a8191c7e3e,
                    0x8e3d212cb09e386c,
                    0x3177d9b00c78e788,
                    0x0dbf2f41efa4e879,
                    0x0128cce49c09b2de,
                ])),
                Felt::new(BigInteger384([
                    0xaa6748a1997f9971,
                    0x9dc74369a408eba8,
                    0x62abcf5ec0a27d17,
                    0x485357c9b14a708c,
                    0x65e36d40881cc78e,
                    0x009d83437c0c0b17,
                ])),
                Felt::new(BigInteger384([
                    0x100be5839435e14b,
                    0xd57c7d472325bda7,
                    0x7054000bdb511378,
                    0xd78ff42768a0ff1b,
                    0x8442d37b7b031658,
                    0x003712cdb8e40333,
                ])),
                Felt::new(BigInteger384([
                    0xc90adfdd21614482,
                    0x9bb74163784ae05d,
                    0x142dd78b0089ed90,
                    0xdc5eaa2187c6a9d1,
                    0x6685a3ce718b372e,
                    0x004c52ff9609a951,
                ])),
                Felt::new(BigInteger384([
                    0x78427433ed63713f,
                    0xdef35ef5655acaf7,
                    0x70f66332d5dd611f,
                    0x8b76d3fb29563823,
                    0xeb090ca5404c904a,
                    0x0154ef16c0c15169,
                ])),
                Felt::new(BigInteger384([
                    0x9af360736c7db53f,
                    0x1de1aadf7c1b9c75,
                    0xdaa48437ba61e8d9,
                    0x6e77f9007171d07e,
                    0x262dfa24ed78098b,
                    0x0125c5582a37cc3c,
                ])),
                Felt::new(BigInteger384([
                    0x638cd37e2bf691e7,
                    0x1a92a6f01a5a372b,
                    0xa461124b1129d438,
                    0xfcdcea1b04efb189,
                    0xbf12c86a3313323f,
                    0x0037b00a919baa11,
                ])),
                Felt::new(BigInteger384([
                    0x402089c4b8ac120a,
                    0xf09dbfa10f33f46e,
                    0x31f6ddde94cc7630,
                    0xb9d9de54612a76ec,
                    0xffb123a479661d21,
                    0x015a19906a68dd13,
                ])),
                Felt::new(BigInteger384([
                    0xd53e663ea5abe013,
                    0x5fed13385c99f6fd,
                    0x4c4d4c4a62f5dce9,
                    0xeeb800f308fd2ac7,
                    0x86de5bb846b522af,
                    0x00f1e848fa4abe10,
                ])),
                Felt::new(BigInteger384([
                    0x06503c5de8e02154,
                    0xffd5c8581cf22bd1,
                    0xc31ac77874f301a4,
                    0xcdcb7cd1e294d98f,
                    0x1a805918dcbe4537,
                    0x00bde32e7596d0ef,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xadcf820980881bee,
                    0x51989182b86bf540,
                    0x9d3b326292094a35,
                    0x2791de6e6145100c,
                    0xb7af80cfa0a4e461,
                    0x0031487b3b88d00d,
                ])),
                Felt::new(BigInteger384([
                    0x0f7a791ee62e5240,
                    0x6951fe59890d19d5,
                    0xc33263428cdf98e5,
                    0x4e0015da6dea4e8a,
                    0x3a96da29e9ff40cd,
                    0x017e36f719459112,
                ])),
                Felt::new(BigInteger384([
                    0x60c338fc964d48a1,
                    0x5d662c0f28e7451d,
                    0x86c4b222d402d6ab,
                    0x94c8b2e35acc90b8,
                    0x6f2fd5263b97419b,
                    0x0070394fc46d52bf,
                ])),
                Felt::new(BigInteger384([
                    0x703723fa585ac927,
                    0x09d2421008909b50,
                    0xcfbf390946411c25,
                    0x4e551e6ba8eb7b42,
                    0x2c3a95e9638b30d4,
                    0x0065fb58f069b7eb,
                ])),
                Felt::new(BigInteger384([
                    0x0bce88102ad86ff2,
                    0x7a249901841c5d4b,
                    0x5ef11f8d86b81c58,
                    0xfd5a03b60a63da2b,
                    0x5cb4d3f2b35cf73b,
                    0x017920133df12606,
                ])),
                Felt::new(BigInteger384([
                    0x8dc8e251d296e030,
                    0xf24f382a0ed5fcb5,
                    0xcbe60b017968882c,
                    0x2455105b058ca58d,
                    0x583491659766364c,
                    0x00ff424eca283080,
                ])),
                Felt::new(BigInteger384([
                    0x0347b73dc0e2f32a,
                    0xbea85df3727a5a83,
                    0xa4cd3881ffba6ca4,
                    0x324fc788e5a8fd7c,
                    0xff373c1b4a1891f6,
                    0x000cec9c5a56e3a3,
                ])),
                Felt::new(BigInteger384([
                    0x2ec8bd8a85a93df2,
                    0x1bc0cbd033ef4e9f,
                    0x7e4823b36b7f16ac,
                    0x941768dffe8a7865,
                    0x9dcc3ad078c4953f,
                    0x013d458936ee392b,
                ])),
                Felt::new(BigInteger384([
                    0x222106e98e812181,
                    0xdf4553bca9a1d2e4,
                    0xcf668b2282572bb4,
                    0x174a0a7c48d4e4b9,
                    0xd343ecaa6b0411a9,
                    0x00923ef2c3d2f752,
                ])),
                Felt::new(BigInteger384([
                    0xd148531f3fbb81be,
                    0x96bb44b745764906,
                    0x4dc8575da4b3c790,
                    0x9b430c717e6ebd3b,
                    0xac4c79b940c691c3,
                    0x0090e7dfa2f7f0c8,
                ])),
                Felt::new(BigInteger384([
                    0xd44a5910d363c92e,
                    0xca6dc32b66036549,
                    0xa962d350a5891499,
                    0x41121e7bde89214d,
                    0xaa4e22c88335e1d2,
                    0x001c701b03e1b834,
                ])),
                Felt::new(BigInteger384([
                    0xfc5feb10afbf1b76,
                    0xc4868aec5b2b2f8b,
                    0xefaf3e0f5338553e,
                    0x70823f5443169910,
                    0x92886c93b942d69e,
                    0x00898924ee867dad,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf74c2db6ae592c9a,
                    0x07831a8eb446d7c5,
                    0x6002789b5635b979,
                    0xc153095ff2e2167c,
                    0x16ba1c08ec463273,
                    0x01463959a6eacf22,
                ])),
                Felt::new(BigInteger384([
                    0x7c062230a89bd63f,
                    0x75b11134ad952ba3,
                    0x19cbea6f87665981,
                    0x20584d47cb85abe4,
                    0xeb8b79a11489beb6,
                    0x00528331e6cbd5fd,
                ])),
                Felt::new(BigInteger384([
                    0xfc4e8134b5df1f94,
                    0xd3fafa984416a7ca,
                    0x22abbf7971bc7513,
                    0x0506a30cb5c63ef1,
                    0x07db377f1e44a56f,
                    0x00e6a02c8bd15201,
                ])),
                Felt::new(BigInteger384([
                    0xaae5c1c4fee0a96c,
                    0x51e4d677eb9b8290,
                    0x766adec2ba2d4480,
                    0xb3a51b8d3263f182,
                    0x1f5d5313ef9ece57,
                    0x00732e02fc0bc8c6,
                ])),
                Felt::new(BigInteger384([
                    0x0a0095a2a8f59a53,
                    0x8a873cee351c0247,
                    0x307fbc202e3bfc0a,
                    0x673e6bb8705de53b,
                    0x7f741c17484194cb,
                    0x0028d60bac2998ce,
                ])),
                Felt::new(BigInteger384([
                    0x6e9607574e43e5f1,
                    0xfa81c56550639dc0,
                    0x877fb1a2985c3674,
                    0xbd1d9d70ba56876f,
                    0xf9748ffa42b2a177,
                    0x00d00e824d8d53e3,
                ])),
                Felt::new(BigInteger384([
                    0xe945456bc07ba36a,
                    0xd18a93c433d12365,
                    0x66584d322f8ae9fa,
                    0x2f87987d67bd2b4a,
                    0xe569c3334073b021,
                    0x00310d30357ea42f,
                ])),
                Felt::new(BigInteger384([
                    0x4f4f992efdc3e3b0,
                    0x1a1a6f0ee56b4a12,
                    0xdb8128c065c410d1,
                    0xbb2ae169a7cf1496,
                    0x1ccd45df32d31b55,
                    0x00fbae551041f2c8,
                ])),
                Felt::new(BigInteger384([
                    0xd8817e5acd6d25a8,
                    0x1ada8df1540f81bc,
                    0xe86730f6a7150f08,
                    0x8c2c2c1ec6533ff8,
                    0x914df5e6a56de28f,
                    0x013feb491db744c6,
                ])),
                Felt::new(BigInteger384([
                    0x89d21f15df25157a,
                    0xa82d3b7dddc897fe,
                    0x2ab58bb4c29c166b,
                    0x884883d3480f76aa,
                    0xba1842c9047c700f,
                    0x018d6c2f9fac3989,
                ])),
                Felt::new(BigInteger384([
                    0xa9c10f85c7819969,
                    0x1ac05b46c5cb4648,
                    0xa68d8bf4030b2cf2,
                    0xd190095aaffd5cb0,
                    0xa15d741ec5665ebf,
                    0x00f556cf6284b6b9,
                ])),
                Felt::new(BigInteger384([
                    0x62d3e1b7ea43f898,
                    0xbae680259a556546,
                    0x338f8909e2b38b20,
                    0xfb81f4ac23189faa,
                    0x3613d1c13218b039,
                    0x0103bf7c7dab8598,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x47c3c3c0e8815205,
                    0x12d270d4974bf6c5,
                    0x8849a7b683dee026,
                    0xe89957470ff4701f,
                    0xcaf1b1fe669a8467,
                    0x0047750d2e593516,
                ])),
                Felt::new(BigInteger384([
                    0x1d311c9bc007c43c,
                    0xb01b75b521e38afc,
                    0xeded20f574753048,
                    0xad18eeeb24724795,
                    0x5befca905760cd4a,
                    0x006264ee23c15d58,
                ])),
                Felt::new(BigInteger384([
                    0x574d4317d5286b02,
                    0xee7de3bf36e62344,
                    0x1bea281dbc7e4d88,
                    0x91b65bfd248922fd,
                    0x2ed13c3277129427,
                    0x0050b51e3df243ec,
                ])),
                Felt::new(BigInteger384([
                    0x719fff59fc891379,
                    0x62b89a57c2ac45de,
                    0xcdb3b9f378dca5ff,
                    0xaed041255af14282,
                    0x84937f3793a37036,
                    0x00cb58a79db57018,
                ])),
                Felt::new(BigInteger384([
                    0x82d949dfd966fcad,
                    0xd8c7e0fa762cd964,
                    0x5d8b535404858af2,
                    0x46d987d95db0802e,
                    0x4c130cc447028d0c,
                    0x000644ad1120260f,
                ])),
                Felt::new(BigInteger384([
                    0xee2786a3718393a3,
                    0xdc3d600abf26821f,
                    0xfe85582737d5ed99,
                    0x871406fff1e1c764,
                    0x419d52073b800645,
                    0x00d1906e8ce5dcb1,
                ])),
                Felt::new(BigInteger384([
                    0xc63ecd5c6b2b67e7,
                    0xcdcd741cc451e2e5,
                    0xbdd90e0200f6a36a,
                    0x2c011eb10090b6a7,
                    0x36319342ca92d138,
                    0x003d5da29f991fcc,
                ])),
                Felt::new(BigInteger384([
                    0xa3c1ac10cd24c7f5,
                    0xfd354166476f3189,
                    0x3807704d9bbc99af,
                    0x1f2335b401a86977,
                    0x8da209515d1846cd,
                    0x01a0fbcf31039a23,
                ])),
                Felt::new(BigInteger384([
                    0xd159f410df43186a,
                    0x88cc79b4a9d9e657,
                    0x328f8397fd1d1acb,
                    0xe1e18a968075ab88,
                    0x033f686ae24efd76,
                    0x0043925110c6bfca,
                ])),
                Felt::new(BigInteger384([
                    0x61746702f2ee3f83,
                    0x04125668daec506a,
                    0x0dda9f207d723e8c,
                    0x4a0bd8074430a2f5,
                    0x42d0b5cd57cdc90f,
                    0x014422aea40aeb6a,
                ])),
                Felt::new(BigInteger384([
                    0x6077b47c2dabd9ea,
                    0x64655f67266bc5d1,
                    0xaa1af19a8a572409,
                    0x4465dc681c652285,
                    0xd3149d0b13b13f55,
                    0x000040e424f3a168,
                ])),
                Felt::new(BigInteger384([
                    0xde75a20cade18de6,
                    0xcbf4018dced0c618,
                    0x991270d38201a030,
                    0x03ec2ac5fc20e093,
                    0x14355c33fdb4712a,
                    0x010f21a627484174,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xcc9c2745fb000581,
                    0x108188dcd3e39861,
                    0xb18ef15e202be43f,
                    0x9a34ab56305a4221,
                    0x5f5f1b1b6566fac5,
                    0x014d1e3ec1225587,
                ])),
                Felt::new(BigInteger384([
                    0xd0715fd4fc686509,
                    0x872d2d79cad08611,
                    0x80d68a974621766d,
                    0xaf6b587bae60700c,
                    0xa6cc8519d79095c1,
                    0x005c7abb0e551f79,
                ])),
                Felt::new(BigInteger384([
                    0xccaeaa51a04b9383,
                    0xa3c01a92c97e87e0,
                    0xc4456ee5f92a9044,
                    0x9e6de577984e0448,
                    0x0912f0b9cc4f5e54,
                    0x017cf38db8b8d36a,
                ])),
                Felt::new(BigInteger384([
                    0x85b9663773aace3e,
                    0xe7d55aea001e3a64,
                    0x5f93b9336c3c662b,
                    0xb2657f4836929fb6,
                    0x18c3ad839a7fed5a,
                    0x017cd010765467f0,
                ])),
                Felt::new(BigInteger384([
                    0xbc848a12f96249a0,
                    0xc3348d06b3276fc0,
                    0x2a079100a4378db0,
                    0x8b6ffc072e0d1daf,
                    0x674bca3d3c39af10,
                    0x00ff8640e812d279,
                ])),
                Felt::new(BigInteger384([
                    0xd13c6075720b0b7e,
                    0xaa815fc4ded9bc12,
                    0xd2a01da26274c9ce,
                    0x3120732901aacbdc,
                    0x617d2901b489ea65,
                    0x00077527dbf24fda,
                ])),
                Felt::new(BigInteger384([
                    0xfee4eee17afaaa25,
                    0xb749037330f8180b,
                    0x571f305b8ea941b4,
                    0xb15be2942c91b73a,
                    0x97fb602d02eb5100,
                    0x00f6ae6cc3e17d8a,
                ])),
                Felt::new(BigInteger384([
                    0x700c426c65c0a4d2,
                    0x8c318a9b27539ed4,
                    0x61ecb3c1b0a815d8,
                    0x81e43302ec2d5bfa,
                    0xc26bb839a4291cc4,
                    0x0198d8a771f33011,
                ])),
                Felt::new(BigInteger384([
                    0x6c4fb8aa7b7aaaf8,
                    0x499e5a348abe0237,
                    0x38f5fbfba7125996,
                    0xa0ef52ac00ed1b1d,
                    0xccae6c73fe39e20d,
                    0x0062aefa188b4a65,
                ])),
                Felt::new(BigInteger384([
                    0x790062be4d2e4982,
                    0xd19c204a88e6f2e4,
                    0x19ce5472a7edb5b1,
                    0xaed4d7b6e58d9c8b,
                    0xc7003fcabaf0489f,
                    0x0113d443c0c0d784,
                ])),
                Felt::new(BigInteger384([
                    0x65a0070f6544551e,
                    0xc0b33e1a662f0ad9,
                    0x5978d7cec8e6cd2b,
                    0xa098fdcbdc9df579,
                    0xa884dac3e4a32cb8,
                    0x016b1974bba6bcf8,
                ])),
                Felt::new(BigInteger384([
                    0x47366de17e091336,
                    0x60de442e78bf77a0,
                    0x17ecb960671aedb9,
                    0x10a1a79566dd8a88,
                    0x5fa5bc6ecead502e,
                    0x006adf192953e340,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xeb2a9b33ac1f4e4a,
                    0x90da667b20d4d935,
                    0xd2594fbc40378d0b,
                    0x7f4a0f08501421ed,
                    0x0c94bbee3c31a29b,
                    0x01295f103266d87f,
                ])),
                Felt::new(BigInteger384([
                    0x9dc58f4a536657f3,
                    0xe5b547004e7140ab,
                    0xe29b385da0e5aa55,
                    0x18d6628f56e96e15,
                    0xdd06cd28c3850682,
                    0x0123aea6c80cf707,
                ])),
                Felt::new(BigInteger384([
                    0xf438476dbb5b2d08,
                    0xc04ffada790ab1fb,
                    0x09e3d91f7d8b49a5,
                    0x8e44bb9bc262e466,
                    0xb4c7c1d2517a15ac,
                    0x0134eb7254dac997,
                ])),
                Felt::new(BigInteger384([
                    0x7a72ca0d4a2a2147,
                    0xe72c8e5b358806de,
                    0xca02674eae1920e5,
                    0x74d0277c41f7bc33,
                    0xf24805fd4881aba6,
                    0x00934a6aa0a7a7e7,
                ])),
                Felt::new(BigInteger384([
                    0xcce0b64b81610061,
                    0x278e6a2f52570221,
                    0x7cbaad5547995d26,
                    0xa74574abfb178276,
                    0x229ba36d1516aed2,
                    0x0017fb8f27defca0,
                ])),
                Felt::new(BigInteger384([
                    0x4c71f58f0b85d5c8,
                    0x640255c5b7c871b6,
                    0xb0a798c1e15fdefd,
                    0x240aca5604648dcd,
                    0x7a198cd9861829c2,
                    0x005cf8318ce71cd2,
                ])),
                Felt::new(BigInteger384([
                    0x12cc731c498568a0,
                    0xd3932e3286f04dde,
                    0xa12a874e75e913c9,
                    0xb9a5678afc0ff73e,
                    0x904c89130417e8a8,
                    0x00ac7fb282b35396,
                ])),
                Felt::new(BigInteger384([
                    0xa609385303e0fd5f,
                    0xe92b19119f03dbb8,
                    0x3e695a668c353db1,
                    0xddd68ca89e7af5a0,
                    0x48702feca21a676f,
                    0x01202619fb0020e8,
                ])),
                Felt::new(BigInteger384([
                    0xdd3d6cdd26d6777b,
                    0xa2c8b5f67e11e16a,
                    0xb6dc30d27f6a0382,
                    0xff89942451a52949,
                    0x38bf37815c278aa3,
                    0x002c12b2b70e2bf1,
                ])),
                Felt::new(BigInteger384([
                    0x08ee31fc3656e851,
                    0x824d912fcc7d22b4,
                    0x7e7f0aa2c3a2209a,
                    0x8363b18bbb0a3816,
                    0x7cfa7792752d39f1,
                    0x003969673416cb49,
                ])),
                Felt::new(BigInteger384([
                    0x0aca1f318e11b262,
                    0x31cb3faa7f0de524,
                    0xe16351a2ef38b24a,
                    0x34a96034e9676a8b,
                    0xd349e44358facb8e,
                    0x01331e305be46ae9,
                ])),
                Felt::new(BigInteger384([
                    0xb2960cb8f5f0736a,
                    0xdead76139f25ecad,
                    0x781c1eb3ee0e8c18,
                    0xaad938e1cdce9dc0,
                    0x7812e96b2b4c8b0c,
                    0x00ae50c0d698ff54,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x3b365053108db051,
                    0x45dc81a7ee4f1945,
                    0xf601d4f7545c1344,
                    0xa211746193c2a80d,
                    0x72ccd871d324d423,
                    0x000a643cb620f9c1,
                ])),
                Felt::new(BigInteger384([
                    0xa8356f660f8fb043,
                    0xb8be36aee9dd0456,
                    0xfbd0a3d2ec423f15,
                    0x85a254bc776d5aa5,
                    0xf3851102961ae2b6,
                    0x00506ef3d2e963f1,
                ])),
                Felt::new(BigInteger384([
                    0x50cd93e40f068ae4,
                    0x2cb93273f1d88f55,
                    0x80aa5bce9b58307c,
                    0xf45fd9a9eb58f27c,
                    0x266c85f017296028,
                    0x01268ce130ac4741,
                ])),
                Felt::new(BigInteger384([
                    0x49ac2b6acb1b3922,
                    0xe1a8fdbdc6e008e6,
                    0x423e6091d0324821,
                    0xa16f66af663fe502,
                    0x2d606fc746725fc8,
                    0x0062e1527c4057c7,
                ])),
                Felt::new(BigInteger384([
                    0x34702121feeb244b,
                    0x09fc15c4400431a2,
                    0x906b629615427a52,
                    0x22061980b228b950,
                    0x7f0e6449e897ad42,
                    0x01384e71d40d62a6,
                ])),
                Felt::new(BigInteger384([
                    0x42abb97b3760ffd2,
                    0x3f326eb5e07e1bc6,
                    0xb42dabe3b6e82ce9,
                    0xbea6b8e87b934043,
                    0x8fa86cd7643f0fb1,
                    0x0089d6d862c7c0de,
                ])),
                Felt::new(BigInteger384([
                    0xef1831fcea778e5d,
                    0x784270d0f857c7c8,
                    0xf40e12efa49178a3,
                    0x40567f5001843bef,
                    0x74a1ccce6390b780,
                    0x002b8c71572c0960,
                ])),
                Felt::new(BigInteger384([
                    0xe01472ebc696e0a2,
                    0x91659069db4b0e68,
                    0x5cf3bbb84f182410,
                    0x1f2facfb3b10bc41,
                    0x18e6813cf3a864b4,
                    0x01043fe38fd27a6a,
                ])),
                Felt::new(BigInteger384([
                    0x36d6e0d8e52c17ff,
                    0xfc47b306ed04706c,
                    0xe450bbc75e2ff9ac,
                    0xfaa88cb04b5bf909,
                    0x9a517f41e2a72087,
                    0x0059687bbdd541a5,
                ])),
                Felt::new(BigInteger384([
                    0x3316aa527f5a6da2,
                    0xb7ffd7012e1682e8,
                    0x0599181053f07011,
                    0xd0ea07ad83ce71e1,
                    0xbeedb639ebb88a11,
                    0x007fe6bb9e278adf,
                ])),
                Felt::new(BigInteger384([
                    0xd5b99978bbf038f1,
                    0x04eb4f2fc325e577,
                    0x174e4a72e3edd212,
                    0x660230a7f9610021,
                    0x083cdca010df9db3,
                    0x009e8c372c4be9d3,
                ])),
                Felt::new(BigInteger384([
                    0xda72b61b91f09173,
                    0x89d860331584d5bd,
                    0xdeb03bc7c9fab083,
                    0x94db9f11b32af5ee,
                    0x91409e6047f45005,
                    0x0156d7de0642a787,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2a3a768f47d664db,
                    0xc41a8ee2c8f89c8d,
                    0x1f627134216587d5,
                    0x3606b63da7f107f9,
                    0xe670bdf9d67d1c4a,
                    0x008ff9b077bd3aff,
                ])),
                Felt::new(BigInteger384([
                    0xe8ce1de95474d552,
                    0xb67682a4c8b00d30,
                    0x9f4f7869596c31b0,
                    0xfd0f7eea04d255fa,
                    0xeb53d0c57281ddd8,
                    0x0089aa209146bef3,
                ])),
                Felt::new(BigInteger384([
                    0xf93b6086c1e8275c,
                    0x8cc065357cc5e4fe,
                    0xafc9f2573921985a,
                    0x87afe0ce7867e530,
                    0x55d1adceba891ea4,
                    0x0000dc116a068bb4,
                ])),
                Felt::new(BigInteger384([
                    0x7d2bef03ee60e28c,
                    0x7a6857269eea4617,
                    0xaee9aecee2abe98b,
                    0xef0b80d4f0336e18,
                    0x5d4388d691bca1cc,
                    0x00f07078bb0f53c0,
                ])),
                Felt::new(BigInteger384([
                    0x1dde35d692c07e83,
                    0x446dbad62aab11d5,
                    0x6bade4675803ae8a,
                    0x5c462eb1fdec9f07,
                    0x2829df2a3b23fe5f,
                    0x00c2dc0efd8218cb,
                ])),
                Felt::new(BigInteger384([
                    0xc8d2868b39b4233a,
                    0x36b1543147c2f982,
                    0xd9f38475f60158ac,
                    0xe045b082c46a20a3,
                    0x9e16aed1eb733036,
                    0x01232602b3012a5c,
                ])),
                Felt::new(BigInteger384([
                    0x3d92bec00ab209f5,
                    0x4ecfdfea75e8418b,
                    0xf407ddac1323adb6,
                    0x2c9ad3d863431c87,
                    0xab637ca763c6b8d9,
                    0x0021b93642d0ce31,
                ])),
                Felt::new(BigInteger384([
                    0xe1aa3509a3b53b35,
                    0x5d10dc94f23faa3e,
                    0xbc30b8b7db4702b7,
                    0x301d3ecce785675c,
                    0xa9f9c828d06b7107,
                    0x0102628c1178e10f,
                ])),
                Felt::new(BigInteger384([
                    0xad9a27ac85b82c8e,
                    0x7e1216e0469ffb8f,
                    0x8c823c84abaad707,
                    0x429180d59b935a9b,
                    0x8ed5668d91153144,
                    0x010411ca6c7cfa2d,
                ])),
                Felt::new(BigInteger384([
                    0x6dbe06154b7f30c4,
                    0x43b7c14ee9072927,
                    0x235e7d90fbb026af,
                    0xccd0230b45fdd51a,
                    0x677c292b793d5538,
                    0x00d21cff0500d2fd,
                ])),
                Felt::new(BigInteger384([
                    0x02ec747959d97fb2,
                    0x7b24d4bcaaebf432,
                    0xc95dba2794572639,
                    0xef26beaba46896d5,
                    0xd64ccb9f5f9c833f,
                    0x01164ff6e015b64d,
                ])),
                Felt::new(BigInteger384([
                    0xa39fe8deeb35ff94,
                    0xabd4279bb17c7c09,
                    0x5f399720187133ac,
                    0xb2a929db1c34c13f,
                    0xecf7841f907e6657,
                    0x0023c6b5e9d7ada8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe5a9298dfea56288,
                    0xb4526ecbe901d078,
                    0x7dfd2b3137ba4b28,
                    0x91f79b685ce8db16,
                    0xe03a7f889e03e904,
                    0x01a015115688512e,
                ])),
                Felt::new(BigInteger384([
                    0x12f163c5b4a46d05,
                    0x80c4b884205881d1,
                    0xfda7b63e568a7ac0,
                    0x9daa2a420a95a59a,
                    0xefda21d10b4d7c53,
                    0x00e840be48903528,
                ])),
                Felt::new(BigInteger384([
                    0xb5ef8d08b77ff675,
                    0x36c86536f0aeb1a8,
                    0xdbbaf58237bfc2fb,
                    0xbd41bb193e3b9965,
                    0xab2c079c707762f2,
                    0x01359f746ffd15a0,
                ])),
                Felt::new(BigInteger384([
                    0x776f05c342c9d136,
                    0x739a91f07fc223ef,
                    0x60ce093882dc6f7a,
                    0x17a10de31f788972,
                    0x069ae093b47831dd,
                    0x0076dca12045c9b6,
                ])),
                Felt::new(BigInteger384([
                    0xd5ceec4be712532e,
                    0xef91dd5bbaed6fde,
                    0x882d77ee709a1086,
                    0x2cf8efa9e5a34500,
                    0x9c64ccbc5e0a5be1,
                    0x018dc07a48f1dd18,
                ])),
                Felt::new(BigInteger384([
                    0x68c095ecc48e8adf,
                    0xfd2020807cf474bb,
                    0x514029e122e2cecb,
                    0x77ea02d8d565647e,
                    0xafb3427f4d3162f1,
                    0x009d03f5aa21337f,
                ])),
                Felt::new(BigInteger384([
                    0x993e6f1af4f332ac,
                    0x4617c89a2347c19f,
                    0x15034d81a4f4ae6b,
                    0x9dca79a499e5ac5e,
                    0xe11e6f9dfe97f969,
                    0x00032a06e4ba072f,
                ])),
                Felt::new(BigInteger384([
                    0x58605334194c9983,
                    0xbc23f45747eb8ea1,
                    0x1794233023da32c5,
                    0x0db7778cf131951e,
                    0x9afa3e431c7121a9,
                    0x00d96ed952d86194,
                ])),
                Felt::new(BigInteger384([
                    0xa2fd305a8ee6cdb9,
                    0x216480de0f76d3c7,
                    0x5fb1db37fdb7461c,
                    0x28ba70904c82ffc7,
                    0x1f0a34097f3aaf9f,
                    0x0194d48e769d8e9a,
                ])),
                Felt::new(BigInteger384([
                    0x136c9520d6b8a6fe,
                    0x491342bce364eb42,
                    0x927031bd875d6331,
                    0x69712b8757057c7a,
                    0x4df963ab263781c9,
                    0x009dd772d7ac0dc9,
                ])),
                Felt::new(BigInteger384([
                    0xb0e4cd1f8ac50a33,
                    0xc1a909d1d148eede,
                    0x6bf3d4150e4be0e7,
                    0x72cd8d1d49ae8a23,
                    0x5b7065105a3b6785,
                    0x0138ebfe52693054,
                ])),
                Felt::new(BigInteger384([
                    0x3942112bb09f4bd2,
                    0xd03baf1d40b00e2f,
                    0x2ac0602f89804fcb,
                    0x378fb5677b03c9d5,
                    0xeed0229fced5aa62,
                    0x00552bc542b0d7a6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe913e7e9efcc1c95,
                    0xf2e1ecd4945e65c4,
                    0xbe17c7dbd040b5ee,
                    0x9f401a71b9f10f42,
                    0xd1fbbc3096c915a6,
                    0x009cbbf601bf79ff,
                ])),
                Felt::new(BigInteger384([
                    0xcc2ed1f9efe0be50,
                    0x4e2a7060d7699d00,
                    0xe5deab214d7651eb,
                    0x549258af120cec95,
                    0xa3a9f9115f727b58,
                    0x0198a442cb829840,
                ])),
                Felt::new(BigInteger384([
                    0xad306cc0adfec8c9,
                    0x110cbc01b45be6d0,
                    0xd757bf2baf6adb77,
                    0x2c57337a261de5c2,
                    0x1faca03dd0e1806d,
                    0x01a3253473e6db7c,
                ])),
                Felt::new(BigInteger384([
                    0xea005c0a9f96273b,
                    0x449571b752736189,
                    0x24b18621b7bc4554,
                    0xe704c2595ab2ff4f,
                    0xbbc9d984348eb99c,
                    0x015b26eadea25fbb,
                ])),
                Felt::new(BigInteger384([
                    0xd2804a6c36c941fa,
                    0x7ce22e1a4ab8a23b,
                    0x39e08573060a7e0f,
                    0x3d66ba2160252fff,
                    0xda186cf035c3c508,
                    0x0146a43e041c54f2,
                ])),
                Felt::new(BigInteger384([
                    0xf80e098dd4583e98,
                    0x5a76566c10b864b9,
                    0x2a9171af84214202,
                    0x1c171d472f2bc34f,
                    0xac72365ba70caeb0,
                    0x000a9ea17d8434c5,
                ])),
                Felt::new(BigInteger384([
                    0x1075d741de9c9e58,
                    0x512a358a7d91fdb5,
                    0xf01a1882a9e16126,
                    0x1a9856b25155556a,
                    0x9bcea69575572155,
                    0x004c8f227f7f2d5e,
                ])),
                Felt::new(BigInteger384([
                    0x5367b4ee8e4ba0f7,
                    0xa38d7a8c62ec33c9,
                    0x42e3bd5018b19199,
                    0x21b39a9afcf580ab,
                    0x3e20f7491ab15de2,
                    0x0125f0e3421875d5,
                ])),
                Felt::new(BigInteger384([
                    0xc2af4c5850bd3e56,
                    0x3d4b9048c9fd8cb4,
                    0xf3060c7d432df1cb,
                    0x9e7ac50d43c75561,
                    0xfc4c853a80ec991d,
                    0x012575bb2e86d17b,
                ])),
                Felt::new(BigInteger384([
                    0x6ea74201cdfc8891,
                    0x875f327530e03ed5,
                    0x132d5216c1f7dadd,
                    0x1b3091bc84277ad9,
                    0xd1f14d3b02cca593,
                    0x00179b15ddbfbe12,
                ])),
                Felt::new(BigInteger384([
                    0xf2ecae81c01677e1,
                    0x0523625df58714b0,
                    0x02babb88418f3c7c,
                    0x3e4c5e54b4e81eb8,
                    0xe5f3b975b5e3e097,
                    0x014854b9903fee42,
                ])),
                Felt::new(BigInteger384([
                    0xe12089be23e40499,
                    0x5455a7b85941aefa,
                    0xdf6834e1099f768d,
                    0x59cabd91300b6a37,
                    0x16edbd278bf0abb0,
                    0x009069047bc6b176,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2e2cf8f5f9983682,
                    0x528c160150cd33b6,
                    0xf0b5ee002a329758,
                    0xe69e7b15848b417a,
                    0x59131dc970672b17,
                    0x00644cffaf184428,
                ])),
                Felt::new(BigInteger384([
                    0xd245dae03db2ba25,
                    0xaaab732ab16276c2,
                    0x8dd441c22674d761,
                    0xadab4cccc7354c81,
                    0xfba6c06b8fc25fb7,
                    0x00dbddc884404c24,
                ])),
                Felt::new(BigInteger384([
                    0x3519117d05a1066c,
                    0x2b6c8fb2b3650a1a,
                    0xfe6dafcc3063f1b7,
                    0x2dfb9000c98773c3,
                    0xc1bb0c4ae4aa9aca,
                    0x01367072afdfef86,
                ])),
                Felt::new(BigInteger384([
                    0x6a2085eceea717cc,
                    0xe31d883c7e49d3e7,
                    0x36a42b417d0eedc5,
                    0x0d5c69a6d5c80486,
                    0xe6565440a8809028,
                    0x019db5a8e16b37ac,
                ])),
                Felt::new(BigInteger384([
                    0x90bbf3930cffd5ed,
                    0x5172fe4a5c3ff999,
                    0x21a1e9400f08f57f,
                    0x023229d46194dde9,
                    0x23c2a1ee40a17eea,
                    0x0180cba563274e72,
                ])),
                Felt::new(BigInteger384([
                    0x54f3a38485177eb4,
                    0x5ca60fdf9f400547,
                    0xbeb765384ee7ac35,
                    0x05be51c5ed22520e,
                    0xfd05e13cd67a20a4,
                    0x00c10d8fcc6d3152,
                ])),
                Felt::new(BigInteger384([
                    0xa684c384f8adac2f,
                    0x5e48b299b6473fea,
                    0xeeb8704760b70994,
                    0x48b13685224111a8,
                    0xa774f7c82714b1bb,
                    0x0018da087dca098c,
                ])),
                Felt::new(BigInteger384([
                    0x06607cc4500c65bd,
                    0xc6243b52347be734,
                    0x3c594cfc2f8fcc18,
                    0x8bfa446a09526854,
                    0x15a8b3b1eed3f1ca,
                    0x011e330fd90709fb,
                ])),
                Felt::new(BigInteger384([
                    0x0c9fe9f06688836c,
                    0xd359c2fa73a28d5a,
                    0xa1edc56f2a464d5a,
                    0xd2f13d77c9715301,
                    0xf7fd4d4219be78a1,
                    0x002d08cf8d0bac04,
                ])),
                Felt::new(BigInteger384([
                    0xd259582310c7d2fd,
                    0x04ebadb317d7e283,
                    0xf9452604452265c4,
                    0x74c10d9a256a8736,
                    0xa679a1c81dd8fcce,
                    0x00028a03b5499ba0,
                ])),
                Felt::new(BigInteger384([
                    0xd0d780edbd9bcee5,
                    0xa77c8acbb176c280,
                    0x4e4316aa81c3d510,
                    0xf37e70dbdd8035cf,
                    0xc4efe01e4ac9e1a4,
                    0x00bbba38c189fb26,
                ])),
                Felt::new(BigInteger384([
                    0xb3463e17ad2f04d5,
                    0x73a752796be4148d,
                    0xfc3486a5c8ca59db,
                    0x7102e0431b8fe748,
                    0x94507a50b0c36592,
                    0x00f049ec9a113fdd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x9e07df877285308a,
                    0xe4610795cbe14d27,
                    0x7e6492742453a42c,
                    0x68c9c8c14f83d518,
                    0x3b94d52bb44356b4,
                    0x007b53a5d3f48009,
                ])),
                Felt::new(BigInteger384([
                    0x766c0ef0da6185e7,
                    0x9625319d852efaa0,
                    0xf973f8bce0fd4796,
                    0x2808d2b085ddfe0d,
                    0xdcb319a364fe9bea,
                    0x01087e841a739665,
                ])),
                Felt::new(BigInteger384([
                    0x3f1d7f8da0501edb,
                    0x67fddf34c9328d04,
                    0x3a34aa6056b3fc2b,
                    0x0bafaa71b8883c15,
                    0xd3d2484d8087e761,
                    0x019ea4ce154ef641,
                ])),
                Felt::new(BigInteger384([
                    0x2b9787d6dbc5d761,
                    0xd34cc703d2f51771,
                    0x3a033553ea6070fc,
                    0xb947499c4b08e2c9,
                    0xa4716574e2b0011d,
                    0x016e5326bb9c9a4a,
                ])),
                Felt::new(BigInteger384([
                    0x9c9f3145bf635101,
                    0x9597ecd2d992fd9a,
                    0x32913b9797182ddc,
                    0xff4af1c5517d1b55,
                    0x69b3e1ecda3423a9,
                    0x0182e676e5775d03,
                ])),
                Felt::new(BigInteger384([
                    0x0f64625634bb528f,
                    0x90d344450dea9bcf,
                    0x564861ff30962f26,
                    0x28f03655c8e65f89,
                    0x885664ad20c74e94,
                    0x00a9d030e9f500be,
                ])),
                Felt::new(BigInteger384([
                    0x1dbe82c26063dc05,
                    0x0c40cda529c7811c,
                    0x51b5ff44e5d696d2,
                    0x546c4d249ac42ca7,
                    0x50a556297e99091a,
                    0x0188c621d8f42e8d,
                ])),
                Felt::new(BigInteger384([
                    0x6ecfca15b5cf7476,
                    0xcadfa214a99aed89,
                    0xe2e47dd6b7e8c76e,
                    0xebcde6cca66ff476,
                    0x0c8534a488203492,
                    0x000c4e092af062e8,
                ])),
                Felt::new(BigInteger384([
                    0xaec9a8713c2e02c5,
                    0x551c2148d311279d,
                    0x2c3c16fa8f708f36,
                    0x986799c6d8532293,
                    0x28bb54c2ad82efa1,
                    0x012f313f97b4dba6,
                ])),
                Felt::new(BigInteger384([
                    0xf6e50ceae846dcf0,
                    0xbe5f7205d82f6cd0,
                    0xe3bda6a0afe65d44,
                    0xb204ea9d045ec981,
                    0xbce7a54a58994912,
                    0x008b5b0a27beb9dd,
                ])),
                Felt::new(BigInteger384([
                    0x45aa7fe4add579f9,
                    0x54f4788b56f5bf94,
                    0xc66e19b107350359,
                    0x221bf11744cc57d7,
                    0xb1b12579cdabe7e9,
                    0x014b16b0fe08f790,
                ])),
                Felt::new(BigInteger384([
                    0x03ff9617a08d579d,
                    0x1003f8a9624fc959,
                    0x2dcbc77fd2ebc7bb,
                    0x06137e6b58edaee4,
                    0x86b6785e720c4f3d,
                    0x00f3ea09105ac5f8,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x6a76279dc07b9a23,
                    0x002a61a0cc3f8e01,
                    0x905af14436e33567,
                    0xdb80f637bed0f1e2,
                    0x367b8edc47ebcd13,
                    0x013cbe38c2d97db5,
                ])),
                Felt::new(BigInteger384([
                    0x3a340b6cf3cb98b3,
                    0x0745bd5108b79763,
                    0x141eb7cf7db4d567,
                    0xcf42039938da9db7,
                    0x780187cd7f4aa72d,
                    0x005b07956c9a7683,
                ])),
                Felt::new(BigInteger384([
                    0xc29d76a56489c351,
                    0x67ab2a622d77349a,
                    0x5f0da889141e0e10,
                    0xbff3711100f40add,
                    0x239159792d920d50,
                    0x01092072bd77ae53,
                ])),
                Felt::new(BigInteger384([
                    0xbd981ea15a55d0c7,
                    0xc76d19884dff649d,
                    0xdda3c55886b8fc95,
                    0x27264874acb1ea94,
                    0x6322ccc929703a97,
                    0x0018255fed5e0ce4,
                ])),
                Felt::new(BigInteger384([
                    0xf96cf123b3f80356,
                    0x9d0ca34ad55eac9f,
                    0x6cf6de0107f6d096,
                    0xcf150f3bbf370177,
                    0x6030b85aad662c56,
                    0x011fb87ff31eae01,
                ])),
                Felt::new(BigInteger384([
                    0xb7678772a3c2e3df,
                    0x36fd8e23063fd5ac,
                    0x37789a3e43a27df4,
                    0xcb36830d4697e31c,
                    0x5bdbe4ed58786800,
                    0x003fec45e3fa7204,
                ])),
                Felt::new(BigInteger384([
                    0x42a73316721352b1,
                    0xaad2fe3b4cd178d4,
                    0xe866d6b2efde04a0,
                    0xd7fc34e77998b7d2,
                    0x37655221a1b876be,
                    0x014b77825d400b78,
                ])),
                Felt::new(BigInteger384([
                    0x1892db7b1bf881d5,
                    0xf3bda4d238193811,
                    0xa4f755d1c6f29596,
                    0x7cbf5d77ea4a3bc8,
                    0x61b01e4f638b6bab,
                    0x0191beb04e8dae25,
                ])),
                Felt::new(BigInteger384([
                    0x5abb71c1daf5877d,
                    0x5ad8816b99bbf34f,
                    0xdb2fc390d26bcc9c,
                    0xbbc6ca2f81893e26,
                    0xfc3ffaad7c83afed,
                    0x013b46bfd5a40853,
                ])),
                Felt::new(BigInteger384([
                    0x244c93659d9e01c4,
                    0xf0429d0dc47b8fbf,
                    0x236d9c134a584d8c,
                    0x6695d367273fae02,
                    0x32c48581b9f6ceba,
                    0x01321e2352d5bb1e,
                ])),
                Felt::new(BigInteger384([
                    0xa3b170b049429b7b,
                    0xbb9dcfa47d2379c6,
                    0x4a07f8b2b998a0d0,
                    0xdf0eacc2f7ebfc0c,
                    0x3a507e8c188a1bb1,
                    0x0067f8f37e64e1a2,
                ])),
                Felt::new(BigInteger384([
                    0xde0d74be7550f2e2,
                    0x62c2fc0ff3e4b0dc,
                    0xaa72c97f032cff70,
                    0x231ef539372bbf09,
                    0xf0d47656e07d07a2,
                    0x003d6087c63a5a45,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x9061e690d3828653,
                    0xd959f5b3578ca34e,
                    0xa94298f9a2ad1d7f,
                    0xaa1b3de65e46f4dc,
                    0xcd8dfc809a486356,
                    0x005f1dcc82f8cdf4,
                ])),
                Felt::new(BigInteger384([
                    0x0d32cae9fc0cab99,
                    0x9ed68f88398396a3,
                    0xf20fd2a3a6b4a335,
                    0x7d45ab7402a22494,
                    0x7e9a3ff19d53e31d,
                    0x0056d3919a0b46a3,
                ])),
                Felt::new(BigInteger384([
                    0x12ff0f7fb1480a84,
                    0x12282dccdbb8a484,
                    0x6ab95732eb188186,
                    0x380c68dcd1044233,
                    0x763ffbea25f0f31b,
                    0x005e83c6e9d2eca9,
                ])),
                Felt::new(BigInteger384([
                    0x68aaab707f5074e6,
                    0xdcee643facd45695,
                    0xc68402941601e403,
                    0x60fc17afc0e43a2d,
                    0xb5da764f65c840ea,
                    0x01aafcfe8c398408,
                ])),
                Felt::new(BigInteger384([
                    0xb794946e559939a4,
                    0xb5389b9cf9733347,
                    0xefbe258e295e2883,
                    0x76c14ae9c2f0c8ad,
                    0x5e2d828df767a77a,
                    0x014e292c42b43b7e,
                ])),
                Felt::new(BigInteger384([
                    0x1438870c9ef10942,
                    0xae7d87c128791b0f,
                    0xae683d6b6f6285f4,
                    0x4a250d67fa4b170d,
                    0xf579554246b87f3d,
                    0x00d3512578a29222,
                ])),
                Felt::new(BigInteger384([
                    0x698bc5b64b8b3273,
                    0x3c9d6044ba84e77d,
                    0xb2e02f185c334b57,
                    0x81d7d01ac19098af,
                    0xc83f36bde9034c60,
                    0x003de65da0cc0162,
                ])),
                Felt::new(BigInteger384([
                    0x8d3ae6a397556fb8,
                    0xf9adf308a16436a1,
                    0xdd843e6a3340bbf0,
                    0xf03c2db2965a6b1e,
                    0x1644fb0c481eeb66,
                    0x009b8ef2c9a37da3,
                ])),
                Felt::new(BigInteger384([
                    0xa37f2766e69e0a5b,
                    0x0afe7a916307d037,
                    0xdaee68fea4037689,
                    0x35421e13ef77a9c9,
                    0x2b4695e12cfe01c9,
                    0x008d2b3ad2028616,
                ])),
                Felt::new(BigInteger384([
                    0x2f15989d558e8d4e,
                    0xc4eec140ae6abe8f,
                    0x71a5797b09730126,
                    0x16940c282db25ebe,
                    0xac56aa5d384b3ad6,
                    0x0089c6f73ecb8f5d,
                ])),
                Felt::new(BigInteger384([
                    0x40833eb08c7d5f56,
                    0x59211712c74f317c,
                    0xed658beb8c341c6b,
                    0x0f7e6130d32b6d39,
                    0x1e894d89076d18a4,
                    0x012f18c17edac35a,
                ])),
                Felt::new(BigInteger384([
                    0x9b1b3ebcb21009ce,
                    0xeb4c318fdfab3046,
                    0x15cc5e3e883c856b,
                    0x624f06380d18c550,
                    0x2b4301fda861bf05,
                    0x004d2b02cb1603e4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe2532c8303a3d8d9,
                    0x46f7b2965ecce2ba,
                    0xcdfd01ba46e2e02e,
                    0x56c49078121c4f7e,
                    0x93a689e2c7064d29,
                    0x00faffd3d42fba74,
                ])),
                Felt::new(BigInteger384([
                    0x32b1da3b9f742952,
                    0xd09fc7cef2d4893b,
                    0x14567f44639af335,
                    0xc54d6f0389c60a14,
                    0xbf49fd04c3349134,
                    0x00b214a461fc28f9,
                ])),
                Felt::new(BigInteger384([
                    0x7e5215caf6d0676a,
                    0xcc3dd1da7427155e,
                    0xef962f0a435f4f87,
                    0x7383989c67cfaea0,
                    0x3504562e4987f345,
                    0x0082c59842a63d93,
                ])),
                Felt::new(BigInteger384([
                    0xff06db1e465336eb,
                    0xccccc9652b66e6e6,
                    0x5cfcff67c7c268ac,
                    0x244e984396cf3e6d,
                    0xd44efeeac94561f7,
                    0x004e0824977a35ad,
                ])),
                Felt::new(BigInteger384([
                    0xde3831b8a05d713b,
                    0xd6c89018163fad2b,
                    0x8509c72dbe58ff94,
                    0xf2020b23e58f31b3,
                    0xa7243f5974b55f90,
                    0x0104cea705094519,
                ])),
                Felt::new(BigInteger384([
                    0x7a97c58677801760,
                    0xd9c9f85b2a15e42a,
                    0xd8ceb14ab6b6c6af,
                    0x223fb5733eaef886,
                    0x8ccb30347202fe8f,
                    0x01466fcdd419cecc,
                ])),
                Felt::new(BigInteger384([
                    0x90c2e7eb8841301e,
                    0xeadb54493dd3b050,
                    0x788748ce21df1b92,
                    0x69b7e8576635b8e6,
                    0x5d1759dfed3469bc,
                    0x00d2f318b550d6bd,
                ])),
                Felt::new(BigInteger384([
                    0x1b5d504828f758ff,
                    0x1660b5b67962e445,
                    0xfee0b14dcf9d2bee,
                    0x792050ed0e9595a1,
                    0xd66dccca9ab0b9ea,
                    0x0096f261129982fb,
                ])),
                Felt::new(BigInteger384([
                    0xb39354531f103133,
                    0x3976ffd2183fcafc,
                    0x7033bbfae13807ae,
                    0x47d20f04f1c24dd0,
                    0xc3612ad79f3e0110,
                    0x017f07fb150d8914,
                ])),
                Felt::new(BigInteger384([
                    0x0d9228f65246429d,
                    0xe2bfb1788d2e22e0,
                    0x6a9aa865ac8430bf,
                    0x13ac1c18d73be747,
                    0xd07cf60526646a89,
                    0x0178784017d82756,
                ])),
                Felt::new(BigInteger384([
                    0x36b1b3ae9f4d0208,
                    0xca2adee2c243fc4e,
                    0x14ba3d468d14cc5c,
                    0x41f222d77d3508be,
                    0x42fe2ea2513797c9,
                    0x012630c319c5eacf,
                ])),
                Felt::new(BigInteger384([
                    0x46fe5085ef6bcb34,
                    0x65034ee211b87810,
                    0x9b24bb28d593fb97,
                    0x6b9e49741697f064,
                    0x7b1c6df6fc16a1ea,
                    0x010e0a775060b306,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x9a4addc074019393,
                    0x183c43359c96c4e0,
                    0x8919d656437e99eb,
                    0xd0f80bd59a5c570e,
                    0x8c71239e874bc479,
                    0x00afd77da3af4eed,
                ])),
                Felt::new(BigInteger384([
                    0x22d05bcc1c48e91f,
                    0xc6b52fa3cbd28b99,
                    0x45a486652816fb41,
                    0x884d433e07bc0c57,
                    0xb1241ec69f599501,
                    0x012943a493e63255,
                ])),
                Felt::new(BigInteger384([
                    0x8e0601b49192b510,
                    0xcc0d52360c2c6ccd,
                    0x192a4e6a6d6f0430,
                    0x341bd436616a82f7,
                    0x86e5de17c69c6eac,
                    0x0123b7bb1d444693,
                ])),
                Felt::new(BigInteger384([
                    0x9395492dd5f5038a,
                    0x5def33e0200642e8,
                    0xcdb15652b8857788,
                    0x52d31d0862a1b980,
                    0xc2862e4df8f19498,
                    0x0129b5dede3d7d3e,
                ])),
                Felt::new(BigInteger384([
                    0xc8f65ba2bd87a6d1,
                    0x7fbdebdd1ab2778e,
                    0x76d11b1405bbdad7,
                    0x494d53b7d5c326b4,
                    0xf2caa02b11423366,
                    0x00a74138cbade2cb,
                ])),
                Felt::new(BigInteger384([
                    0xaff06526b2680935,
                    0x66985a9d8957f1d4,
                    0x3a1c362cced17290,
                    0xd5e072f8afbd2683,
                    0x122cd5a78ba02bdf,
                    0x01380e20beb0c412,
                ])),
                Felt::new(BigInteger384([
                    0x52e7fd953478258a,
                    0x76de26a7f55b2ce3,
                    0x9f5a9a59bd28a595,
                    0xb485548f72594c27,
                    0xf5efbb0efee88be8,
                    0x008d5ac10c574baf,
                ])),
                Felt::new(BigInteger384([
                    0x280b72b89d621e67,
                    0xc1292c5255dcf0c5,
                    0xb74edb714b8e23aa,
                    0x3fb10f9f22a2d454,
                    0x638bcc52ee57d61a,
                    0x009a1798e0422dc7,
                ])),
                Felt::new(BigInteger384([
                    0x4597bd80201b226a,
                    0x894383eef302a671,
                    0x3f9e35ef9219b25d,
                    0x2b44a3668c6bedf1,
                    0xce0a92c57e949e5d,
                    0x0013977d53410318,
                ])),
                Felt::new(BigInteger384([
                    0x901f9b84209c466a,
                    0x8187aaf0ea64c474,
                    0xf89348aeb703b70b,
                    0x5920fe7e30f27b64,
                    0x701f83053cfffcfd,
                    0x002d4bacefde03b0,
                ])),
                Felt::new(BigInteger384([
                    0x9f03924076cdf93f,
                    0x629533defd1a312a,
                    0x9f06e10f192334e8,
                    0x4bc983765001f222,
                    0x1d6fffe76817ee3e,
                    0x003e5ec744362908,
                ])),
                Felt::new(BigInteger384([
                    0x43a51c3e2eda8f88,
                    0x256f1acc65255444,
                    0xab411917453ae953,
                    0x05a600ddcb633c0e,
                    0xec1742b08e0e001a,
                    0x019b9918bdea58af,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x582ff6fb625688e7,
                    0xa382f3712e46180a,
                    0xe27ddd52883127b2,
                    0x2d59c8f269bb3f02,
                    0xc3357a6715ff2238,
                    0x018ba8ce4df711d5,
                ])),
                Felt::new(BigInteger384([
                    0x8f2013cab64f202e,
                    0x8646663441b4339d,
                    0xc0196e6093793983,
                    0x7173df014acf9181,
                    0x82762ad5985426db,
                    0x00912e95783af1f5,
                ])),
                Felt::new(BigInteger384([
                    0x47687e4481cf082d,
                    0x2bcacea99fbfab06,
                    0x65da865f8b89a1d3,
                    0xe6a76ef6b0fca919,
                    0xec6aa939fb3d63b6,
                    0x00a92c3f83be4c51,
                ])),
                Felt::new(BigInteger384([
                    0x54feb734c7920d13,
                    0xf11aaa4296c93a95,
                    0xbe862bb205d30c78,
                    0x1401f7b6a3a03c80,
                    0x5591dda1ae0a7727,
                    0x0008549415448a84,
                ])),
                Felt::new(BigInteger384([
                    0x7e1ca87929ba8f92,
                    0x50a7604aba259ef7,
                    0x976d959ae430687a,
                    0x54c858a3df118623,
                    0x384aca6a8d824e97,
                    0x00c7b5f9d0bf9c95,
                ])),
                Felt::new(BigInteger384([
                    0x79dd8622458e77d0,
                    0x5b81e619a2b9c2c5,
                    0x5d5e66ab92fdbe67,
                    0x753d394455746cd1,
                    0x08c38c06f9ab55d9,
                    0x00769dc51d3e0751,
                ])),
                Felt::new(BigInteger384([
                    0x9bba7e691558bef2,
                    0x4af32c3926a10c5e,
                    0xedbb371cbe5c31c5,
                    0xf1afd4cf0b90b4ce,
                    0x07fb7c47cc6b9f83,
                    0x01212d410a509987,
                ])),
                Felt::new(BigInteger384([
                    0xe2363b6e208e95be,
                    0x784daf06c9bab460,
                    0xb1d89a0a028e9a38,
                    0xe298d422d21c5a26,
                    0x9a285d793ef8d372,
                    0x0191c5ced3f12dc6,
                ])),
                Felt::new(BigInteger384([
                    0xa4840ce3b0187250,
                    0xc90c85328252b675,
                    0x36a46627335e8b54,
                    0xeec6a482c0243fd9,
                    0x5d07ff7cd012ab74,
                    0x008260ac38fa5117,
                ])),
                Felt::new(BigInteger384([
                    0xaa429f29fa5ef241,
                    0x30a84e61235c4575,
                    0x8d7c589db4fb416a,
                    0xe12f237e50fe6f79,
                    0x4c224688ad6446a6,
                    0x00a6dd89daf53dc8,
                ])),
                Felt::new(BigInteger384([
                    0x070c1decf5b1e835,
                    0x041095e43e293b12,
                    0x40db4ec4235e905d,
                    0x2375815066da0318,
                    0x5b8d0f13421f9af3,
                    0x0123cc6b73f1afe5,
                ])),
                Felt::new(BigInteger384([
                    0x45d0d7d982980f95,
                    0x233f62e183b4a10f,
                    0xacc5f1bb04fce945,
                    0xeb3bc3eb10b39345,
                    0xec2c3659e94612e9,
                    0x00ff5098a895878b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xa52650de9642f4d7,
                    0x0dff12e2ebdae771,
                    0x5fbc76f69d6ab46e,
                    0x1d2ed4cb6a8ec699,
                    0x90d3d2b43c7835c8,
                    0x001b3ed1c7134b10,
                ])),
                Felt::new(BigInteger384([
                    0xf491d3f5c2582ee5,
                    0xff529a172a699e55,
                    0xfd47521f21b1faf7,
                    0x7ea687d0248454ee,
                    0xcf4cd12628f180e1,
                    0x00b63c767c82196e,
                ])),
                Felt::new(BigInteger384([
                    0xa3739bd8e810498c,
                    0x3ca6cb756b0b6e04,
                    0x6146931cc5e17dbf,
                    0x433f212dc1e135ab,
                    0xa84a6aa7ad4bc146,
                    0x005c046fe629f70b,
                ])),
                Felt::new(BigInteger384([
                    0xfce7a643093838d0,
                    0xf707731b16e7504c,
                    0x3217206f5944abf4,
                    0xab31e6211a52e52c,
                    0x9124b714d4e07469,
                    0x019392e795a3e435,
                ])),
                Felt::new(BigInteger384([
                    0x5a719ac2fd67f349,
                    0xe545fab39f98b917,
                    0xb7a26d23bbe30aa8,
                    0x26edefb96fde5dad,
                    0x3e1ea6658db57060,
                    0x00e8a6c33887b7a7,
                ])),
                Felt::new(BigInteger384([
                    0x424b3bbb7ed6ab15,
                    0x08f4f947c65e73b6,
                    0x0c1cd560d09062df,
                    0x308b9c6cdceef81c,
                    0xf60b92c7c6ba5e6a,
                    0x000e94c4f10a3fdd,
                ])),
                Felt::new(BigInteger384([
                    0x1df5d7dec741d411,
                    0x1cf0ec53d74d4f4a,
                    0x10f4d427830a436b,
                    0xe7da3a64efdc4b0b,
                    0xa72d233923c1a9df,
                    0x00292c94648263a8,
                ])),
                Felt::new(BigInteger384([
                    0x81ec57b6d4fab2e7,
                    0x6a790ba223e80f4f,
                    0xceda423128ede425,
                    0xf0a2b85bf1af85a3,
                    0x359bfd1aa2c2ba09,
                    0x0092e4a44bae251f,
                ])),
                Felt::new(BigInteger384([
                    0xcff9bf33ef7524b6,
                    0x82f858945fa01e3c,
                    0xbcc43d18770b8386,
                    0x602324b30794b2d1,
                    0xba0156c7f2340b75,
                    0x015faf4c31e528ce,
                ])),
                Felt::new(BigInteger384([
                    0xe4249e51e55b72ed,
                    0x059c6da05d7a155c,
                    0x91fdbd55cd8d20f1,
                    0x0f95c92853011470,
                    0x9d6fc6ae817ef645,
                    0x011a97485414e201,
                ])),
                Felt::new(BigInteger384([
                    0x6b74d8d2af7ac894,
                    0xa07a9a6737dc4f11,
                    0xbce6a19f74a00821,
                    0xc0eb9f2ff15f7e3d,
                    0xbc37a14a8dcab51b,
                    0x010b67e096305163,
                ])),
                Felt::new(BigInteger384([
                    0x31713ddc94543c0a,
                    0xdb53c86e9dff0eb8,
                    0xe6bd51f522d42816,
                    0x8105fa413eb0a848,
                    0xe72e6c92775e6e4e,
                    0x010280babcd3cb6e,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
