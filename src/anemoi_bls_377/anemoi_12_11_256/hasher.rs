//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 47 == 0 {
            bytes.len() / 47
        } else {
            bytes.len() / 47 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 47-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 48];
        for chunk in bytes.chunks(47) {
            if num_hashed + i < num_elements - 1 {
                buf[..47].copy_from_slice(chunk);
            } else {
                // If we are dealing with the last chunk, it may be smaller than 47 bytes long, so
                // we need to handle it slightly differently. We also append a byte set to 1 to the
                // end of the string if needed. This pads the string in such a way that adding
                // trailing zeros results in a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 48];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 47 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        AnemoiDigest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        AnemoiDigest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        // We can output as few as 2 elements while
        // maintaining the targeted security level.
        assert!(k <= NUM_COLUMNS);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger384;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger384([
                0xb639183bd4d2a626,
                0xa5db440dbaacd508,
                0x3b958ef0788935f9,
                0x1d0b1238361a42b0,
                0x060f19ae1c68374d,
                0x019d9e7355f8fde5,
            ]))],
            vec![
                Felt::new(BigInteger384([
                    0xf31c5647577440f5,
                    0x17defbad5a5bceac,
                    0x078bb1bffa6fb355,
                    0xff72eb21cdd9ff6f,
                    0xed910c3f2bbef1b7,
                    0x0124fcf49520ebd3,
                ])),
                Felt::new(BigInteger384([
                    0x496db933766f5cad,
                    0x2de9790c5b33b134,
                    0x989faeed28625744,
                    0x4c9b4e33052ad326,
                    0x26271536a5ba0504,
                    0x00fe86aef1298ff4,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xa7708f7b1e56d177,
                    0xc5e642c039349342,
                    0x85231388bd78cfb8,
                    0xb3a3232afdd8d494,
                    0x635f670e61a96c70,
                    0x000c72c024d62f02,
                ])),
                Felt::new(BigInteger384([
                    0x94f1c58bfbf0533d,
                    0xc60eb3d18bbbbfd6,
                    0x2a068006d9e6c980,
                    0x7d539d6ad79a1e87,
                    0x121436e6746218d2,
                    0x01a2efe8d4fde60e,
                ])),
                Felt::new(BigInteger384([
                    0x05760c07b386a151,
                    0xbd88aebfd9139f46,
                    0xb93ebd91f094f951,
                    0x1e7fadc3766beae0,
                    0xcdec95c6d56e6580,
                    0x00188bff03d4d6a1,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x1a14d0d56a66aa05,
                    0x7a6d9010e8f90f83,
                    0x2787ee5f90bac051,
                    0x93c4f0a4bb00f711,
                    0xf33baa8cc999e1e3,
                    0x00cd0ade3ef9ec7a,
                ])),
                Felt::new(BigInteger384([
                    0x1cd9ee745267a2af,
                    0x48b705f5333ea190,
                    0x619de84984f1a582,
                    0x746d3415e6284432,
                    0x83bbc668fd7a17aa,
                    0x0056361f5f4ea027,
                ])),
                Felt::new(BigInteger384([
                    0xa43ce869c76dbdf5,
                    0x90e561e4c85e6685,
                    0x544ec934c5a62b43,
                    0x934c737993e7ec93,
                    0x708ef1b4fde47efd,
                    0x004ced006f1b3958,
                ])),
                Felt::new(BigInteger384([
                    0x9f3d8c355e55fd66,
                    0x5d36e66b3d1dc1ee,
                    0x8053fd7f04f221d1,
                    0x466d9aab76332d0e,
                    0xa610b68103ee136c,
                    0x007c05a530e6e037,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x678b86fa6e6bdf38,
                    0x98d90fb603683789,
                    0xff8c0af6ca8fdb26,
                    0xa2552f0ecf52e668,
                    0xa1507f6203d5e198,
                    0x00fbb16ebb815d0f,
                ])),
                Felt::new(BigInteger384([
                    0xad51738328dc37d9,
                    0x12daa9d06dd2ebaa,
                    0xb4d586b3b7d550dc,
                    0xca8e61a68b85be32,
                    0x76a3f98618f1ed6b,
                    0x012aed7f44abda71,
                ])),
                Felt::new(BigInteger384([
                    0x3defd3061fa3e99a,
                    0xb26e5e40d6d5923c,
                    0x43856a2bd7015e99,
                    0x36496b7ba9e906e0,
                    0x530bffe7c24315d8,
                    0x016b93113221a5d1,
                ])),
                Felt::new(BigInteger384([
                    0x128fde7fb994e6c8,
                    0xfbec1addd3aab016,
                    0xdd752d812a643e19,
                    0x9cd7dfb8b7d88aac,
                    0x882db0a6059381ba,
                    0x00342aba8e5eaff8,
                ])),
                Felt::new(BigInteger384([
                    0x70adb448e00be9b2,
                    0xad4e348fc43b9e73,
                    0xa7fc81d6fb6d714b,
                    0x8bf1c3c9f0004e16,
                    0x28d06a1161ec403f,
                    0x0105ad33703f408f,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x2c3d04d5d711bcec,
                    0x60deed625203e07a,
                    0x9ce21f03de6170e0,
                    0xe772b281fa681375,
                    0xe31c8682349c0647,
                    0x0112b5f5d99b2da4,
                ])),
                Felt::new(BigInteger384([
                    0x1cc0c19fa420c967,
                    0x711e44f427ffdd05,
                    0xa7be4a2daa4b960c,
                    0xe017ad2e6be97a5a,
                    0x6ed11c596ec5fa03,
                    0x01077edde8a8ffba,
                ])),
                Felt::new(BigInteger384([
                    0xc0deb4399bd000e5,
                    0xc1d6c3a90952a3d4,
                    0x9165a2bb36135069,
                    0x2de356728c375d53,
                    0x34d71ed40940b72d,
                    0x007cd31245c1dd46,
                ])),
                Felt::new(BigInteger384([
                    0xd27bd26d8a73d7ec,
                    0xa73b989127600bb0,
                    0x30f2828ffc770866,
                    0xf6d994f26b9d0f0b,
                    0x487987eca15f4def,
                    0x0025458403088473,
                ])),
                Felt::new(BigInteger384([
                    0x3906d7a31960c8d8,
                    0xee40c40eabaa1867,
                    0x6b3c618de47612cf,
                    0xb62fed94c78b5436,
                    0xd60cd9f880ab7422,
                    0x009c725177517113,
                ])),
                Felt::new(BigInteger384([
                    0x8eaf83edd21b280f,
                    0xecb1de1c7399b62e,
                    0xe91f1bdcfe882043,
                    0xb3546aeceb542e80,
                    0x424d178991b804ab,
                    0x0084d44af923db0a,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x79ed1af40f4af129,
                    0x2ce5252af411fa52,
                    0x6b5f16b7b3dab78c,
                    0x8b5a987889e7fed5,
                    0x4c37357405dcb28c,
                    0x00c4133d44bd163e,
                ])),
                Felt::new(BigInteger384([
                    0x14899eda4b82f9c1,
                    0x7aa19ff198db09b2,
                    0x07dc48eaa6a34e6c,
                    0x8b4316807f6ef842,
                    0xc508a1b08cb79883,
                    0x016616f5c58278a5,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8c78ce813982147c,
                    0xa211576b481edd2f,
                    0x8f042e4f79b69a16,
                    0x6bef82e538d52056,
                    0x18994dc5a29cb74d,
                    0x0166705c87d78327,
                ])),
                Felt::new(BigInteger384([
                    0xc902d52bbdcde88a,
                    0xf2c8e0cdb194cb9c,
                    0x208620d2ce230b26,
                    0x20bfe2fd3f4b8bf9,
                    0x235510fc62e1d3e0,
                    0x00bcac59d6cad747,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xa47091331094b655,
                    0xa8e02a98c726a3a0,
                    0x535b6f7979938648,
                    0x0cb0260670adb102,
                    0x360d2f2d2be6d75d,
                    0x00de82bcd00dfd02,
                ])),
                Felt::new(BigInteger384([
                    0xfecb48335b649171,
                    0xf5430fe959f373df,
                    0x8e39f574c591b74a,
                    0x88a2bb16354aafae,
                    0x36cfb762a109e721,
                    0x017f624816a348f4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5f1d2d37e5942642,
                    0xe08b0482adcc2850,
                    0x6fb9ae32e6be1380,
                    0x84fe383dc772bb3b,
                    0x9f0a9315c03e45b8,
                    0x019e3a83f8797a4a,
                ])),
                Felt::new(BigInteger384([
                    0x176959f2be14cbb7,
                    0x11e08c9d4a1f5d60,
                    0xc9be0da683739c8e,
                    0x69c513f4778c9f19,
                    0x0737f32d75c208be,
                    0x000d0953cf53cf7f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xbb74238f1bce526f,
                    0x17ac9b69d5f99c86,
                    0x8b887dbb394bca1d,
                    0x397bea095dddae3b,
                    0x7616d7a91e428b78,
                    0x01ae26782aa94eef,
                ])),
                Felt::new(BigInteger384([
                    0x9ccadbbac1d25c36,
                    0x0261feffe531d5fb,
                    0x69dfe40cd568eb46,
                    0xb6290c24c26b2b25,
                    0x6ac453fe3874cd90,
                    0x011828314fadb4de,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7050bad2005454c0,
                    0xc4cfdf5b96598000,
                    0xab639ada5424925b,
                    0x4955f2405ff73bdd,
                    0xbcf0fe76445ecbf3,
                    0x00a082659fc441ca,
                ])),
                Felt::new(BigInteger384([
                    0x58f7757798faf175,
                    0x3bcf552556c53f2d,
                    0x69a0815cec939c9e,
                    0xa6a94edc42713fd9,
                    0x22928da742095019,
                    0x000fa90f9a72119c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x42892f271faaf4d5,
                    0xb4113bef0a376769,
                    0x7233ec88bac288a0,
                    0xc09cd48cd3d5e52b,
                    0x86c6f0a6fc58c3ce,
                    0x00f9ea58300149ac,
                ])),
                Felt::new(BigInteger384([
                    0xf7433fe400fcc7f6,
                    0xa6f4e1cf99747922,
                    0x01ad97c30f014213,
                    0xeebbd8a43bd3538e,
                    0xaa67c1111d32a8b4,
                    0x013e690eb89fd6a2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7836378c8d414bb7,
                    0x71230e93453876e9,
                    0xa3ff89155ad9d746,
                    0xeadc30dfd6bc53cc,
                    0x2b924cf72cb0be8f,
                    0x010e28a8385d74b1,
                ])),
                Felt::new(BigInteger384([
                    0x0c9018a0e68e4056,
                    0x40cc8c0ab24b96a4,
                    0xbd304d1b6eba7342,
                    0x47231c2bf487ecbb,
                    0x32ea22aaa4555974,
                    0x00f049c1bd19cec4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x07cc274d4729c271,
                    0x107063f302320656,
                    0xa65d0055071aebc0,
                    0x5d2304ccbfbf8198,
                    0x7ffcc7af56027b15,
                    0x008a6cb3d061d9b5,
                ])),
                Felt::new(BigInteger384([
                    0x4331922e06499cce,
                    0x471e455c6e936c83,
                    0x135a80083bcf01b1,
                    0x71e7caefa53fb7f2,
                    0x5eba0972f4314cba,
                    0x012d8fd16ad237a0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc11ce04a5e07a5c0,
                    0x6475b37136535571,
                    0xbe019115e8119e2e,
                    0x5195d87095e2baff,
                    0x4110c9083076d8d8,
                    0x016aef20be0230f4,
                ])),
                Felt::new(BigInteger384([
                    0x4927fb01ae289fae,
                    0x66efda49ce9dcda1,
                    0x77bdd75b629e2ee3,
                    0x915d04b33c368a69,
                    0xd09d2db21a2caa98,
                    0x00a044595c46956d,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x0772d813fc7f6f97,
                    0x44fe1a7348180278,
                    0x0036f5f64e8188af,
                    0x6468849f9043402a,
                    0x3c07519dd8badc52,
                    0x015e375b40a62ec3,
                ])),
                Felt::new(BigInteger384([
                    0x2a6d3ea0aebf25db,
                    0x0ad6fdddd610b86a,
                    0x0fc55acc37c4dc1b,
                    0xd47e16b89bd6d9b5,
                    0xc40a1c2ec13f6a89,
                    0x005cef97a606f877,
                ])),
                Felt::new(BigInteger384([
                    0xa301a5a75a5faacc,
                    0x95f32f328481eb19,
                    0x37e33a0a175016f3,
                    0xbe33e0ec4ac4ff72,
                    0x7e23239a8626516c,
                    0x004958ea973e644f,
                ])),
                Felt::new(BigInteger384([
                    0x7d242f425703ea00,
                    0x1de87451bea7020e,
                    0xb6d91667be8d7346,
                    0x11786dad6e5a104a,
                    0x681a626ceae80723,
                    0x00f9b7b68364ed14,
                ])),
                Felt::new(BigInteger384([
                    0x69dd5cbf05a86bc8,
                    0xb52ab8d1b49b8a3e,
                    0x52a6309c99951f70,
                    0x0f937e179441f90a,
                    0xef6656334b69b316,
                    0x0145faeb24003534,
                ])),
                Felt::new(BigInteger384([
                    0x9766807d085a5d5d,
                    0xaa471b78ecba8745,
                    0x5cbbccb5db7e25d1,
                    0xda0201004ffcd644,
                    0xd7aebb7d8febd20e,
                    0x01a91a66f015f717,
                ])),
                Felt::new(BigInteger384([
                    0x3e5c6fe0d6950905,
                    0x2a8c598a30f375e5,
                    0x9275cb1d669c02fd,
                    0xeb77dd680b11ef41,
                    0xa937544aba152695,
                    0x015fecb81ffafd2f,
                ])),
                Felt::new(BigInteger384([
                    0x16d3782ffd35173f,
                    0x457e17276907ed28,
                    0x33a6d3321915c867,
                    0x1145e4441952bac8,
                    0x3e11ee46261429d2,
                    0x0114c6f5c740e750,
                ])),
                Felt::new(BigInteger384([
                    0x13bc1dc8f1586c66,
                    0x2ea1bc330ed2f63c,
                    0x6172ff3653db09f0,
                    0xbe8b352142e70501,
                    0x2d390422deb7fecb,
                    0x0068abb4b120ba67,
                ])),
                Felt::new(BigInteger384([
                    0x8a3417e34e07b99f,
                    0xfc98c69bdfc599b5,
                    0x6b66a576049fd3dc,
                    0xcb43e5594e8a29ff,
                    0x2fad62f005cd8873,
                    0x0131a142b3b238ba,
                ])),
                Felt::new(BigInteger384([
                    0x2ebb1ef2d15d3a40,
                    0xf0861240109f183f,
                    0xb3b83d02333ebead,
                    0x6317bc0af3ab080d,
                    0x4e3b5f0f099ff441,
                    0x00895f637e9d218c,
                ])),
                Felt::new(BigInteger384([
                    0x1e242c0a75ab056c,
                    0xff733e83ebe70857,
                    0xebffed19e14c2b43,
                    0x0c12b147550940cd,
                    0x23e8371570598d1a,
                    0x013c78ad9086a34a,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xec01169d12a6a37a,
                    0x455e61ebd6a3a04b,
                    0xe48f22b7ff5a9da8,
                    0x9193e52264f2db20,
                    0xca10e76cd37ab3dc,
                    0x018b76167988c1d3,
                ])),
                Felt::new(BigInteger384([
                    0x6022675177bc9fd4,
                    0xe6e703c9183b942a,
                    0x025ebef91061c5e2,
                    0x140fe6c563da86c2,
                    0x1fb827ff1a9ae623,
                    0x01252ae74b428643,
                ])),
                Felt::new(BigInteger384([
                    0x0ea9d37e525ab59e,
                    0x9f4c1b3fa07df2d7,
                    0xd8f93b5ffa6a6d89,
                    0xe9d99eaad8fb6e25,
                    0x9696ea0705f0bda8,
                    0x00656cf7a71854e4,
                ])),
                Felt::new(BigInteger384([
                    0x6a59484c9ba4eac6,
                    0x4650b8f4782c328d,
                    0xc51439ee17f8b9ef,
                    0xcbd39715e7425670,
                    0xe29151882dd51507,
                    0x0173300b06a2daad,
                ])),
                Felt::new(BigInteger384([
                    0x491c3dc394ffcff5,
                    0x4c7b7ca1fb198314,
                    0xe22a256106f4b09e,
                    0x7a3fe5b38a6ef603,
                    0x77b38dd4945a0c1f,
                    0x019bfbf7b64fc7c0,
                ])),
                Felt::new(BigInteger384([
                    0x509e85ab88d01e69,
                    0xe2895d16c52db3d0,
                    0x6bae5daca415146c,
                    0x25baffdaccdac951,
                    0xcd11e508c0c7dfe5,
                    0x0055afa3d76cb4e1,
                ])),
                Felt::new(BigInteger384([
                    0xd2f7c123162e2691,
                    0x0cec6d484b250b6f,
                    0x0e5f46c61cbc453b,
                    0x065664b5b64281c5,
                    0x3c995bee2a9595b8,
                    0x00fb4b99e035b0e9,
                ])),
                Felt::new(BigInteger384([
                    0x8f76ae9931a438bd,
                    0xaae7a8cc74deaf54,
                    0xc8d3b6b45ed2cced,
                    0x5c8af2d56657e16c,
                    0x325d052d2c020208,
                    0x00fc3cb40c0d44d4,
                ])),
                Felt::new(BigInteger384([
                    0xcef5376d90027523,
                    0xa1c7e56b5bff1405,
                    0xab0d3d7c081749a2,
                    0xdd5a9e161d0ad1e0,
                    0x5e676e508d2d6111,
                    0x0182ad423a9a7648,
                ])),
                Felt::new(BigInteger384([
                    0xc022dd03f0f13e82,
                    0xefe21cddfc6bdf91,
                    0x3b6d3af5a310c0f9,
                    0x11a4edbd93164043,
                    0xfeca0d998b31dc29,
                    0x003004c07a4aeb7f,
                ])),
                Felt::new(BigInteger384([
                    0xf28dfee31a583664,
                    0x5fcf4617a98ce688,
                    0xab0c3837c65f275f,
                    0xa51666148e1895c7,
                    0x4e79804ba98f5dd1,
                    0x0173163c61626f94,
                ])),
                Felt::new(BigInteger384([
                    0x2b50a44f4ec6eb38,
                    0x650c707743e3596b,
                    0x3477033d92daa11e,
                    0x20e4c0460421def1,
                    0xda0856500905c9a3,
                    0x009e9842453e7ee3,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x9d639946a20222a3,
                    0xf041e4bca7b3f0f2,
                    0xaef7d17e14c3f2b8,
                    0x2f5a538ac2ea441b,
                    0x3a1c247579ee36ad,
                    0x00c794ef1be4c924,
                ])),
                Felt::new(BigInteger384([
                    0xb0b80d33bbfc7f9f,
                    0x14f21501c1e73cc1,
                    0xd3a281647efdd108,
                    0x87daf49d5e3bf545,
                    0x7225e53c183a4d37,
                    0x013713002b7eef23,
                ])),
                Felt::new(BigInteger384([
                    0xbd2dc4e321c1802e,
                    0x5bc6a9c69522f710,
                    0xf74618977084451d,
                    0x1a0a3db51179037e,
                    0xe12e7786ea4a0b08,
                    0x011fccf071415b3c,
                ])),
                Felt::new(BigInteger384([
                    0xe35484c84cc508cb,
                    0xef3a55fc4f034302,
                    0x6a7b4cf6554755fd,
                    0x69475e9785383231,
                    0x6fd9f02633ad5995,
                    0x00682f448ebeebbc,
                ])),
                Felt::new(BigInteger384([
                    0xea2a4e4f57ef0227,
                    0x7e49f94b1f14e228,
                    0xfb63d3f30d15f495,
                    0x4de78e6d5e4bcb94,
                    0x35e8d7301e8c3915,
                    0x016c9e637becf672,
                ])),
                Felt::new(BigInteger384([
                    0x551d6063b2266c72,
                    0x7649402a5926a533,
                    0x5921b15e1868b2fa,
                    0x5147c175ce6bc001,
                    0x6bf9cb451903a78c,
                    0x00661146bc580308,
                ])),
                Felt::new(BigInteger384([
                    0xea17fd3f81ae3b24,
                    0x19888de54619cce0,
                    0xda405750fc744e0a,
                    0xdfcd9b26222ab33b,
                    0xb3653fb2389b4e4e,
                    0x00a476d289c0cde6,
                ])),
                Felt::new(BigInteger384([
                    0x9ff91d68f7a7228b,
                    0x54cb47692c6f60a6,
                    0xba0eab246801c0b7,
                    0x7069de0477b1b778,
                    0x095dc51ab8ab1e6d,
                    0x00e66f2e44562e3a,
                ])),
                Felt::new(BigInteger384([
                    0x69bcaa843fd32852,
                    0x9284f63b5362676e,
                    0x9d13509fc23c14de,
                    0x83a3ed0b07ea7d21,
                    0x6e79ab27c44f7aa1,
                    0x017cd43e21fcad46,
                ])),
                Felt::new(BigInteger384([
                    0x97f3aa4a25f5a3ba,
                    0xe2e879ddad2f7568,
                    0x139c624c1a289d13,
                    0x6468d160d7066c6b,
                    0x9b3e6ec5b3ba0c4f,
                    0x00a0d72280dacc2e,
                ])),
                Felt::new(BigInteger384([
                    0x2f316ed32682ade3,
                    0x440e068c7ec02987,
                    0x061b7509236fb325,
                    0xcf079452dac3fbf5,
                    0xda12e2c73caf9391,
                    0x010a4b5756354cfb,
                ])),
                Felt::new(BigInteger384([
                    0x3cde299de23354e7,
                    0xe9a563961c4f688c,
                    0xc836140ea4f80d26,
                    0xba4fd97549eec805,
                    0xc1aa47722482aff4,
                    0x019cd4643396aa64,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xecaeabb0aee36cbd,
                    0x42e2df609f94d87b,
                    0x93fc83a90fdf7777,
                    0x802cb172ddd4d2cc,
                    0xf376967e101f7c8e,
                    0x0032fe1e7ceed73b,
                ])),
                Felt::new(BigInteger384([
                    0x6df500ec765df599,
                    0xdd4179a6419fade8,
                    0x39f9ed796ea305ed,
                    0x757285577e8a3d0b,
                    0x295cb4cd229dafca,
                    0x0064b77899a49480,
                ])),
                Felt::new(BigInteger384([
                    0xed91bda72ba0f1d3,
                    0x5ed24bffc56e2f02,
                    0x32c41891ec635c97,
                    0x0a4554f2b8e9a35c,
                    0x534a385ad66baf0d,
                    0x00cd5195f1932505,
                ])),
                Felt::new(BigInteger384([
                    0xfa4b17e3e25b4231,
                    0x6fb21c49b19cc37e,
                    0x4cb6e60f18d31887,
                    0xface31651d5587b9,
                    0x27557899973a7017,
                    0x016ef5ac30675bdc,
                ])),
                Felt::new(BigInteger384([
                    0xf6a383557ecb716f,
                    0x11f9fc411aca2722,
                    0x010aea6a3f4281fc,
                    0x19bbd87eb6cbe112,
                    0x51c38dd37099fb56,
                    0x00097c24819a9596,
                ])),
                Felt::new(BigInteger384([
                    0xb2200d8ea3ea6ce6,
                    0xc14d2a214c9d2a7c,
                    0xd9f7776b6a88de39,
                    0x24a144ba18aa9169,
                    0x4bb7156eeda1e82e,
                    0x00140d6087845077,
                ])),
                Felt::new(BigInteger384([
                    0xa1f736eb4e8d59e2,
                    0x019414d8b8ced112,
                    0xf9ba1af80ef09a31,
                    0xd1b9a0f3c027b9bf,
                    0xca68ab0d6daf9be5,
                    0x01ab6832f064b735,
                ])),
                Felt::new(BigInteger384([
                    0x0b0c60fc8af3229b,
                    0x9f795e9abfa8bb78,
                    0xde5196c6e569597a,
                    0x9bfa338c8bd13447,
                    0x7c90924032a06c42,
                    0x01253a7778420ecf,
                ])),
                Felt::new(BigInteger384([
                    0xfe65109bb0a7da2f,
                    0x19bcf6fb998460cf,
                    0x9332f053f2bf52d7,
                    0x1cbb23bef9ad6e32,
                    0x9545204c142e3daa,
                    0x011209803fc57a1c,
                ])),
                Felt::new(BigInteger384([
                    0xebe93a4dfa809f2d,
                    0x8e003d4be496a734,
                    0x606d83f80f94d9b1,
                    0xf343d1b45072bc72,
                    0x80fd3d4baaa1eabd,
                    0x019c2af4b87f185a,
                ])),
                Felt::new(BigInteger384([
                    0xafc2b2bbd182344b,
                    0x085d56bfc6588cfa,
                    0xd41a7e3e4ee09854,
                    0x80a2a1ddf3ad23b4,
                    0x0db91b87280656b7,
                    0x017e0eb0652f465d,
                ])),
                Felt::new(BigInteger384([
                    0x517b26db2882afc1,
                    0xdb8aa48e3c328538,
                    0xb660d17bfae062c7,
                    0x1a39e32f8a08cd98,
                    0xdefa6b0561ce8879,
                    0x00b8e9fe65e851d2,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x20311dd61aae98ec,
                    0x415a9c8d5be16aba,
                    0xab9421d2eb8e3e0d,
                    0x1de63fe03326e09d,
                    0x4d3a79f8512950a5,
                    0x00dc24e25499c0a8,
                ])),
                Felt::new(BigInteger384([
                    0x010dd3fd964dc303,
                    0x2505ab52785128c7,
                    0xf0d0360528514dfa,
                    0x3a33cdebbbe37aba,
                    0xb13ccabd26f8ea97,
                    0x00effc6bc7291abc,
                ])),
                Felt::new(BigInteger384([
                    0x86cc0dfbff3f2c1a,
                    0x04210c07466d968b,
                    0xe033d3cf88bf69c5,
                    0x1788509032d2448f,
                    0x7827ceb1af0ad741,
                    0x0063826621fee982,
                ])),
                Felt::new(BigInteger384([
                    0xaccb8b13ab67035e,
                    0xc67f57ee18f98de4,
                    0x117780ca925d6d38,
                    0x3f921dde787410cb,
                    0x5f3fa9ecbb472aa8,
                    0x0199229e036fbb46,
                ])),
                Felt::new(BigInteger384([
                    0xf8c5e9a686089dad,
                    0xb7d9e60edfae30b5,
                    0x40b11cd60814c666,
                    0x1ba2eb30419caa64,
                    0x83cc12d9bb4a37d4,
                    0x008567a0585fd0be,
                ])),
                Felt::new(BigInteger384([
                    0x0b0b683d82974e14,
                    0xbc193ac605f700d6,
                    0xcdf70b47c1cd7877,
                    0x03d8e3651d7abdad,
                    0xff026565206b93ef,
                    0x0085aaefbc71df17,
                ])),
                Felt::new(BigInteger384([
                    0x71432cb1136e2fa6,
                    0x6ba8345406c1d2e2,
                    0xf3685b95d838eced,
                    0x87db354be69f6642,
                    0x627b91deef0aaa33,
                    0x0153c55e36e0d3db,
                ])),
                Felt::new(BigInteger384([
                    0xbddb7b81ae187957,
                    0x5d576c0010880389,
                    0x9bd6334203350b81,
                    0x2caf063249abbc98,
                    0xcda4ef7cb8145b19,
                    0x004bd8d51f9040f2,
                ])),
                Felt::new(BigInteger384([
                    0x52d3412177539c31,
                    0x4178b1a84d693e85,
                    0x4f5e52d1969d2512,
                    0x3aa5b9022fe9e49c,
                    0x9542241ef5c92af1,
                    0x012787279458384a,
                ])),
                Felt::new(BigInteger384([
                    0xc38dbc3794506e44,
                    0x120d5200223bea28,
                    0x08137c71c8a9771d,
                    0xbef00df4b1ac4ce5,
                    0xc2a1cd2bd4b586d7,
                    0x008a871bf958027b,
                ])),
                Felt::new(BigInteger384([
                    0x42c12ce91b98854a,
                    0x66128819e15c1f61,
                    0xc3ad08a82fd5fead,
                    0xae75798314c2534d,
                    0x2908d972fadf833d,
                    0x0099d3c2f6a596b3,
                ])),
                Felt::new(BigInteger384([
                    0x8f3ea04be300aef5,
                    0x942a15b4b003ce6d,
                    0x34d30d7124203a44,
                    0xf702dbd3257312e7,
                    0xda7a6d58017f953d,
                    0x00eba86d9097d703,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x6c885aa38b3664c1,
                    0xbba52b57afe7503d,
                    0x9adcacc57d6ec2e2,
                    0x0f958c8c9f2f006e,
                    0xcfa31bea42496439,
                    0x01170b4120e0395b,
                ])),
                Felt::new(BigInteger384([
                    0xe2d688e730b28895,
                    0xa9d58474d71940d5,
                    0x807c2c3d08a31899,
                    0x02f0b475679db848,
                    0x745c2451c4bc1132,
                    0x0154dc4befebd7f8,
                ])),
                Felt::new(BigInteger384([
                    0x24f35b79fc2b3ecd,
                    0xb78ae466f6c8dede,
                    0xf414928ea8ab300d,
                    0x63ef3d6b1162c7c9,
                    0xc984ab01074da4f5,
                    0x00430b26dfd59b4d,
                ])),
                Felt::new(BigInteger384([
                    0xeda9497d33c06be6,
                    0xf866f0f089fd4600,
                    0x2802377b4f31d5be,
                    0x3fbea41a8f55944f,
                    0x97de75beae49f139,
                    0x00b67fbb0030bfae,
                ])),
                Felt::new(BigInteger384([
                    0x1b97eccdb633a477,
                    0x6a28aab47ae15704,
                    0xd3dea1ffb07ce1fe,
                    0x021d5709ba57164f,
                    0x9048670c6a884095,
                    0x00d9d56a392ff6bc,
                ])),
                Felt::new(BigInteger384([
                    0x24fe87aaccaad41b,
                    0xf2e0deff2aac8985,
                    0x6f31d31d210926a1,
                    0x3878fbc24cef57d4,
                    0x1a3ff5a7158c8b40,
                    0x00bddafdbf1b3970,
                ])),
                Felt::new(BigInteger384([
                    0x1bcfd5e08540d64a,
                    0x5b833bb76977c6ca,
                    0xd76e62f4ecb63533,
                    0x02b28ff9a5720c2c,
                    0x0566b01482802638,
                    0x008d2c3871213ed9,
                ])),
                Felt::new(BigInteger384([
                    0x805557e27079d3df,
                    0x0693eba561a884e7,
                    0x85bfd69a4fbd2f90,
                    0xc535ef816c876474,
                    0x36f49163cbea137e,
                    0x00cbcaab0a1e3df1,
                ])),
                Felt::new(BigInteger384([
                    0x5bcc6d4ccdaebd2d,
                    0xbc63b17cf481f9cc,
                    0x3d2806517c8dc60e,
                    0x37aac978d0c86c78,
                    0x6a81d1aad30d8818,
                    0x0103122b88c10e4e,
                ])),
                Felt::new(BigInteger384([
                    0x64a2f393fb474cd0,
                    0x3cc7c156df0ee497,
                    0xd3c0a833b978c36c,
                    0xf57eb3501f47f2da,
                    0xc030ceb0c8e6ef97,
                    0x011cda6486ad7dc6,
                ])),
                Felt::new(BigInteger384([
                    0xf2c4c6a4fbec00db,
                    0xbcf19832b9e8d73d,
                    0x90d9d0e9058c4b05,
                    0x97257c1bbe2341f2,
                    0x4f1011fbe771ab28,
                    0x005cdd3792b182ba,
                ])),
                Felt::new(BigInteger384([
                    0x235b10f8fb59881f,
                    0x0328dc2241cfd1d6,
                    0xf8619870b81f76ad,
                    0x98e90b9997bba794,
                    0xc987d9733dccaabe,
                    0x008cc4e67d8860d2,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x935ab6440783a725,
                    0x6d244718638174f3,
                    0x1ebd670d57c4d7f3,
                    0x50c598c77a948641,
                    0x06add9fc2e974bcc,
                    0x0177f6ef5741b900,
                ])),
                Felt::new(BigInteger384([
                    0xf91ca95b474ca644,
                    0x618b7ea6a5f61047,
                    0x3f1806ecef2592cc,
                    0x5f13f33d0fbd5417,
                    0xd156a31dd33bc200,
                    0x0054fefeb420016a,
                ])),
                Felt::new(BigInteger384([
                    0x577dc2ea4927891e,
                    0x8eeeae83a3fd1f06,
                    0x2ac0a624e230cc70,
                    0x6f12f4fc9d4c6d7c,
                    0x5db3c5aa36d39839,
                    0x01626686ed038635,
                ])),
                Felt::new(BigInteger384([
                    0x65c86a3749044a8c,
                    0x26e724d5ad4b82fc,
                    0x67b170cb7f6f3c7e,
                    0x0f62144efb894311,
                    0xe3198b812707dc62,
                    0x0058e04172d802e2,
                ])),
                Felt::new(BigInteger384([
                    0x3b6f857ed9ecdb6b,
                    0xef59fcc0fa240b2d,
                    0xccb6b85cc5bffa6c,
                    0x896a630c330253ba,
                    0xb59b5feca471e19e,
                    0x00da6f3a2d457ad6,
                ])),
                Felt::new(BigInteger384([
                    0xb9fe6c11679a7d69,
                    0xab6981f1bd5b8087,
                    0xc9e7763b0614e0d9,
                    0x29f1d0f3ed06fd05,
                    0x737073f7d49cd3ae,
                    0x00956fee005a9e5e,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1ac684ab8e8cbdef,
                    0x53db23a3e3fe2174,
                    0x3b1f637bccd8c840,
                    0x1929f1712ed1d690,
                    0x98f9675b02a357e7,
                    0x01a7f78cb63ffffa,
                ])),
                Felt::new(BigInteger384([
                    0x529586866cadfb83,
                    0xf876f9772a2bf6c9,
                    0x77d7f053a7f7621a,
                    0x062bc37d2a571d2b,
                    0x5fc917dcea8dd2a8,
                    0x004ed4c5afd6883b,
                ])),
                Felt::new(BigInteger384([
                    0x92071a451b8e99fa,
                    0x5b39a4ba8f578bd3,
                    0x8afac8620f26110f,
                    0x3be3e0e0a8796337,
                    0xec8180a595ac0ddb,
                    0x015b6a7c3a54c3b3,
                ])),
                Felt::new(BigInteger384([
                    0xcf3bf3f88fb6eb33,
                    0x216c19ea08d6d12f,
                    0xb5125b86f4bfd112,
                    0x5ab9ea121f5bb373,
                    0xed5411b5c09b08f4,
                    0x0145e7ccd06491a8,
                ])),
                Felt::new(BigInteger384([
                    0xb9e0d1fbae1e9843,
                    0x7e3294547fb909d5,
                    0x50d7eacb48b041e2,
                    0xa3fd1a30050601ae,
                    0x7d364738b2d04a5d,
                    0x0073c145fcd99b03,
                ])),
                Felt::new(BigInteger384([
                    0x9a4f803c71d6c872,
                    0xbd5cd5594fe90bdb,
                    0x3ecf0075a0afa092,
                    0x3277fb6f07ce2dec,
                    0xc0b492d8533ce4a1,
                    0x009173c6f9fcc1b2,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x75495887f592e4c9,
                    0x31399f632aa3ae78,
                    0x4ec93c8be8eeb944,
                    0x3db5a42c72233233,
                    0x8efd0a9ac47ceba0,
                    0x00cb96332ae951a5,
                ])),
                Felt::new(BigInteger384([
                    0x04d255e11381c8e1,
                    0x370b166e1e0a68b7,
                    0x1291818779a1aacd,
                    0xb957844784e7c06c,
                    0x1616718679dbca46,
                    0x0001baa0590084ca,
                ])),
                Felt::new(BigInteger384([
                    0x44c35006b139597f,
                    0xc10fcdfce68014e9,
                    0x3fe638f69564b1ea,
                    0xf784c8144ad3650c,
                    0x863ebbe81a29235f,
                    0x010b34c86f24f8d1,
                ])),
                Felt::new(BigInteger384([
                    0xbe95e1fb88f7db5b,
                    0x2bab32395451e5e1,
                    0x394704ed97a2514d,
                    0x11566f5b65c8684b,
                    0x8824e6a083f183a5,
                    0x0104038560d76f85,
                ])),
                Felt::new(BigInteger384([
                    0x1b923dcb306f7ede,
                    0x5db4dee345837ec2,
                    0x8d657ccd1d279ce5,
                    0x6ba151d51ca3ee75,
                    0x05ec495c6533bedf,
                    0x00b73d6a65f1aad7,
                ])),
                Felt::new(BigInteger384([
                    0x12c6d2ff7767ecb9,
                    0xc0107b52e2024821,
                    0x05675a1fa221bfb3,
                    0xa83e918c07176f22,
                    0x921e4a241b437409,
                    0x01a9d8d26e4e9808,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x798eacb873edc726,
                    0xe3d28fae0447b4d2,
                    0x1e1333657e738bba,
                    0x4d42be231f2abaff,
                    0xb99e31ba827b5434,
                    0x00a541b30e03273e,
                ])),
                Felt::new(BigInteger384([
                    0x254ba95f35605032,
                    0x4d44761189d0bd78,
                    0x54afeb2f1493e849,
                    0x654f023d3521e549,
                    0xe6d0e153b18b4cf8,
                    0x00e840b660af1202,
                ])),
                Felt::new(BigInteger384([
                    0x6ddf217d3e73a7be,
                    0xfe17b157f82fc910,
                    0xce47f25e36238d81,
                    0x2e8bae73f0e9ae4b,
                    0x9138c427b6e07110,
                    0x0108fbaa6b0ce20b,
                ])),
                Felt::new(BigInteger384([
                    0x6bd7b00a8052127e,
                    0xe5d716512fbd0802,
                    0x37449cfc5329c3ef,
                    0x69a4e7ab6b78a6f0,
                    0xa3b133011b82ddb7,
                    0x00a69b0a82f01a44,
                ])),
                Felt::new(BigInteger384([
                    0xfb23f09e949db84f,
                    0x017b9ce82b7dcb9d,
                    0x25eba7378a2d3431,
                    0xbebf744e8bc79396,
                    0xee7c4455366ed9d3,
                    0x018704c12de6d8c2,
                ])),
                Felt::new(BigInteger384([
                    0x0271d50c8ea1e055,
                    0xbafd4f13562f3d24,
                    0x99d1bb1908346027,
                    0x952b0533f06dfbf6,
                    0xb2654ec421341ff5,
                    0x0077930b83bbe2b8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x9e6377f87cc5f3ac,
                    0xba70ad3920747f0d,
                    0xea32c0ed66cd8c46,
                    0xeff9da5267ffed24,
                    0xc0bab74a93650c80,
                    0x0158dcc4711f142b,
                ])),
                Felt::new(BigInteger384([
                    0x4887249dd0eda702,
                    0x41d99fb0f14d3253,
                    0x715747ff4b91fa18,
                    0xf115c044b09008d3,
                    0x83e78b4d49b72c81,
                    0x01a37fa6d8100837,
                ])),
                Felt::new(BigInteger384([
                    0x2fa9dc6617f3ba5c,
                    0x48dedb7f82e3d461,
                    0xbfe77caee52d86f6,
                    0xab041c3fc8360b87,
                    0x8ca1ab22a4da0e76,
                    0x00e264d266dbd7f4,
                ])),
                Felt::new(BigInteger384([
                    0xf63fdb085d1a7278,
                    0x40b5d7c2f3a65a81,
                    0x61a4f667e9e9e657,
                    0xaf20daf5ecc77410,
                    0xcd161d4a91edeaa1,
                    0x00a9bf90c9ade4ff,
                ])),
                Felt::new(BigInteger384([
                    0xd5f3c5634537c2f1,
                    0xfab29ff94aafc21e,
                    0xd69ea1fc337578bd,
                    0xa41ea85100b6a236,
                    0x8eff07070c791f4d,
                    0x01a88aad57d79d2f,
                ])),
                Felt::new(BigInteger384([
                    0x488d530170c840d3,
                    0x3bca93d8190e4ce9,
                    0x1319bd094976f509,
                    0x1083551e138a4768,
                    0x8a8438735c4c6679,
                    0x011632abd70d8b12,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf6a80abb57c6868b,
                    0x4121b75be3a4f0f8,
                    0xb97602183830c088,
                    0xb6ab7ef4863c4e1e,
                    0x09709f5e53d31033,
                    0x0168c669e70cfb66,
                ])),
                Felt::new(BigInteger384([
                    0xcbff288b03ea25f6,
                    0x4c8ec198fe4d59aa,
                    0xb8f4898522196ba6,
                    0x85de3a89b2fda3c1,
                    0x76c37c390a70c2e9,
                    0x0157b83824456b01,
                ])),
                Felt::new(BigInteger384([
                    0x320434d1ed57dded,
                    0x81ae602ba54cbc37,
                    0x85132fdf2954d8fa,
                    0x2c665dd17bded244,
                    0xa801ef9d9196d320,
                    0x00b7c48e1bca68ff,
                ])),
                Felt::new(BigInteger384([
                    0xc36eb3d543c49323,
                    0xf7df7a1f72dfe64c,
                    0xb9a31ee4a59cdad5,
                    0xd0f8df32d98d7abf,
                    0xd5c4eebb4536d47c,
                    0x004d8a61223e0af7,
                ])),
                Felt::new(BigInteger384([
                    0xe8abd91e35bcf59d,
                    0x88cd7497e26e5e23,
                    0xad746ef223ff8bb7,
                    0xda5a54dad61b801b,
                    0x48b6f888983bf9ac,
                    0x007a9823d543b23a,
                ])),
                Felt::new(BigInteger384([
                    0x0e8f24ddfd000ec2,
                    0xcabe5372f4c3bb21,
                    0x332adb43a4518936,
                    0xe5b5340f9892eb8f,
                    0x08384d8d9b4d2a4b,
                    0x00867f434e3fc30a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x700fb9f22b35b519,
                    0x1a7c90a17b35b5b2,
                    0x7ffc80998e84acd5,
                    0x4dae01b244f81bd1,
                    0x5a8094fae75311b3,
                    0x010b742dc5af0d21,
                ])),
                Felt::new(BigInteger384([
                    0xc231c05d26ad3b5b,
                    0x47649d71759d2965,
                    0x2c5f0ed9e658ff0d,
                    0xa57ab6e3e7208785,
                    0xbd9bdf785ea47ff8,
                    0x008c3b37d326fc27,
                ])),
                Felt::new(BigInteger384([
                    0x2dd85d9cb5580ea7,
                    0x3f26f81a09bb2f31,
                    0x3b8d799ae43af8bf,
                    0x81350f726114fd73,
                    0xed76abb4581d25a7,
                    0x005152d2b73316d2,
                ])),
                Felt::new(BigInteger384([
                    0x89ce1e4fa930e5db,
                    0x28fec7b07375d101,
                    0xe2efc593aec60e79,
                    0xad5e98a042363eaa,
                    0x2455a039f4c87131,
                    0x00e1d8d9824ace55,
                ])),
                Felt::new(BigInteger384([
                    0x38f1c449a835c605,
                    0x43e40889fe41c030,
                    0xaa33837f1c26de08,
                    0xaaed9a190c5286a3,
                    0x0beccfeaa2469c77,
                    0x014c92953d7bc586,
                ])),
                Felt::new(BigInteger384([
                    0x254e87bc7a786c3c,
                    0x7b86c53d6fd0dba2,
                    0xa2ca016dd9d8a036,
                    0xe53b2bce94353d83,
                    0x55e4f818f113895e,
                    0x009a986384691bce,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf273233e6cf0b1aa,
                    0x09b36c550544a56e,
                    0x6c0a16f482c325a9,
                    0x497795bb65ada3dd,
                    0xff36c378a4eed91f,
                    0x0175107ee650f6f8,
                ])),
                Felt::new(BigInteger384([
                    0x3f4866ca1c84253c,
                    0x0b421cf2c2278526,
                    0xda526cf20b3063a7,
                    0xa7e6cde1399510d6,
                    0x2a1f4ce2711c442f,
                    0x00981576f16ee6be,
                ])),
                Felt::new(BigInteger384([
                    0x5157d88f60c412ca,
                    0xa9c6efbe3d76e366,
                    0x0db463976b990515,
                    0xd2bd6c36488fc0e7,
                    0xdcae51b05728fd11,
                    0x0159c765cc7e3434,
                ])),
                Felt::new(BigInteger384([
                    0x6809c0bfd6c00b3a,
                    0x143cd3e0c49e2de9,
                    0x8846c0f838f5ccee,
                    0x465899dcc4e45f30,
                    0x283a9252b9acb4a7,
                    0x005538c9fde8d298,
                ])),
                Felt::new(BigInteger384([
                    0xee8a80f199d9f5e2,
                    0xa5a4064fc3d2eb59,
                    0x20b3f7634adf65ca,
                    0x7289b685e06a6ede,
                    0xb329b18bdccd5d6b,
                    0x007504d8cabb0ea6,
                ])),
                Felt::new(BigInteger384([
                    0x0209135fd3d36370,
                    0x9b851475658d3bc8,
                    0xe5e70cf14b499205,
                    0x70c47b8e12058f05,
                    0x5167f2fc5a845832,
                    0x003f0f16eed3f09a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x624ec04401245653,
                    0xda662798ce3de6d0,
                    0x3f546476eddecc3b,
                    0xcfd5488c00a6339e,
                    0x18fb8668b3d569d7,
                    0x00da0383ba74bab8,
                ])),
                Felt::new(BigInteger384([
                    0xa93c2312ff3973f1,
                    0x9100f2671f2c5407,
                    0xaba66e9bf02d9d10,
                    0x99233fab68a479cd,
                    0xb85f84a0925405bd,
                    0x0141710c7dabd39a,
                ])),
                Felt::new(BigInteger384([
                    0xfbddcd9bbc48d2ad,
                    0x822053b02861c92c,
                    0x63a26dcd7014b86d,
                    0xe88ed83661fb7128,
                    0x13d4c1e1f2a4f37c,
                    0x00262837a2f253c8,
                ])),
                Felt::new(BigInteger384([
                    0x8d60241fa3fc748b,
                    0x74c2381b4f35dd79,
                    0x51db6e52411f09f6,
                    0xc77cb3a0333fedc7,
                    0x44dd267fad39790b,
                    0x000b6826f68e8db0,
                ])),
                Felt::new(BigInteger384([
                    0x347c40d87d884786,
                    0xe33abcc2e783826a,
                    0xbc748de99ba6cf90,
                    0xd844b3161c602546,
                    0x40fc1f038192b8f9,
                    0x003a53ba527e5623,
                ])),
                Felt::new(BigInteger384([
                    0x7755014fe3036ff6,
                    0x504f5114688b9ca9,
                    0x66b7a3f39a65c824,
                    0x7fd367c7c7af26e0,
                    0xde9ee3ec50637bd9,
                    0x009099b1faf2c51d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x545073770c9b72d8,
                    0x7d192d34ba8b31fd,
                    0xbf37a88686c5c225,
                    0x7e1c39517aad6d5e,
                    0xb057c88558ad4d6f,
                    0x0143e0965ebced5c,
                ])),
                Felt::new(BigInteger384([
                    0x923d5af8456cf74c,
                    0xa7712690cb34283b,
                    0xa0e57cfee109166b,
                    0xe88470af51412925,
                    0xbda79c82a70c032c,
                    0x007a3738ee0f7eae,
                ])),
                Felt::new(BigInteger384([
                    0x5b709a7418263193,
                    0x385e792bf2321a87,
                    0xd1e6c56e963f13bb,
                    0x61e971cc0450ec2d,
                    0xa14583f11d21387c,
                    0x00efc33e7341ae19,
                ])),
                Felt::new(BigInteger384([
                    0x30d65d16b84d7e1c,
                    0x0bc2b6c58dd5f483,
                    0xf388dca53c5f65f8,
                    0xd87c913181bfc6c7,
                    0x7f65f7eee99357c3,
                    0x005e7f25b3e206d5,
                ])),
                Felt::new(BigInteger384([
                    0x75268f2b0e604342,
                    0xc5e4b96a3a24584d,
                    0x55229b076631e68d,
                    0xfc44a61a52bdf0c2,
                    0xcdfbc8ae7a74caaa,
                    0x00b5d67b019838ce,
                ])),
                Felt::new(BigInteger384([
                    0x3af9911a5e78cc34,
                    0x964adaa1767a7329,
                    0x107fae032096314e,
                    0x9abaaa376f93380e,
                    0xdafa2a9f577ec5a9,
                    0x013daecf281a1e68,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x14e04f4de1a59f53,
                    0x8e9eb00904e013b4,
                    0xd62c870d2a8b3b66,
                    0x3540a47daf8419e8,
                    0x7fe65509f4aa056d,
                    0x0022bec3ed6ff17b,
                ])),
                Felt::new(BigInteger384([
                    0x1be6bea32a48a4ba,
                    0x176b99bd6d3d1dc5,
                    0x1a756f60ea912e7d,
                    0x1caaa2f44198c88a,
                    0xda9700d944f6347c,
                    0x003aecc26226b6f6,
                ])),
                Felt::new(BigInteger384([
                    0xc099383d3c5db204,
                    0x89815f2989ecb99c,
                    0x42e85f59e87c91e6,
                    0x50dadcc8a88d6893,
                    0x5ade851c4db6132c,
                    0x00c97f74a35a2a99,
                ])),
                Felt::new(BigInteger384([
                    0x70c073ada3755792,
                    0xf2e834051cdd945c,
                    0x70c2500fe427b23b,
                    0xefad2b61d67cdd3f,
                    0x7ce1ba8caea46f3f,
                    0x00954976032eddda,
                ])),
                Felt::new(BigInteger384([
                    0xd4f8ff3d9f4f51ac,
                    0x1bdcae8ac63f7eb6,
                    0x4078e6cf6cf817cb,
                    0x539574e4fcde2ff4,
                    0x3078576f9c7626a3,
                    0x00d95dfddddaeee2,
                ])),
                Felt::new(BigInteger384([
                    0xd67ee408e79700d6,
                    0xb01dbadcaf036748,
                    0x80a813936c61c0a4,
                    0x949ace9a754e4f08,
                    0x457e0227f5bf7a85,
                    0x002ace6b545a6401,
                ])),
                Felt::new(BigInteger384([
                    0x2be6fa17333185aa,
                    0xd319de9a41823441,
                    0x8adeb4bdfb9b282f,
                    0xb3bae58e16bc3583,
                    0x34fec8c2b57aef28,
                    0x013edd08cf09064c,
                ])),
                Felt::new(BigInteger384([
                    0x98103f0169695bc7,
                    0x1f897644c8cafa22,
                    0xc9f0ecef43b88f07,
                    0xc53aad6b4cc82a3d,
                    0xdff6d1bc254951b5,
                    0x016a6a7777ba4b5e,
                ])),
                Felt::new(BigInteger384([
                    0x1f964ab6863df663,
                    0xd5e9d951b95e4180,
                    0x92f6fd4363734faf,
                    0x983aeeb2cbc18c71,
                    0x56bb8b70e69e7d4e,
                    0x01aa27b16bf81aa7,
                ])),
                Felt::new(BigInteger384([
                    0xc5914775f41ed1cb,
                    0x94e7efdb079e28a9,
                    0x23e932a0c3868505,
                    0x23cdd32e3a0a5f12,
                    0x7ce5b48452f9b1ba,
                    0x00fe0b61fbb3ff8d,
                ])),
                Felt::new(BigInteger384([
                    0x816196c54a047174,
                    0xf0746914e64e8d20,
                    0xead64bd0fced50e8,
                    0x065710e3844b16eb,
                    0x63e91e3a838edf61,
                    0x00de6c8579057c26,
                ])),
                Felt::new(BigInteger384([
                    0x7e5714a367e83afa,
                    0x780cda22317b75a0,
                    0xa194f4baaeb81b77,
                    0x843b9fbffc2e7df4,
                    0xc0b87ca528ed772e,
                    0x015ae06f9b4ab692,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x40c68a534bcb7a7a,
                    0xc4454a4cfafd0e70,
                    0xdca419ae3d2fc793,
                    0x10f86aaea1c545d9,
                    0xde56beea12ceb429,
                    0x011a5965c684734f,
                ])),
                Felt::new(BigInteger384([
                    0xb4535bb96e706f18,
                    0x862c0e535ecf6582,
                    0x048cf0986956fac4,
                    0x3d05d94e1f39aae2,
                    0x288eead22a01c611,
                    0x005772dada5ce8ee,
                ])),
                Felt::new(BigInteger384([
                    0xbcd022a451a2c41e,
                    0xb9709b6977604bf4,
                    0x2fcafc0b48cc06a9,
                    0x2a29f9aa48325b6a,
                    0x617d15fb3755cf39,
                    0x00818d409986dc9e,
                ])),
                Felt::new(BigInteger384([
                    0x66a4e45fa4b4e3e4,
                    0x645422a9a80e9a85,
                    0x797e13e4e9fc3b7e,
                    0xaa3ff50397eff009,
                    0x7ba1b60146c2d5e9,
                    0x00634975fc168b99,
                ])),
                Felt::new(BigInteger384([
                    0x885e353f0bd2b077,
                    0xc4efb65cb1653488,
                    0xac13e89388066580,
                    0xd161b2534861d45c,
                    0xfb35bdec29d6a21f,
                    0x013a887ef8f05a83,
                ])),
                Felt::new(BigInteger384([
                    0x9b7cc343a71959b9,
                    0x6ec6346cee077336,
                    0x9d8686260e0b79a5,
                    0x1ede8682d14fbdb7,
                    0xf8d1d8ae03389d85,
                    0x000fb6b690f58106,
                ])),
                Felt::new(BigInteger384([
                    0xe1b1ec85a1e0a80c,
                    0x588eb3caa5127f07,
                    0x3a121a6c7da2eaae,
                    0x6ed7b52c482ebed2,
                    0x1acf07865384ac02,
                    0x00695870493704ef,
                ])),
                Felt::new(BigInteger384([
                    0x48a8fafaabd7b491,
                    0xf81d492f824323ff,
                    0xe0ca2d7d1f766df3,
                    0x3482c784ec575a4d,
                    0x25d3e99fa37ead75,
                    0x01697479b0226501,
                ])),
                Felt::new(BigInteger384([
                    0x8324909f235f2f60,
                    0xc078ee7aa315b8a5,
                    0x0163819c94b86b86,
                    0xd57a6a43f59fd545,
                    0x6953c580e6a12507,
                    0x0029fb89e9762cc8,
                ])),
                Felt::new(BigInteger384([
                    0xd846d87ee6c0fa18,
                    0x6be07917bce7f848,
                    0xa5a1638f13eba181,
                    0x5d3c3f34a029bacf,
                    0x3e80f2c13fbd55a9,
                    0x00abac927afbd707,
                ])),
                Felt::new(BigInteger384([
                    0x3f5727218614e125,
                    0x3b7f267ce15e0713,
                    0xf0c3f216d6e7f765,
                    0xd48c1b3362f074af,
                    0x8c2c175a8a873d26,
                    0x0120c94dfe495c4c,
                ])),
                Felt::new(BigInteger384([
                    0xd1f6f78a946a0329,
                    0x49116c97195367c8,
                    0x204bafe2244bb20f,
                    0x03bae5920a784027,
                    0xb4469ffe2fd2f164,
                    0x00d5184cb7a3ba5b,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x82a78453eee5e201,
                    0xe2fff3c1f0a190c8,
                    0xe43abae653d2f8e9,
                    0xcb7e8939223bdddd,
                    0x112783bea74b28fc,
                    0x00aa581e52f23e23,
                ])),
                Felt::new(BigInteger384([
                    0x327183d80661d145,
                    0xb41cc1c2393abe11,
                    0x034e3ea247699304,
                    0xbdb3fa4862251c4c,
                    0x144acfb1190c32b9,
                    0x0117eb61f98bd7b1,
                ])),
                Felt::new(BigInteger384([
                    0xc405a4fc2cd2c17f,
                    0xab7d452d58268069,
                    0xb09dfbee012a923f,
                    0x3f05208e961d71d7,
                    0x900e0725fba4dfa9,
                    0x007bf0f4e3cfffaf,
                ])),
                Felt::new(BigInteger384([
                    0xa3cc45f0af4d9d26,
                    0x7a386151d86586aa,
                    0xf661645967ac7788,
                    0x310ebe17db6406b6,
                    0xd9500abcd911b37d,
                    0x018665791e2fca60,
                ])),
                Felt::new(BigInteger384([
                    0x6ae7031b9768bfcd,
                    0x270db8a64530cb9a,
                    0x36b3368573f1e779,
                    0xaae3661292e7af9f,
                    0x736b5276676a867e,
                    0x00832fe10e68dba3,
                ])),
                Felt::new(BigInteger384([
                    0x7436298436fba816,
                    0x85735ab45b39b55e,
                    0x75a08e95a21005e9,
                    0x41e62ebeafcf57ec,
                    0x8370e9f231b413a0,
                    0x012a19df03e1af49,
                ])),
                Felt::new(BigInteger384([
                    0x87f063167c9b9f50,
                    0x95b1e764992c3188,
                    0x79373bba9b64e94c,
                    0x83cdb351d705ff67,
                    0x259fef9ea79ff0fd,
                    0x017c9b38acc3b582,
                ])),
                Felt::new(BigInteger384([
                    0x6b10d077b8b088e0,
                    0x06a4c1c37d34c9d8,
                    0xd1f9df4bc6ea2648,
                    0xbc2c6690c6408e9d,
                    0x7c862fa860eb26c4,
                    0x00ddbf07784800e0,
                ])),
                Felt::new(BigInteger384([
                    0x6e01f91c4a835daf,
                    0x980d22ea688f4df1,
                    0xaedec24a766a22c3,
                    0x42179edabaccc8c4,
                    0x8073739abf8849ec,
                    0x0182fe53c43975b1,
                ])),
                Felt::new(BigInteger384([
                    0x852ba1c10b9d407f,
                    0x50378ea1470e6c73,
                    0x9179786d167b6ea0,
                    0xe89168d3c09aa1b2,
                    0x523fa1c27c644084,
                    0x015e7f24753b8f46,
                ])),
                Felt::new(BigInteger384([
                    0x71ed8e8f97df8d40,
                    0xc09467eb5cd0e2d3,
                    0xade4dca4c7efcd0f,
                    0xf21f3d177186905f,
                    0x93b330327b17c9ca,
                    0x001241707600410f,
                ])),
                Felt::new(BigInteger384([
                    0x5cd48da741fee3c2,
                    0xbec8c763ce34845b,
                    0x4eeda6d43355e438,
                    0xa13ed70b67d7c8aa,
                    0xf4eef631f48487b4,
                    0x01a1ace68b405947,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x0c8ff74d427964c7,
                    0x896b412e2b9ef4a6,
                    0x1c8c6f02bc463da7,
                    0xde47081cdd606256,
                    0x5da534fe3e5e6f8b,
                    0x0075afc52d61b7cb,
                ])),
                Felt::new(BigInteger384([
                    0x3903a39ae499352a,
                    0xaacfa2a690778d5e,
                    0x4f0997b605305518,
                    0x1542dffe1c651c22,
                    0xf0e4a86388db0f46,
                    0x005ff6b6852a76b3,
                ])),
                Felt::new(BigInteger384([
                    0x9a3f7ccc1575bb07,
                    0x276d6deabd238317,
                    0xa5c75fb6b3d0fe06,
                    0x4821a5b0c06f683b,
                    0x703c458352435a5d,
                    0x0124eb5fc1b38623,
                ])),
                Felt::new(BigInteger384([
                    0xe683a1a244f165e2,
                    0x9abca6dd26d57ef1,
                    0xb08fec09db96f52d,
                    0xe4c6f8419dc33f11,
                    0xc1eaa2206ad80c6b,
                    0x019399d5bf9e6179,
                ])),
                Felt::new(BigInteger384([
                    0xb51a75ade322b1b1,
                    0x0baf1a6901606517,
                    0x014648819ddd1286,
                    0xbb332219f4c6d734,
                    0xe982048aba9f742b,
                    0x01263b163b6e6b8b,
                ])),
                Felt::new(BigInteger384([
                    0x139e08f492230ad4,
                    0x67890aced1dbb13b,
                    0x603b34d9f2e13566,
                    0xfec7049e2047bcef,
                    0xe0dcad0baecf34e8,
                    0x0195d66d87a4aef6,
                ])),
                Felt::new(BigInteger384([
                    0x4b21fdc6f82262c7,
                    0xc8b91b62616aae85,
                    0xe6260b7225579e46,
                    0x6b051a5670ac95de,
                    0xdb7b85bab4720f75,
                    0x0193c70ad0b20c7c,
                ])),
                Felt::new(BigInteger384([
                    0xc9473e48579bdd08,
                    0x3419ce6c550d43bd,
                    0x7fcaa7d007cc4da6,
                    0xcd4796d94bcd130c,
                    0xc9aaef079acd5592,
                    0x005fb06355990ec2,
                ])),
                Felt::new(BigInteger384([
                    0x62c8cb829004cccf,
                    0xa845796030d4a964,
                    0xd7a3f13820cb940a,
                    0xad76091d991acaa8,
                    0x82f5111737f426b3,
                    0x00a05c82df2b5025,
                ])),
                Felt::new(BigInteger384([
                    0x0c2818ab2daadcb7,
                    0x12e8f4a641cdb4df,
                    0xf4884bbfcf9fe7bf,
                    0x57a459fa21fe0955,
                    0x884a8a6495c8d23d,
                    0x019744814917ae71,
                ])),
                Felt::new(BigInteger384([
                    0x102586e58336d9ec,
                    0xeee5c8744e3d68c2,
                    0x31701910a459f605,
                    0xc1ea74e41bf22bc0,
                    0xbd960dc6500feab6,
                    0x0094708f8e015079,
                ])),
                Felt::new(BigInteger384([
                    0x4e651743fda71c11,
                    0xe495a1eb7c16d856,
                    0x75d38ff913a0a60c,
                    0xe14a05aaeb298f37,
                    0x26675bd93ce4d801,
                    0x0003a5310794415c,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x3ce67cbc8559962a,
                    0x34e51c5238c125a2,
                    0xc491b92970939b34,
                    0xbb3e3ede5683eda4,
                    0xd04bd92cd4589277,
                    0x005243f648f15e7f,
                ])),
                Felt::new(BigInteger384([
                    0x01605f613df67e03,
                    0xaa124359d9160911,
                    0x28234eb9f2dfe350,
                    0xd563b6dd2b8e20d5,
                    0x460af08f4f408014,
                    0x0085b146df332876,
                ])),
                Felt::new(BigInteger384([
                    0xda362eb0f4d24326,
                    0x59d9945a1169c817,
                    0xc1147383de3a720a,
                    0xc913803413210c55,
                    0x83ba805586e9a601,
                    0x00d727278125bc52,
                ])),
                Felt::new(BigInteger384([
                    0x029b95d32e069851,
                    0xb63128c96afc6f39,
                    0xa50285422fbbb70a,
                    0x5beb5a9942c2d10b,
                    0x0850d00cfcbaabda,
                    0x01928dbb7288a78f,
                ])),
                Felt::new(BigInteger384([
                    0x4c477da0138fcb5a,
                    0xcdfddf2d00111215,
                    0x9b367e63f7307ee7,
                    0xd2257fa15363760c,
                    0x4c0dd389d3ecbeb7,
                    0x00de8881a261dee1,
                ])),
                Felt::new(BigInteger384([
                    0xf32eac1029bf125a,
                    0xfac8c1073049d557,
                    0xe3fe45c4b5a928db,
                    0x2fe4782323a30491,
                    0x92e5003d3d96d1a9,
                    0x01a723dfc24782b0,
                ])),
                Felt::new(BigInteger384([
                    0x4059a6c2d4f1f74b,
                    0x92f6432eaa62f620,
                    0x0d4ca4534adc6946,
                    0xe4060aa76ae6b281,
                    0xa181594c206c42a1,
                    0x00befdf93956de76,
                ])),
                Felt::new(BigInteger384([
                    0x2252c51ed5aa9c16,
                    0x2afa3657d3a5cf85,
                    0x30e9ba7d1b522e9e,
                    0xf98d8f03f77edebe,
                    0xba44590200613671,
                    0x0012c8715754e11e,
                ])),
                Felt::new(BigInteger384([
                    0x6396b8cb5095e08a,
                    0xb53c02664a156782,
                    0x524ca34c37e43754,
                    0xb753879d4b6af295,
                    0x8cfeb7a81b5a54de,
                    0x00ab660b7b42565c,
                ])),
                Felt::new(BigInteger384([
                    0x1fbe6ffb8545b137,
                    0x096d2e67e69fe729,
                    0x113076abffaef0cb,
                    0x06885fbbd87c99f0,
                    0x45018279f6d69800,
                    0x00bf13768a3bb4da,
                ])),
                Felt::new(BigInteger384([
                    0x0489e126afae37c7,
                    0xdd8f99e950908faf,
                    0xfb3d2a4aef0c874d,
                    0xfaab080a8cb6559c,
                    0x77b4d7422414aba5,
                    0x0074f797b5b11bb5,
                ])),
                Felt::new(BigInteger384([
                    0x83500f8a1955fa22,
                    0x0ffdc4f167eef18e,
                    0xe8a2cd050f22bc02,
                    0xa9b37647c2a19e86,
                    0xe0533dd253d313e6,
                    0x00493bdaf7704e89,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x4a49301be983a3c7,
                    0xe71d71784235d1fb,
                    0x544a66de79340488,
                    0xc5bee6ef03787fc9,
                    0xf70f218728340f6b,
                    0x00aafe510df8698e,
                ])),
                Felt::new(BigInteger384([
                    0x60c7d02fb32d01ec,
                    0x9ec90514f059068a,
                    0x0dedbc094bf7e2da,
                    0x712cab0d9450ceef,
                    0x5f2e429cadbed024,
                    0x00e42d28f1139a5f,
                ])),
                Felt::new(BigInteger384([
                    0x4be9ef9eccc43a76,
                    0x9806a451a06e8b8e,
                    0x7b611f4213e2d6a5,
                    0xa948126e513c4a51,
                    0x6b21da5fb41c7462,
                    0x01272beeb73c3d84,
                ])),
                Felt::new(BigInteger384([
                    0xf44277c9600bcd39,
                    0xf016391bebb9c6dd,
                    0xab893a7120bafcf2,
                    0x3cc4f50c7a3268e2,
                    0x892aad5c8422d8cf,
                    0x013bdf234c47ff1f,
                ])),
                Felt::new(BigInteger384([
                    0xeaf70b1eba410c5b,
                    0x20757fbb383efe26,
                    0x1a87c60dfd3e2c7b,
                    0x996580ce1ff91c13,
                    0xc58a70499a9819a3,
                    0x0182abc7eefcca8c,
                ])),
                Felt::new(BigInteger384([
                    0x90f5f901a4bfbe4c,
                    0xc2dbfce31f5dfca1,
                    0x29ede0cb0a5fe341,
                    0xaa650d2955b412e8,
                    0xe5ebeb0878e30f83,
                    0x00c11252a3a38496,
                ])),
                Felt::new(BigInteger384([
                    0x950b17929fee696e,
                    0x77c6132fae6c1d01,
                    0x2b980a8dc8b40e38,
                    0x827b053db62b3649,
                    0xfad65372ed79fbde,
                    0x004a5ed7ee483e22,
                ])),
                Felt::new(BigInteger384([
                    0xcaab18a5e8c2290b,
                    0x6c4cea56aea483fd,
                    0xf1c1f219e87b4762,
                    0x4997923ee051b4fb,
                    0x631bfa43cde835dd,
                    0x015f04c3e9440888,
                ])),
                Felt::new(BigInteger384([
                    0x464f7c93927abd42,
                    0xfb82f290c1001db8,
                    0xa4080626f82530cf,
                    0xa233dae5f5d90a9a,
                    0x905663d526f70e99,
                    0x014895606247c5d9,
                ])),
                Felt::new(BigInteger384([
                    0xb5fa5ab484a3f024,
                    0xff66f1e957488690,
                    0x7abbbaee59e75715,
                    0x1e73cfe5e89dd20a,
                    0xde0f941b9c65e4ea,
                    0x00c170449c54ea01,
                ])),
                Felt::new(BigInteger384([
                    0xc4b18fb86118de01,
                    0x0ee589f1fbcbfeee,
                    0xcb44431bdbc0baf9,
                    0xcdfe2e8fc033f6ba,
                    0xada35ba8824f8dbd,
                    0x00d8751b9ef3e038,
                ])),
                Felt::new(BigInteger384([
                    0x40d5095e5393c329,
                    0x305e1bb73aea8b74,
                    0x70ba1d36e9499db6,
                    0xf1f16eee89f57c32,
                    0xabf71f9947728f76,
                    0x00652f547733c17c,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x1c367ead2a980bac,
                    0xbd5637d4a1a29f26,
                    0xd84e012f8ba30ed0,
                    0x14fd3cea48f92059,
                    0x8d86f412309a332e,
                    0x0058582442009836,
                ])),
                Felt::new(BigInteger384([
                    0x18e37fa3f7eb6e39,
                    0x33dc256e109d13cc,
                    0x70b0edf374a9b024,
                    0x9867d87ff84d942e,
                    0x27e0a296cee07210,
                    0x01434f2e2752a2ac,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5c9cf0ec5839f02a,
                    0xff30a22a930eb71c,
                    0xd90b5249b09c8b31,
                    0xc4c5389bda671457,
                    0x763b23b871dd1da9,
                    0x001aaec2bde43cdc,
                ])),
                Felt::new(BigInteger384([
                    0x37183abb6e3baf27,
                    0xc0348b7652ebd3d4,
                    0x4cc5ea20835d8bbf,
                    0x793acf0b508beafc,
                    0x4796b6aa91c47702,
                    0x0077f6136272caac,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x50962659d73bbd25,
                    0x38f2eeff26a74223,
                    0xfd21901fe171c014,
                    0x86b8e422d8a57225,
                    0x54ed0a1ed73884a4,
                    0x00dfce1fe83ae463,
                ])),
                Felt::new(BigInteger384([
                    0x51264adc13e190f4,
                    0x0bbb66b6245e96b9,
                    0x324c7e64f95c73ce,
                    0x58c9ab3bf0d2844a,
                    0x6a1e9c8aac6f78ba,
                    0x01015cb210617b6d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5d88fed446ff2732,
                    0xcc5a80a9f7f54980,
                    0xf3536acb84bb056d,
                    0x206b06f29ae6e951,
                    0x73183477032955dd,
                    0x018707d88f31d122,
                ])),
                Felt::new(BigInteger384([
                    0x0e8c6e7644544304,
                    0xd70d7e31dfbd029e,
                    0x06d2e114b5e8c460,
                    0x49fc1529901374a1,
                    0x76ac5d5881a1016a,
                    0x005834864f95fe15,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe199fa3659d12dfc,
                    0xff45c363a3026475,
                    0x0d9b7be447b15e7e,
                    0x989eecddbbb10ba8,
                    0xcbb6bf02ac07e3b0,
                    0x008f8ea2a8559981,
                ])),
                Felt::new(BigInteger384([
                    0x157bf9a5efc5e13f,
                    0xb73c3a0e10938978,
                    0xf67d1ac73e0c1b1e,
                    0x726eb892ffd085f7,
                    0x1112db9866ca15ba,
                    0x014aa1113456ed21,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3adf4c3116644e02,
                    0xb7c19b68bde8ce81,
                    0x09fb9588b2cde76c,
                    0x6b36194c2caf9aa3,
                    0x336f224b22705069,
                    0x00f8c02c0261e229,
                ])),
                Felt::new(BigInteger384([
                    0x4a5caa5c5947ed79,
                    0x6406924b83c0ece9,
                    0xfbc2c4c449ec57fb,
                    0xd2f9e9873769538e,
                    0xdf1a99be3e5d8016,
                    0x00809eda75bfeb70,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8f90088977f3c6c3,
                    0xae6e22c4adf6d114,
                    0x440a25bfc48d6159,
                    0xf9375661052dfcf5,
                    0xa34541ff0c2c05aa,
                    0x017e9ed9bfbcf445,
                ])),
                Felt::new(BigInteger384([
                    0x25b60dac2d3b1e7f,
                    0x8bb410221352ba15,
                    0x47f5c5990887ae6b,
                    0x83cac0511be31134,
                    0x011b15eca18d6968,
                    0x00757781c5512c5b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf5c6d8b4834179af,
                    0xf65c95c07f533745,
                    0xe86555315177b93e,
                    0xe9aefdf4659f95e0,
                    0xfdb81d76a130319f,
                    0x018b093df0a7b8b0,
                ])),
                Felt::new(BigInteger384([
                    0x25e87d629400b768,
                    0xcea7db50e83319b9,
                    0x381a5835971fa3c4,
                    0x24850ed97a7ea8ae,
                    0x019c12add4e17b87,
                    0x0082ea02fad2bc08,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8dbf44a7f51198cc,
                    0xbbb334864e05c4cc,
                    0xabdd390bb4778a55,
                    0x0a47b55f389ade3f,
                    0xe8178acd79513346,
                    0x00c479261dbdffc9,
                ])),
                Felt::new(BigInteger384([
                    0x069434605f563ed4,
                    0x216965037346f422,
                    0x7f500cb196c2bdc3,
                    0x306f829b4543d925,
                    0xdfb90262bfc915d5,
                    0x01247454563575ea,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe16aea1e8f3958f8,
                    0x09476291f79e517e,
                    0x425b27851897bf59,
                    0xc77aae85bbf769f1,
                    0x3450d507064d42e7,
                    0x00580b454f6a29f0,
                ])),
                Felt::new(BigInteger384([
                    0xa2ff2c09276c5377,
                    0x71f5282dde47c1fa,
                    0x844b1a7035d55105,
                    0x60dba6e10d4ececb,
                    0xa615c3d57b13ac94,
                    0x0146ef69f73a972d,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 6));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 6));
        }
    }
}
