use super::{sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 8 field elements or 384 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 8;
/// 7 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 7;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 4;

/// 1 element (48-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

/// The field multiplicative generator: G = 15
const G: Felt = Felt::new(BigInteger384([
    0x15eefffffffff714,
    0x669be3a3bffffb5d,
    0xdc8ffe3035319f32,
    0xd10f7bf375757f17,
    0x6968af36d106a4b2,
    0x019016a3edcd115f,
]));

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2.double().double().double().double() - y2;
        *t -= beta_y2
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2.double().double().double().double() - y2;
        *t += beta_y2 + sbox::DELTA
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3]];
    let y: [Felt; NUM_COLUMNS] = [state[5], state[6], state[7], state[4]];

    let g_x0 = G * x[0];
    let g_x1 = G * x[1];
    let g_x2 = G * x[2];
    let g_x3 = G * x[3];
    let g_squared_x0 = G * g_x0;
    let g_squared_x1 = G * g_x1;

    state[0] = x[0] + x[1] + g_x1 + g_x2 + g_x3;
    state[2] = g_squared_x0 + g_squared_x1 + x[2] + x[3] + g_x3;
    state[1] = state[2] + g_x1 + g_x2 + g_x3;
    state[3] = state[0] + g_x0 + g_x1 + x[3];

    let g_y0 = G * y[0];
    let g_y1 = G * y[1];
    let g_y2 = G * y[2];
    let g_y3 = G * y[3];
    let g_squared_y0 = G * g_y0;
    let g_squared_y1 = G * g_y1;

    state[4] = y[0] + y[1] + g_y1 + g_y2 + g_y3;
    state[6] = g_squared_y0 + g_squared_y1 + y[2] + y[3] + g_y3;
    state[5] = state[6] + g_y1 + g_y2 + g_y3;
    state[7] = state[4] + g_y0 + g_y1 + y[3];
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 8],
            [Felt::one(); 8],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x8b730b66413449b4,
                    0x8f7d83c66997e016,
                    0x60c731a748800c46,
                    0xe02fa4976a4f167e,
                    0x8dfe7f1ffe12d095,
                    0x0177410a21b45f42,
                ])),
                Felt::new(BigInteger384([
                    0x3f948164b71514cb,
                    0x6b4ff27b83d2fbff,
                    0x9b393d0169217ef4,
                    0x39ae8bb0abb868dd,
                    0x0c04c6a3a98d52d3,
                    0x00dbb2333e4bff21,
                ])),
                Felt::new(BigInteger384([
                    0x87327147f1987469,
                    0xa03e2717b0ef7ef4,
                    0x05758c5785659384,
                    0x8c1081f087740be5,
                    0xfe1b269c1defd5f6,
                    0x00a60b7e2574d023,
                ])),
                Felt::new(BigInteger384([
                    0xd60a906cf4783973,
                    0x027c2dbf6542e924,
                    0xe854ed9ad1cccf00,
                    0x70b9ba5093a04408,
                    0xa6844d7fbf373c24,
                    0x0181c3ef8e079597,
                ])),
                Felt::new(BigInteger384([
                    0x8e5a2cc478749bdc,
                    0x8eb3e6c6acca4669,
                    0x0ec5ea62a9e88401,
                    0x8bff349972d0a726,
                    0x7bbebbca317d75b6,
                    0x009f692ef321c94e,
                ])),
                Felt::new(BigInteger384([
                    0x707fab2b8746d536,
                    0x89424bf8976f0d5f,
                    0xb01c90f268a17095,
                    0xec65730e9911520c,
                    0xb49f4085c5a45260,
                    0x00478d25512b44e3,
                ])),
                Felt::new(BigInteger384([
                    0x0c2f88bea9661ed4,
                    0x10fd0d1c5098478b,
                    0x03cd290da269236a,
                    0x48ccb3a73aee6e53,
                    0xb287cd3db642f119,
                    0x0148a3ab2485c597,
                ])),
                Felt::new(BigInteger384([
                    0x325ae60906bb3744,
                    0xf19bc11dde17d2bc,
                    0x7acb6a48d741fbb8,
                    0x9a2fa2f6b7bcc8c6,
                    0xdd4563f0190664bc,
                    0x0003767230766633,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5c17f0c0f74b4ef7,
                    0xf449a72fae4e9b44,
                    0xd64603c96b62ee1d,
                    0xd22bc565e4110edc,
                    0x8ea91c4bfed3714b,
                    0x019b594a3ed67d4f,
                ])),
                Felt::new(BigInteger384([
                    0x65a5085c6787f04b,
                    0xd820bf9fc6974f63,
                    0x7e7f29993102cf22,
                    0x1df9ffe9911faed9,
                    0x09cc39b18498a3a0,
                    0x01923b7f8e3dc73c,
                ])),
                Felt::new(BigInteger384([
                    0x1837413461ab771e,
                    0x97f704d68e58c956,
                    0xe58efb3e1fc9964f,
                    0xe5e4c95838dd0e94,
                    0x39d7d5adddcd5545,
                    0x011a4687901de353,
                ])),
                Felt::new(BigInteger384([
                    0x3328d28b69d0221e,
                    0xa610f3da7007c807,
                    0x10f525f373155c99,
                    0xaca4cc377a51d9e2,
                    0xfded3d9ee98ac5eb,
                    0x0067a22ceec83a6f,
                ])),
                Felt::new(BigInteger384([
                    0xf79ef487b13a3555,
                    0xf58c35fafdeb1bb5,
                    0x83f90eeb9ea98c33,
                    0x5a46db7c336d56ff,
                    0x7d148ea7745e598c,
                    0x00ae8a89f78a8dd8,
                ])),
                Felt::new(BigInteger384([
                    0x9d411bfb17e084b8,
                    0x9f4bd9b4ccf43f26,
                    0xbede7f4e041a6a87,
                    0x4ba51530d95bdb9f,
                    0x3694f45ffd2c843e,
                    0x01acaac876cbf68f,
                ])),
                Felt::new(BigInteger384([
                    0x93251dbba977ed1c,
                    0xb956e95e4d8a182e,
                    0xd2e29154184ba711,
                    0x44fdb6aed1865214,
                    0x691861b1244609df,
                    0x00b3958d9749e7f6,
                ])),
                Felt::new(BigInteger384([
                    0x0c1818bc058bfcfb,
                    0x67a17a2565c59aff,
                    0xd3e8bf9fd7654831,
                    0xdf2bc6acc7709489,
                    0x994658acb8c6eb36,
                    0x00b36590786cc076,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1d5633a0a89ffc36,
                    0x280a02dadb3745e0,
                    0xe4a5e31c3dd223b1,
                    0xe8cdf4c36793206d,
                    0xe9937e5535b63165,
                    0x012d08f8ae5d5a7f,
                ])),
                Felt::new(BigInteger384([
                    0x4a93d581a2b4efe1,
                    0xf29e09fc9254a5cb,
                    0xb41787c272dc9fac,
                    0x138a61474711945b,
                    0x937475f94a89fa52,
                    0x006f73c4ec464e59,
                ])),
                Felt::new(BigInteger384([
                    0xac72b3a5d2a04d9e,
                    0xa6f3de5422d4dc22,
                    0xd7fd4e0d1e3df360,
                    0xb563911d06c3b381,
                    0x046ea8d5e0bd823e,
                    0x00e9ce1a154124b9,
                ])),
                Felt::new(BigInteger384([
                    0xaa243db676c76f5f,
                    0xd38d9b9c7bf6bf43,
                    0x86e3b49b2ccee344,
                    0xf527e063481d1677,
                    0x7adece0ed21cdd5f,
                    0x00d2aa182289868b,
                ])),
                Felt::new(BigInteger384([
                    0xcb80ae6fdc11e373,
                    0xa308db63b5a0a1cf,
                    0x9eee88bd0d829ffe,
                    0x2d7c592713862671,
                    0xbb25f28797c83500,
                    0x009f3c3cff11bcc4,
                ])),
                Felt::new(BigInteger384([
                    0x3a995ea118ce115a,
                    0x48bc7adbfd269f69,
                    0xb8c1d28242769e35,
                    0x4740045e0f22aaf2,
                    0xa3039b3a8ec42ccd,
                    0x00e26e93438ef162,
                ])),
                Felt::new(BigInteger384([
                    0xac2a5f0fdda637d4,
                    0x53ad56f734bb0ad3,
                    0xe5561e5c09baa4cf,
                    0x9a04489912d57c80,
                    0x38d0f789facda4c4,
                    0x0107cb78fc514bbc,
                ])),
                Felt::new(BigInteger384([
                    0xa3b482ab952aa203,
                    0x0db51389f2ae6180,
                    0x23ea80357846c489,
                    0x3016d787db02b160,
                    0x1ecac7c98a7a707a,
                    0x017ca8184b918b29,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x62b49426de243912,
                    0x92235678db83536d,
                    0xf4dbe1cdc73dba3c,
                    0xf5f09ab579286636,
                    0x3a9243758cb3aba4,
                    0x0175002f58a3eb7c,
                ])),
                Felt::new(BigInteger384([
                    0xda81e083f95af2a2,
                    0x8fa1088fa90ff47a,
                    0x71a962e8d9c86b24,
                    0x9d4f99bfc356493f,
                    0x554db6a35d0ce131,
                    0x018abd63d825ca5a,
                ])),
                Felt::new(BigInteger384([
                    0x3d3d7747e89a14da,
                    0xf074ec333a9fee16,
                    0xc689fc4b968b941a,
                    0x6d6d98251fa8f9a0,
                    0x2ac87acd870f65be,
                    0x0149c9cf9bc439fe,
                ])),
                Felt::new(BigInteger384([
                    0x26cb47cf9a730ec2,
                    0x23f577a2aaccec5f,
                    0x26488d59372d4518,
                    0x0fc35a809ee90708,
                    0x769b089ee2d6b061,
                    0x0039dd30e4e95d51,
                ])),
                Felt::new(BigInteger384([
                    0xe76f97cdd90065d1,
                    0x8026bd815fd40906,
                    0x5ea58f7cfbb1940b,
                    0x05e37c2d921a4ceb,
                    0xa1d2afb85a73d8f1,
                    0x0059ad4f6f309e6d,
                ])),
                Felt::new(BigInteger384([
                    0x9af314c7e01f7a9d,
                    0xac7210bf2b70abcf,
                    0xe2da80285ff7ee4f,
                    0x6f9c0dfd5d301b68,
                    0x081ad127120f5364,
                    0x00de4463ecfec88c,
                ])),
                Felt::new(BigInteger384([
                    0xd9b2abeb93749a17,
                    0x72ab601e1b5157a4,
                    0xb8d258f85f958871,
                    0x1b2d90be87eee48a,
                    0x021f0b7df58cca39,
                    0x004f82e6afb176d7,
                ])),
                Felt::new(BigInteger384([
                    0x3d425e49a6e4cc64,
                    0x7e197ef56cbf6e20,
                    0x86e4bc509d147f29,
                    0x6710a443b6d669bf,
                    0x6d1d2d1e46176d6b,
                    0x00fce8c0297ef059,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x41bda80c32983e34,
                    0x682bf2f2198df70b,
                    0x5ee464a846474899,
                    0x54d9f20ba46b80be,
                    0xaa5c019f58d04032,
                    0x0077b819e9564565,
                ])),
                Felt::new(BigInteger384([
                    0xa402594baea3e306,
                    0x3613dd445755d5eb,
                    0xcb8768306c11096f,
                    0x74171b42bb826cf0,
                    0x30202b992296f41d,
                    0x0173598528fe841e,
                ])),
                Felt::new(BigInteger384([
                    0xb8aff2ff59a56fb0,
                    0xe79ff08388d2280f,
                    0x5a7765cd07c6121b,
                    0xa93150b62ab45532,
                    0x029d4ee978cf3b14,
                    0x012e93d3efb37054,
                ])),
                Felt::new(BigInteger384([
                    0x78a7d5a6ae996109,
                    0xa249ca6e54106afa,
                    0xdb8a8ba0a39039ae,
                    0x1de87cc4c695944e,
                    0x0aefcbcd598ea12e,
                    0x00a5b96e574b915d,
                ])),
                Felt::new(BigInteger384([
                    0x5db302ba90882fa3,
                    0x4af53fc1343d4398,
                    0x6a32dd8d75da7822,
                    0xc0547995eddc67cd,
                    0xaa6dfd35e078e481,
                    0x013d212c5eea395a,
                ])),
                Felt::new(BigInteger384([
                    0xa32ce3587fa3bafb,
                    0x8223752e7be55bfd,
                    0x88bf019cbc3e40fc,
                    0xad9f551205f93f1e,
                    0x8716aff6771e2afc,
                    0x00ba39b501ce5fcc,
                ])),
                Felt::new(BigInteger384([
                    0x4d54d6e4d94b5717,
                    0x692a74cc5d6deee4,
                    0x75d9f9b579f804de,
                    0xbdc0f76f6551b371,
                    0xc9236006d6c0ae55,
                    0x01a4e62e6611c6a2,
                ])),
                Felt::new(BigInteger384([
                    0xd51e6b02bff1996f,
                    0x586dfae0cfa43354,
                    0x8751c68c4ec5eb39,
                    0x8a27a6fedd910f17,
                    0x28895331a6a5fbd8,
                    0x00f2909d78b310c8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7316a9c332232d4a,
                    0x5d7f4fdcbd23d163,
                    0xddb2e0e3481e5107,
                    0x4c43522c633f92e3,
                    0xe904b31ebbd1b525,
                    0x0148b69cf2539567,
                ])),
                Felt::new(BigInteger384([
                    0x760e304471e5c59c,
                    0x57c433b0072ceb50,
                    0xd6e81c48f70d2125,
                    0x6a42e802f17a7b88,
                    0xd1f9ffc7a5845c53,
                    0x018833464978e3d2,
                ])),
                Felt::new(BigInteger384([
                    0xdfc6470c6deaea36,
                    0xf0ca32406f07a29d,
                    0x4c28619ccb9e0bb2,
                    0x36192cfe7169c9cb,
                    0xba11781ba445547c,
                    0x006b53274a6d71f4,
                ])),
                Felt::new(BigInteger384([
                    0x33123ed5ce7f8546,
                    0x0d57e3717a4961c5,
                    0x80a10bcb7b2f724b,
                    0x197176cd9c532288,
                    0xba031ed6f8ca19dd,
                    0x00bde1eebc2ac66f,
                ])),
                Felt::new(BigInteger384([
                    0xec19214f44c786bb,
                    0x9b34e24ce460d3d8,
                    0x2a9fc5ad2abe394a,
                    0x79a8d60b037adf1b,
                    0x55776e06e0652f48,
                    0x019cf95493508b5c,
                ])),
                Felt::new(BigInteger384([
                    0x3412d1306bb90918,
                    0x532be9d95bd7dd2c,
                    0x1c3e2501a8b1af21,
                    0xbe438b056f52c148,
                    0x89e3ca7b1d52feb2,
                    0x00093422915b7e7c,
                ])),
                Felt::new(BigInteger384([
                    0x2fce994745db4da6,
                    0xbedf71d6cfba62bb,
                    0xb1729960f61450f7,
                    0x9c42ac43052e904a,
                    0xffe63e929a3fc43f,
                    0x0073606e9fea6221,
                ])),
                Felt::new(BigInteger384([
                    0xc0eac66c4cf07642,
                    0x67dea3d7cbe56dd3,
                    0xf7e816f3839d2a49,
                    0x70947d26543e5a58,
                    0xf37c5f20a0e8bc6e,
                    0x0023c80001fcf815,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xbdfcf4d41b2cf0a3,
                    0x718ae79b359af80e,
                    0x8a4f84dc1860207b,
                    0x1d47dd237fdf5830,
                    0x3bb4d9e2cfb36393,
                    0x00be965c6b71b106,
                ])),
                Felt::new(BigInteger384([
                    0xf03476118cc4dfdf,
                    0x52c67ff30f24b293,
                    0x5625b5b22369fa42,
                    0x70477c963452b9ca,
                    0x79d97e1732aef849,
                    0x00278c146f72eb4a,
                ])),
                Felt::new(BigInteger384([
                    0x9f2cb843375342b7,
                    0xbc5493a1af4e3044,
                    0x0c835ed49e738511,
                    0xcb327c383d4a2519,
                    0xe4b6942aac85878e,
                    0x009fac7aaefc2f72,
                ])),
                Felt::new(BigInteger384([
                    0xc4530f91f97081fb,
                    0x806756508dc5b6e6,
                    0xdeb8147511a70702,
                    0xecf8f6ef3b455bbb,
                    0x45da607688012e23,
                    0x00c32b5a184950b3,
                ])),
                Felt::new(BigInteger384([
                    0x0bc8cca0c7976d6c,
                    0x7880d08c7ea12fd0,
                    0xe364a801cb3a9e76,
                    0xcdca0dba11fe5de5,
                    0xf03821490e8d3ae9,
                    0x00a174065021f310,
                ])),
                Felt::new(BigInteger384([
                    0x04961f4fbee2899d,
                    0x4a7dc23508e1eb4b,
                    0x8204f1a3e673caa9,
                    0x7772d950bf7c2bfa,
                    0x3e735bb3d6c86300,
                    0x0045fca9db71a589,
                ])),
                Felt::new(BigInteger384([
                    0x1c7247e5de1cb647,
                    0x6fe60a9a50c8de83,
                    0xa70c4de6708983b2,
                    0x1053037424ab3e29,
                    0x5a744afa3372e0c0,
                    0x0077efcf54dc4332,
                ])),
                Felt::new(BigInteger384([
                    0xbaa69151d7fe441c,
                    0xd4117a66319e2b8d,
                    0x48f5f97df7c6c20c,
                    0xbd2899b79e1baddd,
                    0xc3df679b2b007fd5,
                    0x001912aa576020f5,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x04c0507972ba79b8,
                    0x727741f805b86f26,
                    0xccb1bc1e0024415d,
                    0x31e1f553f71952bb,
                    0x28a0b11f4bca2c5f,
                    0x00a0690d1810e283,
                ])),
                Felt::new(BigInteger384([
                    0xece436454d9495b0,
                    0x684b08e41a74f908,
                    0x101f496072c6c3c7,
                    0x4fed4089c70c8368,
                    0x00af0d6adfe35172,
                    0x015a3d4834fbcc6f,
                ])),
                Felt::new(BigInteger384([
                    0x57a8ad7b0348b956,
                    0x5aea3c7b1a6ea434,
                    0x814ad04d32651b50,
                    0x88c540e929b6f122,
                    0xe12759551bb475d4,
                    0x014cfff36f98301e,
                ])),
                Felt::new(BigInteger384([
                    0x2b364a0dfb176307,
                    0x1070b37ee791e8a9,
                    0x4be1b5a6c944735e,
                    0x285368288ce48125,
                    0xd13d11d2158054d1,
                    0x0066fe329fb4ed83,
                ])),
                Felt::new(BigInteger384([
                    0xc6c375f378ad2021,
                    0x3745fca3340c7c69,
                    0xaf62245447f71668,
                    0x9d618f6b8a7c83a1,
                    0xdc76e8ee69203901,
                    0x019ec499678a3d3e,
                ])),
                Felt::new(BigInteger384([
                    0xa4921b53ac999df5,
                    0xfc561a10f704d43c,
                    0xb2d3165eaf03be77,
                    0x59ab9e0e97f4f81a,
                    0xc2f52db236a3450d,
                    0x00172b0cd034bd63,
                ])),
                Felt::new(BigInteger384([
                    0xf7c624876c947b80,
                    0x34cd13dcafd5dc6f,
                    0xb77699d0abe62e59,
                    0x6058a0c269491b02,
                    0x86017f9470c5abee,
                    0x00f64dfdb4b7b0ad,
                ])),
                Felt::new(BigInteger384([
                    0x77944d845d364006,
                    0x9ed5d99095fceb3c,
                    0xe1f699398dfa7a6b,
                    0x7de17d49fe9be24a,
                    0xd1b6e8f32d510d95,
                    0x014461ecc0735bff,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdc672fc2fb2acfa8,
                    0xa19af2239bb0f76a,
                    0x604e37b0526cabe6,
                    0x075d1d6f9d2b8b3e,
                    0xd13e00f10be9fbe4,
                    0x010606bee0685aa8,
                ])),
                Felt::new(BigInteger384([
                    0xbdd97fb7d467377b,
                    0xb2c4261651ba6119,
                    0x63eae7dd27da3780,
                    0x0e435ab1c20220d8,
                    0xc8a9e5a0b4540067,
                    0x0027e8aa05b269ea,
                ])),
                Felt::new(BigInteger384([
                    0xd0e8ef1e22d01d30,
                    0x374240ce20ee752e,
                    0xafd822dc58831257,
                    0x9cd67a6f7750c231,
                    0x9e63fe2a8f1c4d6b,
                    0x01283d0346215de4,
                ])),
                Felt::new(BigInteger384([
                    0x8d2dca902faae07e,
                    0x44dc560bf96ec4ab,
                    0xdf9a19e5eebfc684,
                    0xb8971c4248a196fa,
                    0x901f1ff464d1a8b0,
                    0x01807da0c1e9af01,
                ])),
                Felt::new(BigInteger384([
                    0x8a109540261210a5,
                    0x88156c10d9b086a1,
                    0x3a92f906a02b5400,
                    0x1b9f24795af61322,
                    0x32611dfa8861aa7d,
                    0x0191715a88e90b54,
                ])),
                Felt::new(BigInteger384([
                    0x762a63cef9a04fbd,
                    0x13d912440a55e370,
                    0xf0abb8db86532a39,
                    0xa34c66417c94ca1c,
                    0xf5a09980eaaad87c,
                    0x00a6cbb56e73c58c,
                ])),
                Felt::new(BigInteger384([
                    0xe839697186bd5aca,
                    0x10ee6ec9f5b4f8b2,
                    0x8e52fd9cb1e26286,
                    0xebc54059424470c8,
                    0xd8321caf23a9b8e4,
                    0x0133f29c560da645,
                ])),
                Felt::new(BigInteger384([
                    0xcfdaa08f3b1b4d2e,
                    0xb646fd9fa6743881,
                    0xc1c05e87ef5b33ff,
                    0x44a6da81a9f3bb26,
                    0x39157a206cb73a3e,
                    0x00dba8741546861a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x512029f8ace2f1df,
                    0x85f230c2a94e9f53,
                    0x00b0982346aa2331,
                    0x1e88a333b50d0c06,
                    0x449142f1e9b2b606,
                    0x019d8c5431677ed5,
                ])),
                Felt::new(BigInteger384([
                    0xc18bd2f1f57db4e6,
                    0x439bd122f13fd8a3,
                    0x33909997aabcc3c3,
                    0x81473fe1065af1a7,
                    0x2a16323041bd7153,
                    0x002a137676dfa4b7,
                ])),
                Felt::new(BigInteger384([
                    0x89ddf3b5a7708d81,
                    0x6cf73389a9a5a829,
                    0x08fa482186b326c3,
                    0x9c075d754362fe6c,
                    0x3be4cb948e251fed,
                    0x008a3237006e1052,
                ])),
                Felt::new(BigInteger384([
                    0x72fcc52ab0a0ca3a,
                    0x7ef2c2063f402ac9,
                    0x5c389ab47f2d0afc,
                    0xba3874414f318e51,
                    0x40f8ffec79d64d97,
                    0x019fc2445ff10629,
                ])),
                Felt::new(BigInteger384([
                    0xce8c06c3ab6dd43f,
                    0xaf72628acede20d2,
                    0xe9cb54bb59fa4cfe,
                    0x49f01625af755fe8,
                    0x89a0bbec3716390c,
                    0x0179470793950eb9,
                ])),
                Felt::new(BigInteger384([
                    0x93259d4013e7c8dd,
                    0x8ca866a278a601c9,
                    0x0c93a28785bd785c,
                    0x8e934aea1322d315,
                    0x35d5b886329998c7,
                    0x01677aaeb5393e66,
                ])),
                Felt::new(BigInteger384([
                    0xebe859eb10e4adfe,
                    0x0297be275ef9baed,
                    0xcc102a6e35dbc05b,
                    0x42786be320342a1e,
                    0x13ac4b219313c7bf,
                    0x0004ad0831cdeb95,
                ])),
                Felt::new(BigInteger384([
                    0x88f641ffebedfb9a,
                    0x0905397b2f00b8f0,
                    0x1239be7ca14c5150,
                    0xe53562fed27bab00,
                    0xe7d776344ee8c4f7,
                    0x000d684636462110,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc67f87478a372b20,
                    0x2da5e8486959dde1,
                    0x0a0122ba78b6f0f7,
                    0x338275a48891b596,
                    0x0eb0fce8dc86e01d,
                    0x017f8cc13f3d7b9e,
                ])),
                Felt::new(BigInteger384([
                    0x60594f0163b9dfda,
                    0xfdb6a01e8006293c,
                    0xed33734ff0cbdf0a,
                    0x6844da5f01eb6928,
                    0xc3e2fad792095ae0,
                    0x0116ad3efdfbe881,
                ])),
                Felt::new(BigInteger384([
                    0x285c514ed0570b96,
                    0x33b2cbd25d9c1293,
                    0xb4b8778660b726bc,
                    0x5be0395f32e6fd85,
                    0xdd85f8fdcb85856a,
                    0x01405d7c696c7268,
                ])),
                Felt::new(BigInteger384([
                    0xd8a411fefa135a95,
                    0x9b2f1d2452239f92,
                    0x124cb8845ed4ab76,
                    0x384fdfac2dc2d271,
                    0x9a0caaf28b68b465,
                    0x005b3b84c825b7df,
                ])),
                Felt::new(BigInteger384([
                    0xebaedcb01b52babe,
                    0x2340f24adf4864e1,
                    0xd60f219b4684adf1,
                    0x90e10bc7e23ad4bf,
                    0x3d7c38e868c2c83b,
                    0x015cbf693ee72e9b,
                ])),
                Felt::new(BigInteger384([
                    0xe88a5eb65f79f619,
                    0x12262da4db5f9808,
                    0x712884e9e7b29f24,
                    0x9d7592d72f72b136,
                    0x429a0102b49e5a2e,
                    0x014b32a64cda64e4,
                ])),
                Felt::new(BigInteger384([
                    0x02317ff61cb7bbc6,
                    0xf85ed0dc3f078cbf,
                    0xb3e0165af478a3c4,
                    0x22bab7e4b0101dd6,
                    0x086bd64aea3df0f1,
                    0x019dd86db0dc792f,
                ])),
                Felt::new(BigInteger384([
                    0x5abdafb1324c69ff,
                    0xf9f585d8bd09968d,
                    0x32aec8f3fab5411f,
                    0x3d03a58a6835ee1d,
                    0x5513fb5dfd8a44c5,
                    0x006d2f8fc58aaaec,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x30c4f8ddc66a58ba,
                    0xa6d98c68c5853d6d,
                    0x88b3de0b4ddc0a22,
                    0x958cb942dad5be2b,
                    0xcc9a81b63c4119ae,
                    0x00a5640806b0bbe4,
                ])),
                Felt::new(BigInteger384([
                    0x49bf81c5d33e5af8,
                    0x89d96c3634d0940c,
                    0xce074dd4ba9673df,
                    0xe44ac1d09098409f,
                    0x45975d53551a20ff,
                    0x0074467c5cde4cc1,
                ])),
                Felt::new(BigInteger384([
                    0xfdc16ed04c2d6eeb,
                    0x80ee72318a92faa8,
                    0x06e6ba046109ce85,
                    0xdb15eed8aae4c5ec,
                    0x988ff1f5e1a6c1be,
                    0x00541852ac556cc4,
                ])),
                Felt::new(BigInteger384([
                    0xa18b83ecbdc799d3,
                    0xc30f4a6661ecd036,
                    0xf43fff73ad4348dd,
                    0xa6bd05daffd61fd5,
                    0xc056ed493bc236a6,
                    0x00a0bee7c17ddeb4,
                ])),
                Felt::new(BigInteger384([
                    0x2d0971cd706c1782,
                    0x6f29caa727cba8e7,
                    0x2350d66f033073ac,
                    0x9eeb82aef91d462c,
                    0xdb0a62e0310f1b2b,
                    0x008e0cf7f5b730f1,
                ])),
                Felt::new(BigInteger384([
                    0xdb3390c4afeeff99,
                    0xe63125d6f6d4f946,
                    0x9ab2305a51a267a0,
                    0xb42a3b55008958ac,
                    0xb9345734a32c0f44,
                    0x015167c6ec2a2733,
                ])),
                Felt::new(BigInteger384([
                    0x222dcff2cbea539c,
                    0x90450d59971e3de8,
                    0xfca8f52b4bedd1b6,
                    0x415b81929081572e,
                    0x5ebf8f92188a9f61,
                    0x0176ee6f58a12cc6,
                ])),
                Felt::new(BigInteger384([
                    0xd1477d1812d234bd,
                    0x2e5e5818ac8e9b78,
                    0x6cdbce52587bda0a,
                    0x9c70bc9a22a2e40d,
                    0xca4b90570c27ea4e,
                    0x00ef0dd5ddae50f8,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x42dfef6f48c343c2,
                    0x553e14f8b47457a2,
                    0xe33d4ce6288e7a8a,
                    0x9cf70917eb56770b,
                    0xb36b630c9af4e842,
                    0x003482b940e1beba,
                ])),
                Felt::new(BigInteger384([
                    0x5b174253ff3c13fa,
                    0xbe2bbb91fc4cd669,
                    0x38bedcd0722cd734,
                    0xd79e7eefe751f147,
                    0x334eedb7aa9037ec,
                    0x00c8ef3b35c2846b,
                ])),
                Felt::new(BigInteger384([
                    0xbb8d6e322bbf816d,
                    0xfaa352c144002425,
                    0x27fb8768839f278e,
                    0x599c44fb1b15142c,
                    0xbad33dbbfa34a984,
                    0x014ecf114db29c74,
                ])),
                Felt::new(BigInteger384([
                    0x2a10ff9a8e30999b,
                    0xce535641b974391d,
                    0x132082d994cd66b4,
                    0x63c2316470accf24,
                    0x65e3d17bc73a4e0c,
                    0x0026fe3c9ead5370,
                ])),
                Felt::new(BigInteger384([
                    0x3e6ff249511ae50a,
                    0x1478a591652c18ef,
                    0x6e5745b749ee23d6,
                    0xa48046c7794966c8,
                    0xe1e176f7d6444f9e,
                    0x01369de231a851f3,
                ])),
                Felt::new(BigInteger384([
                    0xf770efb41c159a8a,
                    0x37f93b902210de8e,
                    0x4db8b2b92c8a383a,
                    0xc509502c8c6a68da,
                    0x1e137721e83500a0,
                    0x0142980b4f5331ce,
                ])),
                Felt::new(BigInteger384([
                    0x5a8e43398faca153,
                    0x6aa63af331795bcd,
                    0x8c27f6f27d49fc56,
                    0xa0826d929377d385,
                    0x604e14a58842c1d9,
                    0x014f1e650e59880a,
                ])),
                Felt::new(BigInteger384([
                    0x68a30dfebde9035a,
                    0x125813ad3349ca65,
                    0xd8c858fab98cc6a9,
                    0x28e383df97c0b54c,
                    0x8bf91c309966a351,
                    0x0101bb9eaa096840,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x39cfc92d30879388,
                    0xd663665d77c43211,
                    0x901565d20aae1b03,
                    0x1306cb7248ac7e88,
                    0x5fb2d98942ec791b,
                    0x00976b26a0d139f4,
                ])),
                Felt::new(BigInteger384([
                    0xa6f0c0cda54d8d71,
                    0xeb36a2ff9381cfee,
                    0xcfce25eadff64e02,
                    0x6c37ec64d82e42f1,
                    0x2b0da735fd3d8124,
                    0x0086000d36c1e57b,
                ])),
                Felt::new(BigInteger384([
                    0x651a8217a4d9088e,
                    0xcdb5a2dc70db0bc6,
                    0x573a0ab50e54e7dd,
                    0x563b511a2fe2c9e1,
                    0x15a3fc949d497ed7,
                    0x001659af9dae0bfb,
                ])),
                Felt::new(BigInteger384([
                    0x3ab0142e984e4efd,
                    0xc4d6c167b1df89b0,
                    0x7156a3ac59eb0aad,
                    0xdf0ad0f1bf632d85,
                    0x1f6716d1dd869fd5,
                    0x0106cd3becbee35c,
                ])),
                Felt::new(BigInteger384([
                    0x4c0e0d9111c0dbdd,
                    0xddcc20166874779b,
                    0xf9f116ca2a28816a,
                    0xe26dd958ae2d4d6d,
                    0xc19feb0811a1be01,
                    0x0001bf22505d005c,
                ])),
                Felt::new(BigInteger384([
                    0xbedd626035484ac1,
                    0x989efd0494611208,
                    0x1921b293351cdc91,
                    0x40f454d346164467,
                    0x845f0ac898b349b9,
                    0x0132a14f3a9f1d5f,
                ])),
                Felt::new(BigInteger384([
                    0x9dde1cca11a18b97,
                    0x20528de027ac3d5e,
                    0x03eb0564485125b3,
                    0x9efc400c08e8ac18,
                    0x35b2dffa5b4de483,
                    0x00af9aa31e49310b,
                ])),
                Felt::new(BigInteger384([
                    0x38272a8d73bb6ecd,
                    0x6e1e5d76d0f6a9dd,
                    0x88fce7b9df1919cc,
                    0x0f416709efbfcc4f,
                    0x8426eeaff60bb02d,
                    0x00dfdf2ac1c466fd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb46d4fbf625d2dbd,
                    0x94c941bf3c1ecd5b,
                    0xf3912afb5c71e467,
                    0xca287cd091fcc406,
                    0x102523a90facd898,
                    0x00bfc26350771907,
                ])),
                Felt::new(BigInteger384([
                    0x4729cebce0b2ac54,
                    0x57e4e2534855e407,
                    0x013f41437cef7cc2,
                    0x0ce9ea80c4d67ed0,
                    0x7a637559741dbe13,
                    0x019fb222a48b7d65,
                ])),
                Felt::new(BigInteger384([
                    0xa481220c3ab9eb67,
                    0xd22d82dcbd646324,
                    0x9ab7c9e5786b8e03,
                    0x955f7365225a398f,
                    0xaf0ca2fe69e699cc,
                    0x0187fd33566cd07f,
                ])),
                Felt::new(BigInteger384([
                    0x830b939faf73cb93,
                    0x7730736b84a1cfbe,
                    0x826d376047340c27,
                    0x48caf44eacd46e81,
                    0x36bb3cf4f183d655,
                    0x00d2062e947f3059,
                ])),
                Felt::new(BigInteger384([
                    0xfaac1b87fc6ef8f7,
                    0x9d0d115b56ab114a,
                    0xab32c387c76ebd1b,
                    0xd9811377660b42d1,
                    0x0a7ff0a61421a976,
                    0x014bf2a963272416,
                ])),
                Felt::new(BigInteger384([
                    0x9da1819fccddc5bd,
                    0xbd7e37e7b96d6ee8,
                    0x0491ca7755072951,
                    0xcd3be550c5fedae1,
                    0x98f32255cb37078a,
                    0x007aa21b31d11bb4,
                ])),
                Felt::new(BigInteger384([
                    0x573e4ca545028b61,
                    0x1874a71d4bfe40e7,
                    0x3f2f2d4c0e159d86,
                    0x7c001dbef4815429,
                    0xa4042888f869c859,
                    0x01ae174a20e3c463,
                ])),
                Felt::new(BigInteger384([
                    0xdbd5b405bef7e4fc,
                    0x5c733c0bd1af466f,
                    0x4efb1119555ddaa8,
                    0x8d4d29055f07ebae,
                    0xfe9fa46aa6d13b94,
                    0x0187bcacd330cdd0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xae1100fc27d8cb5c,
                    0x337f73ba6d4b6f64,
                    0xc643fc3350c5a190,
                    0x23bf7297c027564f,
                    0x09b3e8c7e24b0a37,
                    0x0110940786e55994,
                ])),
                Felt::new(BigInteger384([
                    0xb050427d3840b685,
                    0x17ea1ff762b95608,
                    0xc3fcdd3e0797daf0,
                    0xab83761d213b88e7,
                    0x9572337ac161633c,
                    0x0056b43207490249,
                ])),
                Felt::new(BigInteger384([
                    0x3d2066f16af3d850,
                    0xd0269be0d0863175,
                    0x134f8922baee8871,
                    0xb569a4280b4a6cc6,
                    0xfa5795e9ebdecaac,
                    0x0053d1d30b71e311,
                ])),
                Felt::new(BigInteger384([
                    0x0815c21699440381,
                    0x4d0cffa15177e8d9,
                    0xe4ddf7b3c8fe8b16,
                    0x289baf227ec0cf9d,
                    0xd4715e4d4aaa0916,
                    0x0021eeb3bb4e158b,
                ])),
                Felt::new(BigInteger384([
                    0x0b9d1088d2cc20df,
                    0x51b55a99e18392be,
                    0xd782ac01475a041c,
                    0xa2c4b0b87a13ac50,
                    0x5586905bbcceb485,
                    0x0121f5db3fcf3cd5,
                ])),
                Felt::new(BigInteger384([
                    0x19c77b89281d5c36,
                    0x771ea44468ee13dc,
                    0x32ab1da16c8d357a,
                    0xe0c735a568644a75,
                    0x93cfbe6bc5816676,
                    0x00794e5b3209e0f1,
                ])),
                Felt::new(BigInteger384([
                    0x2f17e721d7f710e4,
                    0x8d18c7bf1e1e6ecc,
                    0xdb1d3b1739c94279,
                    0x24c9ef2a41a5dbdd,
                    0x02e9eb46dcf81c3f,
                    0x01239951be45fba2,
                ])),
                Felt::new(BigInteger384([
                    0x031a0bbbffbfddd4,
                    0xf3790c3fbcfeb7d9,
                    0x2594a894d7bdd1df,
                    0x059e3212ea6109ff,
                    0x1997cf7dd18bfbc6,
                    0x01578829c2ac0fe6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x68af8758c6b0f346,
                    0x0c814ab8362eda0a,
                    0x32218ce56903a16e,
                    0x5fe6a67c80d3a06c,
                    0xc6392a21afa1d721,
                    0x0043ea07a8f355d7,
                ])),
                Felt::new(BigInteger384([
                    0xf91a5ede578d9c28,
                    0x4f825d34722e9976,
                    0x2c2d9e1a806cfd7e,
                    0x927eb8d47303363d,
                    0x849ae1d32973fe62,
                    0x00abdb3a589dcd86,
                ])),
                Felt::new(BigInteger384([
                    0x4e0e406a426d75c5,
                    0x05d48d82aa067c50,
                    0x6e23e3dc1d578d4c,
                    0x647e07f537d9c33c,
                    0x69a2ddb0e083b8a1,
                    0x0074844589c9f49a,
                ])),
                Felt::new(BigInteger384([
                    0xa110acbe6eaa26c5,
                    0xe06ac07b53c98990,
                    0x60abdfebb2cd08a6,
                    0x389bbe35882da70a,
                    0x91f6559964e19391,
                    0x002e997d6199ae7d,
                ])),
                Felt::new(BigInteger384([
                    0xf68eeaab1a55d3e1,
                    0xaf3c14cee12eb089,
                    0xabfe5511b5ac0d65,
                    0x87fd78393af51e53,
                    0x358c4ecad9f5e569,
                    0x00d4b01e3954a9bf,
                ])),
                Felt::new(BigInteger384([
                    0x7c3db3c0437f8fea,
                    0x6b76301cc8db53aa,
                    0xa0839e0cf3dde062,
                    0x83683a3a8d55dbdf,
                    0x4d8292608a1862f0,
                    0x014edc3dc5255e14,
                ])),
                Felt::new(BigInteger384([
                    0x8c651c1178eed7fa,
                    0x57c386e42731cdd9,
                    0x44d86a3d72a1e1eb,
                    0xa3f49841236097b4,
                    0x38bb7350461bdc5a,
                    0x01210ecf2be3638b,
                ])),
                Felt::new(BigInteger384([
                    0x4e742e6b29bc334f,
                    0x53f752fdfb792008,
                    0x49802e8b285882ca,
                    0x6e2912cf3a612ec2,
                    0xc2d942925662384c,
                    0x00ac2181c3ec32fe,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xfdb1232cabce2d5c,
                    0x1a30c2ce5d43c486,
                    0xd4cbb5228341817e,
                    0x1a5fdb75f6b8acd9,
                    0x261cb9e266e463a8,
                    0x008f11485c0b2b34,
                ])),
                Felt::new(BigInteger384([
                    0x5571ac8116a606ea,
                    0x0062ba0bb13c069c,
                    0x41d2d4295d8e71f1,
                    0x3fdd0d1d59c88cf8,
                    0x9efc7fd2c462105e,
                    0x00245ab332c0a89d,
                ])),
                Felt::new(BigInteger384([
                    0x5a6ce89dad0510ff,
                    0x8ae6163365d2b6ea,
                    0xe6415f51d4ffcf3f,
                    0x7d22faf9e46f5a02,
                    0xf38fe81e5c1aa942,
                    0x017d8c3cca879a28,
                ])),
                Felt::new(BigInteger384([
                    0x3a8077b164dd1fb0,
                    0x81dce1299830408a,
                    0xf06383e387a77ad0,
                    0xcb2419be0181cdce,
                    0x84498b1ee053d698,
                    0x019b55827979bd24,
                ])),
                Felt::new(BigInteger384([
                    0x0e4c0ef49aba37ec,
                    0x7b30fbb984026dee,
                    0x1d1094cf476e0d58,
                    0x85059cfe09db7a2d,
                    0xe3d1ab43daa21cf7,
                    0x01a45cae19029185,
                ])),
                Felt::new(BigInteger384([
                    0xa033b01d3074b402,
                    0x2697533c8a2e129a,
                    0x94801c7ca5b2ee2e,
                    0xc8fff61e0685eabd,
                    0x6fcaa6df470c8b49,
                    0x008f858f4e9c0254,
                ])),
                Felt::new(BigInteger384([
                    0xef88d8c3400af854,
                    0x24b09b4be2db00a2,
                    0x07eeda48ad2d7a74,
                    0xf82b887092b11fe1,
                    0x6367a40c612fdd3d,
                    0x0191a7b74c302eb6,
                ])),
                Felt::new(BigInteger384([
                    0x1ab2409cd48dcc95,
                    0x4df59d61e85f8914,
                    0xd52719fbf850b822,
                    0xaa6df8f0d7b50422,
                    0x0fa7c1753718b761,
                    0x01826401f5f1ed7e,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xb84ebfffffffe409,
                    0x9132d225affff177,
                    0x77d13b548673857b,
                    0x1b6315703a7a08a5,
                    0x837227e22da91c38,
                    0x00c061dd4813ea92,
                ])),
                Felt::new(BigInteger384([
                    0x4e41fffffffecf58,
                    0x61c9d2407fff61ae,
                    0xabaee3c2e468a493,
                    0x7650676457f13552,
                    0xd26fb8b92f31c22d,
                    0x007685c662961a87,
                ])),
                Felt::new(BigInteger384([
                    0x9b8f3ffffffeea1f,
                    0x73183f21cfff6f98,
                    0x72d90fc172ef9efc,
                    0x518a8162fa6ff2b8,
                    0xe8e6bc560201afc6,
                    0x00d0f0ace07e1929,
                ])),
                Felt::new(BigInteger384([
                    0xdce93fffffffd197,
                    0x81947e684fffe7e1,
                    0x928826ff074173d2,
                    0x048af12891f742bc,
                    0x16c2108e76b05810,
                    0x011180fad721e016,
                ])),
                Felt::new(BigInteger384([
                    0xb84ebfffffffe409,
                    0x9132d225affff177,
                    0x77d13b548673857b,
                    0x1b6315703a7a08a5,
                    0x837227e22da91c38,
                    0x00c061dd4813ea92,
                ])),
                Felt::new(BigInteger384([
                    0x4e41fffffffecf58,
                    0x61c9d2407fff61ae,
                    0xabaee3c2e468a493,
                    0x7650676457f13552,
                    0xd26fb8b92f31c22d,
                    0x007685c662961a87,
                ])),
                Felt::new(BigInteger384([
                    0x9b8f3ffffffeea1f,
                    0x73183f21cfff6f98,
                    0x72d90fc172ef9efc,
                    0x518a8162fa6ff2b8,
                    0xe8e6bc560201afc6,
                    0x00d0f0ace07e1929,
                ])),
                Felt::new(BigInteger384([
                    0xdce93fffffffd197,
                    0x81947e684fffe7e1,
                    0x928826ff074173d2,
                    0x048af12891f742bc,
                    0x16c2108e76b05810,
                    0x011180fad721e016,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0xb84ebfffffffe409,
                    0x9132d225affff177,
                    0x77d13b548673857b,
                    0x1b6315703a7a08a5,
                    0x837227e22da91c38,
                    0x00c061dd4813ea92,
                ])),
                Felt::new(BigInteger384([
                    0x4e41fffffffecf58,
                    0x61c9d2407fff61ae,
                    0xabaee3c2e468a493,
                    0x7650676457f13552,
                    0xd26fb8b92f31c22d,
                    0x007685c662961a87,
                ])),
                Felt::new(BigInteger384([
                    0x9b8f3ffffffeea1f,
                    0x73183f21cfff6f98,
                    0x72d90fc172ef9efc,
                    0x518a8162fa6ff2b8,
                    0xe8e6bc560201afc6,
                    0x00d0f0ace07e1929,
                ])),
                Felt::new(BigInteger384([
                    0xdce93fffffffd197,
                    0x81947e684fffe7e1,
                    0x928826ff074173d2,
                    0x048af12891f742bc,
                    0x16c2108e76b05810,
                    0x011180fad721e016,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb84ebfffffffe409,
                    0x9132d225affff177,
                    0x77d13b548673857b,
                    0x1b6315703a7a08a5,
                    0x837227e22da91c38,
                    0x00c061dd4813ea92,
                ])),
                Felt::new(BigInteger384([
                    0x4e41fffffffecf58,
                    0x61c9d2407fff61ae,
                    0xabaee3c2e468a493,
                    0x7650676457f13552,
                    0xd26fb8b92f31c22d,
                    0x007685c662961a87,
                ])),
                Felt::new(BigInteger384([
                    0x9b8f3ffffffeea1f,
                    0x73183f21cfff6f98,
                    0x72d90fc172ef9efc,
                    0x518a8162fa6ff2b8,
                    0xe8e6bc560201afc6,
                    0x00d0f0ace07e1929,
                ])),
                Felt::new(BigInteger384([
                    0xdce93fffffffd197,
                    0x81947e684fffe7e1,
                    0x928826ff074173d2,
                    0x048af12891f742bc,
                    0x16c2108e76b05810,
                    0x011180fad721e016,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x03ed83ae219618c6,
                    0x318a6bf193133519,
                    0x7acc081230fea3cd,
                    0x24aee0b37dac5604,
                    0x5677afc31cdf2fed,
                    0x010df0839b43c183,
                ])),
                Felt::new(BigInteger384([
                    0xf641f6682fcbf7dd,
                    0xfe06ca77f75f34f5,
                    0x1e0ed7e004800dcd,
                    0x0f072d9b76a16840,
                    0x8fa9ae3f82c88ece,
                    0x015dd896325f7b44,
                ])),
                Felt::new(BigInteger384([
                    0x904ba47d563536d3,
                    0xdfe62f11150d2de8,
                    0xbf3ef9846e3cbbbf,
                    0x5eedd4efcb9d7a8e,
                    0x1fec4f40ab6e7f10,
                    0x014d5a070dbffce7,
                ])),
                Felt::new(BigInteger384([
                    0xc22badb9e7bcd65c,
                    0x53aab2edf7d920df,
                    0x1b2488f14c724cb3,
                    0x71fa61023d9991ff,
                    0x493308fb253acdad,
                    0x00ee8f9c57a36beb,
                ])),
                Felt::new(BigInteger384([
                    0x44516785f81a4d75,
                    0x3020bfa3f88eed49,
                    0x3db2c6283a2b7311,
                    0x778af0cca3e7c0ff,
                    0x0527a30af69ae9a9,
                    0x000c39e003ee6d43,
                ])),
                Felt::new(BigInteger384([
                    0x5d26aa1011a6016d,
                    0xf7d3e706378d56b2,
                    0xd3f62acceb72e589,
                    0x9e878658634eaac8,
                    0x26f4892526096e43,
                    0x010ae106e11e2d8a,
                ])),
                Felt::new(BigInteger384([
                    0x60c2f577c54defd3,
                    0x3c3be35d3288a3c4,
                    0x323d49f0e7091709,
                    0x58429f64dd5eff0b,
                    0x13b86660c6a3b49e,
                    0x0033e90b0b52584a,
                ])),
                Felt::new(BigInteger384([
                    0x5cec15bc5996b45b,
                    0xb9ebf5c6f2d47195,
                    0xa8562aa4c0b3335e,
                    0xb619c0f1e56def89,
                    0x7f72c668a1660a24,
                    0x01254c0b90011dce,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3a3764251aae8bae,
                    0xc65cff55e8cff2e7,
                    0x7d2f3b693f46f95e,
                    0x6d96cb35c24e0748,
                    0x8ebe19a3eb830d11,
                    0x007749abc4c59a01,
                ])),
                Felt::new(BigInteger384([
                    0xd76564a15ee95d4e,
                    0x0f435a01b4e55943,
                    0xb6b72cbc6a6e01f4,
                    0xe9dd83ae108ae23f,
                    0xaad69deb7a664e5b,
                    0x01304d34237cec71,
                ])),
                Felt::new(BigInteger384([
                    0xf8e5ca771a0ff298,
                    0xf37506c4a75b685b,
                    0x7a781ae05bc2299b,
                    0xe162965c6e2288e2,
                    0xe09dff46626bf24e,
                    0x002834761e8560f4,
                ])),
                Felt::new(BigInteger384([
                    0x6dd80e063a79c938,
                    0xfcc8a88763c99a90,
                    0x5759394a14775b70,
                    0xbbf1de4464efc762,
                    0x111e82264d327a50,
                    0x016918346570abbb,
                ])),
                Felt::new(BigInteger384([
                    0x905a38cb21a96418,
                    0xb6dabf4e9c6bddfa,
                    0x338131c85e7c17ff,
                    0xd1f2561e0729629f,
                    0x58be75f06347bc3c,
                    0x002f27e9ca9b3e9b,
                ])),
                Felt::new(BigInteger384([
                    0x3ddd4167be0e1cba,
                    0x3cf03475704f7b7b,
                    0x6e0f39e73945ac85,
                    0x5a67e4d6088647b4,
                    0x6ab2dc0c7254f4d9,
                    0x014c4a8e0f3cb297,
                ])),
                Felt::new(BigInteger384([
                    0x8535c7c6e34e8ef9,
                    0x27fba2c75ff0ece7,
                    0x38a75de69e2e4eca,
                    0x4e4349a44f66c205,
                    0x05cb4b1e966d1d9e,
                    0x0151245085c4b17c,
                ])),
                Felt::new(BigInteger384([
                    0xfad8b9d65b1dcf0d,
                    0xfa182e8909a7fc9b,
                    0xf1faed1741823b6f,
                    0x314b495c46f58e8d,
                    0x9dbac65df6e69c1e,
                    0x018ec5ddd443c88c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc30de0a02635ab7f,
                    0x21ffb798dfda090c,
                    0x627683933c759913,
                    0xf05c9239e0a9c9e7,
                    0x4cc5c9736616ff75,
                    0x0180e56f054c9b10,
                ])),
                Felt::new(BigInteger384([
                    0xd8672962060b1db1,
                    0x3e2699d0dd769e0c,
                    0x0f64d3e42f8e8620,
                    0x14470035920392f3,
                    0xf61dd0aa50bcdceb,
                    0x017f3fc5d8c1960e,
                ])),
                Felt::new(BigInteger384([
                    0x8be7a73e22e54c42,
                    0xf1c9a90652114662,
                    0x82cb5a6012710636,
                    0xe0d9fb5a0737f853,
                    0x6da59a7901cf2ae5,
                    0x00af9496b0b28080,
                ])),
                Felt::new(BigInteger384([
                    0x9533bd87c3973dfb,
                    0x7c6a443e07523d8c,
                    0x942fa288439226ad,
                    0x943cd96a8ecf74b4,
                    0x986f7f04ba9d5ec8,
                    0x00f1bd70ea032798,
                ])),
                Felt::new(BigInteger384([
                    0x54bab542180d7ce1,
                    0x327b42dc269ca13b,
                    0xab395b041ae15e2b,
                    0x63be64a472f3b508,
                    0xa29b7b0ee03a3e56,
                    0x00dc0790a0a4d8de,
                ])),
                Felt::new(BigInteger384([
                    0xb3dcde37423bea60,
                    0x7be60fd5b136d1b4,
                    0x920efd72e36f5f4d,
                    0xe2a5302b42b0f785,
                    0x8e35e9863c38de9a,
                    0x00eaa31211d7193a,
                ])),
                Felt::new(BigInteger384([
                    0xcef9373a3c0ebe9c,
                    0x08524eba6005e048,
                    0x0ba3380271a17ffa,
                    0xadfff4a389485df8,
                    0x6256b395b2fe26ed,
                    0x00891aa0ac220f89,
                ])),
                Felt::new(BigInteger384([
                    0x43d4e6d620a13686,
                    0x8be01c2f0e96ffab,
                    0xe3b6f744284621ea,
                    0x7d0a9f0bb35c3245,
                    0xc2fc5bb9ee2e5d8f,
                    0x00ee49b000ffcc08,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1e045047eb2a14e4,
                    0xc6d802f346c45a82,
                    0xb814ad576ee67d8a,
                    0x2752c022e3d4e5bd,
                    0x1300476d31fca5cf,
                    0x019e8722fa519901,
                ])),
                Felt::new(BigInteger384([
                    0x3a2622d700afc967,
                    0x60cbf927c2f5d8d8,
                    0x385277a7b2b07f92,
                    0x75480c505cc02c51,
                    0x3c333d6acc48b691,
                    0x00cf70ce96b7b967,
                ])),
                Felt::new(BigInteger384([
                    0x7a831608759f3664,
                    0xe55d89e64c3643c3,
                    0x0a7ea3c19c277e87,
                    0x1d3834e25a4e25cb,
                    0xc85912403df87e36,
                    0x009831e52a947c43,
                ])),
                Felt::new(BigInteger384([
                    0xec5b467b25ecb487,
                    0x5380ed895883d4bc,
                    0x24636642f2e6ac24,
                    0x211500878aeecb58,
                    0x29ae02dc8f9060ae,
                    0x00f4bba6d555349d,
                ])),
                Felt::new(BigInteger384([
                    0xc1dfd5aefdc256d2,
                    0x5dec212c64775f67,
                    0xbb7d1bb9e0549ed8,
                    0xacb359e14601318f,
                    0xb79a52caeb890e39,
                    0x005bc2b92b3bebc9,
                ])),
                Felt::new(BigInteger384([
                    0xd087bf983c23b874,
                    0xc53103ee04a195eb,
                    0x15ad77d27d2a17ec,
                    0xaad864a9c22344ef,
                    0x0bf49072cdf00b71,
                    0x014dee0834c3dae6,
                ])),
                Felt::new(BigInteger384([
                    0xd27e8c943e75cebb,
                    0x5470f180f736b92b,
                    0x490552a18922a908,
                    0xe99355a525372623,
                    0x24d8e19a183f36b2,
                    0x00e0d8b5e212bac5,
                ])),
                Felt::new(BigInteger384([
                    0x47106e3cd1c0dc28,
                    0x953658fc5fb699fa,
                    0x917a39c10034723f,
                    0x1aee6d87a850f75b,
                    0x448c7e57d00320f3,
                    0x0079e19b1b2d1783,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc0bc5aa09fece1d0,
                    0x6dd450aef848c9a1,
                    0x9fbf4d05e988e28d,
                    0x82b298e0e5f953af,
                    0x831d03a94041c57c,
                    0x0065a0cfe069f1a6,
                ])),
                Felt::new(BigInteger384([
                    0xb127972c43ba43a6,
                    0x8ee4902660acefef,
                    0x432919dc2ba1510c,
                    0x9255cb768314a7c4,
                    0x2e67d6b87df63653,
                    0x00216de7180a5c23,
                ])),
                Felt::new(BigInteger384([
                    0x523522c2c20bf144,
                    0x7d13e76410c199cf,
                    0x01b8f7d62b890d6b,
                    0x020891e690f22abe,
                    0xf61edf0416ca465b,
                    0x00ab925939318dda,
                ])),
                Felt::new(BigInteger384([
                    0xf45b8499d4416fff,
                    0xfa1afde6a98c17c2,
                    0x8f73a07279a4fb0c,
                    0x1e281d3cb014f22d,
                    0x45a7de97f86091f0,
                    0x012ef6fa9b5c2b54,
                ])),
                Felt::new(BigInteger384([
                    0xd4ebed25cf7b7b42,
                    0xeea0f4fba9cd69c8,
                    0x69a2c39baf61b1e5,
                    0xbbaf75038c740602,
                    0xd1a4c1d091e108b9,
                    0x01969afe1faeefe6,
                ])),
                Felt::new(BigInteger384([
                    0x895a1dc77f2fd2d3,
                    0xf80606c323aee54a,
                    0xc2056a172a291ef7,
                    0x016fdc95d60cb6ad,
                    0xc2866ab8faeb6e45,
                    0x002b62435d73181f,
                ])),
                Felt::new(BigInteger384([
                    0xbd1100736c22bf75,
                    0xcc9ec8c869ee9d05,
                    0x3dbeaec5e1472f5f,
                    0x6d1d3a0dfa4f243f,
                    0x771fae99393ea4d6,
                    0x0104b2522ecce9d8,
                ])),
                Felt::new(BigInteger384([
                    0x593bc51af4496568,
                    0xfc3961b84bc11103,
                    0xbe27c2bfafb4a9d7,
                    0x38fbada70c152824,
                    0x1585e1addc690f3b,
                    0x0052d49255d26ce7,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xfcb6cfe0226f7620,
                    0x437f5142e330ae11,
                    0x04102870b6e8cf7c,
                    0x5e68338af09f9a73,
                    0xa6f2d0d8e9399bb3,
                    0x008d5cbfd2d6e7ff,
                ])),
                Felt::new(BigInteger384([
                    0x18e72b9e42f43ef2,
                    0x5d6a02d40bd92c50,
                    0x8da11a0d8661a4f1,
                    0x62417ed3f5e51548,
                    0xee0c767ce78b05e7,
                    0x018fed69086b7806,
                ])),
                Felt::new(BigInteger384([
                    0xea4a6b6be2f8fd17,
                    0x1d72d12707284960,
                    0x813c18b8f63f80e4,
                    0x43f359e954d1a118,
                    0x45f7d998bcf694ff,
                    0x0007c25eac9b52ee,
                ])),
                Felt::new(BigInteger384([
                    0x730432bfec1ba5e3,
                    0xb2b0f65604ddd5aa,
                    0x6f160878547e95ce,
                    0xbc29f845a30042a7,
                    0x4c1995525a453e0d,
                    0x00e86e1503de9803,
                ])),
                Felt::new(BigInteger384([
                    0xa72fa5d6b65c7ca6,
                    0x5bfb5622019b95d3,
                    0x11cf80ebf5290f9e,
                    0xafa3aa553fe50673,
                    0x9e784f2b24e58375,
                    0x00ab818ef3d88786,
                ])),
                Felt::new(BigInteger384([
                    0x85599a1fa644920f,
                    0x3aa01a935212d30a,
                    0x53e0c496e5d5cb2f,
                    0x0fa2c727a6480c78,
                    0x6a119591edf9afd6,
                    0x014f041611aea3bb,
                ])),
                Felt::new(BigInteger384([
                    0xe8ddbd296067c1be,
                    0x12e155b58d805073,
                    0xbf8cd8408983dc33,
                    0x0707c16dfea4fd14,
                    0xd8908b9204af4bad,
                    0x01167587a0dd3c54,
                ])),
                Felt::new(BigInteger384([
                    0xbcd8b9f1e891cd88,
                    0x7380028629262452,
                    0xee5cdf908f039e77,
                    0x7b7caab230d498bc,
                    0x659feb355e7807c3,
                    0x00a4f7e6436ca657,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
