use super::Felt;
use super::MontFp;

use ark_ff::Field;

/// Exponent of the Anemoi S-Box
pub(crate) const ALPHA: u32 = 5;

/// Inverse exponent
pub(crate) const INV_ALPHA: Felt = MontFp!("206931540810375275208522186955914826829114810203931728431907410133376374678672658219975110511658688099552257166541");

/// Multiplier of the Anemoi S-Box
pub(crate) const BETA: u32 = 15;

/// First added constant of the Anemoi S-Box
pub(crate) const DELTA: Felt = MontFp!("34488590135062545868087031159319137804852468367321954738651235022229395779778776369995851751943114683258709527757");

#[allow(unused)]
/// Second added constant of the Anemoi S-Box
pub(crate) const QUAD: u32 = 2;

#[inline(always)]
pub(crate) fn exp_by_inv_alpha(x: &Felt) -> Felt {
    let t22 = x.square(); //    1: 2
    let t16 = t22 * x; //       2: 3
    let t20 = t22.square(); //  3: 4
    let t10 = t16 * t22; //     4: 5
    let t9 = t10 * t20; //      5: 9
    let t1 = t9 * t20; //       6: 13
    let t3 = t1 * t22; //       7: 15
    let t4 = t3 * t20; //       8: 19
    let t23 = t4 * t22; //      9: 21
    let t6 = t4 * t20; //      10: 23
    let t12 = t6 * t20; //     11: 27
    let t11 = t12 * t22; //    12: 29
    let t21 = t12 * t20; //    13: 31
    let t14 = t11 * t20; //    14: 33
    let t18 = t14 * t20; //    15: 37
    let t17 = t18 * t22; //    16: 39
    let t19 = t18 * t20; //    17: 41
    let mut t0 = t17 * t20; // 18: 43
    let t13 = t19 * t20; //    19: 45
    let t7 = t0 * t20; //      20: 47
    let t15 = t13 * t20; //    21: 49
    let t2 = t7 * t20; //      22: 51
    let t8 = t2 * t20; //      23: 55
    let t22 = t8 * t22; //     24: 57
    let t20 = t8 * t20; //     25: 59
    t0 = t0.square(); //       26: 86
    t0 = t0.square(); //       27: 172
    t0 = t0.square(); //       28: 344
    t0 = t0.square(); //       29: 688
    t0 = t0.square(); //       30: 1376
    t0 = t0.square(); //       31: 2752
    t0 = t0.square(); //       32: 5504
    t0 = t0.square(); //       33: 11008
    t0 = t0.square(); //       34: 22016
    t0 = t0.square(); //       35: 44032
    t0 *= t6; //               36: 44055
    t0 = t0.square(); //       37: 88110
    t0 = t0.square(); //       38: 176220
    t0 = t0.square(); //       39: 352440
    t0 = t0.square(); //       40: 704880
    t0 = t0.square(); //       41: 1409760
    t0 = t0.square(); //       42: 2819520
    t0 = t0.square(); //       43: 5639040
    t0 *= t17; //              44: 5639079
    t0 = t0.square(); //       45: 11278158
    t0 = t0.square(); //       46: 22556316
    t0 = t0.square(); //       47: 45112632
    t0 = t0.square(); //       48: 90225264
    t0 = t0.square(); //       49: 180450528
    t0 = t0.square(); //       50: 360901056
    t0 *= t17; //              51: 360901095
    t0 = t0.square(); //       52: 721802190
    t0 = t0.square(); //       53: 1443604380
    t0 = t0.square(); //       54: 2887208760
    t0 = t0.square(); //       55: 5774417520
    t0 = t0.square(); //       56: 11548835040
    t0 = t0.square(); //       57: 23097670080
    t0 *= t18; //              58: 23097670117
    t0 = t0.square(); //       59: 46195340234
    t0 = t0.square(); //       60: 92390680468
    t0 = t0.square(); //       61: 184781360936
    t0 = t0.square(); //       62: 369562721872
    t0 = t0.square(); //       63: 739125443744
    t0 *= t23; //              64: 739125443765
    t0 = t0.square(); //       65: 1478250887530
    t0 = t0.square(); //       66: 2956501775060
    t0 = t0.square(); //       67: 5913003550120
    t0 = t0.square(); //       68: 11826007100240
    t0 = t0.square(); //       69: 23652014200480
    t0 = t0.square(); //       70: 47304028400960
    t0 = t0.square(); //       71: 94608056801920
    t0 = t0.square(); //       72: 189216113603840
    t0 *= t22; //              73: 189216113603897
    t0 = t0.square(); //       74: 378432227207794
    t0 = t0.square(); //       75: 756864454415588
    t0 = t0.square(); //       76: 1513728908831176
    t0 = t0.square(); //       77: 3027457817662352
    t0 *= t3; //               78: 3027457817662367
    t0 = t0.square(); //       79: 6054915635324734
    t0 = t0.square(); //       80: 12109831270649468
    t0 = t0.square(); //       81: 24219662541298936
    t0 = t0.square(); //       82: 48439325082597872
    t0 = t0.square(); //       83: 96878650165195744
    t0 *= t3; //               84: 96878650165195759
    t0 = t0.square(); //       85: 193757300330391518
    t0 = t0.square(); //       86: 387514600660783036
    t0 = t0.square(); //       87: 775029201321566072
    t0 = t0.square(); //       88: 1550058402643132144
    t0 = t0.square(); //       89: 3100116805286264288
    t0 = t0.square(); //       90: 6200233610572528576
    t0 = t0.square(); //       91: 12400467221145057152
    t0 = t0.square(); //       92: 24800934442290114304
    t0 = t0.square(); //       93: 49601868884580228608
    t0 *= t9; //               94: 49601868884580228617
    t0 = t0.square(); //       95: 99203737769160457234
    t0 = t0.square(); //       96: 198407475538320914468
    t0 = t0.square(); //       97: 396814951076641828936
    t0 = t0.square(); //       98: 793629902153283657872
    t0 = t0.square(); //       99: 1587259804306567315744
    t0 *= t21; //             100: 1587259804306567315775
    t0 = t0.square(); //      101: 3174519608613134631550
    t0 = t0.square(); //      102: 6349039217226269263100
    t0 = t0.square(); //      103: 12698078434452538526200
    t0 = t0.square(); //      104: 25396156868905077052400
    t0 = t0.square(); //      105: 50792313737810154104800
    t0 = t0.square(); //      106: 101584627475620308209600
    t0 = t0.square(); //      107: 203169254951240616419200
    t0 = t0.square(); //      108: 406338509902481232838400
    t0 = t0.square(); //      109: 812677019804962465676800
    t0 = t0.square(); //      110: 1625354039609924931353600
    t0 = t0.square(); //      111: 3250708079219849862707200
    t0 *= t9; //              112: 3250708079219849862707209
    t0 = t0.square(); //      113: 6501416158439699725414418
    t0 = t0.square(); //      114: 13002832316879399450828836
    t0 = t0.square(); //      115: 26005664633758798901657672
    t0 = t0.square(); //      116: 52011329267517597803315344
    t0 *= t16; //             117: 52011329267517597803315347
    t0 = t0.square(); //      118: 104022658535035195606630694
    t0 = t0.square(); //      119: 208045317070070391213261388
    t0 = t0.square(); //      120: 416090634140140782426522776
    t0 = t0.square(); //      121: 832181268280281564853045552
    t0 = t0.square(); //      122: 1664362536560563129706091104
    t0 = t0.square(); //      123: 3328725073121126259412182208
    t0 = t0.square(); //      124: 6657450146242252518824364416
    t0 *= t21; //             125: 6657450146242252518824364447
    t0 = t0.square(); //      126: 13314900292484505037648728894
    t0 = t0.square(); //      127: 26629800584969010075297457788
    t0 = t0.square(); //      128: 53259601169938020150594915576
    t0 = t0.square(); //      129: 106519202339876040301189831152
    t0 = t0.square(); //      130: 213038404679752080602379662304
    t0 *= x; //               131: 213038404679752080602379662305
    t0 = t0.square(); //      132: 426076809359504161204759324610
    t0 = t0.square(); //      133: 852153618719008322409518649220
    t0 = t0.square(); //      134: 1704307237438016644819037298440
    t0 = t0.square(); //      135: 3408614474876033289638074596880
    t0 = t0.square(); //      136: 6817228949752066579276149193760
    t0 = t0.square(); //      137: 13634457899504133158552298387520
    t0 = t0.square(); //      138: 27268915799008266317104596775040
    t0 *= x; //               139: 27268915799008266317104596775041
    t0 = t0.square(); //      140: 54537831598016532634209193550082
    t0 = t0.square(); //      141: 109075663196033065268418387100164
    t0 = t0.square(); //      142: 218151326392066130536836774200328
    t0 = t0.square(); //      143: 436302652784132261073673548400656
    t0 = t0.square(); //      144: 872605305568264522147347096801312
    t0 = t0.square(); //      145: 1745210611136529044294694193602624
    t0 = t0.square(); //      146: 3490421222273058088589388387205248
    t0 = t0.square(); //      147: 6980842444546116177178776774410496
    t0 = t0.square(); //      148: 13961684889092232354357553548820992
    t0 = t0.square(); //      149: 27923369778184464708715107097641984
    t0 = t0.square(); //      150: 55846739556368929417430214195283968
    t0 *= t20; //             151: 55846739556368929417430214195284027
    t0 = t0.square(); //      152: 111693479112737858834860428390568054
    t0 = t0.square(); //      153: 223386958225475717669720856781136108
    t0 = t0.square(); //      154: 446773916450951435339441713562272216
    t0 = t0.square(); //      155: 893547832901902870678883427124544432
    t0 = t0.square(); //      156: 1787095665803805741357766854249088864
    t0 = t0.square(); //      157: 3574191331607611482715533708498177728
    t0 = t0.square(); //      158: 7148382663215222965431067416996355456
    t0 = t0.square(); //      159: 14296765326430445930862134833992710912
    t0 = t0.square(); //      160: 28593530652860891861724269667985421824
    t0 *= t17; //             161: 28593530652860891861724269667985421863
    t0 = t0.square(); //      162: 57187061305721783723448539335970843726
    t0 = t0.square(); //      163: 114374122611443567446897078671941687452
    t0 = t0.square(); //      164: 228748245222887134893794157343883374904
    t0 = t0.square(); //      165: 457496490445774269787588314687766749808
    t0 = t0.square(); //      166: 914992980891548539575176629375533499616
    t0 = t0.square(); //      167: 1829985961783097079150353258751066999232
    t0 *= t13; //             168: 1829985961783097079150353258751066999277
    t0 = t0.square(); //      169: 3659971923566194158300706517502133998554
    t0 = t0.square(); //      170: 7319943847132388316601413035004267997108
    t0 = t0.square(); //      171: 14639887694264776633202826070008535994216
    t0 = t0.square(); //      172: 29279775388529553266405652140017071988432
    t0 = t0.square(); //      173: 58559550777059106532811304280034143976864
    t0 = t0.square(); //      174: 117119101554118213065622608560068287953728
    t0 *= t3; //              175: 117119101554118213065622608560068287953743
    t0 = t0.square(); //      176: 234238203108236426131245217120136575907486
    t0 = t0.square(); //      177: 468476406216472852262490434240273151814972
    t0 = t0.square(); //      178: 936952812432945704524980868480546303629944
    t0 = t0.square(); //      179: 1873905624865891409049961736961092607259888
    t0 = t0.square(); //      180: 3747811249731782818099923473922185214519776
    t0 = t0.square(); //      181: 7495622499463565636199846947844370429039552
    t0 = t0.square(); //      182: 14991244998927131272399693895688740858079104
    t0 = t0.square(); //      183: 29982489997854262544799387791377481716158208
    t0 = t0.square(); //      184: 59964979995708525089598775582754963432316416
    t0 *= t19; //             185: 59964979995708525089598775582754963432316457
    t0 = t0.square(); //      186: 119929959991417050179197551165509926864632914
    t0 = t0.square(); //      187: 239859919982834100358395102331019853729265828
    t0 = t0.square(); //      188: 479719839965668200716790204662039707458531656
    t0 = t0.square(); //      189: 959439679931336401433580409324079414917063312
    t0 = t0.square(); //      190: 1918879359862672802867160818648158829834126624
    t0 = t0.square(); //      191: 3837758719725345605734321637296317659668253248
    t0 *= t14; //             192: 3837758719725345605734321637296317659668253281
    t0 = t0.square(); //      193: 7675517439450691211468643274592635319336506562
    t0 = t0.square(); //      194: 15351034878901382422937286549185270638673013124
    t0 = t0.square(); //      195: 30702069757802764845874573098370541277346026248
    t0 = t0.square(); //      196: 61404139515605529691749146196741082554692052496
    t0 = t0.square(); //      197: 122808279031211059383498292393482165109384104992
    t0 = t0.square(); //      198: 245616558062422118766996584786964330218768209984
    t0 = t0.square(); //      199: 491233116124844237533993169573928660437536419968
    t0 = t0.square(); //      200: 982466232249688475067986339147857320875072839936
    t0 *= t2; //              201: 982466232249688475067986339147857320875072839987
    t0 = t0.square(); //      202: 1964932464499376950135972678295714641750145679974
    t0 = t0.square(); //      203: 3929864928998753900271945356591429283500291359948
    t0 = t0.square(); //      204: 7859729857997507800543890713182858567000582719896
    t0 = t0.square(); //      205: 15719459715995015601087781426365717134001165439792
    t0 = t0.square(); //      206: 31438919431990031202175562852731434268002330879584
    t0 = t0.square(); //      207: 62877838863980062404351125705462868536004661759168
    t0 *= t18; //             208: 62877838863980062404351125705462868536004661759205
    t0 = t0.square(); //      209: 125755677727960124808702251410925737072009323518410
    t0 = t0.square(); //      210: 251511355455920249617404502821851474144018647036820
    t0 = t0.square(); //      211: 503022710911840499234809005643702948288037294073640
    t0 = t0.square(); //      212: 1006045421823680998469618011287405896576074588147280
    t0 = t0.square(); //      213: 2012090843647361996939236022574811793152149176294560
    t0 = t0.square(); //      214: 4024181687294723993878472045149623586304298352589120
    t0 = t0.square(); //      215: 8048363374589447987756944090299247172608596705178240
    t0 *= t17; //             216: 8048363374589447987756944090299247172608596705178279
    t0 = t0.square(); //      217: 16096726749178895975513888180598494345217193410356558
    t0 = t0.square(); //      218: 32193453498357791951027776361196988690434386820713116
    t0 = t0.square(); //      219: 64386906996715583902055552722393977380868773641426232
    t0 *= t16; //             220: 64386906996715583902055552722393977380868773641426235
    t0 = t0.square(); //      221: 128773813993431167804111105444787954761737547282852470
    t0 = t0.square(); //      222: 257547627986862335608222210889575909523475094565704940
    t0 = t0.square(); //      223: 515095255973724671216444421779151819046950189131409880
    t0 = t0.square(); //      224: 1030190511947449342432888843558303638093900378262819760
    t0 = t0.square(); //      225: 2060381023894898684865777687116607276187800756525639520
    t0 = t0.square(); //      226: 4120762047789797369731555374233214552375601513051279040
    t0 = t0.square(); //      227: 8241524095579594739463110748466429104751203026102558080
    t0 *= t16; //             228: 8241524095579594739463110748466429104751203026102558083
    t0 = t0.square(); //      229: 16483048191159189478926221496932858209502406052205116166
    t0 = t0.square(); //      230: 32966096382318378957852442993865716419004812104410232332
    t0 = t0.square(); //      231: 65932192764636757915704885987731432838009624208820464664
    t0 = t0.square(); //      232: 131864385529273515831409771975462865676019248417640929328
    t0 = t0.square(); //      233: 263728771058547031662819543950925731352038496835281858656
    t0 = t0.square(); //      234: 527457542117094063325639087901851462704076993670563717312
    t0 = t0.square(); //      235: 1054915084234188126651278175803702925408153987341127434624
    t0 = t0.square(); //      236: 2109830168468376253302556351607405850816307974682254869248
    t0 = t0.square(); //      237: 4219660336936752506605112703214811701632615949364509738496
    t0 = t0.square(); //      238: 8439320673873505013210225406429623403265231898729019476992
    t0 = t0.square(); //      239: 16878641347747010026420450812859246806530463797458038953984
    t0 *= t15; //             240: 16878641347747010026420450812859246806530463797458038954033
    t0 = t0.square(); //      241: 33757282695494020052840901625718493613060927594916077908066
    t0 = t0.square(); //      242: 67514565390988040105681803251436987226121855189832155816132
    t0 = t0.square(); //      243: 135029130781976080211363606502873974452243710379664311632264
    t0 = t0.square(); //      244: 270058261563952160422727213005747948904487420759328623264528
    t0 = t0.square(); //      245: 540116523127904320845454426011495897808974841518657246529056
    t0 = t0.square(); //      246: 1080233046255808641690908852022991795617949683037314493058112
    t0 *= t14; //             247: 1080233046255808641690908852022991795617949683037314493058145
    t0 = t0.square(); //      248: 2160466092511617283381817704045983591235899366074628986116290
    t0 = t0.square(); //      249: 4320932185023234566763635408091967182471798732149257972232580
    t0 = t0.square(); //      250: 8641864370046469133527270816183934364943597464298515944465160
    t0 = t0.square(); //      251: 17283728740092938267054541632367868729887194928597031888930320
    t0 = t0.square(); //      252: 34567457480185876534109083264735737459774389857194063777860640
    t0 = t0.square(); //      253: 69134914960371753068218166529471474919548779714388127555721280
    t0 = t0.square(); //      254: 138269829920743506136436333058942949839097559428776255111442560
    t0 *= t13; //             255: 138269829920743506136436333058942949839097559428776255111442605
    t0 = t0.square(); //      256: 276539659841487012272872666117885899678195118857552510222885210
    t0 = t0.square(); //      257: 553079319682974024545745332235771799356390237715105020445770420
    t0 = t0.square(); //      258: 1106158639365948049091490664471543598712780475430210040891540840
    t0 = t0.square(); //      259: 2212317278731896098182981328943087197425560950860420081783081680
    t0 = t0.square(); //      260: 4424634557463792196365962657886174394851121901720840163566163360
    t0 = t0.square(); //      261: 8849269114927584392731925315772348789702243803441680327132326720
    t0 *= t3; //              262: 8849269114927584392731925315772348789702243803441680327132326735
    t0 = t0.square(); //      263: 17698538229855168785463850631544697579404487606883360654264653470
    t0 = t0.square(); //      264: 35397076459710337570927701263089395158808975213766721308529306940
    t0 = t0.square(); //      265: 70794152919420675141855402526178790317617950427533442617058613880
    t0 = t0.square(); //      266: 141588305838841350283710805052357580635235900855066885234117227760
    t0 = t0.square(); //      267: 283176611677682700567421610104715161270471801710133770468234455520
    t0 = t0.square(); //      268: 566353223355365401134843220209430322540943603420267540936468911040
    t0 = t0.square(); //      269: 1132706446710730802269686440418860645081887206840535081872937822080
    t0 *= t6; //              270: 1132706446710730802269686440418860645081887206840535081872937822103
    t0 = t0.square(); //      271: 2265412893421461604539372880837721290163774413681070163745875644206
    t0 = t0.square(); //      272: 4530825786842923209078745761675442580327548827362140327491751288412
    t0 = t0.square(); //      273: 9061651573685846418157491523350885160655097654724280654983502576824
    t0 = t0.square(); //      274: 18123303147371692836314983046701770321310195309448561309967005153648
    t0 = t0.square(); //      275: 36246606294743385672629966093403540642620390618897122619934010307296
    t0 *= t12; //             276: 36246606294743385672629966093403540642620390618897122619934010307323
    t0 = t0.square(); //      277: 72493212589486771345259932186807081285240781237794245239868020614646
    t0 = t0.square(); //      278: 144986425178973542690519864373614162570481562475588490479736041229292
    t0 = t0.square(); //      279: 289972850357947085381039728747228325140963124951176980959472082458584
    t0 = t0.square(); //      280: 579945700715894170762079457494456650281926249902353961918944164917168
    t0 = t0.square(); //      281: 1159891401431788341524158914988913300563852499804707923837888329834336
    t0 = t0.square(); //      282: 2319782802863576683048317829977826601127704999609415847675776659668672
    t0 = t0.square(); //      283: 4639565605727153366096635659955653202255409999218831695351553319337344
    t0 *= t11; //             284: 4639565605727153366096635659955653202255409999218831695351553319337373
    t0 = t0.square(); //      285: 9279131211454306732193271319911306404510819998437663390703106638674746
    t0 = t0.square(); //      286: 18558262422908613464386542639822612809021639996875326781406213277349492
    t0 = t0.square(); //      287: 37116524845817226928773085279645225618043279993750653562812426554698984
    t0 = t0.square(); //      288: 74233049691634453857546170559290451236086559987501307125624853109397968
    t0 *= t10; //             289: 74233049691634453857546170559290451236086559987501307125624853109397973
    t0 = t0.square(); //      290: 148466099383268907715092341118580902472173119975002614251249706218795946
    t0 = t0.square(); //      291: 296932198766537815430184682237161804944346239950005228502499412437591892
    t0 = t0.square(); //      292: 593864397533075630860369364474323609888692479900010457004998824875183784
    t0 = t0.square(); //      293: 1187728795066151261720738728948647219777384959800020914009997649750367568
    t0 = t0.square(); //      294: 2375457590132302523441477457897294439554769919600041828019995299500735136
    t0 = t0.square(); //      295: 4750915180264605046882954915794588879109539839200083656039990599001470272
    t0 = t0.square(); //      296: 9501830360529210093765909831589177758219079678400167312079981198002940544
    t0 = t0.square(); //      297: 19003660721058420187531819663178355516438159356800334624159962396005881088
    t0 = t0.square(); //      298: 38007321442116840375063639326356711032876318713600669248319924792011762176
    t0 = t0.square(); //      299: 76014642884233680750127278652713422065752637427201338496639849584023524352
    t0 = t0.square(); //      300: 152029285768467361500254557305426844131505274854402676993279699168047048704
    t0 = t0.square(); //      301: 304058571536934723000509114610853688263010549708805353986559398336094097408
    t0 = t0.square(); //      302: 608117143073869446001018229221707376526021099417610707973118796672188194816
    t0 = t0.square(); //      303: 1216234286147738892002036458443414753052042198835221415946237593344376389632
    t0 = t0.square(); //      304: 2432468572295477784004072916886829506104084397670442831892475186688752779264
    t0 = t0.square(); //      305: 4864937144590955568008145833773659012208168795340885663784950373377505558528
    t0 = t0.square(); //      306: 9729874289181911136016291667547318024416337590681771327569900746755011117056
    t0 = t0.square(); //      307: 19459748578363822272032583335094636048832675181363542655139801493510022234112
    t0 = t0.square(); //      308: 38919497156727644544065166670189272097665350362727085310279602987020044468224
    t0 = t0.square(); //      309: 77838994313455289088130333340378544195330700725454170620559205974040088936448
    t0 *= t9; //              310: 77838994313455289088130333340378544195330700725454170620559205974040088936457
    t0 = t0.square(); //      311: 155677988626910578176260666680757088390661401450908341241118411948080177872914
    t0 = t0.square(); //      312: 311355977253821156352521333361514176781322802901816682482236823896160355745828
    t0 = t0.square(); //      313: 622711954507642312705042666723028353562645605803633364964473647792320711491656
    t0 = t0.square(); //      314: 1245423909015284625410085333446056707125291211607266729928947295584641422983312
    t0 = t0.square(); //      315: 2490847818030569250820170666892113414250582423214533459857894591169282845966624
    t0 = t0.square(); //      316: 4981695636061138501640341333784226828501164846429066919715789182338565691933248
    t0 = t0.square(); //      317: 9963391272122277003280682667568453657002329692858133839431578364677131383866496
    t0 = t0.square(); //      318: 19926782544244554006561365335136907314004659385716267678863156729354262767732992
    t0 *= t8; //              319: 19926782544244554006561365335136907314004659385716267678863156729354262767733047
    t0 = t0.square(); //      320: 39853565088489108013122730670273814628009318771432535357726313458708525535466094
    t0 = t0.square(); //      321: 79707130176978216026245461340547629256018637542865070715452626917417051070932188
    t0 = t0.square(); //      322: 159414260353956432052490922681095258512037275085730141430905253834834102141864376
    t0 = t0.square(); //      323: 318828520707912864104981845362190517024074550171460282861810507669668204283728752
    t0 = t0.square(); //      324: 637657041415825728209963690724381034048149100342920565723621015339336408567457504
    t0 = t0.square(); //      325: 1275314082831651456419927381448762068096298200685841131447242030678672817134915008
    t0 *= t7; //              326: 1275314082831651456419927381448762068096298200685841131447242030678672817134915055
    t0 = t0.square(); //      327: 2550628165663302912839854762897524136192596401371682262894484061357345634269830110
    t0 = t0.square(); //      328: 5101256331326605825679709525795048272385192802743364525788968122714691268539660220
    t0 = t0.square(); //      329: 10202512662653211651359419051590096544770385605486729051577936245429382537079320440
    t0 = t0.square(); //      330: 20405025325306423302718838103180193089540771210973458103155872490858765074158640880
    t0 = t0.square(); //      331: 40810050650612846605437676206360386179081542421946916206311744981717530148317281760
    t0 *= t6; //              332: 40810050650612846605437676206360386179081542421946916206311744981717530148317281783
    t0 = t0.square(); //      333: 81620101301225693210875352412720772358163084843893832412623489963435060296634563566
    t0 = t0.square(); //      334: 163240202602451386421750704825441544716326169687787664825246979926870120593269127132
    t0 *= x; //               335: 163240202602451386421750704825441544716326169687787664825246979926870120593269127133
    t0 = t0.square(); //      336: 326480405204902772843501409650883089432652339375575329650493959853740241186538254266
    t0 = t0.square(); //      337: 652960810409805545687002819301766178865304678751150659300987919707480482373076508532
    t0 = t0.square(); //      338: 1305921620819611091374005638603532357730609357502301318601975839414960964746153017064
    t0 = t0.square(); //      339: 2611843241639222182748011277207064715461218715004602637203951678829921929492306034128
    t0 = t0.square(); //      340: 5223686483278444365496022554414129430922437430009205274407903357659843858984612068256
    t0 = t0.square(); //      341: 10447372966556888730992045108828258861844874860018410548815806715319687717969224136512
    t0 = t0.square(); //      342: 20894745933113777461984090217656517723689749720036821097631613430639375435938448273024
    t0 = t0.square(); //      343: 41789491866227554923968180435313035447379499440073642195263226861278750871876896546048
    t0 = t0.square(); //      344: 83578983732455109847936360870626070894758998880147284390526453722557501743753793092096
    t0 = t0.square(); //      345: 167157967464910219695872721741252141789517997760294568781052907445115003487507586184192
    t0 = t0.square(); //      346: 334315934929820439391745443482504283579035995520589137562105814890230006975015172368384
    t0 *= t4; //              347: 334315934929820439391745443482504283579035995520589137562105814890230006975015172368403
    t0 = t0.square(); //      348: 668631869859640878783490886965008567158071991041178275124211629780460013950030344736806
    t0 = t0.square(); //      349: 1337263739719281757566981773930017134316143982082356550248423259560920027900060689473612
    t0 = t0.square(); //      350: 2674527479438563515133963547860034268632287964164713100496846519121840055800121378947224
    t0 = t0.square(); //      351: 5349054958877127030267927095720068537264575928329426200993693038243680111600242757894448
    t0 = t0.square(); //      352: 10698109917754254060535854191440137074529151856658852401987386076487360223200485515788896
    t0 = t0.square(); //      353: 21396219835508508121071708382880274149058303713317704803974772152974720446400971031577792
    t0 = t0.square(); //      354: 42792439671017016242143416765760548298116607426635409607949544305949440892801942063155584
    t0 = t0.square(); //      355: 85584879342034032484286833531521096596233214853270819215899088611898881785603884126311168
    t0 *= t2; //              356: 85584879342034032484286833531521096596233214853270819215899088611898881785603884126311219
    t0 = t0.square(); //      357: 171169758684068064968573667063042193192466429706541638431798177223797763571207768252622438
    t0 = t0.square(); //      358: 342339517368136129937147334126084386384932859413083276863596354447595527142415536505244876
    t0 = t0.square(); //      359: 684679034736272259874294668252168772769865718826166553727192708895191054284831073010489752
    t0 = t0.square(); //      360: 1369358069472544519748589336504337545539731437652333107454385417790382108569662146020979504
    t0 = t0.square(); //      361: 2738716138945089039497178673008675091079462875304666214908770835580764217139324292041959008
    t0 = t0.square(); //      362: 5477432277890178078994357346017350182158925750609332429817541671161528434278648584083918016
    t0 = t0.square(); //      363: 10954864555780356157988714692034700364317851501218664859635083342323056868557297168167836032
    t0 = t0.square(); //      364: 21909729111560712315977429384069400728635703002437329719270166684646113737114594336335672064
    t0 *= t2; //              365: 21909729111560712315977429384069400728635703002437329719270166684646113737114594336335672115
    t0 = t0.square(); //      366: 43819458223121424631954858768138801457271406004874659438540333369292227474229188672671344230
    t0 = t0.square(); //      367: 87638916446242849263909717536277602914542812009749318877080666738584454948458377345342688460
    t0 = t0.square(); //      368: 175277832892485698527819435072555205829085624019498637754161333477168909896916754690685376920
    t0 = t0.square(); //      369: 350555665784971397055638870145110411658171248038997275508322666954337819793833509381370753840
    t0 = t0.square(); //      370: 701111331569942794111277740290220823316342496077994551016645333908675639587667018762741507680
    t0 = t0.square(); //      371: 1402222663139885588222555480580441646632684992155989102033290667817351279175334037525483015360
    t0 = t0.square(); //      372: 2804445326279771176445110961160883293265369984311978204066581335634702558350668075050966030720
    t0 = t0.square(); //      373: 5608890652559542352890221922321766586530739968623956408133162671269405116701336150101932061440
    t0 *= t2; //              374: 5608890652559542352890221922321766586530739968623956408133162671269405116701336150101932061491
    t0 = t0.square(); //      375: 11217781305119084705780443844643533173061479937247912816266325342538810233402672300203864122982
    t0 = t0.square(); //      376: 22435562610238169411560887689287066346122959874495825632532650685077620466805344600407728245964
    t0 = t0.square(); //      377: 44871125220476338823121775378574132692245919748991651265065301370155240933610689200815456491928
    t0 = t0.square(); //      378: 89742250440952677646243550757148265384491839497983302530130602740310481867221378401630912983856
    t0 = t0.square(); //      379: 179484500881905355292487101514296530768983678995966605060261205480620963734442756803261825967712
    t0 *= t1; //              380: 179484500881905355292487101514296530768983678995966605060261205480620963734442756803261825967725
    t0 = t0.square(); //      381: 358969001763810710584974203028593061537967357991933210120522410961241927468885513606523651935450
    t0 = t0.square(); //      382: 717938003527621421169948406057186123075934715983866420241044821922483854937771027213047303870900
    t0 = t0.square(); //      383: 1435876007055242842339896812114372246151869431967732840482089643844967709875542054426094607741800
    t0 = t0.square(); //      384: 2871752014110485684679793624228744492303738863935465680964179287689935419751084108852189215483600
    t0 = t0.square(); //      385: 5743504028220971369359587248457488984607477727870931361928358575379870839502168217704378430967200
    t0 = t0.square(); //      386: 11487008056441942738719174496914977969214955455741862723856717150759741679004336435408756861934400
    t0 = t0.square(); //      387: 22974016112883885477438348993829955938429910911483725447713434301519483358008672870817513723868800
    t0 = t0.square(); //      388: 45948032225767770954876697987659911876859821822967450895426868603038966716017345741635027447737600
    t0 *= t1; //              389: 45948032225767770954876697987659911876859821822967450895426868603038966716017345741635027447737613
    t0 = t0.square(); //      390: 91896064451535541909753395975319823753719643645934901790853737206077933432034691483270054895475226
    t0 = t0.square(); //      391: 183792128903071083819506791950639647507439287291869803581707474412155866864069382966540109790950452
    t0 = t0.square(); //      392: 367584257806142167639013583901279295014878574583739607163414948824311733728138765933080219581900904
    t0 = t0.square(); //      393: 735168515612284335278027167802558590029757149167479214326829897648623467456277531866160439163801808
    t0 = t0.square(); //      394: 1470337031224568670556054335605117180059514298334958428653659795297246934912555063732320878327603616
    t0 = t0.square(); //      395: 2940674062449137341112108671210234360119028596669916857307319590594493869825110127464641756655207232
    t0 *= t3; //              396: 2940674062449137341112108671210234360119028596669916857307319590594493869825110127464641756655207247
    t0 = t0.square(); //      397: 5881348124898274682224217342420468720238057193339833714614639181188987739650220254929283513310414494
    t0 = t0.square(); //      398: 11762696249796549364448434684840937440476114386679667429229278362377975479300440509858567026620828988
    t0 = t0.square(); //      399: 23525392499593098728896869369681874880952228773359334858458556724755950958600881019717134053241657976
    t0 = t0.square(); //      400: 47050784999186197457793738739363749761904457546718669716917113449511901917201762039434268106483315952
    t0 = t0.square(); //      401: 94101569998372394915587477478727499523808915093437339433834226899023803834403524078868536212966631904
    t0 = t0.square(); //      402: 188203139996744789831174954957454999047617830186874678867668453798047607668807048157737072425933263808
    t0 = t0.square(); //      403: 376406279993489579662349909914909998095235660373749357735336907596095215337614096315474144851866527616
    t0 = t0.square(); //      404: 752812559986979159324699819829819996190471320747498715470673815192190430675228192630948289703733055232
    t0 *= t2; //              405: 752812559986979159324699819829819996190471320747498715470673815192190430675228192630948289703733055283
    t0 = t0.square(); //      406: 1505625119973958318649399639659639992380942641494997430941347630384380861350456385261896579407466110566
    t0 = t0.square(); //      407: 3011250239947916637298799279319279984761885282989994861882695260768761722700912770523793158814932221132
    t0 = t0.square(); //      408: 6022500479895833274597598558638559969523770565979989723765390521537523445401825541047586317629864442264
    t0 = t0.square(); //      409: 12045000959791666549195197117277119939047541131959979447530781043075046890803651082095172635259728884528
    t0 = t0.square(); //      410: 24090001919583333098390394234554239878095082263919958895061562086150093781607302164190345270519457769056
    t0 = t0.square(); //      411: 48180003839166666196780788469108479756190164527839917790123124172300187563214604328380690541038915538112
    t0 = t0.square(); //      412: 96360007678333332393561576938216959512380329055679835580246248344600375126429208656761381082077831076224
    t0 = t0.square(); //      413: 192720015356666664787123153876433919024760658111359671160492496689200750252858417313522762164155662152448
    t0 *= t2; //              414: 192720015356666664787123153876433919024760658111359671160492496689200750252858417313522762164155662152499
    t0 = t0.square(); //      415: 385440030713333329574246307752867838049521316222719342320984993378401500505716834627045524328311324304998
    t0 = t0.square(); //      416: 770880061426666659148492615505735676099042632445438684641969986756803001011433669254091048656622648609996
    t0 = t0.square(); //      417: 1541760122853333318296985231011471352198085264890877369283939973513606002022867338508182097313245297219992
    t0 = t0.square(); //      418: 3083520245706666636593970462022942704396170529781754738567879947027212004045734677016364194626490594439984
    t0 = t0.square(); //      419: 6167040491413333273187940924045885408792341059563509477135759894054424008091469354032728389252981188879968
    t0 = t0.square(); //      420: 12334080982826666546375881848091770817584682119127018954271519788108848016182938708065456778505962377759936
    t0 = t0.square(); //      421: 24668161965653333092751763696183541635169364238254037908543039576217696032365877416130913557011924755519872
    t0 = t0.square(); //      422: 49336323931306666185503527392367083270338728476508075817086079152435392064731754832261827114023849511039744
    t0 *= t2; //              423: 49336323931306666185503527392367083270338728476508075817086079152435392064731754832261827114023849511039795
    t0 = t0.square(); //      424: 98672647862613332371007054784734166540677456953016151634172158304870784129463509664523654228047699022079590
    t0 = t0.square(); //      425: 197345295725226664742014109569468333081354913906032303268344316609741568258927019329047308456095398044159180
    t0 = t0.square(); //      426: 394690591450453329484028219138936666162709827812064606536688633219483136517854038658094616912190796088318360
    t0 = t0.square(); //      427: 789381182900906658968056438277873332325419655624129213073377266438966273035708077316189233824381592176636720
    t0 = t0.square(); //      428: 1578762365801813317936112876555746664650839311248258426146754532877932546071416154632378467648763184353273440
    t0 = t0.square(); //      429: 3157524731603626635872225753111493329301678622496516852293509065755865092142832309264756935297526368706546880
    t0 = t0.square(); //      430: 6315049463207253271744451506222986658603357244993033704587018131511730184285664618529513870595052737413093760
    t0 = t0.square(); //      431: 12630098926414506543488903012445973317206714489986067409174036263023460368571329237059027741190105474826187520
    t0 *= t2; //              432: 12630098926414506543488903012445973317206714489986067409174036263023460368571329237059027741190105474826187571
    t0 = t0.square(); //      433: 25260197852829013086977806024891946634413428979972134818348072526046920737142658474118055482380210949652375142
    t0 = t0.square(); //      434: 50520395705658026173955612049783893268826857959944269636696145052093841474285316948236110964760421899304750284
    t0 = t0.square(); //      435: 101040791411316052347911224099567786537653715919888539273392290104187682948570633896472221929520843798609500568
    t0 = t0.square(); //      436: 202081582822632104695822448199135573075307431839777078546784580208375365897141267792944443859041687597219001136
    t0 = t0.square(); //      437: 404163165645264209391644896398271146150614863679554157093569160416750731794282535585888887718083375194438002272
    t0 = t0.square(); //      438: 808326331290528418783289792796542292301229727359108314187138320833501463588565071171777775436166750388876004544
    t0 = t0.square(); //      439: 1616652662581056837566579585593084584602459454718216628374276641667002927177130142343555550872333500777752009088
    t0 = t0.square(); //      440: 3233305325162113675133159171186169169204918909436433256748553283334005854354260284687111101744667001555504018176
    t0 *= t2; //              441: 3233305325162113675133159171186169169204918909436433256748553283334005854354260284687111101744667001555504018227
    t0 = t0.square(); //      442: 6466610650324227350266318342372338338409837818872866513497106566668011708708520569374222203489334003111008036454
    t0 = t0.square(); //      443: 12933221300648454700532636684744676676819675637745733026994213133336023417417041138748444406978668006222016072908
    t0 = t0.square(); //      444: 25866442601296909401065273369489353353639351275491466053988426266672046834834082277496888813957336012444032145816
    t0 = t0.square(); //      445: 51732885202593818802130546738978706707278702550982932107976852533344093669668164554993777627914672024888064291632
    t0 = t0.square(); //      446: 103465770405187637604261093477957413414557405101965864215953705066688187339336329109987555255829344049776128583264
    t0 = t0.square(); //      447: 206931540810375275208522186955914826829114810203931728431907410133376374678672658219975110511658688099552257166528
    t0 * t1 //                448: 206931540810375275208522186955914826829114810203931728431907410133376374678672658219975110511658688099552257166541
}

#[cfg(test)]
mod tests {
    use super::*;
    use ark_ff::One;
    use ark_ff::PrimeField;

    #[test]
    fn test_alpha() {
        let mut a = -Felt::one();
        for _ in 0..100 {
            assert_eq!(exp_by_inv_alpha(&a), a.pow(INV_ALPHA.into_bigint()));
            a += a;
        }
    }
}
