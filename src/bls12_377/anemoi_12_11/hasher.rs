//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 47 == 0 {
            bytes.len() / 47
        } else {
            bytes.len() / 47 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 47-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 48];
        for chunk in bytes.chunks(47) {
            if num_hashed + i < num_elements - 1 {
                buf[..47].copy_from_slice(chunk);
            } else {
                // If we are dealing with the last chunk, it may be smaller than 47 bytes long, so
                // we need to handle it slightly differently. We also append a byte set to 1 to the
                // end of the string if needed. This pads the string in such a way that adding
                // trailing zeros results in a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 48];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 47 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn merge(digests: &[Self::Digest; 2]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        // 2*DIGEST_SIZE < RATE_SIZE so we can safely store
        // the digests into the rate registers at once
        state[0..DIGEST_SIZE].copy_from_slice(digests[0].as_elements());
        state[DIGEST_SIZE..2 * DIGEST_SIZE].copy_from_slice(digests[0].as_elements());

        // Apply internal Anemoi permutation
        apply_permutation(&mut state);

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        assert!(k % 2 == 0);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger384;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger384([
                0xd57112bd9812e203,
                0xd306fa26405e41c4,
                0xd5048abebe3a7c26,
                0x7cad29d7c7576b14,
                0x1644523fbe3b40f5,
                0x011f06aa5edd4915,
            ]))],
            vec![
                Felt::new(BigInteger384([
                    0x447c7321a05b114b,
                    0xd3210415a93fba17,
                    0xebb9b8e18ece7d6b,
                    0x2eb63758e91fc168,
                    0xdde1d49627e34b93,
                    0x00d531f784b0d6cf,
                ])),
                Felt::new(BigInteger384([
                    0x5abb99df7d625f4d,
                    0x24fa9f0cfb4d80ff,
                    0xbb0abe3aa75333c6,
                    0x7d1023f903daea3e,
                    0x5dca135b598ff084,
                    0x003ee3040f2cec41,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xbae5c805d76c9eb8,
                    0x67210c94abdf1310,
                    0x4a932cdbe61ab5dd,
                    0x7eb42b9baf098317,
                    0x78a8025b08b33d77,
                    0x006a4f7f863b2d70,
                ])),
                Felt::new(BigInteger384([
                    0xe953a4a032da7572,
                    0x63d8b355e697de22,
                    0x144a25eecfb94c19,
                    0x1ec345fe3712b4f0,
                    0xae1657d6038b168a,
                    0x01759f0d22da9483,
                ])),
                Felt::new(BigInteger384([
                    0xf9142ef63c73e6f7,
                    0x6281adf2eb07a431,
                    0xfb38c5fe156148dc,
                    0xf43e360e9bcace66,
                    0xb0decd07525aa76e,
                    0x011df7d92c790ed7,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x3b322aad43e05b7b,
                    0x415207306e8977d9,
                    0x4c1334923aac37ca,
                    0xa98ed0fb91fe2d9f,
                    0x8bfe00b761a526f3,
                    0x001cfe2db788adb5,
                ])),
                Felt::new(BigInteger384([
                    0x010b94ab2ab5c8d2,
                    0xf7810cde1d532017,
                    0xf13363aa836690ab,
                    0x2913b17364abde72,
                    0x822f6aa2106adbac,
                    0x012e5d461f87605e,
                ])),
                Felt::new(BigInteger384([
                    0xc9975a48c20f7d7b,
                    0xff5448872258e0d4,
                    0xd21e1c850effbb92,
                    0xb986695d6b2bc4bc,
                    0x1de9805b174cacf8,
                    0x004ed95bebe20806,
                ])),
                Felt::new(BigInteger384([
                    0x38744dd27fc1fff9,
                    0xdba61df43b2c186e,
                    0xfe059ba2912e5dc6,
                    0x11c15ce153b91caa,
                    0xd335efaa0a5011a6,
                    0x01555c163a5d455c,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xf5f2ee2caa6e12f5,
                    0x51e10942eeaea21e,
                    0x11a3d00b8df88b07,
                    0x4e1dc05876244a3e,
                    0x7bd30fc1a7b8a039,
                    0x0017eea9d09c7573,
                ])),
                Felt::new(BigInteger384([
                    0x955962aa92bb58be,
                    0x7e6e8e05278ebd0f,
                    0x12d976259a026bea,
                    0x7cabf1075dcd1e0d,
                    0xf1916e04153199cc,
                    0x015eeb052f745982,
                ])),
                Felt::new(BigInteger384([
                    0x24e131e7096bfbdf,
                    0x34b63b2114874848,
                    0x7c94e8c5cc622d13,
                    0xa2941453f98194e1,
                    0x87028a66d72e0e1d,
                    0x00e2c471747c6ae5,
                ])),
                Felt::new(BigInteger384([
                    0xcdaae24b09bf6bbe,
                    0xe3b493fb999a96c0,
                    0xa3799d35d4529917,
                    0x3e94c19efbc412d6,
                    0xc3b692d3e15c55bc,
                    0x0041a3786e6dea06,
                ])),
                Felt::new(BigInteger384([
                    0x7a149ee8840696a6,
                    0x86d219234dd489be,
                    0x8a7fa7ec6c684e7b,
                    0xbe7c6962e4a0f7bc,
                    0xe5828b2d9b0708ad,
                    0x00379bf41600a4be,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xbcb375ef8fd97d30,
                    0xf7ba6478d9c1b7aa,
                    0xf381152cce17d0b5,
                    0xfff78cde98f750d9,
                    0x048148627a492ade,
                    0x00cb11a61dbaf2f0,
                ])),
                Felt::new(BigInteger384([
                    0x5bb3e498f30c40b0,
                    0x24578569c8dfe96a,
                    0xfae050f3426c7a37,
                    0x163baa31c8ac27b9,
                    0x90dc1e1344f4ce12,
                    0x0181cc937a9c9ff9,
                ])),
                Felt::new(BigInteger384([
                    0x3ab2f7a704113498,
                    0x06d5a9dc96017c89,
                    0x78e39153d118e635,
                    0xf0bf34b7bedf4480,
                    0xdbbda66811c74781,
                    0x00f435b5bc8771a2,
                ])),
                Felt::new(BigInteger384([
                    0x6e64f8c57238924f,
                    0xae8e376e9268bc6b,
                    0xf45c6da9e5a65abe,
                    0x8988400b6efb9476,
                    0x4db81c43573e2499,
                    0x005124cf09b34a29,
                ])),
                Felt::new(BigInteger384([
                    0x99e9a2e717b892e5,
                    0xdf6bc92dac5387cc,
                    0x8e6cb38b166b152d,
                    0xdc9ee85488d5e1cf,
                    0x1241dff2590eedab,
                    0x0148dbfac7eb8dde,
                ])),
                Felt::new(BigInteger384([
                    0x288296d1ea9c818d,
                    0x1744527b5c5f3f5f,
                    0x645014df3d06ff1f,
                    0xcb604fbce522f6ec,
                    0xf4a8c18898099acf,
                    0x004b45af810049fe,
                ])),
            ],
        ];

        let output_data = [
            [Felt::new(BigInteger384([
                0x78ef1d1009bc611a,
                0xb5e6140d14dc2b67,
                0x9384e124e6c53336,
                0xc1e6819834376dc2,
                0x9fbd3d052adedf47,
                0x006718434c189ff1,
            ]))],
            [Felt::new(BigInteger384([
                0x434774e39970f303,
                0x8e3b98fe7ccfed0b,
                0xfd85b0ede685f1f9,
                0x6c597a5958bb593d,
                0xb03c392e4021bd3a,
                0x0190dc0228427b8c,
            ]))],
            [Felt::new(BigInteger384([
                0xd833cb49bd9b399f,
                0xb219840c253bd44e,
                0xa51dc0bd0409d581,
                0x81ecd762718ae1a7,
                0xbcbec7d42058bf49,
                0x00a27294d71fa47b,
            ]))],
            [Felt::new(BigInteger384([
                0x7be2993e4553949b,
                0x8d8699a4c1a85a43,
                0x77d0197aca415af8,
                0xfaf17ddfd265997f,
                0xaeda8707e688bfc9,
                0x002c4042efe110c9,
            ]))],
            [Felt::new(BigInteger384([
                0xe9cf92f17a09fb38,
                0xb500f82967a944dc,
                0x29dd7d62c150255c,
                0xef4eab4623ab389a,
                0x6f0520fe5f70cdd8,
                0x01a36bc7febff5c1,
            ]))],
            [Felt::new(BigInteger384([
                0x82c9dd334dc9107e,
                0x041f409764e5ddbb,
                0x6b99f48dfe92df09,
                0xc43f1481dc04cbda,
                0xfbe9c21efe38a07b,
                0x011505577371650c,
            ]))],
            [Felt::new(BigInteger384([
                0x3a9558eafb12b766,
                0xefb206cfdb86ce19,
                0x9d07788d17a43344,
                0xb5fe3ac1ef11757c,
                0xf5aba1d7dbd36ec6,
                0x0170441907780df3,
            ]))],
            [Felt::new(BigInteger384([
                0x6779c12adc34bf3c,
                0xb69357ee31983f87,
                0xc793467d8ce42f42,
                0x425d71d36d5bed50,
                0x1c53ddf0c357f716,
                0x0137a90f7a38e94a,
            ]))],
            [Felt::new(BigInteger384([
                0xf2ff15026eae579f,
                0x000554ce395218eb,
                0x744578124d8fe9e0,
                0x056ca9484ff0b026,
                0x0d6af863d24bbd4c,
                0x014fe5743fb92342,
            ]))],
            [Felt::new(BigInteger384([
                0x44c008774e8b1b67,
                0x51dbaf8e3ca383e6,
                0x1998d9fb5c3acc4a,
                0x1c16a948c2669a85,
                0x4bd64d1d2d221719,
                0x013a13ebfaecbfee,
            ]))],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x11cd622b2e601a19,
                    0x08afda7f588211fd,
                    0x370b146aa4cd6115,
                    0x5b69f48234e0eb29,
                    0x423a1f7b0d921b96,
                    0x002d056696b982e9,
                ])),
                Felt::new(BigInteger384([
                    0x7382f7c23b31fb3d,
                    0xa1bc54ed7407e8a2,
                    0x827173d3c829d2eb,
                    0x9386da622d1c769e,
                    0x3793bc11943b1ccc,
                    0x00e6c73a6bf68093,
                ])),
                Felt::new(BigInteger384([
                    0xa8a8ec6fbbf78178,
                    0xcb6d4b99204ea829,
                    0x17f93ceca2bdd7f9,
                    0xaa040d5feb149385,
                    0x10dcabc7a9e7e7ca,
                    0x001cb96c37fabf9b,
                ])),
                Felt::new(BigInteger384([
                    0xec569fb5cf730d03,
                    0x1d1cb364c8b88d58,
                    0x834677fa70f371d4,
                    0x0dddcb2a0231caee,
                    0x23bd6836087f1e82,
                    0x004f0fd7559b7d95,
                ])),
                Felt::new(BigInteger384([
                    0x8c4e6b484ca50843,
                    0x46bee5689571700e,
                    0x725768ac66caa3f1,
                    0x6ef8b8ae75ab75e2,
                    0x147e312b205e28c2,
                    0x017a2ab07753fbb9,
                ])),
                Felt::new(BigInteger384([
                    0xa380ff9b6bcd9e4a,
                    0x80b133f8a8157e12,
                    0x87304f9508ffbbae,
                    0xf49db3ebdac698be,
                    0xd54ae624933125c0,
                    0x00a8cde14b2e9767,
                ])),
                Felt::new(BigInteger384([
                    0x01a5ffe709dd9c8b,
                    0x89b5506a505b3370,
                    0x8f073be81c675a5a,
                    0x025d02254e8ddfc8,
                    0x3fe4ac118d8f053d,
                    0x0193ad1700384c25,
                ])),
                Felt::new(BigInteger384([
                    0x61327d6bad45baeb,
                    0x11b5c048b88e2766,
                    0x14bef50c26d2cf3e,
                    0x5b09d91dfd1c0dae,
                    0x8b2f5c190b05b4e6,
                    0x001d3e1206dca8b0,
                ])),
                Felt::new(BigInteger384([
                    0x55ca4170883e472f,
                    0x92837ece2339f46d,
                    0x8e1d3c2b6d76a6ac,
                    0xe3f163c41d820f83,
                    0x7a36fe9b8332e2c4,
                    0x008d66d40324d96d,
                ])),
                Felt::new(BigInteger384([
                    0xd6793cf5c6d5ff3e,
                    0xc5818618fed1f183,
                    0x83a47d957538ea37,
                    0x5af8e139e39c3c97,
                    0xca06aec95f21b309,
                    0x017f3121db09dccf,
                ])),
                Felt::new(BigInteger384([
                    0x997be945df4bed8d,
                    0xcc6aac16ec37e792,
                    0xb4df131915f012ab,
                    0xa8e774ba4db1492e,
                    0xfa6669bfd69b123a,
                    0x01adab28a16d9b4f,
                ])),
                Felt::new(BigInteger384([
                    0xa2b3d13a3fb77989,
                    0x82e75aff57e3387e,
                    0x492fbcc1c309056b,
                    0x9c1710757f40aa35,
                    0x41513bd289c68a6e,
                    0x00535de5b5855a28,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xe5f8675233ead5a2,
                    0x13d32c3c5ed1296c,
                    0x099d69dbcda8a1b9,
                    0x41429c77832416f0,
                    0xbd79c893f7deb3fe,
                    0x017aa98cb3c0399f,
                ])),
                Felt::new(BigInteger384([
                    0x2d24a0bf657cdda8,
                    0xe9dad14345b43cb2,
                    0x2501cb1a05416818,
                    0x89b4e8aa233926d1,
                    0xc2f49a7924b836b9,
                    0x00d056e949b19e48,
                ])),
                Felt::new(BigInteger384([
                    0xf3e7e6beb13f8b0e,
                    0x5bbea5b5822942ad,
                    0xfea7f232258f0b90,
                    0x8332608f0e45ebb4,
                    0x5f5d7605a20e5221,
                    0x00b72b41729d3cf2,
                ])),
                Felt::new(BigInteger384([
                    0x1038b0c2fb4f7386,
                    0x90444df8437aa5e0,
                    0x4f473a5000519e77,
                    0xc092b64e7c307c3b,
                    0x0807303b0b649c11,
                    0x0189b9f43b82ef25,
                ])),
                Felt::new(BigInteger384([
                    0xf18c9cc69961cd2d,
                    0x0d14490ec9940361,
                    0x5bd16f044cf64661,
                    0x11081eb8b82552d8,
                    0xd3bad15f3bb114c7,
                    0x003d66b80cc73467,
                ])),
                Felt::new(BigInteger384([
                    0x3ece7d25c020f0ec,
                    0x18504a3749724b2c,
                    0x18d2a08b6bca877d,
                    0x4342c7785ee661b0,
                    0xc02bbc0a2d139b13,
                    0x012fe3c17283dd4f,
                ])),
                Felt::new(BigInteger384([
                    0x11a1eff12d0d7d32,
                    0x9ae4495b96a1a9c0,
                    0x4ef4066f3d0b6c41,
                    0xd3c83082a6c86e75,
                    0x9be0445dd070689a,
                    0x0175ae5662777db1,
                ])),
                Felt::new(BigInteger384([
                    0xfd29e75315be2fe9,
                    0xada600a74aa69d44,
                    0xb1f958dca2a5999a,
                    0x7c5c064f9a53a30c,
                    0x3a02868893e48e77,
                    0x01aad01e64a4855b,
                ])),
                Felt::new(BigInteger384([
                    0x71633d4c0fde0346,
                    0x85fab0e5f7b5f7b1,
                    0x0ef72c6692a01e4b,
                    0x54d102675457af00,
                    0x64c65bb7beeb241f,
                    0x0146b635b9592d99,
                ])),
                Felt::new(BigInteger384([
                    0x7f0ba62f10e6a3ab,
                    0x533997a5cd898e09,
                    0xebb473ca16b1f441,
                    0x583ad1b11d6ff97b,
                    0x73cc74ac6c5348d0,
                    0x018db25bf566d37f,
                ])),
                Felt::new(BigInteger384([
                    0x83c6ddaccc3c7476,
                    0x2e269acd4fca619c,
                    0x75dccec9f938319c,
                    0x58198e0f50929c5a,
                    0x7a0ac04f271e0229,
                    0x0078e4cc30c4a94b,
                ])),
                Felt::new(BigInteger384([
                    0xfa107ffe40739b89,
                    0x478c78f5fd3a13cf,
                    0xb82807e86f87395e,
                    0x87e6b4ce69e114a3,
                    0x822f0cc2ae175296,
                    0x001e234594a5bc9e,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x400db106da91cdb4,
                    0xf8d5a3ba7dd76d55,
                    0xef08f7681a8441f7,
                    0x15b16c2744a56b36,
                    0x00495a15a5eff75c,
                    0x0007e5597933ed1b,
                ])),
                Felt::new(BigInteger384([
                    0x8b04b25299cbbd20,
                    0x28c2f04b744a5b05,
                    0x1b1bd00bcb1e4054,
                    0x01f100d919c13daa,
                    0x37761a6705bed0ee,
                    0x00f1665bcdcecd11,
                ])),
                Felt::new(BigInteger384([
                    0xd7a1fd90229fdc2b,
                    0x6a9b484719d85e7d,
                    0x1633b985b7e128e0,
                    0x248943aefe8e1cbc,
                    0x0352f4b0fe93e301,
                    0x0025846493c62396,
                ])),
                Felt::new(BigInteger384([
                    0x1b8e38ea2e8fcf9a,
                    0x6e2cfb4c87a1fcc0,
                    0xd10e1b330be90f08,
                    0xbbdf8a9a5e898d5d,
                    0x15c979989ff3df2c,
                    0x011dd96b5f52cf0f,
                ])),
                Felt::new(BigInteger384([
                    0x46ceb257e67a78fe,
                    0xf053f6c9885f936a,
                    0x3121ad25147ed87e,
                    0x75a197d42dc4e9f9,
                    0x3692b0d6e6a2ed70,
                    0x00fceb03bb81f947,
                ])),
                Felt::new(BigInteger384([
                    0xe082928a2953ceef,
                    0xcf5c3e2493952593,
                    0x6e6f386a5d3336f1,
                    0x4aecdaa3acb96445,
                    0x7d2488a34c9cd560,
                    0x0142c42eba5a0abc,
                ])),
                Felt::new(BigInteger384([
                    0x1f8043003fe922dc,
                    0x681239009f48c39d,
                    0xde9f88579f78b372,
                    0x0fe9b17bef5a8cc6,
                    0xc5ae2a6402a11d2c,
                    0x003cde77f07a8d6f,
                ])),
                Felt::new(BigInteger384([
                    0x1957c37601c1bc2e,
                    0x0cecd2e63e7ae73c,
                    0x645c00f08584115a,
                    0xb53788101c7ecde6,
                    0x9d3ecde58530ada3,
                    0x0057e51a730e09fd,
                ])),
                Felt::new(BigInteger384([
                    0xfc168fa6fbd996a5,
                    0x842bfc4581018d25,
                    0x5c973b943f2a7b63,
                    0x1df5f4dde9f13e10,
                    0x0578d647ae6d2a5c,
                    0x009f8a10133f004e,
                ])),
                Felt::new(BigInteger384([
                    0xda9c4a5102517a27,
                    0x4a43256141bf66e5,
                    0xe77b51d633a7fe12,
                    0x991c88f8d8def4da,
                    0xe317a03b0a773fb1,
                    0x00b2c5fe02390c00,
                ])),
                Felt::new(BigInteger384([
                    0xa05eb4cc0e0007f5,
                    0xd302011d602a4df6,
                    0xde1dbc9c8751b9cf,
                    0x4bb0699978c45bae,
                    0x800cc257d5af448a,
                    0x012550245902003f,
                ])),
                Felt::new(BigInteger384([
                    0x01aaef818957179c,
                    0x7918940c876879f3,
                    0xb0091a29d9f34855,
                    0xe7648ce23ec5af0b,
                    0x7d35d94cf3a1fe36,
                    0x00d2471e271e3959,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x555dd21497dd5432,
                    0x92ead4b58f795d9b,
                    0xfda0775b9062ab8a,
                    0xf9631a1fc50f9e4e,
                    0x0be26c0656e17b8a,
                    0x001f999b696fd06b,
                ])),
                Felt::new(BigInteger384([
                    0x5b668ff127d6f223,
                    0x28b8c84ceff43404,
                    0x47ebf92ca2e36e51,
                    0xc19f0325642427d4,
                    0x64dde1e8aaac6406,
                    0x012054de017496e0,
                ])),
                Felt::new(BigInteger384([
                    0x1878bfc400e681dc,
                    0xf33e82c7f01ee7cd,
                    0x85662e498b25257d,
                    0xa3b23010e25fec30,
                    0xdf98765b8587d1c2,
                    0x0033e0f9b3664930,
                ])),
                Felt::new(BigInteger384([
                    0x50beb8a91c2075f9,
                    0x1964f6c60d5683c1,
                    0xf5fa86ee085becd3,
                    0xb7424493ef2b4b8a,
                    0x2e350cccb46e4e4f,
                    0x00dd6b713eaf2460,
                ])),
                Felt::new(BigInteger384([
                    0xd57b18dc2ddadb32,
                    0xf098b9be2a4ebf42,
                    0x58238182503674dd,
                    0x38943b6f4d581ab5,
                    0xa81f7f295a467cf7,
                    0x00856b9c9b6592e6,
                ])),
                Felt::new(BigInteger384([
                    0xc2c6286a780e496d,
                    0x63eda84af9e438d5,
                    0x6c52febcf1d17ce9,
                    0xcc0481959f052971,
                    0xe384a492d5d3ee79,
                    0x01436836670b29da,
                ])),
                Felt::new(BigInteger384([
                    0x85ce6e8a81a68942,
                    0x2c1a0d21850660ee,
                    0xe6c905cdf71a724d,
                    0x1d5cc9c7fa573afd,
                    0xe04b8cb1711934a8,
                    0x0165c3afcfb1dcb1,
                ])),
                Felt::new(BigInteger384([
                    0x43309d9dea85efee,
                    0xc0d4ea65eefa81f2,
                    0xbdb2d7c1bcb0aa91,
                    0x7bfe6acb9fb23a45,
                    0x753797d03d5a8b2c,
                    0x00a4f7816c999b3a,
                ])),
                Felt::new(BigInteger384([
                    0x4c7fa91d7b4528f9,
                    0x7083df413ebaeec0,
                    0xafc6e052fa189a44,
                    0x92d6179dcc7b354f,
                    0x430dea6c73e18996,
                    0x000af40da30653b1,
                ])),
                Felt::new(BigInteger384([
                    0xd8f864372d085236,
                    0x689bbda6b9019a62,
                    0x8ff405d9b61f132e,
                    0xc8b4a0cf50cc11ab,
                    0x426d613929c4ef6d,
                    0x01a90e26996d182a,
                ])),
                Felt::new(BigInteger384([
                    0x6e09d9e2b10afb30,
                    0xf53b3edd05e7c048,
                    0xcb815f77b52fb4fe,
                    0x5bca893e40a6bc92,
                    0x92e8d40d08424e49,
                    0x0174316d19e45632,
                ])),
                Felt::new(BigInteger384([
                    0x2da2b86b5fdc8530,
                    0x122aba25cb5bbacd,
                    0x95acdb79671d9cbf,
                    0x96b65a15c9d69216,
                    0x93062270d8dec139,
                    0x00fac4f245050b2e,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xffc42e5d4d066b41,
                    0x3da2e40a7a8229dc,
                    0x46c0e410d547fb4b,
                    0x78a80a238bc96997,
                    0xb46fa1cef60d171b,
                    0x00643ae887c88ab8,
                ])),
                Felt::new(BigInteger384([
                    0x1df0a1c8054e2cb3,
                    0xecbe22500c6b967c,
                    0x4522c4ba0c8a9cdb,
                    0x2e2b6946f66cecf0,
                    0xe741e6ec4eed064c,
                    0x009c5717bcae6409,
                ])),
                Felt::new(BigInteger384([
                    0xa063495fb5f27fde,
                    0x1013dc2a5bf3529f,
                    0xa3f2f684d8c5454c,
                    0x17c8725781bf23ed,
                    0x6005e034bcee12dc,
                    0x014b698c1bf3be91,
                ])),
                Felt::new(BigInteger384([
                    0x7537849725c63203,
                    0x0dd5fac4ee7e3fef,
                    0x186f2b8720039c33,
                    0x8bb6d8849c1a2f70,
                    0x634d6be2719b9815,
                    0x000d1c767a370aeb,
                ])),
                Felt::new(BigInteger384([
                    0xf3bbded91258066c,
                    0xb132eea6bd5b82cb,
                    0xbf5dc1e4340a24e5,
                    0xcdfe91f6c18d933c,
                    0x9fd67dbc20106d1a,
                    0x01477bb009ea4d85,
                ])),
                Felt::new(BigInteger384([
                    0xfca43fadda6db170,
                    0x3db65aa4220943e4,
                    0x3d22d783cf2977f1,
                    0x79241c2aba651c8a,
                    0xc69ddbe1b3dfe553,
                    0x01297b31e1ddd68f,
                ])),
                Felt::new(BigInteger384([
                    0x2d738a79a67ee2d6,
                    0x8e4eb9422d3300ea,
                    0xd659bdb92e169cb5,
                    0xeaf6c7dc3a8be583,
                    0x9ed3fcb09a661106,
                    0x00dccf11d252f313,
                ])),
                Felt::new(BigInteger384([
                    0x82c9a4fe1157a8cf,
                    0x7a1de3d3a53b1d0d,
                    0x1cb376b1b83e29e1,
                    0x7cbea9d733f84b9c,
                    0xb7e3456354ee5c12,
                    0x0047dc8a31de6161,
                ])),
                Felt::new(BigInteger384([
                    0xb29ad990cedb48b5,
                    0x7b142ab42683f90d,
                    0x5b6a90ef6f4e0a3c,
                    0x11d9c0e322e648eb,
                    0x2ed2e22684b02200,
                    0x00d3cb76120b3025,
                ])),
                Felt::new(BigInteger384([
                    0x65dfeeb734061780,
                    0x0802bff6d323fe30,
                    0xfb640374f1d71543,
                    0xe32d12a54ac9147e,
                    0x79476653e34c30b8,
                    0x0100a795714508cd,
                ])),
                Felt::new(BigInteger384([
                    0xb1b22c9c295c5db5,
                    0xc177b6e007172e5a,
                    0xbeb08d32553f49bd,
                    0xbd30063ae2d2b53d,
                    0x3f9b3065d8d18043,
                    0x00410377701a22cd,
                ])),
                Felt::new(BigInteger384([
                    0xa032b93a242f16c3,
                    0x9dce7b8795babfd3,
                    0x8c1db22121708f0c,
                    0x56bc510084065911,
                    0x35e0e766ffe07e96,
                    0x017d07b78e443fad,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x4474793784d1cba1,
                    0x1aae2bb51bf60d8d,
                    0x2d4cbb29406b9b5a,
                    0x6cfc554f2642aa35,
                    0x195e605f39a766e5,
                    0x00d4fc1a093f4910,
                ])),
                Felt::new(BigInteger384([
                    0xc40beef45a5985b0,
                    0x9da3965d2bd9ee68,
                    0x2fd383e80dc06fb6,
                    0x98548a898b5b4b2e,
                    0x7124b3598ef27fae,
                    0x008772e4261e5d09,
                ])),
                Felt::new(BigInteger384([
                    0x1c73c021a79a3485,
                    0x5d94e26e099ccb12,
                    0x37da5b313dcc987c,
                    0xdae725eb02763c02,
                    0x782f87cb2ae5ca12,
                    0x01739a4e70498558,
                ])),
                Felt::new(BigInteger384([
                    0x6701c9449039fdee,
                    0x99b56fa97f7c8d26,
                    0x5f9dab4e55f0a5bb,
                    0x070bba9c10c4062b,
                    0x7368c0bd6dbc62f4,
                    0x0112bf1d875c8c80,
                ])),
                Felt::new(BigInteger384([
                    0xae0b8fa42ffdfe30,
                    0x56aa1b6c4e5c6020,
                    0x575ebc56998bc0b4,
                    0x573919c9bc99c726,
                    0x934d2a02c854a5cc,
                    0x01ac54c34bc4f789,
                ])),
                Felt::new(BigInteger384([
                    0xe396388d903764c5,
                    0xefd39fc8c550251b,
                    0xdf62fe2e04ab72b3,
                    0xb29a86b531cbd862,
                    0xbee846f761d79429,
                    0x00e8fddd01864a9d,
                ])),
                Felt::new(BigInteger384([
                    0xeecb9fd040ad0775,
                    0x544293143830d536,
                    0xb472d0937b6f47c1,
                    0x8a27c32bff9bf74a,
                    0xd28bb09c28e92a08,
                    0x0183ce1f36221ae5,
                ])),
                Felt::new(BigInteger384([
                    0xd18ce7b9b9b6ef2b,
                    0xf16fe3c86b2f862c,
                    0xf02cbdee83e57388,
                    0x50efd96a4066610f,
                    0x4f87ef1fc209b20f,
                    0x0184d63c5d150e4e,
                ])),
                Felt::new(BigInteger384([
                    0xa8bfd038600ad971,
                    0xf822dd16517a8146,
                    0xacef78cedbea5070,
                    0x5a1c8f2b9c3c1e6f,
                    0x55acc763ff5ee27d,
                    0x0050c253a8ba8d89,
                ])),
                Felt::new(BigInteger384([
                    0x5e512e0e17d6200a,
                    0x7e7eeb6d54e057af,
                    0x2d696ddb37c943f2,
                    0x321f5f0d899d3907,
                    0xb3892bce3b5dbda2,
                    0x0017f451e81a758d,
                ])),
                Felt::new(BigInteger384([
                    0x9552f14293b21423,
                    0xb5e593430708101e,
                    0x5baedd5f30a36e9d,
                    0x4f0fd37c7d088515,
                    0x5e45eda3dbbffc8d,
                    0x00ee14bb64bad7c5,
                ])),
                Felt::new(BigInteger384([
                    0xb45f39d469a1b3b3,
                    0x83dcc4921705f4b9,
                    0xd1fa43a92f2c446b,
                    0xf2a7798657d02f13,
                    0xd5b51ccdeca321f3,
                    0x0002c54708baefce,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x20bba01dcaa36c21,
                    0x535b6b1ffe401f4f,
                    0x51076e9517663850,
                    0x13322132c129cff7,
                    0x88eda359819d04bd,
                    0x00b6e999a6be577e,
                ])),
                Felt::new(BigInteger384([
                    0x81db983be3f5e490,
                    0xb8b21cef4f653a97,
                    0xb0006bcfc06b1abe,
                    0x6a501b3458768971,
                    0xe664533a084a3f7f,
                    0x01458c1a39c8207b,
                ])),
                Felt::new(BigInteger384([
                    0xd46fbd2523cb50d8,
                    0xa6ba4b188c466c7c,
                    0x14d2b7e0dd6818ed,
                    0x18098c422efe8c8e,
                    0xbf23c4c0f79cd37c,
                    0x009d737c402672a9,
                ])),
                Felt::new(BigInteger384([
                    0x3b0e43fcde2ea896,
                    0x3b99d68330db0e5e,
                    0x6171b3b1f8e632d6,
                    0xc50fe82be3bbe66a,
                    0x2c36366534ffa667,
                    0x00f6e872032d6777,
                ])),
                Felt::new(BigInteger384([
                    0x4a5472e7958baebf,
                    0x765dffb92dddd3fe,
                    0xf0d7bba5c7572a73,
                    0x0bf80dea488afd7e,
                    0xdcbaa592aa193125,
                    0x000220aa59ce3904,
                ])),
                Felt::new(BigInteger384([
                    0xab7ece2110518ce8,
                    0xb49d097f42bf0535,
                    0xe9710378e3550c3e,
                    0x94077150610ea2c1,
                    0x5f851bc875477424,
                    0x0195832821a71e82,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x6ddf3d1aa68d53bd,
                    0xa667333f6be25e5f,
                    0x4d6100bf3f045032,
                    0x8acdf863b8da2ff5,
                    0xbb33d3f118a66a21,
                    0x010064b58fa7e75e,
                ])),
                Felt::new(BigInteger384([
                    0x387df80e6db1366f,
                    0xdb6db66df73d3158,
                    0x32c3b234b674d163,
                    0x49c000b99f7ec930,
                    0xb846e78115eb7730,
                    0x011b6e7a7b788e73,
                ])),
                Felt::new(BigInteger384([
                    0x61e055eca27e7bd9,
                    0x22a8945d349d7225,
                    0x825ea6c17eacb217,
                    0x464df7b7ad93ad1a,
                    0x598f70dfdf0589d3,
                    0x00ea427f32240750,
                ])),
                Felt::new(BigInteger384([
                    0x1885bf5699df2acf,
                    0xa556ff2cf784fd06,
                    0x3660b3b8e232cdbf,
                    0x68372a5e97ae348e,
                    0x79cfe5c76fc7b045,
                    0x0041faa58bdcb698,
                ])),
                Felt::new(BigInteger384([
                    0x69f516164790a978,
                    0xa5965a4fed60c5f1,
                    0x2d028f91ca3c7518,
                    0x69c420f035ab2ddc,
                    0x44b7ef6188ac3a07,
                    0x00d89e4e148dbfd0,
                ])),
                Felt::new(BigInteger384([
                    0xdb0a7e254eac983d,
                    0x060c13142ceda1ce,
                    0x788f866c711e44f4,
                    0x0dd036fc262b0a59,
                    0x5b5ea211ea3d7fb2,
                    0x009c60b7d96c86eb,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xac515e541aee330b,
                    0x87f5734f51b097b3,
                    0x038fcbc8576cefd1,
                    0x1b149ea80ca74195,
                    0x34491c1314fb1274,
                    0x01adec3a6f4e85ce,
                ])),
                Felt::new(BigInteger384([
                    0x3dd6cfed7499e127,
                    0xd4e2fca8f8d4913c,
                    0x856093534cf7bfa0,
                    0xdbf2306a7b908523,
                    0xc366a0d63f001570,
                    0x00bb0ba7d710efa1,
                ])),
                Felt::new(BigInteger384([
                    0x32a6f8b5d9958143,
                    0x9f96f11438d32be3,
                    0xfa99de2681be4135,
                    0x161922801342665a,
                    0x3794782f4081cf94,
                    0x018989e71c665c32,
                ])),
                Felt::new(BigInteger384([
                    0x8d9852cf9969d3ba,
                    0xc086f5226462ca9b,
                    0xada13df705cd88be,
                    0x657515321a5e0ead,
                    0xaff2ad656996e0b1,
                    0x009a7ea90e6be81e,
                ])),
                Felt::new(BigInteger384([
                    0x5b5c4cac1780e4b3,
                    0x297843bc8ee5c879,
                    0x35495439e62d338b,
                    0x82af77479ab8831c,
                    0xce446e37abad9e99,
                    0x0152bf41205e807b,
                ])),
                Felt::new(BigInteger384([
                    0x6b2dd9befa12ce72,
                    0x1df87942389fea5c,
                    0xee572c42e16710d2,
                    0x3f13c81ce3df25cc,
                    0x086236bc960a6527,
                    0x0003dbfcf5737a79,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x014eaa491353b65c,
                    0x36a832abd0415a8b,
                    0x15d7f277a9cf1203,
                    0x5db131707281ed27,
                    0x7ea06d60c1a00397,
                    0x01408df57f65c7d2,
                ])),
                Felt::new(BigInteger384([
                    0x991031fea7f52b97,
                    0x90480f2b8311b974,
                    0x7460f391ea8fd80e,
                    0x46045a443eb90b60,
                    0x7e6380b7ce632dfa,
                    0x00fe3a72f6cbc1ad,
                ])),
                Felt::new(BigInteger384([
                    0x53ad787e4abd364d,
                    0xe4de936d8b124f6c,
                    0x92f0e6516bea0300,
                    0xc6a1992675bb13b1,
                    0xfb9f8adb87264f2f,
                    0x011e930fb2d49567,
                ])),
                Felt::new(BigInteger384([
                    0xd8319c33105a8010,
                    0x5848a4225a016007,
                    0xf31a4eadfd1570ec,
                    0x9bead1bda3066e0c,
                    0x0d9bf9b631782c18,
                    0x00df19bd6c786e50,
                ])),
                Felt::new(BigInteger384([
                    0x27fda2735eb79be0,
                    0xfa42ffa5860f5fc8,
                    0x692bdc47e608d076,
                    0xed19fa04a273d844,
                    0xcfbdba6ef6c4ffee,
                    0x000ebedba6d75130,
                ])),
                Felt::new(BigInteger384([
                    0x5a3a566d5247b7df,
                    0x4f3426ad6a3b838a,
                    0x7352aae810ef705e,
                    0x365e7408bb2e7901,
                    0x8fa83673b70a72ae,
                    0x00b21f17f84c53b4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5976b47083351928,
                    0xd379ba1d53dfa1b6,
                    0xac11b4a2472b2894,
                    0x7f7ce8fe03d273e1,
                    0x688fdc879eeff365,
                    0x00e00d4eb8c686fd,
                ])),
                Felt::new(BigInteger384([
                    0x19a2b6ac61a67311,
                    0x631041c2d36ba30e,
                    0x01c472563d4ce858,
                    0x650f65b7fb0b32cd,
                    0x30cbc2c307c11d26,
                    0x000f17011d6dc93a,
                ])),
                Felt::new(BigInteger384([
                    0x24d7a10982330250,
                    0x5fc6dec809aba7fe,
                    0xb134e39c61a2cc4b,
                    0xa28bc4b629763b61,
                    0xe14919bd2a42f9f7,
                    0x001a4a61dcfee763,
                ])),
                Felt::new(BigInteger384([
                    0xc4f43d7bf0a3b890,
                    0x3afd2f73553ec602,
                    0xbf938f346a139df7,
                    0xa99d69ee18690837,
                    0xadbcd1b95cc4500a,
                    0x00c234e55ba99280,
                ])),
                Felt::new(BigInteger384([
                    0x9a4d8afce918c701,
                    0x78b641d113086c47,
                    0xd3a9977d7a798809,
                    0xca10f1316ef95f52,
                    0xa33d1076c3c425b1,
                    0x0132a753a4c54e44,
                ])),
                Felt::new(BigInteger384([
                    0xf97face37d030fc9,
                    0x0a3e5b42c569ab21,
                    0x3ff3b02a6b81618c,
                    0x90f74b901ce92af0,
                    0x3c75244382c4c9c4,
                    0x009b8d7094681431,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3b97d609ea36b58c,
                    0x89ffa34ab777e616,
                    0x4e9091aee68011d1,
                    0xac9b87daf2d2d50a,
                    0x376ba383b76e16de,
                    0x019c867cb3014f69,
                ])),
                Felt::new(BigInteger384([
                    0x0dd9c0e71928af35,
                    0x8fb33a0ddd8af247,
                    0x4b5797c485b53fc7,
                    0x5aca7a209e7a3a5e,
                    0x70877d5a240e0a2a,
                    0x0082bf25e8166442,
                ])),
                Felt::new(BigInteger384([
                    0x285aaa664f7b30fc,
                    0x26a1fd851297d578,
                    0x7a372125fdff5a5d,
                    0x317b2599592edf37,
                    0xb815564205a5e993,
                    0x015986f788625a63,
                ])),
                Felt::new(BigInteger384([
                    0x2e00eab326805be4,
                    0x4b3822f719da5400,
                    0xc1306cd5c20b0645,
                    0x488a87d8e87f95f1,
                    0xdb27ca94dc9eec24,
                    0x0198e4d906f8bd05,
                ])),
                Felt::new(BigInteger384([
                    0x5c15cd64fc81bcfd,
                    0x055b97358c5fc3b8,
                    0xc0375783b6d4a7f2,
                    0xafcdc891b81cccc9,
                    0x6bc13a1f5b6a1da9,
                    0x009c7a4456641bd2,
                ])),
                Felt::new(BigInteger384([
                    0x4dd07c401186594d,
                    0x8ca3ad31ce00b969,
                    0x64afa33aeac1431d,
                    0x38babcde45fdd046,
                    0xed2f59f0beff0e6d,
                    0x004202c2d8e78b7f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3f1b40a14b022c94,
                    0xabbda09c52965268,
                    0x7c2004344ff0b071,
                    0x2c0d80fd1e78c465,
                    0x9d0420ec3e4773c3,
                    0x012b0581e7efa131,
                ])),
                Felt::new(BigInteger384([
                    0x42b75d2bb3f59f18,
                    0x09b961b06c278b22,
                    0x4475a75de06537f9,
                    0xc64649b43e20b0b0,
                    0xa4088212e686da96,
                    0x001c419f4a60c50a,
                ])),
                Felt::new(BigInteger384([
                    0x0dc373a41cbe3083,
                    0x716e844b6ef0edd6,
                    0xe54767791e5054b2,
                    0xeab10f15d5cd3316,
                    0x54515ace973f379a,
                    0x00f91cbc4e30e10b,
                ])),
                Felt::new(BigInteger384([
                    0xc3d8c155b33e4b0a,
                    0x886b4dc8d1c7ad66,
                    0x657c8a277f46c399,
                    0x2325c600fcfdb648,
                    0x9691c080ded84b6e,
                    0x015c299719f93f04,
                ])),
                Felt::new(BigInteger384([
                    0x854957abf9136dec,
                    0x749975691aed99d8,
                    0xb6799e67b72827ed,
                    0x042a2d43bef7a80f,
                    0xf51f8f28d1cb1a6f,
                    0x01a2fe308841b81a,
                ])),
                Felt::new(BigInteger384([
                    0x3e2b2fbc645a0f7c,
                    0xba83fac5023c0045,
                    0x4b24b786198776a3,
                    0xa45145810d0f593c,
                    0xb8ecc03fcc5dd3ce,
                    0x00012323fbf87821,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf94ad835d3cb4749,
                    0x89e488f1ec6ef27e,
                    0xb7ddc3ced35a05e0,
                    0x929fb6753104999f,
                    0x75f48634d9a5d607,
                    0x002ec911279a2997,
                ])),
                Felt::new(BigInteger384([
                    0x70d34ce029a8029f,
                    0xa39af916ad7de399,
                    0x75a608b989891a13,
                    0x064514185ca1a763,
                    0xa2ba476d27b55465,
                    0x0001a9f62bda8fba,
                ])),
                Felt::new(BigInteger384([
                    0x6a4402772f5f3a4f,
                    0xe9385eefb00c6a29,
                    0x4c22df8afc81e204,
                    0xf2f58f314ad355a2,
                    0x16a4fb56382137d4,
                    0x015875c874b16454,
                ])),
                Felt::new(BigInteger384([
                    0xa128d99e5c6ecdbf,
                    0x75dc270d4569ba0e,
                    0x0afa857659cc0c45,
                    0xa9e1034713abff71,
                    0x105df05182431ad0,
                    0x010d242aef818213,
                ])),
                Felt::new(BigInteger384([
                    0x1e65993a1ea943bb,
                    0xa8bc2b97264ec8a7,
                    0xe7e6eebbda2a2ed8,
                    0x1f7f5fa08ee1f17a,
                    0xec33a528048f9ed2,
                    0x018bd3b1df1eb1a3,
                ])),
                Felt::new(BigInteger384([
                    0xe05b012f8a5d3ed5,
                    0x8238bd35a7c6a9be,
                    0xb77106d1be3c5c9b,
                    0x5bf2317ecd5ecd1e,
                    0xedaf96588bbca9b1,
                    0x0066f0e82691209a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3e26709dbe2858f2,
                    0x97f058c38bdc0a2f,
                    0x17b1ed313eac306a,
                    0xd3462f9bb3124c08,
                    0xce9ecec8482cac0c,
                    0x00112fd756c3d504,
                ])),
                Felt::new(BigInteger384([
                    0x5e43318df34ef605,
                    0x0c944f8bc5b06790,
                    0xc144a441725ec29f,
                    0x506f92f24945a8f8,
                    0x7a9e8ada73d0a298,
                    0x010706f8278762ab,
                ])),
                Felt::new(BigInteger384([
                    0xad64fc73a63cafce,
                    0x61a2976ba3da953a,
                    0x2b1f2ea3169a9945,
                    0x181a406367596774,
                    0x1df30fcbba3efe8b,
                    0x00222dd17486ec2d,
                ])),
                Felt::new(BigInteger384([
                    0x9b5527725cae6c95,
                    0x9b3e2a17a2014666,
                    0x0a3a3f120f7ac136,
                    0x7ff9a64f2de7683e,
                    0x8515a9a911254f7b,
                    0x003bca47aebea2f8,
                ])),
                Felt::new(BigInteger384([
                    0x0c967cdba145d172,
                    0x43c5fd0e9df63cb9,
                    0xa8d95b9587429f4d,
                    0x261abb452850ec06,
                    0xacc4467e9584de5e,
                    0x01ab645607172602,
                ])),
                Felt::new(BigInteger384([
                    0x1323fc38a68e9955,
                    0x47a44151c85c0ef2,
                    0x2784d44489158df9,
                    0xbc243f43aa3dd734,
                    0xd5bb6515ba6f4b6b,
                    0x00b3f9d196342d54,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb15582ec19cf04ef,
                    0x8bab9acc66918fa8,
                    0x1c01bf2730ae12c7,
                    0x697aa285ebeec58c,
                    0x58ba39d1f7585ccb,
                    0x001d5f8d1dfa3da8,
                ])),
                Felt::new(BigInteger384([
                    0xf32e20197d591fe0,
                    0xf21305259d62d543,
                    0x2ab23dc6478c2d8a,
                    0x7f1c7d374ccaf6ec,
                    0xe2079aef75c57d4d,
                    0x00566cae4fb06665,
                ])),
                Felt::new(BigInteger384([
                    0xdd69273e57d4367f,
                    0xd76419bca2990ebe,
                    0xe32f0edd6a64de5d,
                    0xbb9f9d7a2ab527f3,
                    0x7ba24a39af1bb0eb,
                    0x018ae92066ceee9c,
                ])),
                Felt::new(BigInteger384([
                    0xec9761256a5ca0df,
                    0x6b423f973bba4a4a,
                    0xf068db43295d7e64,
                    0x7a525ff4defcc48b,
                    0x4e6be4721276622a,
                    0x01317c41dc8618f4,
                ])),
                Felt::new(BigInteger384([
                    0xe93b7f7e5dee037b,
                    0xa3d64a4e1f3bcaf6,
                    0x05cc5900d21dd90c,
                    0xe93c44688d3e26c2,
                    0x2768ada10a7669a9,
                    0x00ef1a6c42807dd1,
                ])),
                Felt::new(BigInteger384([
                    0x2eb22094492aaba1,
                    0xb7c341ccd91a942c,
                    0xcf9175b5714bc808,
                    0xa6fd56c014237583,
                    0xee88a34d40031f03,
                    0x01321ceec24d7a1f,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![Felt::zero(); 12],
            vec![Felt::one(); 12],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xcc63c77242c9713c,
                    0x02f3354ba46a8351,
                    0xb11456f1ae48107d,
                    0xe3ae7ca0c4003545,
                    0x5cda03f4c3b6256d,
                    0x00fe74af499bb683,
                ])),
                Felt::new(BigInteger384([
                    0x4692245ce676849b,
                    0xaefc015ac3e86de1,
                    0x4a61360a7b2c4829,
                    0x6c1cae812b3deb02,
                    0x17a9122bcfd8a4ac,
                    0x014f53b9649fc7b0,
                ])),
                Felt::new(BigInteger384([
                    0xfa4fb9783bcb1d90,
                    0x8a2c260a7057e2fc,
                    0x27dc885a8ce2c186,
                    0x0ddc873dbe692dd0,
                    0x5466695595c30413,
                    0x0081a8487e8cc2ca,
                ])),
                Felt::new(BigInteger384([
                    0x480a1c740235adfe,
                    0x669c650a4de79e8a,
                    0x11c362f4e667d39a,
                    0xf691ad110f038a1f,
                    0x96414f203f7dd49b,
                    0x00629499ce0d94bd,
                ])),
                Felt::new(BigInteger384([
                    0x3223ba13433c8aa3,
                    0x13cc7e20671d2ed6,
                    0x3d8795de580b014b,
                    0xa2a54f9c473df1e6,
                    0x3ebdc25b9539beab,
                    0x00f22cea5a2c6986,
                ])),
                Felt::new(BigInteger384([
                    0x3749a8a86ec13930,
                    0x2e20716c6c763cb8,
                    0x1d6f4aefbc96f813,
                    0x90bcf85e3837780d,
                    0x61e58e62e40d4739,
                    0x016e60fc29e9da0c,
                ])),
                Felt::new(BigInteger384([
                    0x842fd378c469e713,
                    0xb73af91d5a14fdde,
                    0xd892c5dcc1b456ca,
                    0x3efdced677a9e3a4,
                    0x169b83795425bec4,
                    0x009bb4cdae2ec217,
                ])),
                Felt::new(BigInteger384([
                    0xa33b0562eb8e8623,
                    0xf9591962a02ac741,
                    0xf95b9bb9abce414c,
                    0x9b3fd7db58bc431c,
                    0xbe9f5bc3c99a4fc3,
                    0x016d6749d9646f43,
                ])),
                Felt::new(BigInteger384([
                    0x900b657cf8c93e93,
                    0xb3683c6a0b761c5f,
                    0xee83cf1c14e39119,
                    0x0aa9b41eb64d1bb0,
                    0x2e43ee9d3f3b6ba2,
                    0x006a9dbbbbb684bd,
                ])),
                Felt::new(BigInteger384([
                    0x2c6d899c26839c2a,
                    0xe39b87d3e71f1692,
                    0xbe1cc210457e1b32,
                    0x6650fa3877f5e127,
                    0xa2b66a9aa5b6509f,
                    0x00e7d3a1a82fba0e,
                ])),
                Felt::new(BigInteger384([
                    0xfc4d59b22ad70ce3,
                    0xc1e8210412c48371,
                    0xd76f0f34906cb548,
                    0xb15d2c5edcc15c68,
                    0xcd64b8262cd9468b,
                    0x012bff5e846717af,
                ])),
                Felt::new(BigInteger384([
                    0x19de14256ba8e62b,
                    0x25ad42f5c4329b1f,
                    0x0cb113c88e2977a0,
                    0x2d3a1767387135c4,
                    0x9fa1fca3a3381186,
                    0x0024bedec2449107,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xe09b587e8a617d1f,
                    0x2a62e5f093c8b026,
                    0xd06c0273c7d112ef,
                    0xf5190007bc27380b,
                    0x58021500324cefed,
                    0x01825bf107de9274,
                ])),
                Felt::new(BigInteger384([
                    0x6fb52d55501addbe,
                    0xe164b8726dd7d3dd,
                    0x2ac85cf584be05ac,
                    0x75a4813b7461d33b,
                    0x3ddc3cbf186c92ce,
                    0x00d450ae039080f2,
                ])),
                Felt::new(BigInteger384([
                    0x8469f1b93f196665,
                    0x36c347cdb8d2f03b,
                    0xa7e268f97ccdac7d,
                    0xe69465a6c24cba3d,
                    0x4472e55da65d2fac,
                    0x010438c3d7d3ec18,
                ])),
                Felt::new(BigInteger384([
                    0x070713fb23753427,
                    0xc0fb2bee4290a7c1,
                    0xd4715bac14dccbca,
                    0xb0d998b556695fd7,
                    0x62e9a3ecab838272,
                    0x00cbec88ecefda79,
                ])),
                Felt::new(BigInteger384([
                    0x513f763335510781,
                    0x745c207eee0c4059,
                    0x390d7c934e71765e,
                    0xd6c2ba197d3f2fe2,
                    0xdbf8cec1b68455ab,
                    0x018d8385b8ac2e8f,
                ])),
                Felt::new(BigInteger384([
                    0x9f4b7cf32b641418,
                    0x37a21e4266a53e0d,
                    0xdde25d537c2ce8d9,
                    0xb193876b5e3850de,
                    0x635657fcba4ed77b,
                    0x008d89b3f19b97ae,
                ])),
                Felt::new(BigInteger384([
                    0xb0b0f7edc6b9edd7,
                    0x2152949f3d5d68d7,
                    0x9798098b7255955d,
                    0x71d682017ffefb6a,
                    0xb7dfab2188358e85,
                    0x00a7616d9048719a,
                ])),
                Felt::new(BigInteger384([
                    0x2d444a884745c4a4,
                    0x4d8aad00b04fe40e,
                    0xec5598da01c61e07,
                    0x3c96ba7998af5be3,
                    0x08365c98f564a586,
                    0x00d5dbfbde1bb316,
                ])),
                Felt::new(BigInteger384([
                    0x3a8959d52cadcd89,
                    0x36eed36b617cbbe2,
                    0x549149d95b635c76,
                    0x93f21ea884ee19d4,
                    0x9713e0eddb94b49a,
                    0x012c9467e2fa9703,
                ])),
                Felt::new(BigInteger384([
                    0x55aac766c783e92e,
                    0x962c00cd9c9f2ddd,
                    0x7b98c80e6f02e94d,
                    0x2afb2b3a6aff0fab,
                    0x44d06cbd78d44745,
                    0x00577537cb8a4432,
                ])),
                Felt::new(BigInteger384([
                    0xe462c477cf25b1ac,
                    0x3c2c339db8eac22d,
                    0x645d54fb483dd552,
                    0x78e3c8b8549e7ee8,
                    0x12ca1ab779257f9b,
                    0x0018d8db026c3a4e,
                ])),
                Felt::new(BigInteger384([
                    0x092b9727383b1055,
                    0xd5197ef2b73ac825,
                    0x42c018362ab2120f,
                    0x4501306b5471d52e,
                    0x452372f8e5562c90,
                    0x00a8a830f4a238ee,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x8c1992b0b27f3a51,
                    0x27c87f34adf1710d,
                    0xcb0ad36657c66570,
                    0xc9248ac84fa5cc52,
                    0x207e8ecc4bf58db5,
                    0x002c1ed1dc0663da,
                ])),
                Felt::new(BigInteger384([
                    0x4b392194b61c8a99,
                    0xebf3dd6b551f532f,
                    0x047984315c8dd434,
                    0x295589b2e45688d9,
                    0x2ce20fd9086f274d,
                    0x01702155132acfa8,
                ])),
                Felt::new(BigInteger384([
                    0x8ad06fdad0f5b8e6,
                    0xe51ce2b7f5dfcc10,
                    0x0c1108dd9da88a27,
                    0x684d0b4de0a20cb6,
                    0x4f289b277beac81f,
                    0x00081d2fda02f305,
                ])),
                Felt::new(BigInteger384([
                    0x395a967f5aae3d59,
                    0xb5157726a7fce697,
                    0x9f747935781a33fa,
                    0x11341a593f8af2bf,
                    0xebeefa54671a17de,
                    0x007949739b872fd3,
                ])),
                Felt::new(BigInteger384([
                    0xc6b0c8398df53c72,
                    0xcd5f91754d4fd49c,
                    0x38ece70eb53e65b3,
                    0xfcc6b8dcc00e423c,
                    0x53230f8875bc7560,
                    0x00830bb6dfeeab49,
                ])),
                Felt::new(BigInteger384([
                    0xf00892991ccb20e0,
                    0x9e112645de43ff15,
                    0x47e320b9153dbeba,
                    0xf7fe7cf36e7a299b,
                    0xcd3d37080cf7f8f9,
                    0x011b38ffdb2a9a95,
                ])),
                Felt::new(BigInteger384([
                    0x06e1c52a8b97f4a8,
                    0xae401bad2d43d0b7,
                    0x56bf9a8c90bc2de2,
                    0xe8aeede76dbc78c7,
                    0xbf69b48865755d6d,
                    0x00a01039bc2f8152,
                ])),
                Felt::new(BigInteger384([
                    0xe3147fc89598e962,
                    0xf0e514c7f616fe5c,
                    0x59f8f44074d23da0,
                    0xd5e8bb25400abc95,
                    0x0516da783a01de27,
                    0x0157ff403f4d3610,
                ])),
                Felt::new(BigInteger384([
                    0xd24e8fb20e636ee4,
                    0xe14b3999c7478a04,
                    0xc09465009e0fb888,
                    0x9bcfa221d1fc9688,
                    0x48aeff77140607b4,
                    0x00faa94f3d3e5243,
                ])),
                Felt::new(BigInteger384([
                    0x53ac1a1eee9c7308,
                    0x1b1ca539a4be42be,
                    0xd2c8159e8c105c19,
                    0x9efec4824c5774d4,
                    0x0013eda58a0eed1a,
                    0x011eb327921ffba4,
                ])),
                Felt::new(BigInteger384([
                    0x658705f300b8967a,
                    0x002d29719bed9d62,
                    0x2f09c9c2b39b2ea0,
                    0xc36df0243c198838,
                    0x2a45b9280f2b2ccc,
                    0x0033f8d923c7f71e,
                ])),
                Felt::new(BigInteger384([
                    0x1c873b896df6c5cb,
                    0x745d2e1481faf782,
                    0xd8547894c9d91dbc,
                    0x6f17791cd1b27541,
                    0xfd32737293e35959,
                    0x002d047d26274f7c,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xb66fbbfa45624ae8,
                    0x559752aa1d0512cc,
                    0x26576b75dc7f2d45,
                    0xdca4a646c4c6e37c,
                    0x9ade27f69c250f21,
                    0x0191df0c95525cb8,
                ])),
                Felt::new(BigInteger384([
                    0xd04c49a480629657,
                    0x39ebd0b111c5743f,
                    0x5453b13c3c87dff1,
                    0x776a8a80702a2b9e,
                    0xd8eff46ce7b3ebe6,
                    0x00e9ffca4828737f,
                ])),
                Felt::new(BigInteger384([
                    0x867c6ab8d6895a4d,
                    0xf92c32c442917eb5,
                    0x7ba94cc838e42e2b,
                    0x6180c8f3ad5425fd,
                    0x55f2bc55d0ceb237,
                    0x007d32ff1efcc9a2,
                ])),
                Felt::new(BigInteger384([
                    0xb76d071a910b09c4,
                    0x9cebac1239e8807a,
                    0x92848f5585975a5d,
                    0xfad3cc5c5b9b4325,
                    0x3008da427cb409d2,
                    0x00305cf5b1a7c011,
                ])),
                Felt::new(BigInteger384([
                    0x67e24fc9c0ff5a77,
                    0x514bea1d8c4890eb,
                    0x8856442b2f8f69b1,
                    0x5e83355b6bcd44b0,
                    0x048d08df77204aef,
                    0x012edf5bc6344fd3,
                ])),
                Felt::new(BigInteger384([
                    0x1e1f09059069171a,
                    0x2f3ff33b32d5488f,
                    0x56d1056e2dcbd214,
                    0xd4c251ceaa75e39b,
                    0xf4d13ec624336e75,
                    0x015b78f802e9da5d,
                ])),
                Felt::new(BigInteger384([
                    0x8ba9d083d1757de2,
                    0x53d2508e6a5e672c,
                    0x22138bed74ee7041,
                    0x7bb1505a60d0b535,
                    0xc76dab716741a05d,
                    0x004711b88357749b,
                ])),
                Felt::new(BigInteger384([
                    0x8816b98be7ebb633,
                    0xbae974732bc60402,
                    0x0d89f833e47025fc,
                    0x7ea28f0603094033,
                    0xe51a22a450b2026a,
                    0x0114b90b2b289849,
                ])),
                Felt::new(BigInteger384([
                    0xa65930c21d783f76,
                    0x8263a8b079b62df6,
                    0x17583f680651a88f,
                    0x08f413c4c2426cc8,
                    0xdb6ec753e1d234d2,
                    0x001300c1c664d171,
                ])),
                Felt::new(BigInteger384([
                    0x2bc90ab8a0fe20e7,
                    0x087b328295079096,
                    0xad99b0b1dff5aaa6,
                    0x7c2e7e6efb51498c,
                    0xee76cfeea925ef8b,
                    0x006fa9fb99043db5,
                ])),
                Felt::new(BigInteger384([
                    0x2958c08d1fec33f2,
                    0x1edb52427066ab1f,
                    0x993f3fa35c8ec91c,
                    0x4c615058f28b7715,
                    0x69853dc46f2e568d,
                    0x0147fe06522d70e7,
                ])),
                Felt::new(BigInteger384([
                    0x0370553696062ffa,
                    0x6ccaad008db74b31,
                    0xad45e9ec054140aa,
                    0x36ca95cb1ed73035,
                    0xbbe41908730248cc,
                    0x00f642de124d4b1d,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x2a143069c3210854,
                    0xe1474be58affd34f,
                    0xe63d54e3d9fc0531,
                    0xbef96ef9a00a9aa8,
                    0xeccf6fc4326a0b8f,
                    0x0194ff4cb26d2ef6,
                ])),
                Felt::new(BigInteger384([
                    0x219df44f198a8798,
                    0xc494575b5a1faa75,
                    0xd8632e16d3ba7b1d,
                    0x3858a0049197a924,
                    0x25d6760ad1ce2c92,
                    0x01882e58dddac16b,
                ])),
                Felt::new(BigInteger384([
                    0x5ac249e8217523a6,
                    0xb1f4050132c2355c,
                    0xaa542a90dd1a8ac5,
                    0x68fc13f9b21c42bc,
                    0x7eb46a1003301c46,
                    0x017b263c7e23a8a1,
                ])),
                Felt::new(BigInteger384([
                    0xdc38148df0705678,
                    0x6d89e7834fb1415d,
                    0x7a5f0c0af206e5e4,
                    0x0b56e542d330c12b,
                    0xd9ffc96256656c7b,
                    0x008b8aec2fbbe95f,
                ])),
                Felt::new(BigInteger384([
                    0x73385cc0182169c8,
                    0x503fb93526c8d63c,
                    0x8c6b770396eea968,
                    0x5fab3c5d9dcfdbde,
                    0x90558c5eb4bc3f72,
                    0x00c40cb76c3e0585,
                ])),
                Felt::new(BigInteger384([
                    0x83b61aaee821e1ff,
                    0x63681a291f150f2e,
                    0x4b39dcbe562f3eea,
                    0x2c09366e73e987f8,
                    0x07189ad43fc0e245,
                    0x003554626401a5ab,
                ])),
                Felt::new(BigInteger384([
                    0xf0a6d624308e5f7c,
                    0xe73d90d91117e865,
                    0xc71b310a89f773d2,
                    0x141ff546693fb753,
                    0x8de3bd1f88b37141,
                    0x01468b35077d4580,
                ])),
                Felt::new(BigInteger384([
                    0x1a2ef7c09e65e270,
                    0xea5ec437824ea105,
                    0x392a29b3bb261e4f,
                    0x5be09118df63bb01,
                    0xf677c9bfe4e8c3bc,
                    0x00fd5f442f4d97a1,
                ])),
                Felt::new(BigInteger384([
                    0x158748801b0b3025,
                    0x796e7b2fa5cc787e,
                    0x1c70b96a332b9541,
                    0x5b3b8d230d2fee90,
                    0xc21d5900f42e830e,
                    0x00e2217c6d69aef3,
                ])),
                Felt::new(BigInteger384([
                    0x62f6304b44a1ee99,
                    0x11622710b197ec4f,
                    0x735f155120462cf9,
                    0xdb98785727e38189,
                    0x24cdbe4350d414c5,
                    0x00a85fc7815cb9dc,
                ])),
                Felt::new(BigInteger384([
                    0x5dc2ba478fa9dbeb,
                    0x4ce04d877592a553,
                    0xf033dc4563386e5d,
                    0x508f5ea0a1c8d96a,
                    0xf34357186d79c129,
                    0x00dc1c26c812bd3b,
                ])),
                Felt::new(BigInteger384([
                    0x1bd62f9649aaa2b0,
                    0x600aec831515b907,
                    0xd7056420e44f0326,
                    0xa00db7ca2a3571f4,
                    0xc0eeb3c234be742f,
                    0x01461ad6854521f2,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x2f7ac8f93450262a,
                    0xd1367af1c860ea49,
                    0x0e1fcf5ab2a6ccc1,
                    0xf91129f027bdf599,
                    0x5c959b786cdbe570,
                    0x00a6888eda42cd25,
                ])),
                Felt::new(BigInteger384([
                    0x1706e6352f6ea8f8,
                    0x5dffb1945723eb88,
                    0x58bcbc7084a8ac5f,
                    0x37e090598f47bd04,
                    0xef4b00a1e5661634,
                    0x00ea3acbc1a22c5d,
                ])),
                Felt::new(BigInteger384([
                    0xe78720cebe60abe2,
                    0xb8cf31d8ae484321,
                    0x63c1ff2bd7ab7056,
                    0x5b35d34b3b6b1305,
                    0xf0e3a621e8f4b455,
                    0x00c466333b13f3af,
                ])),
                Felt::new(BigInteger384([
                    0x5ce28146bcf1eb50,
                    0x4077d980f2947cfa,
                    0x9cf5c002cc2a9824,
                    0xf2cfccaa2477e376,
                    0x2ea98446f7ea90ca,
                    0x007205cc5cebf1e5,
                ])),
                Felt::new(BigInteger384([
                    0x3f28fc422fbaa7d7,
                    0x0ab0bed2b59b236f,
                    0x196d177cfcd3d585,
                    0x279185bc6b2d9773,
                    0xf536b8c001807239,
                    0x00d7fbe0ee8966d3,
                ])),
                Felt::new(BigInteger384([
                    0xa12d65a09b2ea7ae,
                    0x9850b9aa5a99c1d5,
                    0xae5791506825c8da,
                    0x00d5cc18e9c35dab,
                    0x17b7cc2be2a8ea00,
                    0x012dd3b35c6b3758,
                ])),
                Felt::new(BigInteger384([
                    0xbe7d44eed5f9ec73,
                    0xbe80925e02599ba4,
                    0xc53e3d6ae8af80ca,
                    0x1e0ef025f900c61c,
                    0xbbe3e6d8ef0458c2,
                    0x019021434379960c,
                ])),
                Felt::new(BigInteger384([
                    0x7b72bdfe0a55b826,
                    0xaaf3e2ca0630e3d3,
                    0x490b7ec820f47501,
                    0x66051126df57727d,
                    0xa4a2f02e0bc55d7f,
                    0x017885da5bf10f98,
                ])),
                Felt::new(BigInteger384([
                    0x1e1291ef779eb406,
                    0x350963514ee9ae65,
                    0xb98554251d53a14b,
                    0x9edd4f0a950e3c1a,
                    0x2a36be7f356ee37b,
                    0x00ba4bc1ee62f701,
                ])),
                Felt::new(BigInteger384([
                    0x714831723900d221,
                    0xc2fcf2a22575b051,
                    0x6060df2a23bfe624,
                    0x5e117aa7866c55cc,
                    0x5d263289caf65486,
                    0x0029e3f8e9136a24,
                ])),
                Felt::new(BigInteger384([
                    0x32e3ad31085de2f0,
                    0x20952d829802fc68,
                    0xbdd01fb06fc621b3,
                    0x8d5cb5f7ae6e0563,
                    0x0c19651fede185ef,
                    0x001667370fee02ea,
                ])),
                Felt::new(BigInteger384([
                    0x5034e88f2150856a,
                    0x1629f61c777e34aa,
                    0xdab115372ae60e28,
                    0xdf81fb4614e28f14,
                    0x6e5691c9e346daf8,
                    0x0053aec63bbbfe59,
                ])),
            ],
        ];

        let output_data = [
            [Felt::new(BigInteger384([
                0x18ce3a84567085c3,
                0xd43a9b16eb63adf4,
                0xf4bade872aaffd84,
                0xac32a236d31531f4,
                0x443aa1d3900087b8,
                0x001dc6a2580076e2,
            ]))],
            [Felt::new(BigInteger384([
                0x5bb15ea7e6d97287,
                0xc7603013499066a2,
                0xa08f5f0d1da0cb79,
                0xc661bf39f786ebe5,
                0x5a7a980c170642ad,
                0x01609ace879158a1,
            ]))],
            [Felt::new(BigInteger384([
                0xe1d76032141b1c51,
                0xbf44fb611f40d242,
                0xf7f1d526c568e5c3,
                0xe5efb8503190a9fc,
                0x632c7630f9e80039,
                0x00d8ecde3fb481f5,
            ]))],
            [Felt::new(BigInteger384([
                0x3e6469d9c75fec0d,
                0x1f77e531c8b1a6c5,
                0xaedbddd980440ed4,
                0xf574b0c025b4a46d,
                0xd92f580c1d2e8d00,
                0x01a0de9d05181047,
            ]))],
            [Felt::new(BigInteger384([
                0x8e5f98c81416139b,
                0x4dd7dd21774888c6,
                0xecd1668870593748,
                0x9121342803611a87,
                0x783ae465ef9a3866,
                0x00c0cf01b867c83b,
            ]))],
            [Felt::new(BigInteger384([
                0xcd853e0ba8819800,
                0x58a87bb598d42ccb,
                0x3f1f9e6078361d53,
                0x4ad976d1ccbd44dc,
                0x863dcee759837d47,
                0x00d37c98465de1e9,
            ]))],
            [Felt::new(BigInteger384([
                0x1cf3a584212028c2,
                0xad791fd70368a925,
                0xa31b44bebfbb7a3c,
                0x53c51ee466b9513e,
                0x11602f249339b98e,
                0x002373cc96448bc8,
            ]))],
            [Felt::new(BigInteger384([
                0x478ff01f7643d97d,
                0x85ce275d6636b6ba,
                0x3bc253443a01b196,
                0xbc860d16df15a729,
                0x9d39cd3f866b58e1,
                0x005147cce1a94d59,
            ]))],
            [Felt::new(BigInteger384([
                0x852fbd1b7a397db5,
                0x0e6a0f62d74d9987,
                0x4089acfeef128d63,
                0xbc7c6b315c04b0da,
                0x1c50034e43d4ebb2,
                0x00742b6a5c811762,
            ]))],
            [Felt::new(BigInteger384([
                0x2cb8f1be3b9b6887,
                0x3ff55af4ab6faa2b,
                0x5a93ac9793d75211,
                0x03ab171753a27dc8,
                0x760592bc0f163b00,
                0x0136e4629d8b326d,
            ]))],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 12));
        }
    }
}
