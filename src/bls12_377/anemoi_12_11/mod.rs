//! Implementation of the Anemoi permutation

use super::{mul_by_generator, sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 12 field elements or 576 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 12;
/// 11 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 11;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 6;

/// 1 element (48-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= mul_by_generator(&y2);
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += mul_by_generator(&y2) + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4], state[5]];
    let y: [Felt; NUM_COLUMNS] = [state[7], state[8], state[9], state[10], state[11], state[6]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4] + x[5];
    state[0] = sum_coeffs + x[3] + x[5] + (x[2] + x[3] + (x[4] + x[5]).double()).double();
    state[1] = sum_coeffs + x[4] + x[0] + (x[3] + x[4] + (x[5] + x[0]).double()).double();
    state[2] = sum_coeffs + x[5] + x[1] + (x[4] + x[5] + (x[0] + x[1]).double()).double();
    state[3] = sum_coeffs + x[0] + x[2] + (x[5] + x[0] + (x[1] + x[2]).double()).double();
    state[4] = sum_coeffs + x[1] + x[3] + (x[0] + x[1] + (x[2] + x[3]).double()).double();
    state[5] = sum_coeffs + x[2] + x[4] + (x[1] + x[2] + (x[3] + x[4]).double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4] + y[5];
    state[6] = sum_coeffs + y[3] + y[5] + (y[2] + y[3] + (y[4] + y[5]).double()).double();
    state[7] = sum_coeffs + y[4] + y[0] + (y[3] + y[4] + (y[5] + y[0]).double()).double();
    state[8] = sum_coeffs + y[5] + y[1] + (y[4] + y[5] + (y[0] + y[1]).double()).double();
    state[9] = sum_coeffs + y[0] + y[2] + (y[5] + y[0] + (y[1] + y[2]).double()).double();
    state[10] = sum_coeffs + y[1] + y[3] + (y[0] + y[1] + (y[2] + y[3]).double()).double();
    state[11] = sum_coeffs + y[2] + y[4] + (y[1] + y[2] + (y[3] + y[4]).double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies an Anemoi permutation to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Applies an Anemoi round to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xc19439e10b9c8b81,
                    0x09b4ec6bf864ee87,
                    0x839396d6fb74ed1b,
                    0x3f69ab249f88beb4,
                    0x41f8cfa40d0265b3,
                    0x003e760156e3b8d3,
                ])),
                Felt::new(BigInteger384([
                    0xccd0026cabd49fa6,
                    0x13c3a46285098745,
                    0x8f26b162b6f01c3e,
                    0x094f30b2614f2556,
                    0x64b0d043cc3c0b00,
                    0x00df329a2167ca53,
                ])),
                Felt::new(BigInteger384([
                    0x7d02af3645bf6f66,
                    0xf1ad4f28add9958e,
                    0xfeccaee23afc6449,
                    0x08ea010e3d4addd6,
                    0x7a652267c6092c81,
                    0x0121d4c53e0c02b9,
                ])),
                Felt::new(BigInteger384([
                    0xf602b3081402b3a9,
                    0x9b4f8de44fc1c679,
                    0xd608afddd620322f,
                    0xc2c6df580901ade3,
                    0xe38c387a6fedb93b,
                    0x007a059a5847f9fa,
                ])),
                Felt::new(BigInteger384([
                    0x95b187b1ebd495fc,
                    0x1bd1b487cdffd1f1,
                    0x119bac83aacfb5b5,
                    0x97deb5a2999d84cf,
                    0x42ceb7ae2b2dbbee,
                    0x00d8bf471a94bbf2,
                ])),
                Felt::new(BigInteger384([
                    0x81aef8c6d02a352e,
                    0xd475b4f0be7dc3f9,
                    0xa2ecbd1fbd22f448,
                    0x4c137869260fb598,
                    0x48a72c41bf249657,
                    0x00baa483d1930243,
                ])),
                Felt::new(BigInteger384([
                    0x449608a297e5d5c8,
                    0x060c21dfc0e97c0e,
                    0x903a6316dc50667d,
                    0x0edf192febd7fcef,
                    0x9361f65aadca0de6,
                    0x0036f4bbc059c49d,
                ])),
                Felt::new(BigInteger384([
                    0xf319e301f365b0a6,
                    0x668305a0b12a35ed,
                    0x174c0b6a40a5f33a,
                    0x04607e6f8452144d,
                    0xc9d8c99c6feb8c52,
                    0x01717a87fb31ad00,
                ])),
                Felt::new(BigInteger384([
                    0x249bb70e32fe01d8,
                    0x66e7a3a792f1faac,
                    0x086dea10faab2569,
                    0x6eb2a641ec8f853f,
                    0x51c163b9fba133b4,
                    0x008973fed1d28739,
                ])),
                Felt::new(BigInteger384([
                    0x648b7deb37097889,
                    0x109a1d64e1c80578,
                    0x8f091e3b5f0a72c9,
                    0x591b2f39265d21c0,
                    0x4a1a9a84bd217044,
                    0x0100f94ed6752346,
                ])),
                Felt::new(BigInteger384([
                    0xd84412858f9e37fe,
                    0xee33b560ee66ed71,
                    0xbe24f0bd6b5705fa,
                    0x4da10ff92866f228,
                    0x85ded7df404388bf,
                    0x00c8db2c0b07251b,
                ])),
                Felt::new(BigInteger384([
                    0xf0946ddbd450a9d5,
                    0x770928588eb50528,
                    0x343175199202988a,
                    0x0f0c20996b88cc83,
                    0xcd9a344cca1b61f9,
                    0x004384d8938d1d19,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2ae2439367109bff,
                    0xdaa420248efeb38d,
                    0x3a30e63360150309,
                    0xad56e6f3aa8d4393,
                    0xe854a5a4658e035d,
                    0x002b984b1328f10b,
                ])),
                Felt::new(BigInteger384([
                    0xf09d50892d175cce,
                    0x99d8089c6d81c5d6,
                    0x71627ad203d189f9,
                    0x78ad65568eddc173,
                    0x6318eed736ec863b,
                    0x00c9d32a11fe0a45,
                ])),
                Felt::new(BigInteger384([
                    0x3372e47fb7640545,
                    0x90412bddbb4257ad,
                    0xcaaf1a843d094e0c,
                    0x52ae85b41c0d1cad,
                    0xd1da3d66a3b5bad6,
                    0x0048d0c88b9a3d7a,
                ])),
                Felt::new(BigInteger384([
                    0x3cf179ebbb97160e,
                    0x864f8e5d6149db8f,
                    0xd66686867f625e6a,
                    0xd195a0c053fec6e6,
                    0x3f41eddc4893e48f,
                    0x017fb2b75b65138e,
                ])),
                Felt::new(BigInteger384([
                    0x885906a02a5203cb,
                    0x20963a81e35d227b,
                    0x97d69436c21f7cc0,
                    0x54f8d4773183ed4b,
                    0x835238f129b22340,
                    0x013dfbb22ae8219d,
                ])),
                Felt::new(BigInteger384([
                    0x8cb87eccf809f8d2,
                    0xfc0a00ab04a65c32,
                    0x01bce31cbbe50773,
                    0xa0a94efb582e0200,
                    0x232d438bb7c2a623,
                    0x00bc1759850b1f99,
                ])),
                Felt::new(BigInteger384([
                    0xc8cdf2c8a5f8b069,
                    0xd5d5cdfa6b9dd85a,
                    0x4bacb096efff96a2,
                    0xa96f7e7828036f99,
                    0xbe9916a89d365e04,
                    0x014ab2e12eb5454b,
                ])),
                Felt::new(BigInteger384([
                    0xbc029b0dc1031d96,
                    0x7606f6f3894547e2,
                    0xc4a6214dc97e14a2,
                    0xd2883600f982e482,
                    0x83c4c22a2cd9c3ee,
                    0x016bd7a9a7f19671,
                ])),
                Felt::new(BigInteger384([
                    0x0ab985c42f6cd3a2,
                    0x3615e0feac56fd4a,
                    0x67ac5a01c40a0bf2,
                    0x6ffcaed7cd75e371,
                    0x5c02e31354a1fadf,
                    0x003df059d93f0114,
                ])),
                Felt::new(BigInteger384([
                    0xf98696d280dc476b,
                    0x5cf0d142ac13d778,
                    0x9aee4286e18cb8de,
                    0x2d702da41e6be7a2,
                    0xb23c267286aca521,
                    0x008052b05b407369,
                ])),
                Felt::new(BigInteger384([
                    0xe4358b1547b49a3d,
                    0xa7ffaae7398c0e4b,
                    0x7096a8c6b8d81e89,
                    0x3dc3cbc7744920fe,
                    0x2af6697b8aff4139,
                    0x0054e150956039d7,
                ])),
                Felt::new(BigInteger384([
                    0x9492684f22d035ab,
                    0x7fc25474fc1784c6,
                    0x42de2d734773f7e9,
                    0x934cee95708905b1,
                    0xa528893008c4416d,
                    0x005c5ddb15a68820,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x6b9d2168d5b23f22,
                    0xe2707e926a9f0c3b,
                    0x25606aba99c99cba,
                    0xc0e2e8a880ff76bb,
                    0x73fcc093129fbda8,
                    0x01769c0c9346c1ce,
                ])),
                Felt::new(BigInteger384([
                    0xc48fa097ee3a20ca,
                    0xe2cdb2acb1b88cba,
                    0xd594956fdaa9a1b1,
                    0x31c624f7ad94f862,
                    0xa25f9bd0f6f800d5,
                    0x00f42885a3c557ae,
                ])),
                Felt::new(BigInteger384([
                    0xfe1ffe4828a8433c,
                    0xf0e1f311173a05e5,
                    0x2a5b60dcb4b7c9a3,
                    0x677a78371fcccd93,
                    0x9e463b27e6d7ca92,
                    0x011a6bb53c9e4d14,
                ])),
                Felt::new(BigInteger384([
                    0x4ff1f5d59bff2d9e,
                    0xdf0e4cdb0bccb908,
                    0x112ca02b7f5ebe86,
                    0x144b93bf77e178ca,
                    0xcede2708dcb2187e,
                    0x0135590237d5f67d,
                ])),
                Felt::new(BigInteger384([
                    0xd815c7e161008750,
                    0xcf69370495300440,
                    0x77adc65638606b84,
                    0x8d6e24e510d4f7b1,
                    0x45cae695c6d301b0,
                    0x00358bf438d5d63e,
                ])),
                Felt::new(BigInteger384([
                    0x324df0634d8fd074,
                    0xcf2956bbe83858ff,
                    0x2df6fd7fbacf39f1,
                    0xed4e3bd541dac9ab,
                    0x26e3ae909f69422d,
                    0x00a1e5c6d2300e20,
                ])),
                Felt::new(BigInteger384([
                    0x10211a15fd5edf97,
                    0x2aa31dceb676dbc0,
                    0x9aa53a9772aca0ae,
                    0xb67347b8f3f9a102,
                    0x5f3fa742d9a9ccfc,
                    0x002005b601563a65,
                ])),
                Felt::new(BigInteger384([
                    0xc971b2e015f9fcd0,
                    0x1e73b4ecacb7ef10,
                    0x4e2874ada77df467,
                    0x898edef8bb980ad9,
                    0x2f9679ae4437b2e9,
                    0x00ac0098408cf7e4,
                ])),
                Felt::new(BigInteger384([
                    0xe1075eb0394e4d07,
                    0x7873ea9995fc7860,
                    0xa561003dd3dcda0e,
                    0xe999974c91a81a96,
                    0x11ccc6a13a1b147d,
                    0x014b7cd9ed5fa5a4,
                ])),
                Felt::new(BigInteger384([
                    0xf4104faa70280a72,
                    0xe2ec60d2c26b4965,
                    0xee5be3a8ecd9582c,
                    0xb6566b796dbba5e1,
                    0xd3beee2e5aac307b,
                    0x0176264f4068abd0,
                ])),
                Felt::new(BigInteger384([
                    0x57880611fe76b749,
                    0x7ee1046e19d83c37,
                    0x479bce0eda19adb2,
                    0x1e85bd86f7524a42,
                    0x833f21e608eb73ee,
                    0x00638ec5827d4058,
                ])),
                Felt::new(BigInteger384([
                    0x5fe88ebc8f456138,
                    0xd76f277864629ccb,
                    0x0f196904b0ac5258,
                    0x1d721551e4b01e45,
                    0x492542c4ef5958e0,
                    0x008a0702a09e5674,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x08cddea7a56d1311,
                    0x320d6693c2cdf223,
                    0x4defe9a551cca7da,
                    0x4b1786ec861f5939,
                    0xace62e883e0a9930,
                    0x00e77b1d05d80e6b,
                ])),
                Felt::new(BigInteger384([
                    0x3d142eb40a6c205c,
                    0xbbd9d987ef81d70e,
                    0x17d0ddcfa998ba9e,
                    0x974dbc81c83065a5,
                    0x1e7fc866f75adb36,
                    0x014fec28c0850263,
                ])),
                Felt::new(BigInteger384([
                    0xafc6af79b8fbfd56,
                    0x69cda184c43dc336,
                    0x16eed035043d477d,
                    0x6174adbd06e97947,
                    0xaff98de20fc2434f,
                    0x00ebc85a5cb709af,
                ])),
                Felt::new(BigInteger384([
                    0xe3612229da522c3f,
                    0x978fb1d2dbffa927,
                    0xa36abe64f74d6299,
                    0x0b062ee9fe568afc,
                    0x7e7a0d321bb0ef34,
                    0x010c8b9ac15a3e4f,
                ])),
                Felt::new(BigInteger384([
                    0xe4c26ce855b9a994,
                    0xd706425194650216,
                    0x50fdd01bf8ac70d3,
                    0x441606b624dbdd4d,
                    0xb7d32ac08acbc478,
                    0x00625a20c5ec4d70,
                ])),
                Felt::new(BigInteger384([
                    0x85d9e7f6e0cf6516,
                    0x388c672fe6b083e1,
                    0x2f3e585375f032b6,
                    0xb67e918b994b3809,
                    0x3958a25695c47aab,
                    0x00e897fe7a3b4fb0,
                ])),
                Felt::new(BigInteger384([
                    0x590cc0068ba1e465,
                    0xa83523071142c33d,
                    0x5b8914b51484e326,
                    0xc58dbff914e287fd,
                    0xc4f963c9f32a6980,
                    0x002d3548ee3eb14a,
                ])),
                Felt::new(BigInteger384([
                    0x4cdeba564a8429b6,
                    0xfb0de811d31d1fc0,
                    0xcda7f1ca3af6bb55,
                    0x369acdd156f4a36c,
                    0x42023c64664429e9,
                    0x000e5ffdac85e24e,
                ])),
                Felt::new(BigInteger384([
                    0x3f212720a3800080,
                    0x7b87d1b4d15b11e2,
                    0xd35835890981a320,
                    0xc8280bb270ea8d3a,
                    0x6ea5f898439d469c,
                    0x0128d3b476a227ee,
                ])),
                Felt::new(BigInteger384([
                    0xab36d0db6b159dfa,
                    0x366ac7c3476c2305,
                    0x9c26acac83fbe443,
                    0x664ffc5343b018da,
                    0x03e9cb0fe9f38503,
                    0x01464ab28a4efda4,
                ])),
                Felt::new(BigInteger384([
                    0x6b84a1567b571228,
                    0x10a4905e24b773c8,
                    0x90fbe76effa94617,
                    0x7c6bb333b9bf083d,
                    0xf346c6b030fc82b4,
                    0x015859e735501a92,
                ])),
                Felt::new(BigInteger384([
                    0x7325157e203abb0f,
                    0xc69613cf84f7673f,
                    0xfb8d8fdc89daf60c,
                    0x07089cf3cae25b00,
                    0x9a8b1d5c38354393,
                    0x0024498152615062,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xcb9207f300d1fe4d,
                    0xd96bdd1cd811f998,
                    0x38719bf90baccd50,
                    0x52a1fab4d278fbeb,
                    0xfa98ec9ea04d7fe3,
                    0x019f56925e9a6473,
                ])),
                Felt::new(BigInteger384([
                    0xeb3434427034f1e8,
                    0x5494f45b70688d73,
                    0x52e209fac0009a7e,
                    0xfe12c61b9928f27b,
                    0x0e29dd1151fc34f7,
                    0x015502a4f43a580b,
                ])),
                Felt::new(BigInteger384([
                    0xd369c87a6cb09982,
                    0xaaef4f6978c23692,
                    0x2bbb56d598a33fd0,
                    0xa2b9b36b748100bf,
                    0xa6b45a0cfa9dbdd9,
                    0x00b8c4dab0755ad1,
                ])),
                Felt::new(BigInteger384([
                    0x08b424adab0fa14c,
                    0x55310ec6b3dc91e2,
                    0xd74f6659b0353802,
                    0x8d229cc34732a264,
                    0x214f9e4e471ad55e,
                    0x00aa87d0b02174b0,
                ])),
                Felt::new(BigInteger384([
                    0xc2daf430091404f0,
                    0x945784c1a4ccd91d,
                    0xa06d40df67d71b38,
                    0x34acda17eef278cd,
                    0xbbbd120680e3f53a,
                    0x0095d8303c8a6005,
                ])),
                Felt::new(BigInteger384([
                    0x33a7463e9408a484,
                    0xb32870e7361ae180,
                    0x832e810e8c711948,
                    0x2b41b163e0640a11,
                    0x71cf746a80d8257d,
                    0x00d1dd462572511e,
                ])),
                Felt::new(BigInteger384([
                    0x6c3e4dc838cafdc7,
                    0x6bd397345347ed6f,
                    0xb3482551f9bb735b,
                    0x5b4898042e4238af,
                    0xc61d86c52a346eb3,
                    0x00f7acdefeed05e8,
                ])),
                Felt::new(BigInteger384([
                    0x336ceee451a14b05,
                    0xe2f4ffab9dc095cb,
                    0x729b90a293c55823,
                    0xe3509f06978d27aa,
                    0xe3082402d5f1407a,
                    0x00bc0340adf30549,
                ])),
                Felt::new(BigInteger384([
                    0xee5a62bda809cc60,
                    0x3ec09d641f1e7b1a,
                    0xc739e96cf3d4af71,
                    0x0d0ac9c0de5caef4,
                    0x098803ebc18c0c8a,
                    0x00d022477114fef4,
                ])),
                Felt::new(BigInteger384([
                    0x999255c576020f58,
                    0x510771e99b1c1119,
                    0x92d4edaba7f9d438,
                    0x4dcf3340db11f15f,
                    0x563260dc80f3d250,
                    0x005cef62dca2b749,
                ])),
                Felt::new(BigInteger384([
                    0x053d226e235407ad,
                    0xd20e13dcb77e38fc,
                    0x9ac41cbf6e4cbe46,
                    0x930acccecbfd99d4,
                    0x776e14e3fcad7a31,
                    0x0123682b72e48494,
                ])),
                Felt::new(BigInteger384([
                    0xed263f8d7ff1aed5,
                    0x1e05beba0c7f271a,
                    0x5cb7eff97a2f58a4,
                    0xd0c6ce3235fd516d,
                    0xb2dc450decad85bd,
                    0x0061c32a7d0bf7d9,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdc82c94a2bf220fe,
                    0x14139dc5cb2e6dad,
                    0x5908808c29670efc,
                    0x22ccfbd8df3f079e,
                    0x058abc022a23fc89,
                    0x012a34fb41519f51,
                ])),
                Felt::new(BigInteger384([
                    0x27cc5759e52c780e,
                    0xa7967b2a0aa39414,
                    0x96ed4b1a2fdd85f7,
                    0x6d658c4e93fe93e1,
                    0xaa01bbbf3be1d65b,
                    0x006c05426286ab0d,
                ])),
                Felt::new(BigInteger384([
                    0xd4382545808c9a3f,
                    0xad30c8a04a8f4700,
                    0xcf5c1ad2a1fd11b8,
                    0x23393f45cc339297,
                    0xc2780df61524d801,
                    0x000d1a1496849ed2,
                ])),
                Felt::new(BigInteger384([
                    0xdc51d16318347703,
                    0xb21c3d33929a2fb5,
                    0x4ae55c0c89a206dc,
                    0xfaae05a16867fa86,
                    0xc47cb85b0c32fb79,
                    0x0047165d1a9dcd59,
                ])),
                Felt::new(BigInteger384([
                    0xefb616e547c51dab,
                    0x54432973e4286522,
                    0x40030ae1b72582fd,
                    0xce0db992f19c3460,
                    0x593dd2a52c7f573d,
                    0x00bc21d02357f0b7,
                ])),
                Felt::new(BigInteger384([
                    0xfe20b4a1925a1496,
                    0x7e2d5368d5babe07,
                    0x697401f9ed2a7a1b,
                    0xad2bf05a60a75ae8,
                    0x992e2dc690414262,
                    0x00f582f6dde60334,
                ])),
                Felt::new(BigInteger384([
                    0x167bb829c013eec6,
                    0xdf3b65659c160182,
                    0x2da0ccd499fc4b8c,
                    0xd31deb598f58d32f,
                    0x3284ca6d95a0b8ec,
                    0x00a1673dc8c02080,
                ])),
                Felt::new(BigInteger384([
                    0x415f472257d2ae02,
                    0x1dcc856ef8a5d077,
                    0x8b9f0b6468165eac,
                    0xa765b5ddc57a9d9c,
                    0x947e4f8160a32d50,
                    0x00c19446a5511c79,
                ])),
                Felt::new(BigInteger384([
                    0xcbef0c400cf4ea37,
                    0xed6a8318c7c89348,
                    0x0ce1385a3fdedd7c,
                    0x144fae0c5f2a8f9e,
                    0x373f9433509df7dd,
                    0x0125c14ac69226a9,
                ])),
                Felt::new(BigInteger384([
                    0xbc2064dfbaf0b1b8,
                    0x6e2ef151b9ed3fc3,
                    0xc643128ea30fc612,
                    0x57cc497289374ef0,
                    0xa366029fce444ba5,
                    0x0185efc3ed693ff1,
                ])),
                Felt::new(BigInteger384([
                    0x04afce6bfdc35cb8,
                    0x4fc3933124d749e4,
                    0xeb24554f3c8739f2,
                    0x9addb01df2b26ab7,
                    0x8acd3c138bb65ae3,
                    0x00b739a743e1729f,
                ])),
                Felt::new(BigInteger384([
                    0x201c797f4e3e4df2,
                    0x50d56a63ca2b64a9,
                    0xc73abd135098be2b,
                    0x46c4a6ed8449eef2,
                    0x253a1c7494d0099a,
                    0x00f5c088d4f700e1,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x42efffec1c22b7b8,
                    0x860ae23ed96524cc,
                    0x6d8c9f90c06ab4e4,
                    0x472616f7ef3437d3,
                    0xf53b6b0e3d2be22e,
                    0x00f53d09b6e1eea0,
                ])),
                Felt::new(BigInteger384([
                    0x07fa489eb0b327eb,
                    0x22c9d17bea1f9e65,
                    0x463424027bbe6956,
                    0x2efb96ae470a8f7f,
                    0x4da75607250bb9e9,
                    0x00644960d88f01f4,
                ])),
                Felt::new(BigInteger384([
                    0xc42c4b7676e064e2,
                    0x5b26e20c6e8f8694,
                    0x7f6deb4a0b121276,
                    0xd8b577ef605bbe46,
                    0x35127a17b077b668,
                    0x0068625f28600527,
                ])),
                Felt::new(BigInteger384([
                    0x85fda7f9f27ff4d0,
                    0x49a4f78d66a01b64,
                    0x4d1470f26ef59aaf,
                    0xcab1607967c1391e,
                    0xfa00b7c440ab1cc4,
                    0x0114667eceb70d26,
                ])),
                Felt::new(BigInteger384([
                    0x83eb5878dd520be4,
                    0x1bf5d53f936fec71,
                    0xd28ca839690a2847,
                    0xe3863682818eb668,
                    0xaa2a79bf92067bb9,
                    0x003e70069b5f7572,
                ])),
                Felt::new(BigInteger384([
                    0xd4060fa4d0c996b4,
                    0x22f59869aa251324,
                    0x54ae4367b3555496,
                    0x3db867f79d7afadb,
                    0xb1f9350cb6bc6a32,
                    0x009827aaf9a80c18,
                ])),
                Felt::new(BigInteger384([
                    0xc4cde7b77966a3c6,
                    0x54b172cdf7bc9872,
                    0x2469a1ae7ac43db7,
                    0x270b014037baa39b,
                    0xd425f90be869843a,
                    0x0123a8645e9d1a95,
                ])),
                Felt::new(BigInteger384([
                    0x84903c0ee38e5d62,
                    0xe5ed82f8e9d52e7b,
                    0x2569a7e90d31e06e,
                    0xebb9858f4cc0f468,
                    0x7bfd278b2a15f503,
                    0x0176219477d7d030,
                ])),
                Felt::new(BigInteger384([
                    0xaeaa82df672c2bca,
                    0x729756f62ad5ed08,
                    0xf7e5ad4889b9be16,
                    0x98231ff625d92fef,
                    0x763e54d146eb0164,
                    0x00da7b863192788a,
                ])),
                Felt::new(BigInteger384([
                    0x92026d8edc852733,
                    0xeb1bdf34a531d242,
                    0x057af08c461535d2,
                    0x4da3c7d7b3efbd37,
                    0xf965f182f625fc44,
                    0x007a1f8b8d44659b,
                ])),
                Felt::new(BigInteger384([
                    0xe456f02f4e65b019,
                    0x14296e07fb4422c7,
                    0x54e8e33e22b48fe7,
                    0x8493170019c36d1d,
                    0xae664b3501f5438a,
                    0x00b702c76b3efeeb,
                ])),
                Felt::new(BigInteger384([
                    0x75076a62e1305766,
                    0x45f82e13f19f98d1,
                    0x70d5b4a02b7ef294,
                    0x91cf4ea81c96b361,
                    0xb74ae470200b932e,
                    0x003cccb17a78067a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x619c139a3127d29d,
                    0x10b8556fe3effca5,
                    0xded7af1244b193f9,
                    0x2f13b269c1af7ca0,
                    0xca2ec99d9c64b431,
                    0x005ba899fa8a7d57,
                ])),
                Felt::new(BigInteger384([
                    0x3056618d4f97618f,
                    0xdfbab1012069aa7f,
                    0xb80175ee6ae1fbd2,
                    0xa4d5c07d611343eb,
                    0x3eebc61d8abf7268,
                    0x009539a380d54051,
                ])),
                Felt::new(BigInteger384([
                    0x7b4d62554757c332,
                    0x58c966d9f11569d6,
                    0x61a2a21bd275ccd8,
                    0x29327ddaf5d484a8,
                    0xc051d7f7e2becf88,
                    0x00826ae4f05202ee,
                ])),
                Felt::new(BigInteger384([
                    0x0de343217c50fdf4,
                    0x3d0ffd1c0f0803e3,
                    0xb1b42a9a32582c90,
                    0x63df8e683fce5d26,
                    0x7f49812c5314cedc,
                    0x00af7e2d6f5062c3,
                ])),
                Felt::new(BigInteger384([
                    0x4caa038b39b9d2b3,
                    0x1372b0131b678c69,
                    0x48d75da9fcedf68c,
                    0x99eea1f03ea1a622,
                    0x90604ff71d1b3fec,
                    0x01494f1004a3915c,
                ])),
                Felt::new(BigInteger384([
                    0xe173f9d4239a776d,
                    0x9cd4641825d89896,
                    0xd4cda06b92a7af5d,
                    0x78f9fe8a5a3d7199,
                    0xf87a07ee49d5292f,
                    0x0067ed03033f10bc,
                ])),
                Felt::new(BigInteger384([
                    0x7c5d0560c8a17d4d,
                    0x5de3a3f788d4e81d,
                    0x4c68713aa657157f,
                    0x232d866f78ab5b38,
                    0x0f38679ff76a2f8c,
                    0x00226ebd9b22a984,
                ])),
                Felt::new(BigInteger384([
                    0xf0014ecdbf57913d,
                    0x99bbba221954cc1c,
                    0x566c6e2f8e64fc51,
                    0x4a3378848c1b34e9,
                    0xf03730a93519fa8e,
                    0x014ed07187065e77,
                ])),
                Felt::new(BigInteger384([
                    0x8ee93ef8daededb2,
                    0xbf1a37b245e96335,
                    0x1d94ee96dea582fd,
                    0xce2e85e786495fbc,
                    0xd5904bd48f7bcfe9,
                    0x00126528d71e7a45,
                ])),
                Felt::new(BigInteger384([
                    0x2baacbee37b872f4,
                    0xdc43324457bcb8fa,
                    0xc393e33f53e93877,
                    0x2ea6224f5adae389,
                    0x277c6d33f633ac5a,
                    0x0190312d2ef8033b,
                ])),
                Felt::new(BigInteger384([
                    0x6c64c48488ebaa10,
                    0x2d8727303b2f3896,
                    0x6af49602d2813171,
                    0x035547ac433ca904,
                    0xf04c6700f0854d57,
                    0x002571ff2023e9b6,
                ])),
                Felt::new(BigInteger384([
                    0x1a8110dac78b071f,
                    0xa35b91880a3497cc,
                    0x543a4ff3d5720b68,
                    0x95c925609f858195,
                    0x813c787f186cae00,
                    0x00909353c4fdf213,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x66123e5d4ad5b21e,
                    0x005be1ab0b1b9505,
                    0xf168683669c0124e,
                    0x011f4c2d3f397bf5,
                    0x4dbe06046e1a885a,
                    0x015f6964850044cd,
                ])),
                Felt::new(BigInteger384([
                    0x9a4eb96fa180d66a,
                    0x8fecc6ba69b53ba0,
                    0x6aa94f2e01ade96f,
                    0x97299b357ae0a392,
                    0x916a543de3a3ce62,
                    0x00d38c18dea329f9,
                ])),
                Felt::new(BigInteger384([
                    0x1be58acaf0103d31,
                    0xbceba6781f3cb326,
                    0xc301696f08da4845,
                    0xa52f53acf3d03f3f,
                    0xfc97cd5e10484885,
                    0x008de3c9e72e0963,
                ])),
                Felt::new(BigInteger384([
                    0x34fc12d2939c1901,
                    0x85c67a31c10802b9,
                    0x74deeff2e0774bd6,
                    0x6ad90dee5ca8f7db,
                    0xb1fa5124616a689c,
                    0x00e365e14bfbdd65,
                ])),
                Felt::new(BigInteger384([
                    0x5f9c380516eb21f5,
                    0x1dc02c4654182dcd,
                    0xe2723bcc8e59fb64,
                    0xebc5e406a98d2199,
                    0x5de087512ab93395,
                    0x0104f697304799c6,
                ])),
                Felt::new(BigInteger384([
                    0x01afc201272ff869,
                    0x92b3d58512fe4a2d,
                    0xc5250177529b1b22,
                    0x22379cadd2e1afc1,
                    0x6a44ea3dc06e47c6,
                    0x015cf4b6507e7558,
                ])),
                Felt::new(BigInteger384([
                    0x9570d1eab68938b4,
                    0xf7ca34cbe01c7fb9,
                    0xa5f52a49dd930e41,
                    0x9b6f4cf4f3417683,
                    0x820d0a56b2709869,
                    0x0042601562a65f7d,
                ])),
                Felt::new(BigInteger384([
                    0xdbd998988b75e1f5,
                    0xb54a26943593eef5,
                    0x7938be704ee1dc8c,
                    0x0cd17c1622f1206f,
                    0x2bf8b7878b3f6910,
                    0x0175c28520345bbe,
                ])),
                Felt::new(BigInteger384([
                    0xbfedd0155fcfd95b,
                    0x187f91cb21a08457,
                    0x9e119be954cc6aff,
                    0x97f400e63b3f1713,
                    0x48d16cb75fa97818,
                    0x00d6447787b07ad0,
                ])),
                Felt::new(BigInteger384([
                    0x0964af69c0d95eee,
                    0xdaa5adb8e3455841,
                    0xe64482062af6ac7c,
                    0x2cebe03c85f0afca,
                    0x02a9eec430b78f70,
                    0x00d693d70e422324,
                ])),
                Felt::new(BigInteger384([
                    0x8490cdf1f2765c9e,
                    0xe9d03761610578da,
                    0xb5232a1cb54e4903,
                    0x2b52483ecaf50007,
                    0xcf9558f075114a0f,
                    0x013c1fa33d856ccf,
                ])),
                Felt::new(BigInteger384([
                    0x93ad3a5580b11aac,
                    0xe590492d552a515b,
                    0x7f4cf8283ca8a411,
                    0xcb981685c8e6a374,
                    0xe1ac560dc1f5d657,
                    0x00a42904b8ee1591,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xaf2edaf00bf0e9dd,
                    0xa4a64c859f0f4734,
                    0xb38c12ef1f125667,
                    0x3802a5afb4dbebd0,
                    0xd6db231f8c799576,
                    0x003ebf3e709ee8fc,
                ])),
                Felt::new(BigInteger384([
                    0x9239480df1d176ea,
                    0x5f938c43b65cc1c5,
                    0x0f1b36f99b5da3b9,
                    0xcb6d25d372c63235,
                    0x3318e262b7690452,
                    0x014d2743163db5a2,
                ])),
                Felt::new(BigInteger384([
                    0x564ffc5e68c493df,
                    0xd48e61d00cf4a8c8,
                    0x34ad7d47e65d33d1,
                    0x881b088bde5d7b30,
                    0xe5709dd5960fe453,
                    0x01099913e5d76b72,
                ])),
                Felt::new(BigInteger384([
                    0x7d10646678b22e41,
                    0x8e24eb561d16c6d9,
                    0x67f88595f0e99945,
                    0x5fe269cf7cfeba4e,
                    0xec2e8f4915e9f0d8,
                    0x002abe222828b915,
                ])),
                Felt::new(BigInteger384([
                    0x1211fd6dd15e82bf,
                    0xc55e24fc700249e8,
                    0xdb21ca8f3821eda2,
                    0x83f848cb9db9c187,
                    0x56f48ca0e9f8e973,
                    0x01236cda6cf95452,
                ])),
                Felt::new(BigInteger384([
                    0xd0e86039e45fcdb5,
                    0x436ef4a7a6fa66d3,
                    0xe969351645329332,
                    0xc323d8cbb18ce447,
                    0x16b36ff300560370,
                    0x0006ecb67e5f73c1,
                ])),
                Felt::new(BigInteger384([
                    0x54a39fa2d31143e6,
                    0x6f46bbea209728d3,
                    0x7e969dd0e2d50af8,
                    0xa92b7f8de8a0e6de,
                    0x68a167baf23f3025,
                    0x00d39cf7070799e0,
                ])),
                Felt::new(BigInteger384([
                    0x28c0524a92532cee,
                    0x30242b119e49527e,
                    0x9daf4e84763147c1,
                    0xee193f450976e417,
                    0x2e8c2a92fc891b56,
                    0x00e1e852413ab191,
                ])),
                Felt::new(BigInteger384([
                    0x35eb78d670e935ae,
                    0xa50ef10de6c31cc1,
                    0xab83f4be3e9eca4b,
                    0x9f19368e355418e2,
                    0x69dfa9c9e9b6a0cb,
                    0x005224e2bcf9a1c4,
                ])),
                Felt::new(BigInteger384([
                    0x4f733bca9c571f6d,
                    0xb6559e251783f225,
                    0x5349b0cd9b27b258,
                    0xbfaea3eda10ad17c,
                    0xa63655a0243f1d6e,
                    0x012564b6e6581883,
                ])),
                Felt::new(BigInteger384([
                    0xfc2784964b6a0299,
                    0x23ea529cecbb1f75,
                    0x393508c69c91c6be,
                    0x96ab879e37bf9bc6,
                    0x084511cf320796be,
                    0x010a64ed0538371c,
                ])),
                Felt::new(BigInteger384([
                    0x8b524f20d83690bc,
                    0x4692d30a216feb5c,
                    0x2d50fcc61209ebb2,
                    0x536498061995916a,
                    0x257f82c4427a4a1c,
                    0x0020a822274a84ed,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x33265d8ef2c53194,
                    0x6bec8f496097ebc8,
                    0xdd15de2a7fe8aec9,
                    0xfc848c2fc138ebb7,
                    0x0a54f4310b1e1cd7,
                    0x0105f0ba11374fb3,
                ])),
                Felt::new(BigInteger384([
                    0xc72d9f6879f5c9ef,
                    0xfbc4bdefc039a1b9,
                    0x79f18221703d58e8,
                    0xeaf8eda3cf4e4468,
                    0xae5767a2e7f8ae8c,
                    0x0124339ddd510f3f,
                ])),
                Felt::new(BigInteger384([
                    0x2536a5f14a05a6b4,
                    0xd6440915bcedbfc7,
                    0xb7242212fb024bbb,
                    0x382a165fa5455bb8,
                    0x0d809d799501a98f,
                    0x000bb938916f74a2,
                ])),
                Felt::new(BigInteger384([
                    0xf54572fc9faef9f1,
                    0x5208cb0c96940d7c,
                    0x07876eafd4e62760,
                    0xb308810c275aaa80,
                    0xf9cc9ea123d10ec7,
                    0x002d6ac83655256f,
                ])),
                Felt::new(BigInteger384([
                    0xda3455a3f4a93861,
                    0x00eb977d3b33ee5f,
                    0x2bdd04e3ffa4387d,
                    0xa6a9cd207a15d93a,
                    0xe947079e90988c55,
                    0x0198fced1ba33515,
                ])),
                Felt::new(BigInteger384([
                    0x152df8494aa7f08e,
                    0xaa06276f58adc33f,
                    0x90f34b0386b30fab,
                    0x61e998f20152a28f,
                    0x3404100fc444428b,
                    0x011526ca14d12151,
                ])),
                Felt::new(BigInteger384([
                    0xa0a391c679ba8fc4,
                    0x7001d0d198126a3b,
                    0xc4ce92489bd0364b,
                    0xc6bdfe75ca0e5d0d,
                    0xd42f9337645804eb,
                    0x01a18a1f4c2f9986,
                ])),
                Felt::new(BigInteger384([
                    0x59d8d9614d6e0cbe,
                    0x07e94800ff00d6d4,
                    0x2f1fe501fd805c01,
                    0x410b25c62cf05f20,
                    0x748cb4a78769a853,
                    0x007b88a82086f5c0,
                ])),
                Felt::new(BigInteger384([
                    0x5d49304cd92b2487,
                    0xbf058b66a9881a47,
                    0xb5b80a866f78633f,
                    0x92c58dfe64539f87,
                    0x713ef8a17c5fe3a7,
                    0x00843bb2afaf047d,
                ])),
                Felt::new(BigInteger384([
                    0x78056667a62c904e,
                    0xb425e55e6f6c7848,
                    0x4c0e527747a5a4f9,
                    0xede4eff21d9a8acc,
                    0x745e8ebda8328706,
                    0x014906915f40cf76,
                ])),
                Felt::new(BigInteger384([
                    0xc08875d4f44e9b70,
                    0xd8643ab49b36c362,
                    0x08a65d3bd7d32036,
                    0xd06b9df29e9bd271,
                    0x92295179d016aa0a,
                    0x003b6bd89fad1ded,
                ])),
                Felt::new(BigInteger384([
                    0xf60011ed03092b10,
                    0x59140165f442e984,
                    0x34342655dcc35f99,
                    0x15d570aa8131d1f1,
                    0xda602fcb649c0712,
                    0x019889a172dfbd62,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xa6b0a23ca0a08036,
                    0x5ae6b5aa9818b6b5,
                    0x1e955aea27a9c025,
                    0xdf3f677930eadec7,
                    0x39073ccf851954bd,
                    0x011e538f992b3a51,
                ])),
                Felt::new(BigInteger384([
                    0x21d9a805b129e882,
                    0xdbae9021147620c0,
                    0xf958a633a1f2cf8c,
                    0xb9a6481997c1b6a5,
                    0x10792c240ce1a90e,
                    0x0144e3aeb74aeaed,
                ])),
                Felt::new(BigInteger384([
                    0x8efba9886e65a99d,
                    0xf267e9a317b83da2,
                    0xbea738a0db9babc5,
                    0x0355a6c36e82e211,
                    0xce2560d06eff683f,
                    0x00441df1c6966cb7,
                ])),
                Felt::new(BigInteger384([
                    0xaf8588a402dceade,
                    0x0df413700441f2bd,
                    0x44a220f8f63a8202,
                    0xf9f30670d8c5bb20,
                    0x5f02743611671be6,
                    0x0163d683887b2dc5,
                ])),
                Felt::new(BigInteger384([
                    0x37a6689f591011c2,
                    0xfcc997384cbef205,
                    0x54382c1b455c25f9,
                    0xba2f940c8870557c,
                    0xf39eca1488d8f797,
                    0x00fad94bd342f21b,
                ])),
                Felt::new(BigInteger384([
                    0x129ce81a911ffc88,
                    0xa3825b15d539d6bb,
                    0x48fbb065d0a36ccb,
                    0xd7d11fc39311d286,
                    0x392adb12f6776e0b,
                    0x015d0e258f8e7083,
                ])),
                Felt::new(BigInteger384([
                    0x7bb8ee791d3e362e,
                    0x7220f2be3edf354a,
                    0x9c19b8306e395791,
                    0x7f924310d635e529,
                    0xfe83a905d6d7260b,
                    0x00c84755a0cbc640,
                ])),
                Felt::new(BigInteger384([
                    0xfbaeff02ac9591a6,
                    0xff94969c28693420,
                    0x2e4699c130cb9bb7,
                    0xe4d72b5cbe51cc8b,
                    0xe4a9c4e4c7f30c13,
                    0x014c2f6b492752ea,
                ])),
                Felt::new(BigInteger384([
                    0xe60c90b6fce02a1a,
                    0x343b39735442bb5e,
                    0xf9f4dc9f575a8224,
                    0x1242576d2dba6304,
                    0x8bc26ede14dcbe82,
                    0x01a24907a066f04f,
                ])),
                Felt::new(BigInteger384([
                    0xe1af7fe3cea73c5b,
                    0x0c94c6b2f080dc9e,
                    0x34320eca2abdae0b,
                    0x110ae3b0d97e22cd,
                    0x9b7066f7706391ed,
                    0x00b7fd4c751b1fc0,
                ])),
                Felt::new(BigInteger384([
                    0x385b5bc99226475a,
                    0xedc60a29238a3d10,
                    0x374cc424c76182c6,
                    0x65aae1512f402c81,
                    0x3a5b05759b4c2b29,
                    0x00502d3595dce871,
                ])),
                Felt::new(BigInteger384([
                    0x12bd1e218631d7e9,
                    0xd57eb612595f60c0,
                    0x8732e8fb4ddd88f8,
                    0xdcdaa85f9102a688,
                    0x00dbc796fdb12004,
                    0x015b21a6059b02bf,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let mut input = [
            [Felt::zero(); 12],
            [Felt::one(); 12],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xaa4558148d1ce45d,
                    0x8049b38c701ad7a5,
                    0xfd138458de4c1c17,
                    0xd20e305ac44bdf67,
                    0x4ad6e04e1b874889,
                    0x0196bc218e8650dc,
                ])),
                Felt::new(BigInteger384([
                    0xbe3a08d59a7b1a00,
                    0xee217fcbf577b7e1,
                    0x8d7b0231d0591cf6,
                    0xf0c2a34de9801e58,
                    0x7d0d4ba9dd264704,
                    0x008b92e231d07209,
                ])),
                Felt::new(BigInteger384([
                    0xf34ff83b192992b6,
                    0x0b6e4901ed72048b,
                    0xa5af7ee138682ede,
                    0xb9c55446b1d87f0a,
                    0x741f24288fe213e9,
                    0x003a3c9415260788,
                ])),
                Felt::new(BigInteger384([
                    0x2a239fbcca0415ba,
                    0x5f61c3d2f42aa35c,
                    0x02076935b551c699,
                    0x07ecf041c12f0f51,
                    0x5dfba9e26aacafc9,
                    0x01550880bd000a32,
                ])),
                Felt::new(BigInteger384([
                    0xbb07b679f094b71a,
                    0x8f167e5779a7e27b,
                    0xe698aa58e2417b13,
                    0x8e5b90c427810dd5,
                    0x764b3a096e812258,
                    0x00e2de6fb0e9b87a,
                ])),
                Felt::new(BigInteger384([
                    0x28b0d58f381036ee,
                    0xc66c97d0bfac643f,
                    0x1faa5c4b12f260e6,
                    0x2c7dacf538891bd0,
                    0x6dc453cb0806a7da,
                    0x00231373c496f190,
                ])),
                Felt::new(BigInteger384([
                    0x3a41e61abf33d09e,
                    0x53caf46c3633683c,
                    0xa90959f73d1739e1,
                    0xd4072a6ef5c6c716,
                    0xd4e44d39e65387ee,
                    0x0126e958dd808809,
                ])),
                Felt::new(BigInteger384([
                    0xdcb94b3d5b1164df,
                    0x8bb6bd12d2ffcc47,
                    0x5bb7b996bad6fd33,
                    0x482653d659ddd246,
                    0xbfe0b237461b137b,
                    0x0183f5cd8f3a2f1b,
                ])),
                Felt::new(BigInteger384([
                    0x13e2349a05ad5439,
                    0x22a3d241813c96f8,
                    0x65441bdc0b8ba630,
                    0xea903c2e004b8ce6,
                    0x3f6ed09b0c2f52f6,
                    0x019bb0184c57e3ad,
                ])),
                Felt::new(BigInteger384([
                    0x761294f16750840a,
                    0x77f10a7e1c13d25a,
                    0x0240266f37d108c9,
                    0x4bc08e6de0155dd9,
                    0xc90cce6b3a68ed6f,
                    0x00196e82ba8cf674,
                ])),
                Felt::new(BigInteger384([
                    0x251f0595030aef07,
                    0xcaf6a966ad6b44e3,
                    0xc9c0b21245587f65,
                    0x9d8163b6ef0658eb,
                    0x4337402bb4603cef,
                    0x00cb36a1f3140398,
                ])),
                Felt::new(BigInteger384([
                    0xd6fd89b91c6b92c7,
                    0x80233ecbf3aaef65,
                    0x559d73ecf55c566d,
                    0x7c6f82a65d34733e,
                    0xc95c1c5bb486f1b8,
                    0x01838f0eb1386b79,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xedc417a71b703d80,
                    0x66e5d59f58146905,
                    0x668b2c87200a4fbd,
                    0x052d57a6b27ed9a1,
                    0x01c3a5725a2bc32f,
                    0x000c0b4bf75e136c,
                ])),
                Felt::new(BigInteger384([
                    0xdb445b2ad9981a33,
                    0x072529da7166d823,
                    0xcd31d9744633ab2f,
                    0xd93ae650a03fe628,
                    0xcce3b7a39d287e66,
                    0x0034e51ffd541b6d,
                ])),
                Felt::new(BigInteger384([
                    0x89eb8d822f113d30,
                    0x66b2ddb9e01a0cad,
                    0x64bb2cadfffb274d,
                    0x417a3d05504faa2c,
                    0xe2ed4c7362d43167,
                    0x00d2a2d2eee3c2df,
                ])),
                Felt::new(BigInteger384([
                    0x2a226dd54464ac9c,
                    0xa4522d419d0ea4c4,
                    0x6da8100093f839d4,
                    0xe842d451e7dfe79a,
                    0xa6958c7f91550dad,
                    0x00bcf72e4ea96888,
                ])),
                Felt::new(BigInteger384([
                    0x678269231b869856,
                    0x081ff2e5d0e0ec62,
                    0x69d382d334a51849,
                    0x0dbe028810855b41,
                    0x9c1eb9d5a3be7e24,
                    0x01715537fbe822ac,
                ])),
                Felt::new(BigInteger384([
                    0xf8bc0616be0bca42,
                    0x64fb2d6e70a7a39f,
                    0x939fb32ac1f02b76,
                    0xd5d42dbaaca8397a,
                    0xd5b72651e051f545,
                    0x005c1a7fd016ca80,
                ])),
                Felt::new(BigInteger384([
                    0xd912ad5dd7218435,
                    0x890f502fc569a78f,
                    0x1e29b9e3cd671f1d,
                    0xdc5d3ea9b9f929da,
                    0xe6186cc8c0c57cc7,
                    0x00223217ccb3e22e,
                ])),
                Felt::new(BigInteger384([
                    0x087619436724ad91,
                    0x95a106411f5a9bb6,
                    0xa3d9f2c3ee8dcb6e,
                    0x73a622deef7678e8,
                    0xd72f5f124b7f2ec0,
                    0x0144e84caec9cc72,
                ])),
                Felt::new(BigInteger384([
                    0x29961ffc3f81bfb8,
                    0xa544540c0d9dd15b,
                    0xbe871ef569aa91d2,
                    0x875efbb8923ec2ed,
                    0xe04502a3747b4c76,
                    0x00351d29458e3752,
                ])),
                Felt::new(BigInteger384([
                    0x18f667e210157eda,
                    0xd06ad60665654d75,
                    0xb3704eca308b0116,
                    0x07e8850555e9cf92,
                    0xf6b2456b7b331de8,
                    0x014697bbb0f42893,
                ])),
                Felt::new(BigInteger384([
                    0x1395330e8669c084,
                    0x34a0ff5241f4648a,
                    0xa6a2aa1c86c01c93,
                    0x86e2203efb4d8203,
                    0x2491bb9b9102abf4,
                    0x005bcf88ae15ec72,
                ])),
                Felt::new(BigInteger384([
                    0x5ade8af870d4c7c4,
                    0x9f3e0f52c3666d02,
                    0x9944fe8fd21be65e,
                    0x4e56454e4dc08643,
                    0x5d60e4fdd47d7138,
                    0x0191d48d1320aeb8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x20568a8839295ea8,
                    0x7793589dcda4ea1b,
                    0x530e799c5ff606d1,
                    0x5b2fb3d4d92648a3,
                    0xc8333085c98aca40,
                    0x006e4281852ccb2e,
                ])),
                Felt::new(BigInteger384([
                    0x04a9a7dd7508c76c,
                    0xf8c8c741eac43c3c,
                    0x9ae4fb41c5212974,
                    0xfc6e70483d781833,
                    0x9b466b3753796e83,
                    0x015c03ea002974f9,
                ])),
                Felt::new(BigInteger384([
                    0x9d0ec4311ad54a78,
                    0x1b255461bd9b22a7,
                    0x1f68c6333d516933,
                    0x1731a6c41f2254a8,
                    0xf4255a4ec721af2a,
                    0x0020580eedb3470d,
                ])),
                Felt::new(BigInteger384([
                    0xa8d236e659c17c61,
                    0x8dca2f56267554ef,
                    0x80213a4e687cab89,
                    0x18c83af9e9c8baa8,
                    0x8d1fd59e47ce5061,
                    0x00b58eb1d10ed024,
                ])),
                Felt::new(BigInteger384([
                    0x18f9b76d91be6399,
                    0xc12eaac6ae022515,
                    0xc19cea86a895a23a,
                    0xf07e2a61a8b17036,
                    0xce7a4eff03820678,
                    0x0059dff9d8054bd9,
                ])),
                Felt::new(BigInteger384([
                    0x00a35de6745ab0e4,
                    0x4e4bd105e12ca616,
                    0x0a6fd6d37f1dc309,
                    0x50c48fdc9e266b93,
                    0x1bd4c6667c65966e,
                    0x0163e1287a7513e8,
                ])),
                Felt::new(BigInteger384([
                    0x56b0645b4dc0b849,
                    0x217ea02931d29d8a,
                    0x85b692411fa192f5,
                    0x0291d2c5a83fec51,
                    0x20ffc02e77b5d61b,
                    0x00a2db516eaa2441,
                ])),
                Felt::new(BigInteger384([
                    0x9a1f31f96921a7a6,
                    0x3945b34fb3288be1,
                    0xd6c3a9e68e7c60a3,
                    0x7ee7ccfeca1f80c8,
                    0xba812d1b220fec7d,
                    0x0025b11c2c06f555,
                ])),
                Felt::new(BigInteger384([
                    0x30065fbb21ef21a9,
                    0xb7ff212501dab2e1,
                    0xc141b0e8d2c54a54,
                    0x395dc20eb933d399,
                    0x1cb5ceb51fefe3e4,
                    0x015e1568858335e8,
                ])),
                Felt::new(BigInteger384([
                    0xf8c29bc0578e18a0,
                    0x2c72222f7b67e3a0,
                    0xc83ce32c4344c805,
                    0x04e1b882f63cd3f4,
                    0xf94beed4565b2dc7,
                    0x00523dbfd27e8d21,
                ])),
                Felt::new(BigInteger384([
                    0x91dff30788a4ded6,
                    0xa1d6dbce6bbe1fd1,
                    0x93606b82beff5380,
                    0x0a419eccda54c07e,
                    0x36ec77cd8dd4c4a2,
                    0x005bddff647a0a8f,
                ])),
                Felt::new(BigInteger384([
                    0x3e866c19976fd5b2,
                    0xada632a6fd6c852f,
                    0xec783a3782865657,
                    0xd1afd6dd9dab2008,
                    0xe6ff410fa70e2c22,
                    0x01a6254d12e6a210,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xea459b70197f3619,
                    0xb567d4687659d958,
                    0xf237b5b92cfda0a4,
                    0xfb1ac49ada75bda3,
                    0xdbfe9f9bf4c3be47,
                    0x01131f6d5b429342,
                ])),
                Felt::new(BigInteger384([
                    0x64eb8c7a1ab39125,
                    0x1e8da4728c43933b,
                    0x90686fd8bb0cc541,
                    0x022eee95646bf72a,
                    0x83e64df963c51601,
                    0x012e258ff3158b58,
                ])),
                Felt::new(BigInteger384([
                    0x42c5f24cd93f0f4e,
                    0x089502282988083f,
                    0x80697aeeeeb6a0ce,
                    0x679b76c19bd8bafa,
                    0x5e0d02e0a34f2c92,
                    0x014d49f747064de7,
                ])),
                Felt::new(BigInteger384([
                    0x60bbb037888c22bc,
                    0x0e1a46c6b08a6bc2,
                    0x8a15e3804b9d3dbc,
                    0xb8adcb46b7b5eb2b,
                    0xe201ec18ab75eb30,
                    0x000543d27e257a5a,
                ])),
                Felt::new(BigInteger384([
                    0xc8ed363a81345f2b,
                    0x83fdbb3f86f93506,
                    0xc4c9ec9a0a0b507b,
                    0xf228036f93dc52f9,
                    0x973de86a85a53ff3,
                    0x015b3a3485697c50,
                ])),
                Felt::new(BigInteger384([
                    0x909828f02505edfe,
                    0x7dcf9db9db7aab5c,
                    0x6d0fdc2764868624,
                    0xdb3312372285ca26,
                    0xafbd0c2541f6462f,
                    0x008e0a389aa246bd,
                ])),
                Felt::new(BigInteger384([
                    0x36d8f2932d6f0779,
                    0x665a056be092b709,
                    0x0c86e19cca75307f,
                    0xb8d81e0e81c70e9d,
                    0x9dc951bdb9fab178,
                    0x004655c4dcaa1f0e,
                ])),
                Felt::new(BigInteger384([
                    0x6e385525bb099046,
                    0xc4fe8b9f4818c007,
                    0xa539afca250d0594,
                    0xaa8b6bc748c35deb,
                    0xb54627427feabb94,
                    0x00abe5d10e41f7cf,
                ])),
                Felt::new(BigInteger384([
                    0x10881c7ac2c5b919,
                    0x955e6f9249091339,
                    0x415ea2d0286851a4,
                    0xd5a70d188dab9a1d,
                    0xa5e5e53c427bcbfc,
                    0x01787b4d2a3f6819,
                ])),
                Felt::new(BigInteger384([
                    0xaa7e5e028bb06a8c,
                    0x4ae5f4087f90c4a3,
                    0x3e2b9cf78c709b05,
                    0x8cc84005cb39acf6,
                    0x3d8f3941b5f1c7f1,
                    0x002424c4b762502e,
                ])),
                Felt::new(BigInteger384([
                    0x4997422110c9bfa2,
                    0x9cda02f0e3dd2995,
                    0x53a9a1a0b2ee88fc,
                    0xf853ad239ffaf7ac,
                    0xb956cfe036237b79,
                    0x01098e56ff56e05a,
                ])),
                Felt::new(BigInteger384([
                    0xc36cc60993ce7381,
                    0x9abe854afd5ac3a4,
                    0x26c203e5859fed9c,
                    0x573e4f91d9db8961,
                    0xd83d3cd54b915798,
                    0x0187640779c2b91b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x95b7b14d1e1d26ed,
                    0x82f24a3e735918ea,
                    0xb28a7956aa309ec6,
                    0x245e9d0af3e7aad3,
                    0x7bcd9305dd40f5c6,
                    0x005547a4fcebb1c8,
                ])),
                Felt::new(BigInteger384([
                    0x0fdd308a1c571360,
                    0xc881caf5894ced4d,
                    0x065074338050ae1e,
                    0x0746bed7b0a9fd57,
                    0x540e9f78cddb0363,
                    0x0172b64f8d18ca37,
                ])),
                Felt::new(BigInteger384([
                    0xb7bec2053115330e,
                    0xdfa60e6945173961,
                    0x01a4f308c2a7f0f3,
                    0x2267604b57456735,
                    0x3c7099b63b735c09,
                    0x00607824380b56bd,
                ])),
                Felt::new(BigInteger384([
                    0xda20c8bc4ce7cec0,
                    0x5cc34a38e3fd0b4a,
                    0xd15ec89a049f1571,
                    0x816d95ba4f0e2a5d,
                    0x3c40b2a46df1ff76,
                    0x01832f324bcaf190,
                ])),
                Felt::new(BigInteger384([
                    0x19b5f78f186eb9c6,
                    0x6fe718be7424aeab,
                    0xb770287227db64c8,
                    0x4a19e98884e9a947,
                    0x739abddfe2734515,
                    0x00bbbaf9f1f3872f,
                ])),
                Felt::new(BigInteger384([
                    0xe0acc50f5300be2f,
                    0xf4d7f0494346b530,
                    0x8eb0df4d3bcf6546,
                    0x842e40b948f8e80e,
                    0xf42d56c9fec3f59b,
                    0x00e46476f4ab602b,
                ])),
                Felt::new(BigInteger384([
                    0x400e5571276b946a,
                    0x91152624ea6748e6,
                    0xaa831457041b7bdb,
                    0xc04db287480bda13,
                    0xd97f382cd147df92,
                    0x00930c5d15f6eb9e,
                ])),
                Felt::new(BigInteger384([
                    0x02b15d08c03176ee,
                    0xebd8d19a4a8ff1e1,
                    0xeb01979541548c84,
                    0x44cf3151a615ba84,
                    0x3377c0041d0a5fe4,
                    0x0170fa3bbf4bb245,
                ])),
                Felt::new(BigInteger384([
                    0x9eaa401538592793,
                    0xcd94046cdd1dab1a,
                    0x9eb064e4399a21d8,
                    0xd2f1d963facd0faa,
                    0xe36e6a8bc976c5c2,
                    0x00e3e2188575a9d7,
                ])),
                Felt::new(BigInteger384([
                    0x64e4c6038d46d0d6,
                    0x10f74a8ff29558fe,
                    0xd1f2ddf4c4c8c482,
                    0x20bc58a28cb1d774,
                    0xcd462bbf44598dfb,
                    0x0063e0ca4dbc6a4a,
                ])),
                Felt::new(BigInteger384([
                    0x0eda3a94b2217e8b,
                    0xc3e7c1f9c4106796,
                    0x78e6a5ddd233d82c,
                    0xb55d97b6d64517e5,
                    0x17a2407d49d9a454,
                    0x002b59641d0ffe3f,
                ])),
                Felt::new(BigInteger384([
                    0x60434ab73f61bf3d,
                    0x9cdee8b0a7c2eae2,
                    0x4705641d6ab17929,
                    0x717a3332e89612e8,
                    0xb020c49be106c80b,
                    0x0141bdc5cdc88381,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xa546eb5054ca9f10,
                    0xc30d7923736b2a01,
                    0x23db1b3739d9cae7,
                    0x7eff009ab2e596fd,
                    0x491fabc0e08f8173,
                    0x0071da6a0a6080da,
                ])),
                Felt::new(BigInteger384([
                    0xad242497832054bc,
                    0x553c51ffad8a78a2,
                    0x7acf33742a22cd37,
                    0x380bdfd52d3be583,
                    0x87dd74d7692d3aff,
                    0x00cf6c78cb9970e6,
                ])),
                Felt::new(BigInteger384([
                    0x59067d099c078ff9,
                    0x94cb88f61fc6715b,
                    0xeefe85150276f8bb,
                    0x466c50324c0d46fc,
                    0x326bdbf20419181f,
                    0x004f1bafdc1ee1d6,
                ])),
                Felt::new(BigInteger384([
                    0xe431853ce68443cb,
                    0xea33f9a3d7c12623,
                    0xe0b9564b0baf8855,
                    0x73d46cd2cef3589c,
                    0x0899680aeee18ca5,
                    0x016293a5d1348c46,
                ])),
                Felt::new(BigInteger384([
                    0x8af66d79de639380,
                    0xc2865f7db0fe02d1,
                    0x2db180ef8922d53f,
                    0x4008b28cb992b36e,
                    0xd923d3f4b0b48def,
                    0x00cfd6760a9822b0,
                ])),
                Felt::new(BigInteger384([
                    0x148d3cd99611ae59,
                    0xec31d00fad86b665,
                    0x1ff8c118110820c1,
                    0x0501ab3f567aca05,
                    0x9deb4a36343031ef,
                    0x006c56b1ca5442b8,
                ])),
                Felt::new(BigInteger384([
                    0xea25e179a6427aea,
                    0x1530cf7f9ccf44a3,
                    0x6b179db1f185575e,
                    0xb72ed115d2ed5ae8,
                    0x4e36b7b09484877d,
                    0x0182addbf75675c9,
                ])),
                Felt::new(BigInteger384([
                    0x5fc854e3708f652d,
                    0x807e8af98d4f77e3,
                    0xe5505450eed22f99,
                    0xf38218e32394922d,
                    0xa23549128176ae3e,
                    0x001d0d71fe4c3e7a,
                ])),
                Felt::new(BigInteger384([
                    0xa0dcd08a11c9fc1f,
                    0x6b3bd066d7df8449,
                    0x7e35cff5c96d3dcb,
                    0xb3b1624a259d5c0a,
                    0x12ed16135d359594,
                    0x01432ff87e9a4f7c,
                ])),
                Felt::new(BigInteger384([
                    0x170e3dacb99ce83b,
                    0x7a642950b1ff58e9,
                    0x02ed81b4246ab568,
                    0x1ece4adb9bd2261a,
                    0x51313573b97d4688,
                    0x011a2fb171a47449,
                ])),
                Felt::new(BigInteger384([
                    0xe9cce2a91da38016,
                    0x5a833ee4fe6866c5,
                    0x78d08a35958f22e1,
                    0x0f608e9acd14b864,
                    0x611bd2ab5889dac2,
                    0x00e084c9ce2e523b,
                ])),
                Felt::new(BigInteger384([
                    0xf907aa2271c18e9d,
                    0xdc99bc3b9f2399a1,
                    0x6bc0d6617dcd86fc,
                    0xf9c00caca82faa6a,
                    0x10aa0d0fc01ef259,
                    0x0133e2003cfb554d,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 12],
            [
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::new(BigInteger384([
                    0x19e37ffffffff41a,
                    0xcec846acdffff9d1,
                    0xbc1dbc2075914eed,
                    0x0552bea29bf94715,
                    0x5db9907378f2aac7,
                    0x00f6a2012d38b68d,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xe30c1a4b9e6dea76,
                    0xdee997668ce4f07d,
                    0xea0c7635f3d994d7,
                    0x2b9c7d72da1a1b48,
                    0x12a530a9b34b24aa,
                    0x01a25bbd5d7fcfa4,
                ])),
                Felt::new(BigInteger384([
                    0x2dc7b6763b023715,
                    0x386b3814f5083389,
                    0x0bf7159747db00fd,
                    0xa70730e426d6f308,
                    0x45a1fb268971c89f,
                    0x000babc06a3e5cf8,
                ])),
                Felt::new(BigInteger384([
                    0x0cb63f0af59fbb3e,
                    0x7899203e8e9a65da,
                    0x05df87878f879c8b,
                    0xf258c6b8118d8a31,
                    0x587cbf114d0b4bdf,
                    0x00db3fb114d3a9b1,
                ])),
                Felt::new(BigInteger384([
                    0xd017f4c5329df54f,
                    0x8cd27ff87945c3d8,
                    0x08c98ec5978886c5,
                    0xbb737dd9575af748,
                    0x074f8b871801c5cc,
                    0x014fc3cac75acbc6,
                ])),
                Felt::new(BigInteger384([
                    0x667ecf3173d062ff,
                    0x1de68f4edbbd9812,
                    0x4681b840e713660a,
                    0xbf1a1f6f49b054c4,
                    0x72fcd3fb4ee065db,
                    0x004b8cfcd2611e72,
                ])),
                Felt::new(BigInteger384([
                    0x6275ce9c8ed56b58,
                    0xa6dd708eb4baf568,
                    0xb7177b3291b8cace,
                    0x4a7584ab2b0b41fc,
                    0xa3da2199d543bf06,
                    0x011fcf373db3a444,
                ])),
                Felt::new(BigInteger384([
                    0x3b656a3dac2cc2dd,
                    0xa4f1e9bc25b00c3c,
                    0x1da1d639042166c1,
                    0xb8b41e9f3fb4dc71,
                    0x08b506e3a80e9bec,
                    0x00e9540b61698323,
                ])),
                Felt::new(BigInteger384([
                    0x5e6ec324c63860b6,
                    0xa2a5eef6d53dc868,
                    0xdd69e4f64ed3a77b,
                    0x67b4e040fcf381bf,
                    0xc8112fdf6946d969,
                    0x01782074071b68d2,
                ])),
                Felt::new(BigInteger384([
                    0x7f9183eba5d45f7f,
                    0x2c300c9da3b80d8f,
                    0xabf7c0439c7fca1e,
                    0xf4a090e7719d5cae,
                    0x94359b41833adec3,
                    0x006140e8512d8f8f,
                ])),
                Felt::new(BigInteger384([
                    0x0938f33e519d4471,
                    0xdda6b4cc7e557f0e,
                    0x1dc5f1eaad878bed,
                    0xd8520118cb837368,
                    0x3375b197b820d50a,
                    0x004ba532397f31bc,
                ])),
                Felt::new(BigInteger384([
                    0x6caaee291a5d1137,
                    0x1da1de6734b6d16b,
                    0x182e1ea549e930fb,
                    0xdf765a4e51cbf85f,
                    0xd7a00c815148eb34,
                    0x006b0987bf883b4e,
                ])),
                Felt::new(BigInteger384([
                    0xb20f792b824b5e11,
                    0x0a4dbad2d65237a2,
                    0xbc99988b5c4a7058,
                    0xcf62379b9fba3ccf,
                    0x34bd50eae41bb647,
                    0x00c659b3057007d3,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc10304e591b678e5,
                    0x019432a016566dea,
                    0xa7d37baa78a0965a,
                    0xba7a95bf3a10e166,
                    0xeed1cd8274bef901,
                    0x019a2c8409ebfea9,
                ])),
                Felt::new(BigInteger384([
                    0xd1b103159ece22d3,
                    0x5355103b8ff12ce7,
                    0xb1e07f530262e8de,
                    0xb9d9814772c877fc,
                    0xa5d40eb135ce777c,
                    0x01032d0015dca625,
                ])),
                Felt::new(BigInteger384([
                    0xfcc8286060faac83,
                    0x7174ee4d2339230a,
                    0x937e9e41dcde81a3,
                    0x58ddaa405590ccc5,
                    0xabbd0c0ab353e6c5,
                    0x00667785bf966e8a,
                ])),
                Felt::new(BigInteger384([
                    0x1d98a0bc622f8bd2,
                    0x8fad303aa7d6a4e0,
                    0xf022bedb4b4def31,
                    0xd0886a98c6ad6fdb,
                    0x3dc393388255aaa5,
                    0x0103f048ad6ffe36,
                ])),
                Felt::new(BigInteger384([
                    0x26cff96517f5c176,
                    0x0f887d2dfe3b479d,
                    0x35c013af8b044f32,
                    0x7428dfcd50b90565,
                    0x5b7155c8d1914847,
                    0x013ac1ab9b36713b,
                ])),
                Felt::new(BigInteger384([
                    0x326741441da83c22,
                    0x131043c9e3e789e6,
                    0x7d5c0c0f49e644d3,
                    0x5d23b7a7630767cc,
                    0xbb6c0a3878bc9f70,
                    0x018a273815d27e2b,
                ])),
                Felt::new(BigInteger384([
                    0xfabe442d2f7eebf0,
                    0x01d5c0002673f5fe,
                    0xb4018702657c855c,
                    0xf4ec579a48a49d03,
                    0x6d35f24c4f071475,
                    0x004351a515794dbc,
                ])),
                Felt::new(BigInteger384([
                    0x2690c75544ab4593,
                    0xd92b771ffda9ec86,
                    0x035de281ccdf1247,
                    0x5ba17dc0462514b9,
                    0x85782fae3f35df38,
                    0x00509b3977d26c8e,
                ])),
                Felt::new(BigInteger384([
                    0x9cff2f8bc645899b,
                    0x1a67717c75ab89f2,
                    0x515a423bb5b57154,
                    0x88a434ec357ddd6e,
                    0x0f7b20505c197b55,
                    0x0106139118596cc4,
                ])),
                Felt::new(BigInteger384([
                    0xd3ea7a67b73f82d6,
                    0x13017935c7771e95,
                    0x0083a142248be5aa,
                    0x21fd0c360aea6585,
                    0xc26cdd2f2dbced33,
                    0x00f8ef4d8e0be357,
                ])),
                Felt::new(BigInteger384([
                    0xbdb53dd2f25150de,
                    0x13c30262240c0ba2,
                    0x0e7f81b55cc41ff7,
                    0x22e26673a8d1a409,
                    0xc5290c46b2b2ff86,
                    0x016d35ddcd8aa1c5,
                ])),
                Felt::new(BigInteger384([
                    0x12ee8739822edd78,
                    0x2c505e90a15f71e7,
                    0x6ea3b8c1052bc976,
                    0x78d6265a694715e7,
                    0x61afb7ebe8342f55,
                    0x0188930bfb78044b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf7e4231cf8900e4d,
                    0xdc4a2c40b8267ff5,
                    0x5bc73cc9f4529762,
                    0xc64f67cd13dd637c,
                    0xf1f104812883e4e0,
                    0x01a85e02eb5bc13f,
                ])),
                Felt::new(BigInteger384([
                    0x9d08032980d9c1c7,
                    0x5e9b936f8b84ad13,
                    0x701014c8c94dd646,
                    0x05cfa834e2b78eea,
                    0x7b37577cc2408c86,
                    0x011baa98864bfb27,
                ])),
                Felt::new(BigInteger384([
                    0x1eaebcd3d7403afa,
                    0x69ce8a1a179b7b19,
                    0x1944891ed63e5266,
                    0xf1af41b120964710,
                    0x2a5f72e8b14e1ab9,
                    0x00f42896ddcc56f8,
                ])),
                Felt::new(BigInteger384([
                    0xe27312a21761112a,
                    0xde9aa418360911c8,
                    0x789a0bbf8787b8a0,
                    0x108e2eaeb804689f,
                    0x5f4d41d1cdcb3cde,
                    0x01106de60200f04f,
                ])),
                Felt::new(BigInteger384([
                    0xf04132be266bacbc,
                    0x927fd7bdedf6254c,
                    0xf5f7a8beeb5c3ac4,
                    0x964144e8d7d794d3,
                    0x57def0d0c4830333,
                    0x019810d9c71c62ea,
                ])),
                Felt::new(BigInteger384([
                    0xe1ea0fdca3315324,
                    0xc78a3169e9e256ac,
                    0xdd7c4e640b6d1a15,
                    0x65f05f212a9f0d1a,
                    0xb3507f9be08e2100,
                    0x004b010d35f1bba1,
                ])),
                Felt::new(BigInteger384([
                    0x8f60e7b77c020cae,
                    0x5bc721114441b411,
                    0xe84fcf4de722ea7e,
                    0x2c91ad34cc964c48,
                    0xefb43a24bc42ba7b,
                    0x00d9c9b4db7e687a,
                ])),
                Felt::new(BigInteger384([
                    0x837266996cb8b4dd,
                    0xde5a692a923f65ad,
                    0xc1ffe6da3bf290d6,
                    0xf317a89eb4648290,
                    0xef2cd078e685c8f6,
                    0x01a959b05c2369d7,
                ])),
                Felt::new(BigInteger384([
                    0x91621cc3b6c869da,
                    0xe51bb95a51a0f5d3,
                    0xbbbae7727d0e3b8c,
                    0x5bd730d38ad45bc3,
                    0xfbafaacce3d3e8bb,
                    0x004ea82f39d873d9,
                ])),
                Felt::new(BigInteger384([
                    0x5e66994264ddb801,
                    0x9a68a22868f9814e,
                    0x0b191c5f7592110a,
                    0x647149acf5fa3973,
                    0x66a72815d1adaa8d,
                    0x01819f50579ed4a3,
                ])),
                Felt::new(BigInteger384([
                    0xc77d623c91f5bfae,
                    0x62e6b639ef9fc2ed,
                    0x804bd36f4cc519a6,
                    0xd56e76916f91faf1,
                    0x66c314180f0ed758,
                    0x00313a65eca4088d,
                ])),
                Felt::new(BigInteger384([
                    0x821bec46b2bf83ba,
                    0x893015ee036c8ec1,
                    0xf7647c90b946ca3b,
                    0x592467b06305f6d1,
                    0xd51db897c432290d,
                    0x010db2b4ef4c47dc,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3d5604744649efda,
                    0xdd89ada1591d41a4,
                    0x7bf678a0e5af6e83,
                    0x0994197d9b163e2b,
                    0x1ca445ca46a25892,
                    0x013a861080f06f81,
                ])),
                Felt::new(BigInteger384([
                    0x0bdc59a8e4816fd5,
                    0x3073d25712d023bc,
                    0x5b5700ef74fdf3c3,
                    0x81b7482038a4608f,
                    0xbd4b77abe823fc45,
                    0x0062ccbf053a65ac,
                ])),
                Felt::new(BigInteger384([
                    0x7a2afd0199317cd3,
                    0xdec2f060663f72a3,
                    0xd63088802f6a934b,
                    0x38ada6492d876fb9,
                    0xa3928b6d5b110642,
                    0x019462c93547c275,
                ])),
                Felt::new(BigInteger384([
                    0xd15c3b327bcb55c6,
                    0x98e010d119dd19e0,
                    0xc008b20dbe4ae250,
                    0x67c751d7aeadde26,
                    0x757ac98079320182,
                    0x00e2d6b88cd4d915,
                ])),
                Felt::new(BigInteger384([
                    0x90f98030cf0a50ed,
                    0x4c5bd40839766921,
                    0xf226f14ec6aadc00,
                    0x364989b22854ac97,
                    0x14c96e7c989ee7ec,
                    0x015d3541803c759e,
                ])),
                Felt::new(BigInteger384([
                    0x9691a976a592fd61,
                    0x122d2b8b294ab853,
                    0x0cda92373574f955,
                    0xa41e2d269cd20bc2,
                    0x009670e5bf84eae5,
                    0x0021f1877cfb473b,
                ])),
                Felt::new(BigInteger384([
                    0x117f61cf57a9f5dd,
                    0x4ae556a7257ee3eb,
                    0xe626997e8f0c8b46,
                    0x25e88624fb5e3428,
                    0xed0bde9dc0d51908,
                    0x00e1f31412e09180,
                ])),
                Felt::new(BigInteger384([
                    0x9fbf54c91571b787,
                    0xf01f9b0acd0e7685,
                    0x1cfd475f2c68ca0a,
                    0x58a70639d51e202c,
                    0xcceed1f398d7ae81,
                    0x011dde7c95a20fad,
                ])),
                Felt::new(BigInteger384([
                    0xeca9d12a4573ca7e,
                    0xad15f225ec7b48c1,
                    0xa619d882a7609c97,
                    0xa55b601fb332165d,
                    0xdffbeb0a1a425c61,
                    0x008f1626d5f865a8,
                ])),
                Felt::new(BigInteger384([
                    0x93c8f6f02d0aa763,
                    0x7281c2e98de50e62,
                    0xf92ad3e5708518c0,
                    0xcc25f803a2449871,
                    0xbd0942acda5b378f,
                    0x00d4fddea9823820,
                ])),
                Felt::new(BigInteger384([
                    0xe7c3cccc1c9da2af,
                    0xf9c17a47ff5ed855,
                    0x3eb5e70dc6542a71,
                    0x0cfa8ac01bff9907,
                    0xc1326311901da542,
                    0x018159dee5379ac6,
                ])),
                Felt::new(BigInteger384([
                    0x48bb04122a52e05e,
                    0xb33c7f28257c290b,
                    0x85fe92fd827675b0,
                    0xc2efb8efd00312a8,
                    0xa05b451795a9f8f8,
                    0x001da52701397d4f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc7973eff6d812465,
                    0x6394e219543f87ff,
                    0xbb1919396ebdfd19,
                    0x1ecc64322b6d8267,
                    0xb2f84eca3bc949df,
                    0x012cde18e9658241,
                ])),
                Felt::new(BigInteger384([
                    0xf5356c1be9913a36,
                    0x888d42829f6622aa,
                    0x3bf723af8e209d91,
                    0x5a43cec9246d61fb,
                    0xc74d38ed349f6dbf,
                    0x00a13fac4f4485b0,
                ])),
                Felt::new(BigInteger384([
                    0x7b229f6a53e85eb3,
                    0xbad2f4522b2831cf,
                    0xa12cf4373e912872,
                    0x6f00bc4b36e3b039,
                    0x4944439032e9060f,
                    0x0134cf797ddaeb96,
                ])),
                Felt::new(BigInteger384([
                    0xdd37937f8afff1f2,
                    0x100262aa8c6637f9,
                    0x11ecf7d70fdaa979,
                    0xf1210809f4d5e509,
                    0x927344d75a04a288,
                    0x00a18a154b41c3a8,
                ])),
                Felt::new(BigInteger384([
                    0xf71cd131f9fc11f7,
                    0x9cf2170ed80cc673,
                    0x12fe7f4c4e1b7c48,
                    0xed960326f069b243,
                    0x3e993cc3c264ccf9,
                    0x00e3c27deb47c68f,
                ])),
                Felt::new(BigInteger384([
                    0xaa7e89179d974fcd,
                    0xc1a5dab283b0cbfc,
                    0x69c62703796b8221,
                    0x6c3ea3de4a2d1c18,
                    0xbc43e043fce2dbf5,
                    0x008d7c6f9a42f466,
                ])),
                Felt::new(BigInteger384([
                    0x44d34fb6925341d4,
                    0xba7043cd54e9921c,
                    0x4db78aee6fea618b,
                    0x378ad30ad3998eaa,
                    0x3508a9d7c2bb3cbc,
                    0x0077111e6cc223e5,
                ])),
                Felt::new(BigInteger384([
                    0xcf433a1e1fce209a,
                    0x13cb3b592e53fe24,
                    0x9883e23d77ec39ee,
                    0x32b2e706efd15859,
                    0x6e1ac9a6f5d121d2,
                    0x01879aa15d6a3b74,
                ])),
                Felt::new(BigInteger384([
                    0xa2d6482dae4a1ecd,
                    0x5f078fd1eb0d60d3,
                    0xc4ab1cbd895c6946,
                    0x55f7058e519bbbd3,
                    0x2cab9ada15756539,
                    0x00b053af03c65ddd,
                ])),
                Felt::new(BigInteger384([
                    0x036f1e41d1f28198,
                    0x5db2f19ca65d6226,
                    0x5a105dd980edb344,
                    0x72e750fe58e44e26,
                    0x6ad99522caa12846,
                    0x0094c7f1c1b54469,
                ])),
                Felt::new(BigInteger384([
                    0xd166b52577f16226,
                    0x72c20924eb9de04e,
                    0x43cd5c71c815118d,
                    0x78e8330fcc7b96f4,
                    0xd6501c6d47b97d9c,
                    0x00eb2599c423bfd4,
                ])),
                Felt::new(BigInteger384([
                    0x15e26ffabcb5b986,
                    0xf1ec8328d9892749,
                    0xc867d6f3d0434fcb,
                    0x637e2cbaac856ddf,
                    0x517296e7ae7b64bf,
                    0x01308f72426fc986,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf81e2c73226eaa71,
                    0x1cec2045e56be3b7,
                    0x9b3c30d6ddb45273,
                    0xe6c034f59f2c54b7,
                    0x4a0507a3592bded3,
                    0x00e04ed1e3f27ecd,
                ])),
                Felt::new(BigInteger384([
                    0x81c75b61375b202c,
                    0x40b7a01de0b0f3af,
                    0x6116789e0e36212b,
                    0x3626a6eaa781f72e,
                    0x995e2a0e4ca2328e,
                    0x018ad4fcd13b5e9f,
                ])),
                Felt::new(BigInteger384([
                    0xd64e723930b45f59,
                    0xa4b79e23c2f31f5c,
                    0x942a700df58051aa,
                    0xa2afce0828d3ad15,
                    0x6f4fd841b74cfeed,
                    0x0124c47b49849450,
                ])),
                Felt::new(BigInteger384([
                    0x9b927bb412166612,
                    0x1a344e08615af779,
                    0x44105a04349211f4,
                    0xe0d2482dfc497633,
                    0x107617045915b684,
                    0x01113eaff865948f,
                ])),
                Felt::new(BigInteger384([
                    0xace3cf3ff295d88f,
                    0xe29d22366c573561,
                    0x7d3a8cfbb8601142,
                    0xce1553522b069f0e,
                    0xa9847d030763619e,
                    0x008a6224805bc624,
                ])),
                Felt::new(BigInteger384([
                    0x2ec9f5229b46536f,
                    0x54e638ca5564df54,
                    0xcf74cc66ba115769,
                    0x1df632021cdc6d1d,
                    0x921590745da344a0,
                    0x0134c1d027a692e1,
                ])),
                Felt::new(BigInteger384([
                    0x859b449e4414c4d5,
                    0x6785a097cd5c3dfa,
                    0x5a86b7e027672047,
                    0x1934aab67f07b95a,
                    0x44c08edb24d0b328,
                    0x016b673fd27ac50d,
                ])),
                Felt::new(BigInteger384([
                    0xf8884370ce0064a6,
                    0xee0a5202818f9e8e,
                    0xdc6e8252b1e67a39,
                    0x2b3bb2eab3f7c501,
                    0x601d0b25d1de146a,
                    0x013be5432b7e2a4e,
                ])),
                Felt::new(BigInteger384([
                    0x813ff0516317e260,
                    0xc7da7241c2da1049,
                    0x86be53205dbc137b,
                    0xd05db08f363a755d,
                    0x3535c09cb01ad97b,
                    0x0148f3f5bdc1f8c8,
                ])),
                Felt::new(BigInteger384([
                    0x17acc984f7097217,
                    0x71b09d7dfc9158c2,
                    0xef426ce96e71cbc9,
                    0x1882c13cd4d695e9,
                    0xa67e9ae95c1e8a1f,
                    0x0181332607c48fdc,
                ])),
                Felt::new(BigInteger384([
                    0xbcae10c502bfb32a,
                    0xa5c0b446a3ce7c41,
                    0x0eb23e969a88a8a6,
                    0x3106220e4b5f65bd,
                    0xe948b447559d3692,
                    0x0064024331743d32,
                ])),
                Felt::new(BigInteger384([
                    0xb38308ca715e4d70,
                    0x9c95b59cec9a48ab,
                    0x45ee87ccf4778e4e,
                    0x2ebf19f3bdab475d,
                    0x6cbb3f7e376c95bc,
                    0x014132a68f9243d3,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
