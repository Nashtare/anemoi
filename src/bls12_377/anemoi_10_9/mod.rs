//! Implementation of the Anemoi permutation

use super::{mul_by_generator, sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 10 field elements or 480 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 10;
/// 9 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 9;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 5;

/// 1 element (48-bytes) is returned as digest.
pub const DIGEST_SIZE: usize = 1;

/// The number of rounds is set to 10 to provide 128-bit security level.
pub const NUM_HASH_ROUNDS: usize = 10;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t -= mul_by_generator(&y2);
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        *t += mul_by_generator(&y2) + sbox::DELTA;
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3], state[4]];
    let y: [Felt; NUM_COLUMNS] = [state[6], state[7], state[8], state[9], state[5]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3] + x[4];
    state[0] = sum_coeffs + x[3] + (x[2] + x[3] + x[4].double()).double();
    state[1] = sum_coeffs + x[4] + (x[3] + x[4] + x[0].double()).double();
    state[2] = sum_coeffs + x[0] + (x[4] + x[0] + x[1].double()).double();
    state[3] = sum_coeffs + x[1] + (x[0] + x[1] + x[2].double()).double();
    state[4] = sum_coeffs + x[2] + (x[1] + x[2] + x[3].double()).double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3] + y[4];
    state[5] = sum_coeffs + y[3] + (y[2] + y[3] + y[4].double()).double();
    state[6] = sum_coeffs + y[4] + (y[3] + y[4] + y[0].double()).double();
    state[7] = sum_coeffs + y[0] + (y[4] + y[0] + y[1].double()).double();
    state[8] = sum_coeffs + y[1] + (y[0] + y[1] + y[2].double()).double();
    state[9] = sum_coeffs + y[2] + (y[1] + y[2] + y[3].double()).double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies an Anemoi permutation to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Applies an Anemoi round to the provided state
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let mut input = [
            [Felt::zero(); 10],
            [Felt::one(); 10],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xc7494a9d2456b5b7,
                    0x6ef32e0e54f9fc76,
                    0x9cbaa2d943b73da6,
                    0xfc6f302c617e1850,
                    0x3fbdb2125e2f32a2,
                    0x0057bdc9bb27f1d8,
                ])),
                Felt::new(BigInteger384([
                    0xc50f16a06d8bfeef,
                    0x9462d5c6388ca4f6,
                    0x233408907ef5637b,
                    0x98d26afa1ffc3e87,
                    0x95d83a691ed3c1c3,
                    0x0075ff37b1919208,
                ])),
                Felt::new(BigInteger384([
                    0x983cfec38b72c686,
                    0xfda76d7775c97c68,
                    0x609dc4bc1e6b88b6,
                    0xcc414335740d0f7a,
                    0x922d9749c4b39073,
                    0x00f7d6998ca0af81,
                ])),
                Felt::new(BigInteger384([
                    0xc2d0aac523ad1564,
                    0x5a9d820b7dd41575,
                    0x287644b0cdb23ded,
                    0x418ca9775222de96,
                    0x9d7f10fc387f2058,
                    0x01aa89ff7ab14c14,
                ])),
                Felt::new(BigInteger384([
                    0xea0b88c8f6d93f54,
                    0xb8f7dc8bc74f50d2,
                    0x41dbc3566fbb1348,
                    0x455f390abc9da05d,
                    0xd5bf96592d96f78c,
                    0x002d534f8dca9324,
                ])),
                Felt::new(BigInteger384([
                    0x58749711ad339cb8,
                    0xfeee0b1834e24553,
                    0xefc6a832f3eda500,
                    0x2929afc33fbd9042,
                    0x5c124d9135ee8b42,
                    0x00e16af3744b96e3,
                ])),
                Felt::new(BigInteger384([
                    0xea840ecfdd097425,
                    0xfdce5ddffe744532,
                    0xa0c6da80876b1782,
                    0xf65d243fcbfb799e,
                    0xcf6e5b11c9894eff,
                    0x010e819d9dc66d15,
                ])),
                Felt::new(BigInteger384([
                    0x8ca61e2ca7197a86,
                    0x50a3bca49ee59df2,
                    0x2c7e17d33dfb152c,
                    0x92bbc64d436501ae,
                    0xf4025247cde6b9c9,
                    0x00ae83bab9007fa2,
                ])),
                Felt::new(BigInteger384([
                    0x3d38e42500ec4233,
                    0xaed21158a176ab08,
                    0x6617e87f1fe9dcc0,
                    0x521351deab356839,
                    0x2e973f25ac908857,
                    0x01559c8ce0ea2d53,
                ])),
                Felt::new(BigInteger384([
                    0xa18dcbf8e3df9c91,
                    0x2e0aaca5ee60311c,
                    0x2d79a2d44c00e3f2,
                    0x05039a9c28c3a2ea,
                    0x4f4326ec671fc2df,
                    0x0167f4648b7cd37e,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xbbc58967a132f1bc,
                    0x893d9f5066acc17a,
                    0x7fab173829bb12fa,
                    0x88fac0ae6d6aca24,
                    0x1b9253682fb4be33,
                    0x00b2a14ccae6e1f7,
                ])),
                Felt::new(BigInteger384([
                    0x7120d64e5eb2b8d2,
                    0xbfa1bb1191817ac9,
                    0x3004c983938ed30b,
                    0x193214b67be98d8b,
                    0x935c61ab2fd4cc96,
                    0x011ce4daf558e58e,
                ])),
                Felt::new(BigInteger384([
                    0x6a65467c5e723b54,
                    0x7a8cd52b08eaccd8,
                    0x664589fb771e155c,
                    0xf0c82ee6a07f1289,
                    0xf2f945ac91177ddd,
                    0x003f29e6da66f95e,
                ])),
                Felt::new(BigInteger384([
                    0x167865169a15e8df,
                    0x438dd40eec888bb2,
                    0x151acde39558045a,
                    0x48a795ec3573d607,
                    0x57877a9a2baf587f,
                    0x0110df9fd5f53059,
                ])),
                Felt::new(BigInteger384([
                    0x5f9d65a28e2a1231,
                    0x9222490a6850d956,
                    0x14d185ac091b5a3f,
                    0xc33edd9fd503484a,
                    0xae6fe21983be47a8,
                    0x0188b7a41c396961,
                ])),
                Felt::new(BigInteger384([
                    0xb40ab2b0d448d617,
                    0x4b4785d199d34017,
                    0x908edc22da1c82fd,
                    0x129ebd2cdfb0ae2b,
                    0x8df14a8563ca2c19,
                    0x00a41ed7c80d01ac,
                ])),
                Felt::new(BigInteger384([
                    0x1e97a28bee2f9fa2,
                    0x7aedb05ef06f9834,
                    0x49543322d6b558ea,
                    0x49415462c82f774f,
                    0x32922e6312a5eafc,
                    0x014371f1fa86a495,
                ])),
                Felt::new(BigInteger384([
                    0x0fa1b75e69e9325e,
                    0x064a38c2cafabd8a,
                    0x7954bccecfd893d6,
                    0x53a74af74b5f954b,
                    0xf374fe65869dd798,
                    0x012b85f9770f0d0f,
                ])),
                Felt::new(BigInteger384([
                    0x1e0eb91b6464ea21,
                    0x270fd0d736fb9973,
                    0x35c854e506975e09,
                    0x78cf3957d740094a,
                    0x1961e0ce08268165,
                    0x008f4489a7ba9be6,
                ])),
                Felt::new(BigInteger384([
                    0x121667f125afa854,
                    0x5a0136dd6be16a69,
                    0xef6d87e8e6d3ec73,
                    0xeb0b3c696507da7b,
                    0x33e7d5b2a4e32d76,
                    0x0055538719d32c71,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdee1bc7c82c55f49,
                    0x2711f31518abdb37,
                    0xd9b92032c57a09d0,
                    0x8ba181d24bbeb663,
                    0x6bbfe3fe58d94233,
                    0x006e49b1516c81a0,
                ])),
                Felt::new(BigInteger384([
                    0x609df3497bae6ed1,
                    0xe296d64759ba8694,
                    0x618eee8a98f3053f,
                    0xd106797ce6e3cc8c,
                    0xc498b4494c8cc7af,
                    0x003649237e4e30c3,
                ])),
                Felt::new(BigInteger384([
                    0xe5e42ad4039174e9,
                    0x1f98dbcc59ed8d5c,
                    0x3dd3db64e40b8222,
                    0x1ae3eb68c3bafac4,
                    0x39219b302958989f,
                    0x008a634d29bd2ada,
                ])),
                Felt::new(BigInteger384([
                    0x0a4da927fb564ef7,
                    0xd418087e254a9cad,
                    0x198740337f589497,
                    0x1824fb05632aa84d,
                    0xe838fb86e4c6281e,
                    0x009c861b3daf2dc9,
                ])),
                Felt::new(BigInteger384([
                    0xe9c4e8c68b0ba5bf,
                    0x6b40dab88a75c92b,
                    0xaca28e6849f479a8,
                    0x027d00c3f3903591,
                    0x67c0d528fef054c3,
                    0x01ac51a9f33f9f0b,
                ])),
                Felt::new(BigInteger384([
                    0x24209c6917eb9a3a,
                    0x179ea40df6439839,
                    0x0bb1ec66c6cea24d,
                    0x6e808889d6438583,
                    0x1d94b940f6fedac0,
                    0x016c9ecdd1ddfc5a,
                ])),
                Felt::new(BigInteger384([
                    0xc70747b8baa12ae3,
                    0xf8a60c572942577b,
                    0x549004c8987391a2,
                    0xa6585d3fa3e7372e,
                    0x96d97d335caf7c85,
                    0x0067d4f25f634b96,
                ])),
                Felt::new(BigInteger384([
                    0x5644876b798c1b80,
                    0x02f64e7e478e9cc1,
                    0xcb8b5e3798e9c630,
                    0x9d249f7e6619f3d2,
                    0xb0ef4e1f0d80129e,
                    0x0000762d784b8bd3,
                ])),
                Felt::new(BigInteger384([
                    0xa46262e30706d963,
                    0x141865654a37c3f4,
                    0x71a9f14b588bc4a4,
                    0x22b1280865202f77,
                    0x2d7219484c3bf161,
                    0x00906d34e5d0c85e,
                ])),
                Felt::new(BigInteger384([
                    0xd1a715cb5ad9f804,
                    0xb18946cb587bf33d,
                    0x04bd9f0f96957b47,
                    0xeaf93d9bab5e0052,
                    0x142d084e54ea967d,
                    0x0062a66036aee581,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x13eca0e8c6c976ca,
                    0xab7a67ac0d7eef51,
                    0xd6758a5d75a471e7,
                    0xcd46c1a1ca1df30e,
                    0x5ebe15dacdf2e99c,
                    0x000d22982016a035,
                ])),
                Felt::new(BigInteger384([
                    0x94724e8ea35b668d,
                    0x96bbd10662228020,
                    0xfdb7b7136ea42e5b,
                    0xd55671f2dfc5cccd,
                    0xd7c0d3bf6ccfcf57,
                    0x01a45e0183039620,
                ])),
                Felt::new(BigInteger384([
                    0x81f3fa5f462e2f9d,
                    0xee761fe95e8cb92a,
                    0xbb8b2c9d91988755,
                    0xd3dd05fbaeb2f3c3,
                    0x160028ef0a477d17,
                    0x01aa78cf7591f7f1,
                ])),
                Felt::new(BigInteger384([
                    0xb3856e2302cf94a5,
                    0xce11f5596ee81866,
                    0xc20db014a820a371,
                    0xe42f63fe69c2ee4c,
                    0xfb03b7e84dc89b98,
                    0x00392b70f85560aa,
                ])),
                Felt::new(BigInteger384([
                    0x4b1f09c7eaea3ad6,
                    0x763db1e88b531808,
                    0x79c9fcb8c02ed0eb,
                    0xbf4984e76a678e19,
                    0x7db6869a58da9982,
                    0x00675132ee10dfbd,
                ])),
                Felt::new(BigInteger384([
                    0x04a5cdce2f332d4c,
                    0x266c5051b36d40ae,
                    0xf02800db13691413,
                    0x8eea0a8903eb0a57,
                    0x3e28a013b27f56fd,
                    0x00193c74dd470d06,
                ])),
                Felt::new(BigInteger384([
                    0xa5b29a21e1b7a9b0,
                    0x7ee372b1a78536f9,
                    0xe222b4800f3aadbe,
                    0x1954f58cf7651896,
                    0xc9cedb33ab7d4f37,
                    0x018f97b39bd6538b,
                ])),
                Felt::new(BigInteger384([
                    0xeb0d762a78b4024b,
                    0xf8707e9cf02df0ce,
                    0xca21fa11ca758323,
                    0x99ed8dcc57c9eeb2,
                    0x1919e16f1005e3a7,
                    0x0156c3ca49607715,
                ])),
                Felt::new(BigInteger384([
                    0xc6411cc058e924bf,
                    0xa434b3d39e8731c3,
                    0x1c2f4be188e17713,
                    0xdf59289c2939cc15,
                    0x720ce35ff288185f,
                    0x00b6a1d160e3c0a1,
                ])),
                Felt::new(BigInteger384([
                    0x8957231d371c16dc,
                    0xdea1690c6dea0d13,
                    0x4b631f5e7baa87ac,
                    0xace146c49e55d058,
                    0x3f4eedbb6ae93b50,
                    0x019c18ae71edf8f9,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf86be7234f830211,
                    0x9e7e29b0e1d56400,
                    0xd767b302a7ad5107,
                    0x34c6c3e9727c3b3b,
                    0xa90e553a6a47ecd6,
                    0x003fba72d967c6ff,
                ])),
                Felt::new(BigInteger384([
                    0x3eab808a3a9b3ebd,
                    0xd40e16e0abf3601d,
                    0xc08d23d8ffac1136,
                    0x9cc8bc89335eac6a,
                    0x082c2d70ffec0ea4,
                    0x010ba71339e80d4e,
                ])),
                Felt::new(BigInteger384([
                    0xfa166de2475c5a51,
                    0x0130892eea0f9d32,
                    0x5d77aec68b5bc445,
                    0x6a2a3f0c3858b96d,
                    0x6da9dce9a8b37e52,
                    0x013e995b3e0cd463,
                ])),
                Felt::new(BigInteger384([
                    0x0f4fe58404914ebf,
                    0x4661d71a96a2ab76,
                    0xdf0a949d3b070aff,
                    0x40601d849d79a351,
                    0x64514fddb2c9c16a,
                    0x01994228ec5cb72e,
                ])),
                Felt::new(BigInteger384([
                    0x715376a6ccdd7869,
                    0x4cae05eecae34a34,
                    0x23fdeaf6578f36e9,
                    0x7852cf21b41d8482,
                    0x2c2120911558910a,
                    0x0132a487c25f32e5,
                ])),
                Felt::new(BigInteger384([
                    0xa1e50542c0b03161,
                    0xaa2789563faf0ba3,
                    0x11190898ec239a12,
                    0xb8002517f1876771,
                    0xe56d4a9d8c637b37,
                    0x018b236470058fe5,
                ])),
                Felt::new(BigInteger384([
                    0x1f5ac0e0e2a42097,
                    0x1b01ba77c9bf0ee7,
                    0x5fa980863777ffe0,
                    0x92461f09a83d2bf3,
                    0xb2d145b293f11632,
                    0x016525bdcb9a1959,
                ])),
                Felt::new(BigInteger384([
                    0x76e69d85ffea024b,
                    0x668b5ad115fc3590,
                    0x49ae71a6d4f780cf,
                    0x2b6bc28481d925a9,
                    0xde2022fb62a6b461,
                    0x0130c32d5b14c4dd,
                ])),
                Felt::new(BigInteger384([
                    0x96305e95bde98f8f,
                    0x87029f6a4b97a952,
                    0x523bff2d5af0505f,
                    0x26014efd2e0551a0,
                    0x9af37830c312db5f,
                    0x0019bc050a85bb3d,
                ])),
                Felt::new(BigInteger384([
                    0x15999844f48b1f50,
                    0xe9b7c301c8de242c,
                    0x5d2e87c39f91df20,
                    0x832c22b536a425d3,
                    0xf53b6fd6bb549f4c,
                    0x000db1b9a76c732a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb2e3e59940b1fc49,
                    0x22055eff2f0b86c1,
                    0xaef1d2c961fe4b03,
                    0x37d3a3a8cbd05960,
                    0x91c5cb9440f1ae56,
                    0x007d0aa661c3fe88,
                ])),
                Felt::new(BigInteger384([
                    0x058db16ed660bf90,
                    0xe0764d00860976f0,
                    0x8f6175300369a680,
                    0x5e110d0fef26b483,
                    0x453afd874b74840e,
                    0x002dba66640759ba,
                ])),
                Felt::new(BigInteger384([
                    0xc92dae3f6a3d1b1d,
                    0x8183d767974e117f,
                    0x2fb89894d89124ee,
                    0x0a180cca8b407c19,
                    0xbe0653fc7de4e450,
                    0x003bebf61cdcbf74,
                ])),
                Felt::new(BigInteger384([
                    0x7f149c3f49800afe,
                    0x71c280382d7209be,
                    0xa9ce6f4391fa2bb1,
                    0xcb8d0d15c1c28e6a,
                    0x3b442f809bc5eb7d,
                    0x01727b5ab6d30267,
                ])),
                Felt::new(BigInteger384([
                    0x6f24132a5be6cdf6,
                    0x824ae9d93ed9dae6,
                    0xd1de90b7ad6d3a29,
                    0x7365216112aec655,
                    0x26df113801b700b7,
                    0x018ad1dbfb2877ec,
                ])),
                Felt::new(BigInteger384([
                    0xd175758bff16aca2,
                    0xc142b9522bf714ac,
                    0x7563fe80c90acf9c,
                    0xd03c2ddd0f4aa9de,
                    0x07a73d923c270f0d,
                    0x00ba30640db19707,
                ])),
                Felt::new(BigInteger384([
                    0xcc536df3a698c1ac,
                    0xfcce1d2b750fb2e4,
                    0x8e77e748680ae235,
                    0x631fed65ea9896ee,
                    0x42e821757bc19d94,
                    0x00f20fe2eaaf93e9,
                ])),
                Felt::new(BigInteger384([
                    0x02d5a98a9efe3616,
                    0x0ae8d924e48e2c82,
                    0x0184b5553472dea6,
                    0x3986dfe8ba000fe4,
                    0xcb241f1c7f11c837,
                    0x01a94c5b57b00c0a,
                ])),
                Felt::new(BigInteger384([
                    0xf16922778bd9e805,
                    0xcfff3625ee43b8ae,
                    0x8a4200d9532b80e3,
                    0xbc788691da56b5fa,
                    0x3322a3741d5f76aa,
                    0x015de8b42b1ac7c9,
                ])),
                Felt::new(BigInteger384([
                    0xa9008209dbacf806,
                    0xeeb3ac57fac25ba0,
                    0x6132283641485255,
                    0x4b7969af96bfa541,
                    0x60af9b364dd08c6d,
                    0x001e73d503b92507,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x379ee2275a5bd912,
                    0xe86e90fc231503fb,
                    0xf8baf80f7cd29c32,
                    0x83f5cab7d24283c9,
                    0x657efc6e385c58b6,
                    0x0016cb25d2f02eb6,
                ])),
                Felt::new(BigInteger384([
                    0xbe86dab6c3c8d799,
                    0x80bd916067d211e8,
                    0x59a6d3b1dbc5dfe5,
                    0x1c4c21f76da17877,
                    0x3208fed5ad8e2aec,
                    0x0178f5df41bf9752,
                ])),
                Felt::new(BigInteger384([
                    0xecb9dcd85863e3ce,
                    0xe9cd8c5db7fcc6da,
                    0xe8d1b66f56eacb38,
                    0x60c6b79669b8c273,
                    0x388493203726ab08,
                    0x0042a446699cb03f,
                ])),
                Felt::new(BigInteger384([
                    0x7c8c385abe0dd168,
                    0x7107588cbfddaf3d,
                    0x1fc4725e001682dd,
                    0xc982bf5776926a40,
                    0x1790b45c63d83dfd,
                    0x00de0c67b17a2ad6,
                ])),
                Felt::new(BigInteger384([
                    0x9cb59406b58930c4,
                    0x5f054660cf109008,
                    0xb5e0be3b1f8fbcbf,
                    0x29d9d50e30c68dec,
                    0x800b5a3ae5066384,
                    0x00abef627b2558ac,
                ])),
                Felt::new(BigInteger384([
                    0xdd05b3ddcd05b6f0,
                    0xd2d512f0fc9825a2,
                    0xbb53ca0ad1ab1538,
                    0x28a0861fac264c2e,
                    0xf8f0e88fb279d969,
                    0x014340445d87ee56,
                ])),
                Felt::new(BigInteger384([
                    0xd7a25460ba2d1afb,
                    0x1d180b5baf06264e,
                    0x98118cbc182539c6,
                    0x2d5a1c0ec43d6943,
                    0xafec075e9a680172,
                    0x00f585f0392b5a0b,
                ])),
                Felt::new(BigInteger384([
                    0xdabce105d435d28d,
                    0xb90588d7a7751e8c,
                    0x9a89de4f5a6f2db9,
                    0x950597d937211af1,
                    0x61fe74c7e07b6a1f,
                    0x002acaa475e57b11,
                ])),
                Felt::new(BigInteger384([
                    0xdd66eaa11d35054e,
                    0x3ee8339b6c2f410c,
                    0x6e3487b1361f6372,
                    0x86cd465e05ba0a07,
                    0x000f2b71504c655d,
                    0x0069657a4132a736,
                ])),
                Felt::new(BigInteger384([
                    0xf3e66311dcc77846,
                    0x33488d9e99341347,
                    0x6f57fbcb33edbdd2,
                    0x0b972380fae4fb91,
                    0xbb78398dbb976e93,
                    0x001b58813b2fac67,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf36001821ee4a9b9,
                    0xed8010b6648f8719,
                    0xf7adf4c038cf20e1,
                    0x67d2a8cf3b6ee34d,
                    0x004099ce5a14e912,
                    0x00bf9e3ef9653ba4,
                ])),
                Felt::new(BigInteger384([
                    0x82c792d30b287bfd,
                    0xe16a005f09b78582,
                    0xd1840025b0ceac2b,
                    0xc3621ba00957bad1,
                    0x12b6fd2dbe0b7244,
                    0x014490d6793d28c9,
                ])),
                Felt::new(BigInteger384([
                    0x32e8179f774a514a,
                    0xd53d1f0d6ff455df,
                    0x9b8a5d8b64373fb0,
                    0x2ad95a95942bf1cd,
                    0xbda1f0f67b07002a,
                    0x017d72df55100cd3,
                ])),
                Felt::new(BigInteger384([
                    0x171b2884f1ff2060,
                    0xc95fcc834a57c4c6,
                    0x050e84f78fd35f09,
                    0xa05ab593456682f3,
                    0xe5ef0dad9fd5101d,
                    0x0045dc62ebfae6cd,
                ])),
                Felt::new(BigInteger384([
                    0x2b7dd72d26ccb216,
                    0xe0f77d3e2fc2d1be,
                    0x82abbf0064f87d9f,
                    0x02947da581a77deb,
                    0xe28573ea7f9678dd,
                    0x014d21c30d3bcbf7,
                ])),
                Felt::new(BigInteger384([
                    0xd193d770e569deb4,
                    0x82759fabfb16f4ed,
                    0xcb3e56dd709879c9,
                    0x577ca933706eaab6,
                    0xdbb468b9dc49edc4,
                    0x002ccede946bf16f,
                ])),
                Felt::new(BigInteger384([
                    0x0ff0f14cf27624ad,
                    0x4030ff8ac22f750d,
                    0xb5785a2112ce11a8,
                    0x24df24138a00fa6f,
                    0x89b963083dfa4295,
                    0x0060c0e5d6b8fe23,
                ])),
                Felt::new(BigInteger384([
                    0x6c25f59c570c15bd,
                    0x028d5ee23ffb652f,
                    0x443ebb46171e0e44,
                    0x8b297316efa1151b,
                    0xb383139aa7bb0660,
                    0x00b1dac5f8749556,
                ])),
                Felt::new(BigInteger384([
                    0x0041269211eb887a,
                    0x3e5a4a10ce28eae0,
                    0x3f5fc8f3426f819f,
                    0x2af79289651fa7d4,
                    0x3a7ad7c712b1a48f,
                    0x00101d878e363e2d,
                ])),
                Felt::new(BigInteger384([
                    0x3e3ff6c90c673cd3,
                    0xbd28205ea26039cc,
                    0x75a7810f23347e81,
                    0xd463ec7bfa33e7f0,
                    0xeade148a2c1e3024,
                    0x012a74faf4fc8825,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x824f37023def470f,
                    0x6de54a6012be8a3b,
                    0x35cddd3708a364f1,
                    0x820c963db02e2090,
                    0xb1817185af245482,
                    0x0036108659f8b1a0,
                ])),
                Felt::new(BigInteger384([
                    0x96fb1d4d14cb5acf,
                    0x366c77072d1720ba,
                    0x2e345706382f76f1,
                    0x8203f65c7a1ddfa5,
                    0x41e8b4082df1f86b,
                    0x010aec490f5c3a80,
                ])),
                Felt::new(BigInteger384([
                    0xa9ca4f3d3f047440,
                    0x77a5faf83a9d1ad9,
                    0xc4a676b2b46af314,
                    0x14966cbd2824f5a3,
                    0x97f53b8f4a39abcd,
                    0x01463474f1fb8ed5,
                ])),
                Felt::new(BigInteger384([
                    0x2ed29f0fb0dda909,
                    0xbbe0078c707d70d1,
                    0xe713b227adc259f6,
                    0xa9a29824e20adb8a,
                    0x1dd3c54cea8ee643,
                    0x016182b32da02c34,
                ])),
                Felt::new(BigInteger384([
                    0x8ea3d4ea4507cc58,
                    0x3d7128f92bd4a944,
                    0x8fbd15e356b90d2e,
                    0x3b7141fbe6561ec2,
                    0x86f13e0b80a82139,
                    0x01451196d4d98179,
                ])),
                Felt::new(BigInteger384([
                    0x7ea36bd177413958,
                    0x26f8718b2375146a,
                    0x9923a190ff9c7351,
                    0x14ad9da5295ca7d8,
                    0xffbdef1e2a464c32,
                    0x015c99741df139b9,
                ])),
                Felt::new(BigInteger384([
                    0x82081930c6b15e69,
                    0x6fca0b458fdd65da,
                    0x7bd34985e6ab9191,
                    0xe25a941d920bd91f,
                    0x70dcd351b223b107,
                    0x004ff3f2155aa9bb,
                ])),
                Felt::new(BigInteger384([
                    0x94797ab8cf5dd653,
                    0xa05300adfa5b9d03,
                    0xa4e7ae2a7d590b96,
                    0xc70180a4c6572fef,
                    0xd1752b624bc87ea7,
                    0x016e8b1e41ab0d5b,
                ])),
                Felt::new(BigInteger384([
                    0xb6516c39d4cb2165,
                    0xd9a562ce7fd35eed,
                    0x4a7c96fc84427bd7,
                    0x444a52064ce3e0bf,
                    0xa1470553aa58025a,
                    0x00e69a42481d14e9,
                ])),
                Felt::new(BigInteger384([
                    0xf91c395000cfff36,
                    0xf3dfa0997041df49,
                    0x2b9d7e0ecb789849,
                    0xcf91cfb87e67b657,
                    0xde4682e576331323,
                    0x012be6908e7ac925,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x9295476e472143b7,
                    0x443baef654adbd5c,
                    0xf25da31764603cc8,
                    0x0c516dc3649596c1,
                    0xae160d7ea19b1f3f,
                    0x013ccccff2c04218,
                ])),
                Felt::new(BigInteger384([
                    0xed5df81ff3d29bc2,
                    0x516ff64ccec2e977,
                    0x4a1bdbca36d5a110,
                    0x6149ee42d4dafb0a,
                    0x1e70f97b19dc7d67,
                    0x001d59b6c7637060,
                ])),
                Felt::new(BigInteger384([
                    0x749486ee33e72f7a,
                    0x834d9f6cc1a4f3cc,
                    0x6d5c9f6578b4ef48,
                    0xcbeb49593389de52,
                    0xb828f9e0a466eafa,
                    0x0115f71012fef0dc,
                ])),
                Felt::new(BigInteger384([
                    0x7fc3f1e0e67b3507,
                    0xe6167c5390343a20,
                    0x74a58787823205c2,
                    0x7aa87a46534e5a4e,
                    0xe5e641bee51c6c57,
                    0x008bbe46120722a0,
                ])),
                Felt::new(BigInteger384([
                    0x8e1add4b59940ea4,
                    0x5559db7cee374f68,
                    0xbb2b03fb45e90734,
                    0x576e4e50f65e6079,
                    0x3c0192795478b23a,
                    0x0052011486e757de,
                ])),
                Felt::new(BigInteger384([
                    0x6b1ffa6b032151e4,
                    0x6b2cc9c45947a682,
                    0x1435d85ca3fe51e1,
                    0x0aa67d733b970977,
                    0x05678dcd948a63cd,
                    0x01261758c6fd562d,
                ])),
                Felt::new(BigInteger384([
                    0x38faf31e8947ca53,
                    0x7ad303b770884d49,
                    0x2411faeda7c0b6fd,
                    0x5ec475c015256ebe,
                    0x49c5e6a62987ea38,
                    0x0093d0c06485074e,
                ])),
                Felt::new(BigInteger384([
                    0x92ebb2eff94bdbfe,
                    0x9e5c9b07bf9bf609,
                    0x4c11fef7aa43f822,
                    0x14ce4ebf0763637f,
                    0x8ec81e5069c67079,
                    0x00e1847e8b199c69,
                ])),
                Felt::new(BigInteger384([
                    0x21f13aded67020b7,
                    0x24d058dd03659434,
                    0xd72b8ea24f7c4562,
                    0xd29efebf13a14a91,
                    0x47fd1d61317a729b,
                    0x0128092dfb826784,
                ])),
                Felt::new(BigInteger384([
                    0xdb47b213ac0c575e,
                    0x5c7131f917a1e7eb,
                    0x80ad5b2545538fdb,
                    0x3a1a48823b6d0ef2,
                    0x586779c54edc9b8d,
                    0x009ef166fb1fbdcd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x663a390da2519eff,
                    0xe0dd8af40501f46e,
                    0x4c2d3b0c4cb81210,
                    0xeceaf7dc0f946c0b,
                    0xb5ab4a41b60c3858,
                    0x00d691bcf608ef3d,
                ])),
                Felt::new(BigInteger384([
                    0x3afd718ff9cd4ef2,
                    0xc0743e8c76fbacfd,
                    0x953b05f39233b8b0,
                    0x51c6d0cb812ed88a,
                    0xe40abad4573ff2e1,
                    0x005562519ecd4d41,
                ])),
                Felt::new(BigInteger384([
                    0x50dcb5fc233d12ed,
                    0x8d12d9f46497fb39,
                    0xb5ce38b05d2c5177,
                    0xfb417d9f9cd0c6ce,
                    0x99cff540cd84ba89,
                    0x01391550519cb2cc,
                ])),
                Felt::new(BigInteger384([
                    0xea3e7cbaafbcfe27,
                    0xe69f3c76f041f399,
                    0xa2f9cd92513c844b,
                    0x3809792f90a9e64b,
                    0xd17bc5b011f62766,
                    0x00322265c4111e1f,
                ])),
                Felt::new(BigInteger384([
                    0x577a64f90070ba0d,
                    0x78c41d72854e64bc,
                    0x4be2bbc23636c80e,
                    0xd6b19d26c52265c4,
                    0x1ea5574bafa3b889,
                    0x004b5d0b5f958936,
                ])),
                Felt::new(BigInteger384([
                    0x102b808d173c45b2,
                    0xaca32ab1948a3130,
                    0x8541ec03af8582bc,
                    0xe0734bdcec589c8c,
                    0x340a20905589477c,
                    0x010999a21b0c43bf,
                ])),
                Felt::new(BigInteger384([
                    0x3c51b53f24960898,
                    0x4f3b670a450f9798,
                    0x9a5bccb7ad599935,
                    0xe65c9ecf76b205ab,
                    0x9c0b566adb4ba455,
                    0x003e64a0f49bc893,
                ])),
                Felt::new(BigInteger384([
                    0x02ff14a944ce2d37,
                    0x3c7068ec5e16dd65,
                    0xf4ca12b8ecc84658,
                    0x4a4d22c595ebc25a,
                    0xcbca3606008d7fa6,
                    0x0051c46f1bcec08d,
                ])),
                Felt::new(BigInteger384([
                    0xaeccd2bf960341f1,
                    0x10d91f32b472e49d,
                    0x63973f9c4132ac7b,
                    0x91fec1295c534092,
                    0x596cd31beecc22e6,
                    0x004b9e2d3e8e6408,
                ])),
                Felt::new(BigInteger384([
                    0x83f6c80992567d81,
                    0x61347f0bd3bee4f6,
                    0x8a4969577ec0f344,
                    0x15440c9ee3fdc7e4,
                    0xb43656c6e15f4d96,
                    0x0129afff18370965,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x59aba6c1e7c4e294,
                    0x73667733a6396360,
                    0x2d798479affa2c4d,
                    0x98456d03e72aefeb,
                    0x2c1a1410dd6a1659,
                    0x004f5bede4716bf2,
                ])),
                Felt::new(BigInteger384([
                    0xecb301496946c192,
                    0x7e58bcbaeb8ec152,
                    0xd0ae5a5a39342ea3,
                    0x10c1bdd4aef64791,
                    0xc8f8b1ce0835c414,
                    0x013689273102933f,
                ])),
                Felt::new(BigInteger384([
                    0xe0f1d10bed33b8f8,
                    0xbf09188c1ee9dc3b,
                    0x731a015f2a13e749,
                    0x158248e18f9e7cdc,
                    0x75e71b3cccbe5772,
                    0x018c80a24e8d3454,
                ])),
                Felt::new(BigInteger384([
                    0x43e110c797942fec,
                    0xa4d966b8e9b63117,
                    0x802b496bd22bd68c,
                    0xd406333249650f20,
                    0xda498a0c4506fe1b,
                    0x004e45bbaa81177a,
                ])),
                Felt::new(BigInteger384([
                    0xc0a61153e1b08282,
                    0xf817ec75c4f127aa,
                    0x3ca07569200d9536,
                    0xeb6c88bef94b8a3b,
                    0x44ce56e9930ff171,
                    0x0003e0e6bf058dae,
                ])),
                Felt::new(BigInteger384([
                    0xa19e4e0a65bb690d,
                    0x6d0b4c84aa6f22ce,
                    0x20a3767e9cbfbde3,
                    0x10f0a6356723c394,
                    0xe010303b92065809,
                    0x005a003341a58603,
                ])),
                Felt::new(BigInteger384([
                    0xfb3ef7914d29f8f6,
                    0xd8f5482ba5a28e3c,
                    0x630f7f632f41da69,
                    0xaa957a8258e60676,
                    0xee8316798443c8a6,
                    0x0069db20ad55a256,
                ])),
                Felt::new(BigInteger384([
                    0x472e4e897d0a2eb0,
                    0x05fe13f99e3b496d,
                    0xbde0d699023b1ff4,
                    0x2e184f92793f041a,
                    0xf4b65d3cbcf2d9af,
                    0x005fd2739f75d23a,
                ])),
                Felt::new(BigInteger384([
                    0x8d20d6a08fa3e0e3,
                    0x8b1df9de50fb54e6,
                    0x8938e41828848067,
                    0x63a3a9187bbccb61,
                    0x4eeeb90af188e5d2,
                    0x00afd4b799bead91,
                ])),
                Felt::new(BigInteger384([
                    0x23128712495332c5,
                    0x6f99c3ad5fd12ab5,
                    0xd99fe6b2debc6ca4,
                    0xeaff1ccb64e5c196,
                    0x638e142f9fb860e6,
                    0x005ca2c7e4c9016b,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/anemoi-hash/anemoi-hash/
        let mut input = [
            [Felt::zero(); 10],
            [Felt::one(); 10],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x80a2fe7f23d64431,
                    0x81cab13828c933ff,
                    0x65ad6811e0e3dda8,
                    0x828ea8b856a569e8,
                    0x6ebe867b0ecd5895,
                    0x0095b320c5be36c7,
                ])),
                Felt::new(BigInteger384([
                    0x432689c246579c5d,
                    0xb06d1305fdce0853,
                    0x79b6508a8827bf66,
                    0xf51a8c597d7fd40e,
                    0xf73366d421e0ffb5,
                    0x00fc8b5cef467a03,
                ])),
                Felt::new(BigInteger384([
                    0x8bb3cd11d7911235,
                    0xc571d60f8f126852,
                    0x5601cd7edd6f0972,
                    0xd0f8c9056a9d1b94,
                    0xdc4f288ab2ebb997,
                    0x007532c95cccff6e,
                ])),
                Felt::new(BigInteger384([
                    0x41f5760a1a33bf5b,
                    0x121a5d2a0c132d6a,
                    0x08d08d3d1c274326,
                    0xca50b9dc7cad6431,
                    0x6e080e7d94d7fd6a,
                    0x014a2c2b2681e612,
                ])),
                Felt::new(BigInteger384([
                    0x8e5e5da48d1a9d7a,
                    0xc67018df0c201376,
                    0xab01cf437ef1821b,
                    0xa84ade693cf62276,
                    0x21b2479b37d90da2,
                    0x011bbad2a6bd4554,
                ])),
                Felt::new(BigInteger384([
                    0xba94d775dfd4da35,
                    0xe0749d0c6d572c04,
                    0x1984b65e02784f3b,
                    0x9011ab42dd80e480,
                    0x39558c66877a33e2,
                    0x015f6dbcd0935710,
                ])),
                Felt::new(BigInteger384([
                    0x6b819f116fc53eeb,
                    0x86b97d6ff6a2cfed,
                    0x1aff20f7406d9106,
                    0xcce9847410679c91,
                    0x78015725371d0583,
                    0x01a093240cc02023,
                ])),
                Felt::new(BigInteger384([
                    0x2a78dce403ac93c2,
                    0x8106a5e62e933d71,
                    0xefcb508b3778b82c,
                    0x58b1b752b68a6003,
                    0x99fc43620a8c7b85,
                    0x008a7a9516f8d6dd,
                ])),
                Felt::new(BigInteger384([
                    0x6521d690de2b3cfe,
                    0x187d97e0b175bd1f,
                    0x980b11b5c667bf60,
                    0x4eeec024c36ee445,
                    0x66c51a6929220d20,
                    0x00c7cfef1bab86e5,
                ])),
                Felt::new(BigInteger384([
                    0xb69a310cc79925e1,
                    0x705333c63454fe62,
                    0x5f1e8ab9102e2aa9,
                    0xbb0eb55687c6f696,
                    0x10bd9cddd8a860ad,
                    0x00087bac9d79a87a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x67f7713eebb27d86,
                    0x906ed1ef83f9724f,
                    0xf4255436f232b861,
                    0x0f2ae3151d5fdd40,
                    0x5813890b7659c08e,
                    0x00b08485b77f5580,
                ])),
                Felt::new(BigInteger384([
                    0x1ffee890ec5125b5,
                    0xcd437f19a2e48da5,
                    0xba64e5e5aa291095,
                    0x30a7635fca728617,
                    0xce05c5f3312a1a6d,
                    0x014d92def30c2ccd,
                ])),
                Felt::new(BigInteger384([
                    0x45cdf9d97fb33f21,
                    0x0d0c0ccd7955fdac,
                    0x09a8910685eb0e37,
                    0x11a5aaaa77a29ffd,
                    0xfa8476e4565a58b5,
                    0x00a4ea0f208104e4,
                ])),
                Felt::new(BigInteger384([
                    0x78200b36b19c92e0,
                    0x91fe0ec2c3f7eaa5,
                    0xfb6d873627b4d622,
                    0xe1a9494395ee8b03,
                    0x97f32fc22af94f86,
                    0x00738f3c85f4fe7e,
                ])),
                Felt::new(BigInteger384([
                    0x8f2cfdc7525b49f5,
                    0x4a1e07aa0ee913bf,
                    0x338f72eaf70c6c54,
                    0x4c5fd00df719b726,
                    0xe26911fd9a7d6c46,
                    0x016217344b274196,
                ])),
                Felt::new(BigInteger384([
                    0x2b5da0f7fb680c45,
                    0xb527e7f9c968e759,
                    0xa4d538f3c724498b,
                    0x9fd5d84bc304526b,
                    0xf343713e6f0b45dc,
                    0x01637e5d8822cd48,
                ])),
                Felt::new(BigInteger384([
                    0xc4729c994793ae76,
                    0xf269dcd87a78d261,
                    0x1365d009a7cc053a,
                    0x5c2825e17465d4ee,
                    0x5da122972ee076a5,
                    0x01618f36b5d6e974,
                ])),
                Felt::new(BigInteger384([
                    0x0aadab42ef77999a,
                    0x66d0e283554355eb,
                    0x1d1cdb91025bb30d,
                    0xd11bb98e5cf38a4f,
                    0x6c6e872feb4fe176,
                    0x01506f34eba5efdb,
                ])),
                Felt::new(BigInteger384([
                    0x02298c50590e804d,
                    0xe7858e3ce7993827,
                    0x2a968f6715bf2460,
                    0x8bfa86ee80c3974b,
                    0x316b292811dbe3a7,
                    0x000b421257e067d4,
                ])),
                Felt::new(BigInteger384([
                    0x15ff152ad8061880,
                    0xf3cdf109ce208e74,
                    0x5e8e582aff28e5e2,
                    0xa50c52f5eaef32dd,
                    0x3fe45f898b89119d,
                    0x018be85f4465f46b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xee2dba56893ca7dd,
                    0x331b790c49587d14,
                    0x5d36e173a5201852,
                    0xe647cc12baa9e643,
                    0x823882ca5ea7f482,
                    0x01934afe8fbcff0c,
                ])),
                Felt::new(BigInteger384([
                    0x104da369bf829a02,
                    0xff22f2f52adf5699,
                    0x5234e46a6b5b68bc,
                    0x6451e452e89b2cfb,
                    0x6c0e451b967d3d4b,
                    0x00c3c011781f98cb,
                ])),
                Felt::new(BigInteger384([
                    0x80cd195e2cc861ab,
                    0xfda309cf3dbac54b,
                    0x46236911933f0fdf,
                    0x5cbfde050ea4fbca,
                    0x5fd7edced9f3c36d,
                    0x0192544fd7e73307,
                ])),
                Felt::new(BigInteger384([
                    0xc4533db3f3734b3d,
                    0x62b754be4a27db6b,
                    0x18a659baed39f35a,
                    0x706da3f9a10aa5d1,
                    0x0f7136ee1a307e40,
                    0x01183722de95c44f,
                ])),
                Felt::new(BigInteger384([
                    0x51c74acf816bf31f,
                    0x59a5248ad8dd099e,
                    0x2ca4feee42b117b3,
                    0x0ca858acdd119570,
                    0x4ef91f11855d67ca,
                    0x00458fc04dedd190,
                ])),
                Felt::new(BigInteger384([
                    0x54fa28b69c68cbbd,
                    0x301e706a18769317,
                    0xe2d36624065e4f3d,
                    0xd96c02d63fa0a71c,
                    0x21e4c6c50c9997a2,
                    0x01790a151d3e3c50,
                ])),
                Felt::new(BigInteger384([
                    0x02322bf7e5ba9cc6,
                    0x88878a75cecdedd7,
                    0x599c2d6ce065efcd,
                    0x16adfa92231d0da3,
                    0x3aa7bf7bdaf8167f,
                    0x00845239b4045efe,
                ])),
                Felt::new(BigInteger384([
                    0xfcce61b25b90618d,
                    0x43cabfa8057dd46b,
                    0x52d028c432771f1a,
                    0x6fe614f6f5a7631a,
                    0xc91bdc3d8c37fb9b,
                    0x008888209151da94,
                ])),
                Felt::new(BigInteger384([
                    0xd0529b1a57656450,
                    0x5b73144e174a1163,
                    0x297a5022aad3b13c,
                    0x4209092f62273dd1,
                    0xbce831deebfa0bee,
                    0x00bedde445c60310,
                ])),
                Felt::new(BigInteger384([
                    0x7297d7dabfcdda80,
                    0x4d32957420ddea75,
                    0xcda8af649d99993a,
                    0xa831723d337b8c60,
                    0xfb10beb164625882,
                    0x00562734d291201c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3d9dd2026bc0bca9,
                    0x5aa46124407d875c,
                    0x07dc40e623965949,
                    0xe6afc7e12becea48,
                    0x19d3de03a7b059b0,
                    0x00a1205cb0ee2145,
                ])),
                Felt::new(BigInteger384([
                    0x11eb6dd5b429bbbb,
                    0xe29ff538715ad88f,
                    0xd99cb3701335f50e,
                    0x0ce8e9c12a37716b,
                    0xd67129dbd7288c4c,
                    0x009dbc29c726bfb5,
                ])),
                Felt::new(BigInteger384([
                    0xdfb818837154cad4,
                    0x55450b449500a07f,
                    0x94f2c5c47c2c4fef,
                    0x9fcc13f6977e3bfd,
                    0x4a1fdebcc2f483fd,
                    0x00245e607804b0f7,
                ])),
                Felt::new(BigInteger384([
                    0x7d399d8dab6bc3ed,
                    0x6decd7463fbb285f,
                    0xeabb81b6df4b54fb,
                    0x8526473557295cee,
                    0x24fbd4abf7b06cdc,
                    0x0152df995e27058a,
                ])),
                Felt::new(BigInteger384([
                    0x95559e6e7ce81879,
                    0x20cf07fbff95f101,
                    0x3f91ad4970f950a6,
                    0x4c2accf15388f65d,
                    0xe79716291bc7e48f,
                    0x0033b158f5c85268,
                ])),
                Felt::new(BigInteger384([
                    0xbc479233e9e824d6,
                    0x81997d6225b6e823,
                    0x3de781952bfacc1d,
                    0xccf2390836a198ce,
                    0xd24c745f542d6e9c,
                    0x00dd55560139db03,
                ])),
                Felt::new(BigInteger384([
                    0xcf4d4a1a2ade6caa,
                    0xb9e0475e9cd5793d,
                    0x4d28ed7a3effa40f,
                    0x128418b3f7de504c,
                    0xd69980903a3cac33,
                    0x0073e4d79c40a2d3,
                ])),
                Felt::new(BigInteger384([
                    0x590af0f289a72fe0,
                    0x4afb1580215826a5,
                    0x4f34f16ce6ec0210,
                    0xf229d91f02f294be,
                    0x4e2814466ceed0af,
                    0x006455346ac7e729,
                ])),
                Felt::new(BigInteger384([
                    0x09ac633a88f840cd,
                    0x42f1d9e2baff2e2d,
                    0xa0939f1a9313b182,
                    0x597ae398480c464f,
                    0x48400268b9b651e0,
                    0x01897b499af136b4,
                ])),
                Felt::new(BigInteger384([
                    0xfff287a16fde629f,
                    0xff2250911f2fccc1,
                    0x604946612962a96e,
                    0xf27a46bf0ccbbbcd,
                    0xcdb848dff6ec9a07,
                    0x011ac9fd6de0a371,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2a9c56ab077c09c8,
                    0xd53693bc1bbfcf42,
                    0x2d92e771a91bf6d3,
                    0xff6f08181ff52130,
                    0x8777f000dd5a66ff,
                    0x0072ca455661f149,
                ])),
                Felt::new(BigInteger384([
                    0xccd3a99b731cb368,
                    0xedc5d0a14a849dcf,
                    0xc56ec3c83b4d56d7,
                    0x4adf59d5dd8724ef,
                    0xa2ae62163371530c,
                    0x0040bb26dce283d1,
                ])),
                Felt::new(BigInteger384([
                    0xa85d1995f50f8add,
                    0x7addcca29c4b9d3a,
                    0x1955ffc173d5ddf0,
                    0xa6542c5effa9ad93,
                    0x11cedb5b08b8d1ac,
                    0x018fd2b8d228b562,
                ])),
                Felt::new(BigInteger384([
                    0xc1b58d332a10bc45,
                    0xcdaefab04277e5bc,
                    0x35abf9b201ce5316,
                    0x3ce93a7c3dddb41b,
                    0xeefc0a9075526ecc,
                    0x010b9224ec20b18b,
                ])),
                Felt::new(BigInteger384([
                    0xcd3d9b75c7fa36da,
                    0x99c2f8347e6a7106,
                    0xb0da2cc6e622878f,
                    0x068b7546340c891f,
                    0x80ce4588d40bb1ad,
                    0x00f523b798ee136c,
                ])),
                Felt::new(BigInteger384([
                    0xadfd2a109effaa1d,
                    0xd71987cf4de372ad,
                    0xbb619c45fef8a473,
                    0xe827406a343b34e2,
                    0x7b06afb44c3fc36c,
                    0x00c6ead26fba3512,
                ])),
                Felt::new(BigInteger384([
                    0x31c00301e071f096,
                    0xca56072c5223906f,
                    0x1da799cec96b6b88,
                    0xf50caac16dae549b,
                    0xe8b2a9c770402f31,
                    0x01265caa51d8fbe9,
                ])),
                Felt::new(BigInteger384([
                    0xc2c181088d1e32f6,
                    0x3bc6b51da88f458c,
                    0x8273921d412bdc14,
                    0x33120fd5464911e6,
                    0x0bb9b8801deeb4fe,
                    0x00e144d0945d217d,
                ])),
                Felt::new(BigInteger384([
                    0x411efe48cc783d59,
                    0x6ea17d90b0a61fbf,
                    0x65b8457a78daec62,
                    0xe056091ca2dad3d2,
                    0x3a69a0bed3a8da26,
                    0x00488d2cddc120e0,
                ])),
                Felt::new(BigInteger384([
                    0x06d8d4b0410de580,
                    0x0ca67bd3f345528d,
                    0x2313736c7995d0fa,
                    0xb3489d7b8eed492a,
                    0xed5775627461c0bb,
                    0x00d802da875cf797,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x29bd7e82a0f2ed79,
                    0xd0d91bbac7def394,
                    0x2d460e5f7f91fdcb,
                    0x1748eedf9ddd1396,
                    0x89acb0f4f4b7ad87,
                    0x017db2c69be0ce6a,
                ])),
                Felt::new(BigInteger384([
                    0x3a40030dd17194b4,
                    0x5eb207e2643fc085,
                    0x6e2899e57bd15ab2,
                    0x4ed19e6de05e4445,
                    0x759e50c67edfbb03,
                    0x0079ed45f537a020,
                ])),
                Felt::new(BigInteger384([
                    0xb5bd664baa4ec09d,
                    0x62ce1c16cf4a9b71,
                    0xe4044711a27d277d,
                    0xd128b26a3875d59b,
                    0x46fefb634c0dddab,
                    0x006a6b8737ce365c,
                ])),
                Felt::new(BigInteger384([
                    0x88183dffd5a64480,
                    0x59a9cdadbf3185be,
                    0xc97e69e2e331b05e,
                    0xe28e2ca65c93f3af,
                    0x257b94d6d79686f5,
                    0x017f8cb59b116918,
                ])),
                Felt::new(BigInteger384([
                    0x5f6070b149069db5,
                    0xbdb6dedb2c2a7706,
                    0xcd6c513921a41acc,
                    0xab03313d24cefb4a,
                    0x361d9bd12be1cfd1,
                    0x0188ba0e3f41162f,
                ])),
                Felt::new(BigInteger384([
                    0x1353bb2dea62985f,
                    0x2eb91d5e0f639415,
                    0x1adaa5d94bd7a414,
                    0x2efbcf50b5e28493,
                    0xc3b0d9efee32805f,
                    0x0070528eaed8ff5d,
                ])),
                Felt::new(BigInteger384([
                    0x97911a95f8e65ca5,
                    0x546ab68c6b2ee10d,
                    0x83b65ede8480a324,
                    0xdbcd11dacf65e2b6,
                    0x6868fed2c42ab34d,
                    0x001e9f00a0162693,
                ])),
                Felt::new(BigInteger384([
                    0x24a470f5d048f468,
                    0x724e25e3b63ec01c,
                    0x2358ce93432b3fc7,
                    0xea9c9c430ffa7b2c,
                    0xec1d85f6a1f30978,
                    0x019991d34d9fd424,
                ])),
                Felt::new(BigInteger384([
                    0x180c26789041722c,
                    0xd1fd2c85034fffec,
                    0xc45205ff3a30c147,
                    0xf6292d7cec288590,
                    0x5b47f5334aa95eb4,
                    0x00fad7de3e7d92e7,
                ])),
                Felt::new(BigInteger384([
                    0x7f05eec4b1495fa2,
                    0xf96ab93800131107,
                    0x5d4fee2b62e3fa09,
                    0x7de3d87dca75fa07,
                    0x69c5b404da38fa87,
                    0x00be9da226a62166,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 10],
            [
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::new(BigInteger384([
                    0x1320fffffffff7ac,
                    0x155b44203ffffbac,
                    0x3d124a86aab45f40,
                    0x55c0e43c06f91c12,
                    0x1c74197750ca1fca,
                    0x0102b0420acf1cc5,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x0e4c9bd61b3527f3,
                    0xf2cc4d4ec0bb8c40,
                    0x641950e11c631089,
                    0x8c36000a2fd83150,
                    0x29a2d8ea4f047512,
                    0x00335b72e8fd1ab0,
                ])),
                Felt::new(BigInteger384([
                    0xae25e800541db779,
                    0xad944d4b5d884ab8,
                    0xb9ec5bda0404f704,
                    0x9c06528dfc852eb0,
                    0x627f5168c452a266,
                    0x00e815ab90e1dc74,
                ])),
                Felt::new(BigInteger384([
                    0x27d3c6d18823c88c,
                    0x02d914f807b0c9bb,
                    0x7e754c348c800e8f,
                    0xb0f58919658e2a29,
                    0xd2cc01a7db804030,
                    0x00947cd5947c7c43,
                ])),
                Felt::new(BigInteger384([
                    0xfb25778e6204f5df,
                    0x7093d47e352307c5,
                    0xc0088d3c5556db13,
                    0x46bc953dc2e62925,
                    0x60ed2d0d736ffc3a,
                    0x004dce1e1cf64f76,
                ])),
                Felt::new(BigInteger384([
                    0xadd23be4653ebc56,
                    0x287da05c56fce4c9,
                    0x294471d3e48c1b81,
                    0x8aabfbed1f3ee2e7,
                    0xa1d2c4ee67c73e31,
                    0x012b201cc7a8efd3,
                ])),
                Felt::new(BigInteger384([
                    0x267c79288b80642e,
                    0xea889bb60d9f1a5c,
                    0x1549143fbbf80e23,
                    0x32298e2b7e2084e5,
                    0x028cf8b8394c772b,
                    0x016c334470e47b6a,
                ])),
                Felt::new(BigInteger384([
                    0x8efebfc9e6d0e5c6,
                    0x5594d6598392b56a,
                    0x9aa56f3aaa25c998,
                    0x488c0b32d1af2c69,
                    0x3e7eebb58a174bf3,
                    0x019a8200cef6cccd,
                ])),
                Felt::new(BigInteger384([
                    0xa5975ab916b6cfec,
                    0x11daebe9713bb277,
                    0x6711c4a024c674b5,
                    0xd83a4e19ae623e3b,
                    0xd39ddbf644613f46,
                    0x00b3741b1293601b,
                ])),
                Felt::new(BigInteger384([
                    0xb4034a1b5c483cce,
                    0xc2334b41672e418d,
                    0xa85d8f687b97d28a,
                    0xe85996533b1f1d4b,
                    0xb044980704ecd434,
                    0x009704ead426e77a,
                ])),
                Felt::new(BigInteger384([
                    0xb6e85cb6b94a85bf,
                    0x21aaf97ffb33a0ae,
                    0xc3dd3cac6bb0bb97,
                    0xe1897926c251b4e6,
                    0x552810aa0b899eef,
                    0x013031a345381e19,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x6284291bb9581de0,
                    0x9e154bf19d4d0649,
                    0xe25f995189ed71cb,
                    0xc253862373417a34,
                    0x75e3a46562823ff7,
                    0x00e1ee9ef5435c7e,
                ])),
                Felt::new(BigInteger384([
                    0x6f78f16664c3b8e1,
                    0xe99c63a7e7a5d5c9,
                    0x70a6cdff2820f46c,
                    0xadaaa3d16c736d14,
                    0x66cc990ac9bdd4f8,
                    0x00848626c12268a0,
                ])),
                Felt::new(BigInteger384([
                    0x83074e3674c16279,
                    0x09160bab2865b103,
                    0x1cb72dd7de131dc9,
                    0x374811b354f1c775,
                    0x6e45b089bafb2990,
                    0x0112dd2966fd76d8,
                ])),
                Felt::new(BigInteger384([
                    0x78f7a03df6d427d9,
                    0x62633bc7f90d8041,
                    0x4ca3b42f2553fd05,
                    0xbf6fafbf5e6b8953,
                    0x33a71ee1a4872217,
                    0x009279debfec95db,
                ])),
                Felt::new(BigInteger384([
                    0xa8c4c83079dd1378,
                    0xc639a45114bfbae7,
                    0xacf513dd69b70dff,
                    0xff94da8c3a45e85b,
                    0xe0fd94bc48d5b52f,
                    0x00bb6b1d6cf9c40c,
                ])),
                Felt::new(BigInteger384([
                    0x591ea6508b576847,
                    0x99646eb4fe168f4b,
                    0x4c1b6391416aa4b0,
                    0x99585002c5d8dca6,
                    0x2620a5d9d77513c4,
                    0x00d4d17c8d764ca5,
                ])),
                Felt::new(BigInteger384([
                    0xa03089f2241afcbf,
                    0xd3ff8f55513df2b6,
                    0x222e919b34c5f96b,
                    0x92fed476e70068f0,
                    0x406c075e08098655,
                    0x01a6e92fd0c3502f,
                ])),
                Felt::new(BigInteger384([
                    0xaf18cf16eef1776c,
                    0xe015727cc62873bf,
                    0x214a468bd0f2ab14,
                    0x915716974d860518,
                    0x2178d135004b2c73,
                    0x010bc7b0b8957009,
                ])),
                Felt::new(BigInteger384([
                    0x20fdb68c25501809,
                    0xffc333ed91ff5d5e,
                    0xae518d351d9ac938,
                    0xa2ba3022fc1198dd,
                    0x893ffad29557b2ed,
                    0x00ca83a5ada3ce38,
                ])),
                Felt::new(BigInteger384([
                    0x5e34da71adbb0335,
                    0x84c5705f68b36458,
                    0x9b1880a5f88236e0,
                    0x076215c7e056854d,
                    0x697a7db1fbedfdc0,
                    0x012d1b27f8426462,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x87d6d6b824015368,
                    0xd4ef06414258c153,
                    0xeb00b357b654fc98,
                    0xaae5a0169e030028,
                    0x6ad3e01f8e2c7b6c,
                    0x01071b61e92ae390,
                ])),
                Felt::new(BigInteger384([
                    0xa3d044d27a83f129,
                    0xd2af004699404605,
                    0x6f56ac2a3a62eb13,
                    0xf34c3dbdec4f52d1,
                    0x8f60b3eb48b59757,
                    0x01239d933407d2e9,
                ])),
                Felt::new(BigInteger384([
                    0x1c6b51eb86ff27bb,
                    0x7d0b85078e3862df,
                    0xfd01a9fc258b774d,
                    0xb0c86256b4eb3f68,
                    0x4f85b8a18a4433b7,
                    0x002954d479afdcdc,
                ])),
                Felt::new(BigInteger384([
                    0x73844404ee898648,
                    0x5ff83ca4ff319121,
                    0xcef2c62868977657,
                    0x8b97c4c5902cc954,
                    0xb6365e5318f0ad94,
                    0x003406f7060a4c2b,
                ])),
                Felt::new(BigInteger384([
                    0x9c63c95fbd9267d6,
                    0x9ee3fe055c85e8c2,
                    0xfdb97ee08eade27f,
                    0xd9cfd421a8b87edb,
                    0xe9df074cc0930612,
                    0x00c6736a28a5a466,
                ])),
                Felt::new(BigInteger384([
                    0x3ffd49f554be8fed,
                    0x62be820dc7f27fb5,
                    0xf4f7539193551bb7,
                    0x759d0c964498165a,
                    0x6499e5b2033e8d80,
                    0x003bab594cc07a5e,
                ])),
                Felt::new(BigInteger384([
                    0x6597830ee0a79429,
                    0x67b0daaecb4196bd,
                    0x76eab5a6d556d7fd,
                    0xe4c8495f9a96b157,
                    0x7eae002d92d028b5,
                    0x00ae4173b93ba4b3,
                ])),
                Felt::new(BigInteger384([
                    0x1c7505744d29fcda,
                    0x23d0b386b8389294,
                    0xea6a665d7d3be2e7,
                    0x63e3bb58a77f703e,
                    0x506f6d801359b7fc,
                    0x0026b73d881e337e,
                ])),
                Felt::new(BigInteger384([
                    0x39d352c630a2f84e,
                    0x7c1937114027efb2,
                    0x3d33e69ec2fa4276,
                    0x4cbea4d3990bbc1b,
                    0xc2be1178af7fef90,
                    0x00d17a9037289e78,
                ])),
                Felt::new(BigInteger384([
                    0xb7b61d74b16f62e6,
                    0x17a20144393bd80a,
                    0x634732a055533f6e,
                    0x285c3470c9e644fb,
                    0x79e884ea7f88664e,
                    0x018847315a119435,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xba2117c1922062ed,
                    0x3ca4881eadb497ee,
                    0x0d4a262f75380552,
                    0xfbe0a346171d04fe,
                    0xcf9b4e917eda7747,
                    0x014103b1c694626a,
                ])),
                Felt::new(BigInteger384([
                    0x599032c83625e382,
                    0x56e4b9a016585afe,
                    0xb9950d0f00eadcf7,
                    0x6b93acc3ec2ccf47,
                    0xcfdd189117993b69,
                    0x0047fd2b2e8f1cb2,
                ])),
                Felt::new(BigInteger384([
                    0x58dffe92c74c7573,
                    0xa122d4194c39f41e,
                    0x22164b61b4a5a54c,
                    0x7c330a7e68370e03,
                    0xa47a283c2e039ddb,
                    0x00f2972fffeaadb2,
                ])),
                Felt::new(BigInteger384([
                    0xe294a3eb72e4f76e,
                    0x8e5ff81b1f38342f,
                    0x343875ba46a13d65,
                    0x8997e8c6c9eec91a,
                    0xd3c174bdf00e47f1,
                    0x018c0bbf941cfcad,
                ])),
                Felt::new(BigInteger384([
                    0x608a6fc42394073f,
                    0x2aced7e636ce4de5,
                    0x22f7bd35792d09c2,
                    0xefd6c43c0b1a93be,
                    0x8701f74d0c0fa541,
                    0x0176ba553c273dc9,
                ])),
                Felt::new(BigInteger384([
                    0xca475e45a070a193,
                    0x99deb594a87ce620,
                    0x3d284c27904d1cf5,
                    0x0aac05290fa406bd,
                    0x1e08d769efd9b9db,
                    0x00c0ac5bd7577b9e,
                ])),
                Felt::new(BigInteger384([
                    0x41fb2663e0334b2e,
                    0xa8d70bdec0edb9d9,
                    0xd05ac04484d964a3,
                    0x169fd4e71d818dd1,
                    0xd460231af38850b8,
                    0x00e19e5fd2e73ce4,
                ])),
                Felt::new(BigInteger384([
                    0x9fb5be9d124cb3f1,
                    0xb210594075625989,
                    0xe07eec561cd2f1d9,
                    0x34ff341be22993a4,
                    0x8ee4f34597a18dd3,
                    0x009a5f4f1c9025b9,
                ])),
                Felt::new(BigInteger384([
                    0x1b6e6c12add7d0ed,
                    0x87b2ae9ff7c3a212,
                    0x0cb9c24f772de987,
                    0xc812aab3985c6f1e,
                    0x5a1473d255b1e8c1,
                    0x00d0f3314f4e9eb0,
                ])),
                Felt::new(BigInteger384([
                    0x94dde23704f51167,
                    0x6b8315802e808dcb,
                    0xe4d10e286ab04b91,
                    0x072bfd9d8fdacf1d,
                    0x871f79c229a48cb0,
                    0x00b846b3b0d1b807,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xd14b8b21e9ed6115,
                    0xb2c5a3eb3d1b10d2,
                    0x925b5faaf58699a5,
                    0x80924bc2f086306b,
                    0x6db23c12bf7018cb,
                    0x00e9268f98bf3539,
                ])),
                Felt::new(BigInteger384([
                    0xa62109f92bb37f5e,
                    0xd889213a12a0bca3,
                    0x6d5b9bd53e6c6e6d,
                    0x22771789010743e9,
                    0x84a000c7b34c836f,
                    0x00f068e2f870ec78,
                ])),
                Felt::new(BigInteger384([
                    0xe33363dfd48e93d3,
                    0x9c543fb24d992820,
                    0x5845058952cfed3c,
                    0xe84a667ca85bd8b1,
                    0xef56443651a82295,
                    0x00227d7dbc2ea4db,
                ])),
                Felt::new(BigInteger384([
                    0xe8ab13059e3f9461,
                    0x633262edfbae4dea,
                    0x2b003b67fd667833,
                    0xf5f017983f830f80,
                    0x7e58c8f8e265b96b,
                    0x006786f97026bc9a,
                ])),
                Felt::new(BigInteger384([
                    0xa00f174acf5e339f,
                    0x6fd22baeb73e0b4e,
                    0xa8d22d93493b5a1e,
                    0xdf60913118e9b77a,
                    0xb0a0d007542f38a8,
                    0x003172dcad155618,
                ])),
                Felt::new(BigInteger384([
                    0x1aff23f8f22ec422,
                    0x2dd69bbf3f2bbccf,
                    0x4cc58a4cfa22d6ef,
                    0x8236723bd7a699b4,
                    0x1ac66610cc278f51,
                    0x000e8ce33cf20243,
                ])),
                Felt::new(BigInteger384([
                    0x25e274adfaf87c2a,
                    0x7f205c67b544f9d2,
                    0xfa8af4b0fb82eedf,
                    0xe02a532f848cb2df,
                    0x1a24a0d9b893ca67,
                    0x00c9bd3fb9f77295,
                ])),
                Felt::new(BigInteger384([
                    0x4379a25d2de3e24f,
                    0xb37eaa3ad0f067ce,
                    0xe529203844a2ad3f,
                    0x68ad6c61ddecdea7,
                    0x0aa33e998b0b2a4a,
                    0x00b183503b1ed85d,
                ])),
                Felt::new(BigInteger384([
                    0x018b4354b4355fef,
                    0xe7cb8f1d5d0f2b75,
                    0xa312960993985e44,
                    0x25de094f4ed484c8,
                    0x96460b658c42ba52,
                    0x019ab5701c02f627,
                ])),
                Felt::new(BigInteger384([
                    0xb58e10c09df2a474,
                    0xdb513d662ca7ef7e,
                    0x0be558862d1202a4,
                    0xf57f10c8c6091a82,
                    0x341b34218bb1cfb7,
                    0x0184358823a69a56,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x50215fe9350aea83,
                    0x8cbd64369398f083,
                    0x3b10e545d379466e,
                    0xb580c9d94864cc4d,
                    0xba7c18d25337502e,
                    0x00127102f35b7bc0,
                ])),
                Felt::new(BigInteger384([
                    0x1f1b1eab458c3cf7,
                    0xdc199126f9238b2b,
                    0x72427354cde7db77,
                    0xc89ee8accc956ce4,
                    0x315caf771de0aaf0,
                    0x007de405012ab880,
                ])),
                Felt::new(BigInteger384([
                    0xfde6ffaef60c7b9c,
                    0x5a20328ba7b61729,
                    0xfa0fce1b83afa4ec,
                    0xcae576d3d519c266,
                    0x4fc58d5e8f7ce76a,
                    0x016ac1af0c13b4f8,
                ])),
                Felt::new(BigInteger384([
                    0xbc2fb5ea9ad5c07b,
                    0x68767c1bc06ce2cb,
                    0x91c0640a430b44ca,
                    0x87ad049af101f183,
                    0x8cb14d0ecd9be862,
                    0x0167d02f0b3c1555,
                ])),
                Felt::new(BigInteger384([
                    0x8f06c78b33c8a236,
                    0x3dd49cdb99eab6a5,
                    0xcd1a49803e4cf87c,
                    0x8f13d4b70cd95816,
                    0xc632e6d59e567e06,
                    0x0029d01ee330248e,
                ])),
                Felt::new(BigInteger384([
                    0xc7e8a1edd3061fef,
                    0x98c00760889bc972,
                    0x54c94a6cdad5db4f,
                    0x08b1636056550bc6,
                    0x00c2596436d3d6b8,
                    0x016da862372ae147,
                ])),
                Felt::new(BigInteger384([
                    0xe8c3d561fa70b62b,
                    0x35580f364f40a8b4,
                    0x81c7881383c48f33,
                    0xf8d681f63c382073,
                    0x849ae2145661b4d9,
                    0x0071bebd7cce45ec,
                ])),
                Felt::new(BigInteger384([
                    0xc85365ebf5b8d381,
                    0x5a80a5e24d8311f2,
                    0x78131cf2863ec304,
                    0x6872acf560038aad,
                    0xa8f5ada19e1c1f8b,
                    0x016f64aae7880bec,
                ])),
                Felt::new(BigInteger384([
                    0xc09e3de698ca1a65,
                    0x673ee385ea8e484e,
                    0x8da3599b559d550f,
                    0x02933c36c48b2658,
                    0x73f24405199d939f,
                    0x0113b3ec7e514d2b,
                ])),
                Felt::new(BigInteger384([
                    0x50e32c5f0b98790f,
                    0x5fc908e45aee0a49,
                    0x13cb7ff95acff5df,
                    0x61c2b0b85374484c,
                    0x02d19b490d8faef3,
                    0x013c82c24ca01e92,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
