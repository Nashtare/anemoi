//! Sponge trait implementation for Anemoi

#[cfg(not(feature = "std"))]
use alloc::vec::Vec;

use super::digest::AnemoiDigest;
use super::{apply_permutation, DIGEST_SIZE, NUM_COLUMNS, RATE_WIDTH, STATE_WIDTH};
use super::{Jive, Sponge};

use super::Felt;
use super::{One, Zero};

use ark_ff::FromBytes;

#[derive(Copy, Clone, Debug, Eq, PartialEq)]
/// An Anemoi hash instantiation
pub struct AnemoiHash {
    state: [Felt; STATE_WIDTH],
    idx: usize,
}

impl Default for AnemoiHash {
    fn default() -> Self {
        Self {
            state: [Felt::zero(); STATE_WIDTH],
            idx: 0,
        }
    }
}

impl Sponge<Felt> for AnemoiHash {
    type Digest = AnemoiDigest;

    fn hash(bytes: &[u8]) -> Self::Digest {
        // Compute the number of field elements required to represent this
        // sequence of bytes.
        let num_elements = if bytes.len() % 47 == 0 {
            bytes.len() / 47
        } else {
            bytes.len() / 47 + 1
        };

        let sigma = if num_elements % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        // Initialize the internal hash state to all zeroes.
        let mut state = [Felt::zero(); STATE_WIDTH];

        // Absorption phase

        // Break the string into 47-byte chunks, then convert each chunk into a field element,
        // and absorb the element into the rate portion of the state. The conversion is
        // guaranteed to succeed as we spare one last byte to ensure this can represent a valid
        // element encoding.
        let mut i = 0;
        let mut num_hashed = 0;
        let mut buf = [0u8; 48];
        for chunk in bytes.chunks(47) {
            if num_hashed + i < num_elements - 1 {
                buf[..47].copy_from_slice(chunk);
            } else {
                // If we are dealing with the last chunk, it may be smaller than 47 bytes long, so
                // we need to handle it slightly differently. We also append a byte set to 1 to the
                // end of the string if needed. This pads the string in such a way that adding
                // trailing zeros results in a different hash.
                let chunk_len = chunk.len();
                buf = [0u8; 48];
                buf[..chunk_len].copy_from_slice(chunk);
                // [Different to paper]: We pad the last chunk with 1 to prevent length extension attack.
                if chunk_len < 47 {
                    buf[chunk_len] = 1;
                }
            }

            // Convert the bytes into a field element and absorb it into the rate portion of the
            // state. An Anemoi permutation is applied to the internal state if all the the rate
            // registers have been filled with additional values. We then reset the insertion index.
            state[i] += Felt::read(&buf[..]).unwrap();
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
                num_hashed += RATE_WIDTH;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        // Finally, return the first DIGEST_SIZE elements of the state.
        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn hash_field(elems: &[Felt]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        let sigma = if elems.len() % RATE_WIDTH == 0 {
            Felt::one()
        } else {
            Felt::zero()
        };

        let mut i = 0;
        for &element in elems.iter() {
            state[i] += element;
            i += 1;
            if i % RATE_WIDTH == 0 {
                apply_permutation(&mut state);
                i = 0;
            }
        }

        // We then add sigma to the last register of the capacity.
        state[STATE_WIDTH - 1] += sigma;

        // If the message length is not a multiple of RATE_WIDTH, we append 1 to the rate cell
        // next to the one where we previously appended the last message element. This is
        // guaranted to be in the rate registers (i.e. to not require an extra permutation before
        // adding this constant) if sigma is equal to zero. We then apply a final Anemoi permutation
        // to the whole state.
        if sigma.is_zero() {
            state[i] += Felt::one();
            apply_permutation(&mut state);
        }

        // Squeezing phase

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }

    fn merge(digests: &[Self::Digest; 2]) -> Self::Digest {
        // initialize state to all zeros
        let mut state = [Felt::zero(); STATE_WIDTH];

        // 2*DIGEST_SIZE < RATE_SIZE so we can safely store
        // the digests into the rate registers at once
        state[0..DIGEST_SIZE].copy_from_slice(digests[0].as_elements());
        state[DIGEST_SIZE..2 * DIGEST_SIZE].copy_from_slice(digests[0].as_elements());

        // Apply internal Anemoi permutation
        apply_permutation(&mut state);

        Self::Digest::new(state[..DIGEST_SIZE].try_into().unwrap())
    }
}

impl Jive<Felt> for AnemoiHash {
    fn compress(elems: &[Felt]) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = [Felt::zero(); NUM_COLUMNS];
        for (i, r) in result.iter_mut().enumerate() {
            *r = elems[i] + elems[i + NUM_COLUMNS] + state[i] + state[i + NUM_COLUMNS];
        }

        result.to_vec()
    }

    fn compress_k(elems: &[Felt], k: usize) -> Vec<Felt> {
        assert!(elems.len() == STATE_WIDTH);
        assert!(STATE_WIDTH % k == 0);
        assert!(k % 2 == 0);

        let mut state = elems.try_into().unwrap();
        apply_permutation(&mut state);

        let mut result = vec![Felt::zero(); STATE_WIDTH / k];
        let c = result.len();
        for (i, r) in result.iter_mut().enumerate() {
            for j in 0..k {
                *r += elems[i + c * j] + state[i + c * j];
            }
        }

        result
    }
}

#[cfg(test)]
mod tests {
    use super::super::BigInteger384;
    use super::*;

    #[test]
    fn test_anemoi_hash() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 10],
            vec![Felt::one(); 10],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![Felt::new(BigInteger384([
                0x476f5d845d64cb96,
                0x7aa9d563ff199540,
                0x46db23f44e04bd71,
                0x24380e11421305a4,
                0x3fd48cf97a02efce,
                0x00618663af27f174,
            ]))],
            vec![
                Felt::new(BigInteger384([
                    0x6359de80eefc88b7,
                    0x2fd0a372f874bd8f,
                    0x1ae67491cf447f1b,
                    0x5e8d672309ea76ee,
                    0xc36d3261f34a14ee,
                    0x01588648a1e05c2f,
                ])),
                Felt::new(BigInteger384([
                    0x2e318efb4619fe7a,
                    0xcdf6cc5e7966c2df,
                    0xe1ad18f6af2b201a,
                    0x639e270656da93bf,
                    0xa62a810a27fd46a5,
                    0x016149324f7029a7,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xd78fbfcbe413b68a,
                    0x8d99f962c8d5f824,
                    0xcfc69a3585c9c362,
                    0x4049927cfa4ee9ec,
                    0xfcb84218103d4b22,
                    0x002cf971210e7b3e,
                ])),
                Felt::new(BigInteger384([
                    0xa42077d5a1fd6dec,
                    0x0ef7d286b031bc3f,
                    0xb2896c24b51f9456,
                    0xa8d63101a906ffa3,
                    0x3bf7c9ae59850592,
                    0x011d0b44f0d4f26f,
                ])),
                Felt::new(BigInteger384([
                    0x9d2d00d19663a4db,
                    0x9977a66909e24d77,
                    0x0ff8d43ebad6abbb,
                    0xdfe28b9ac401d140,
                    0x1486a71e716022a1,
                    0x00f7f78a08b9aa6c,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x68ce6ceb9bc92888,
                    0xb11e9f4146ebbb8c,
                    0x32c388e800f92928,
                    0x840fc264f2015b6d,
                    0x18cb97512732e7a2,
                    0x013daad01cc135c2,
                ])),
                Felt::new(BigInteger384([
                    0x2964313b67b4ec91,
                    0x3fe60c2053a77ef3,
                    0x4630aa51defec665,
                    0xb338c79f0b65e131,
                    0x139c63f2e7c5f7ca,
                    0x007eaa1a2629eca9,
                ])),
                Felt::new(BigInteger384([
                    0x06854ef22075430c,
                    0xaefc0b7187af83e9,
                    0x66f824dd0059aa04,
                    0x99a9baddf895588e,
                    0x2b9e5bcb718612ce,
                    0x009077569062f54f,
                ])),
                Felt::new(BigInteger384([
                    0x192db24b63e106f2,
                    0x6c1f0afd57e1cee1,
                    0xf842b727947bc551,
                    0x2e3d5d8d693e53ec,
                    0xbdcf8842252ea21d,
                    0x0064015bdfc5ce1a,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x8d4df9870ddda78b,
                    0x62beb92731660c39,
                    0x7958416c0386bb13,
                    0x9b2148f0775ed8c3,
                    0x4b52870cf3d59793,
                    0x004c10cd9dde28b7,
                ])),
                Felt::new(BigInteger384([
                    0x4d6c0b7f1472777c,
                    0x846e8e44f18aa04f,
                    0xaa4c7635bfe6a174,
                    0x258978b6a7b1eac6,
                    0xe50127d2d70dc4f8,
                    0x00848a2678f803d8,
                ])),
                Felt::new(BigInteger384([
                    0x1cf8c0bec8b70d86,
                    0x2fcbecf99aecb5c2,
                    0xe9231529601fd784,
                    0x3812e98cfefc2d09,
                    0xae51ba707fb7d103,
                    0x0157da48b446453d,
                ])),
                Felt::new(BigInteger384([
                    0xcd15c2464fe8d08c,
                    0xb15c5ea92e9bf4a7,
                    0x1ca0548f620b0c05,
                    0x2654abfd6dbcc136,
                    0x19a52113615d8739,
                    0x01027362d57fe0ab,
                ])),
                Felt::new(BigInteger384([
                    0xaa11dadcb1863128,
                    0x91d32809caf19dd8,
                    0x1f3249e563a53a95,
                    0xb83dd401fd61fbce,
                    0x05b53b7ce7079103,
                    0x0118c815ce4111f2,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x2f56b9608291652f,
                    0x9a6426c1c635d4e6,
                    0xd0b2033c77b1c8bb,
                    0x02f881a825436069,
                    0xbbfe738aae45053e,
                    0x00d3be7ebe4662cb,
                ])),
                Felt::new(BigInteger384([
                    0x1a2238a326cf386b,
                    0x3044050f2920c8f8,
                    0x222c705d0c11d0b8,
                    0x297378044c8055ea,
                    0x5469220262b9b69d,
                    0x018a2b95370a5d66,
                ])),
                Felt::new(BigInteger384([
                    0xdfd4b58c26b17cc8,
                    0x4d9238dc5a2294a0,
                    0xdf574b8b80571107,
                    0xf065bbf645a411c7,
                    0x5de1e5f2f648aaac,
                    0x00c31aa3be975abc,
                ])),
                Felt::new(BigInteger384([
                    0x229dc3e1063dd08e,
                    0x7ec0763c5e3ebe0a,
                    0x4f0952ede8de8378,
                    0x610d93639882df1c,
                    0x4329768298b1fad1,
                    0x0049976f665c2cf9,
                ])),
                Felt::new(BigInteger384([
                    0xc30f5335d3135f98,
                    0xf6c90fd73ee7035f,
                    0x5c71ace5028b59cb,
                    0xfe6cd2f6ad398a8c,
                    0x4ae20da9f9abbc42,
                    0x01227623f6b16e9f,
                ])),
                Felt::new(BigInteger384([
                    0xbef453bf02a956f1,
                    0xecbf3e437b6bf450,
                    0xc2ad4deacd6099f3,
                    0xc02475260903fd47,
                    0x3c60232821d60013,
                    0x00c38ed2ce7158d8,
                ])),
            ],
        ];

        let output_data = [
            [Felt::new(BigInteger384([
                0x0e674254f00e11ec,
                0x8ccb0507b5ce073b,
                0xfd664e320f95b809,
                0x5a1cc6cf2cfbb46c,
                0x0bbe99d49880a91b,
                0x0171be445a83bc52,
            ]))],
            [Felt::new(BigInteger384([
                0x14e152b9a89cf8cc,
                0x8f8f90bf1248e5e1,
                0xc6b05612560c6a95,
                0x8e998899841d4b0e,
                0xa2b3c8fc5631d707,
                0x01255d78f6108e2a,
            ]))],
            [Felt::new(BigInteger384([
                0x415fb90b9732a199,
                0xc4e0492f0801d689,
                0x5f33831f78e04e9c,
                0x78956625f017244f,
                0xafd34fcfccf6c8e1,
                0x0020b8e990fa25b3,
            ]))],
            [Felt::new(BigInteger384([
                0x21205fdd9b91a437,
                0x5d3ee1c30963721b,
                0xee78f226e273adf9,
                0xd3195c2fbee56c49,
                0x5d859da26414d985,
                0x007c3b1cba72f6ff,
            ]))],
            [Felt::new(BigInteger384([
                0x5be226961b888f1f,
                0x5e3a69f20f7d46ee,
                0x93c11a55d5d99feb,
                0xf0903d2edf934d0b,
                0xf40cbbd39f06d264,
                0x0123ba3fbe8a4c8c,
            ]))],
            [Felt::new(BigInteger384([
                0xd0f8fccd737eb9dc,
                0xe4ee1c24afcafc63,
                0xb0bbcfd36dc74d16,
                0xe30162ca1ebc1f36,
                0x656a5643bdd945be,
                0x018f03dfb2a4d4f7,
            ]))],
            [Felt::new(BigInteger384([
                0xb3fdda6543c2696a,
                0xff52973fa31e0a25,
                0x6af452121ddbabc0,
                0x520eceba28a7650b,
                0xdbbe260b57f77b21,
                0x017ca9a80022885c,
            ]))],
            [Felt::new(BigInteger384([
                0xe0c9fd83a2e272ed,
                0xb6bc97e57fa44cd8,
                0x0c129f7682d69c8d,
                0x9be00eb9243a682f,
                0x60a7000cfccf0f99,
                0x0070144dd68b7e5e,
            ]))],
            [Felt::new(BigInteger384([
                0x505e4370fd9af245,
                0x09b67803c60179e4,
                0x09c5ddd937ce1432,
                0x7a878b27ceabbae9,
                0xb299a58c42591779,
                0x01209eb0a8905038,
            ]))],
            [Felt::new(BigInteger384([
                0x5e4fc841ba88dd9a,
                0x5ddf08442f84bc61,
                0xe357bbef6b3ea354,
                0xeafee44e7a689027,
                0xba40fb5e6dc35e27,
                0x008afe713808879b,
            ]))],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected, AnemoiHash::hash_field(input).to_elements());
        }
    }

    #[test]
    fn test_anemoi_jive() {
        // Generated from https://github.com/vesselinux/anemoi-hash/
        let input_data = [
            vec![Felt::zero(); 10],
            vec![Felt::one(); 10],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xd9a4b3f3c9e81925,
                    0x7aea1e55c08776eb,
                    0x2776536216db813e,
                    0x7239d7fef36dc1c2,
                    0x29e5e59e1722a430,
                    0x007bf7f629b0e532,
                ])),
                Felt::new(BigInteger384([
                    0x2334a8dbec2becbd,
                    0x639d6679d2eb457c,
                    0x20fe177314c3981a,
                    0x71c6aa80634fb5fc,
                    0xc8c25ca4601cb2a3,
                    0x0170989739150752,
                ])),
                Felt::new(BigInteger384([
                    0xe2c6c281640b5155,
                    0x74e149cda1279c59,
                    0xc74540c223cef8ef,
                    0x2c9b308329d9ccf9,
                    0x6cc3d2239cf940f5,
                    0x00ef3d07eed5c6b0,
                ])),
                Felt::new(BigInteger384([
                    0xf57c64a406aaf856,
                    0xeba3c8f7125f2701,
                    0x2560aa3c3cd07268,
                    0xbe48db1df346193b,
                    0x3cdf65042d30f7a9,
                    0x012384592b484303,
                ])),
                Felt::new(BigInteger384([
                    0x2804a1a3d88857fb,
                    0x2ae3a9ca5a3733aa,
                    0xf9b4459fc837c0ae,
                    0xbe6e3a041235e084,
                    0xcf461d4e461132a4,
                    0x01620792bf54bd38,
                ])),
                Felt::new(BigInteger384([
                    0x954e62d3ef7e8f4f,
                    0x12b2813039f39adc,
                    0x1a7a675131be99a7,
                    0xf4c15d4eba8cbfea,
                    0x8f4d2f101d315e1d,
                    0x013a97c18c94d436,
                ])),
                Felt::new(BigInteger384([
                    0x9fa30d4a01a2ee2a,
                    0x362a2aef74363692,
                    0x4707db49f97c2a65,
                    0xcfca93f9b305cd12,
                    0x3db44c741d41e125,
                    0x00be3a051ef1e74f,
                ])),
                Felt::new(BigInteger384([
                    0xebc48ad203e1e86c,
                    0x8c486e692fcb8070,
                    0x1966df855a966e0e,
                    0xed30bd6f06c6ddb4,
                    0xe3314779f40d47b2,
                    0x00a0b29d11e50bcc,
                ])),
                Felt::new(BigInteger384([
                    0xbc7293e850561406,
                    0x95f62cec2e59ffc0,
                    0x10f0e106090c32e1,
                    0x5f02a5d84b1ded3e,
                    0x54d6c1fd03e1b25c,
                    0x00e52f08a3fd22a8,
                ])),
                Felt::new(BigInteger384([
                    0x72668250d694e4e1,
                    0xf9b98070a626e9d0,
                    0x6c4620717df89a32,
                    0x4d03f7c1b8b7ac12,
                    0x9cccddccef924d1d,
                    0x0184c9233aab62c9,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x6421e662eee2fec9,
                    0x53c89ce5122e9abe,
                    0xb458aad7b1dcf9d9,
                    0xdbc436d553efa624,
                    0xeaba418b989e9449,
                    0x01041b0365346018,
                ])),
                Felt::new(BigInteger384([
                    0x9ee061ca2593ce8d,
                    0x22cd2fb5dbd645d6,
                    0x17ac69cd36a1d458,
                    0xcfbbf5b19a5b3630,
                    0xcfb9fa86917e31ff,
                    0x0086f4c686c52bb2,
                ])),
                Felt::new(BigInteger384([
                    0xd1493637c2b9758c,
                    0x3f9504f0fd08a054,
                    0xf70075bb389eb751,
                    0x0503e592da9adbd7,
                    0xfb20a94889ca289d,
                    0x003c35368d082aa9,
                ])),
                Felt::new(BigInteger384([
                    0x7fa30b3f86b0f289,
                    0x1fc9eac888babf1c,
                    0x779049a977e733f3,
                    0xd83c489b099e7cae,
                    0xf6a0bd9a6e138ff1,
                    0x00065c571ec96f53,
                ])),
                Felt::new(BigInteger384([
                    0xcf00d0601bc16dca,
                    0xdd38f79f7f2d9cc0,
                    0x9df60160b59e1f0c,
                    0x7bdd7ced08376578,
                    0x38a665efcfbbc950,
                    0x00a31d0a1536d201,
                ])),
                Felt::new(BigInteger384([
                    0xfecb71985e548b2a,
                    0xc103297f97e83f7d,
                    0x46764cef0237ce8f,
                    0x57aa66c444652f96,
                    0x102dcf4a4d314d22,
                    0x00c36fdbfee9408f,
                ])),
                Felt::new(BigInteger384([
                    0x1d662c63be9f1a42,
                    0x635c5f2a27abc512,
                    0x570fd8d1a7b50254,
                    0x073c4712f0b3593b,
                    0x3ea8ef71b5485988,
                    0x008f1942e58fc832,
                ])),
                Felt::new(BigInteger384([
                    0x562e9f9d47bbcbdd,
                    0x45905709616a4f23,
                    0xed247ea3643c2cfd,
                    0x79b39901fa8b6789,
                    0x466d8615257f3911,
                    0x0012130e9abbe459,
                ])),
                Felt::new(BigInteger384([
                    0xb9f5733f58443250,
                    0xc0b165fcc3d332b4,
                    0xafe891dacee42a3a,
                    0x4684dea1a562edd5,
                    0x4fb2be47feadc8e4,
                    0x00f69469ec5a453b,
                ])),
                Felt::new(BigInteger384([
                    0x1a1a2e95f18b456d,
                    0x2446074c794cf056,
                    0xfac9912f62944998,
                    0x9e12bfdbf31b0a6c,
                    0x09e52447e435bd80,
                    0x0096145ad8781eb2,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x2e4ba0efba1323cc,
                    0xca811a227d36cb0d,
                    0x6e5fc53013ddade6,
                    0x7e56eb56597c24d7,
                    0xefe5cec1dfcecb50,
                    0x00079109444334ec,
                ])),
                Felt::new(BigInteger384([
                    0x4490fb8d962c3497,
                    0x6c1240f900e78e7b,
                    0x9a51a44a3f1cb1a6,
                    0xaa3ff437888f7fc1,
                    0xb8d9ea6c6551ace7,
                    0x0169a1f8b9630167,
                ])),
                Felt::new(BigInteger384([
                    0x8af317bea52b52a1,
                    0x2e1eae413dfdffb4,
                    0xb2991b191f331355,
                    0x78fe73c80a57030c,
                    0x6f77427ab07534d7,
                    0x010a67c3871d5744,
                ])),
                Felt::new(BigInteger384([
                    0x147b70dabbc60d8a,
                    0xa7c7f6566f96582b,
                    0x2601e3df7d404eb1,
                    0x4669a860ca07b719,
                    0x563e41cb44c2769a,
                    0x016bb37ca38f4cd2,
                ])),
                Felt::new(BigInteger384([
                    0xbbe8c20fc48ffc6f,
                    0xc45d5108d1eb6e97,
                    0xe2a7f010dc380b3a,
                    0x805a083cbdec328a,
                    0xfe78ea15ac6ad6d9,
                    0x019a0b6155621560,
                ])),
                Felt::new(BigInteger384([
                    0xea7b584b41933f16,
                    0x2c9ef4b5a1d0457b,
                    0x9af0f1ef73b47a1c,
                    0x8e61990458025b60,
                    0xda296348d851a2af,
                    0x0017965c3df6d41c,
                ])),
                Felt::new(BigInteger384([
                    0x61e86c54c0938c80,
                    0xcde6cf4b182a7753,
                    0x4c2c3f999524f627,
                    0x3da2cce655613a4f,
                    0xc975eab63ec3871e,
                    0x0024ac378694835e,
                ])),
                Felt::new(BigInteger384([
                    0xbb02be5a778af3a3,
                    0xe7dfdd4803b68197,
                    0x9a88e3f1f4e8677f,
                    0xc7537e6662df7570,
                    0xeb373aab27f8e2dd,
                    0x013b4f95ac0e156a,
                ])),
                Felt::new(BigInteger384([
                    0x2869db06a09f247c,
                    0x05a7b9ebb4990833,
                    0xe2799bd075c99ca1,
                    0xc3c1bafacb8ac40c,
                    0x663bd5098e3566a5,
                    0x01ac890b34360362,
                ])),
                Felt::new(BigInteger384([
                    0xc437a62e8134746e,
                    0x7ec699acf0a94580,
                    0xe77b7d5084f0f9e8,
                    0xd5e8261d756a3dbf,
                    0x44045b81377af5b7,
                    0x0097d73da20784dc,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xc66457c936f31112,
                    0x41eba49e55af5e14,
                    0x54f634c2c8b64844,
                    0x980317dc410a496c,
                    0x0b508c78d0209693,
                    0x00c4b56dbf64410c,
                ])),
                Felt::new(BigInteger384([
                    0x6e6f44f63b4a6f7a,
                    0xab899f55026b50df,
                    0x3a638322fb104bf2,
                    0x8a21ff6367b2b77e,
                    0x54fb74b341607417,
                    0x015d842a0bbeafdb,
                ])),
                Felt::new(BigInteger384([
                    0xe487a56159f406e0,
                    0x6746ca35a5558254,
                    0x1455ec178799c6b5,
                    0xb790cc7c5fddb0b8,
                    0xc4209c5d87be3788,
                    0x00b6bdd2efab3838,
                ])),
                Felt::new(BigInteger384([
                    0x0c0e49ffb4f59d31,
                    0xb62d02eb88db0da7,
                    0xe18a37f3483167ad,
                    0xf8ee58b45a6158b3,
                    0x796b62a9fc7c03e9,
                    0x007f28d88ea00833,
                ])),
                Felt::new(BigInteger384([
                    0xed2bd567e091e74b,
                    0x0674e9634a2eee6a,
                    0x592137babfad3e4d,
                    0xadd0d860ed406d42,
                    0xd7b0edc3490587cf,
                    0x00bc67c33d55bb05,
                ])),
                Felt::new(BigInteger384([
                    0x28ffd34ca397d5a9,
                    0xebac1402b0fce56a,
                    0x018d6e0d5cf4da7d,
                    0x4b7638e2bb937598,
                    0x815c07f89513c2b0,
                    0x015cba717dc05712,
                ])),
                Felt::new(BigInteger384([
                    0x1b68bf655cdb1302,
                    0x1957f200c557795c,
                    0x77757c67e45f028b,
                    0xf4bf0bcf018c4455,
                    0xfd92d1792024ff6f,
                    0x0032c9f5e0b18be4,
                ])),
                Felt::new(BigInteger384([
                    0x397c696e0e082774,
                    0x71d711b10f710732,
                    0xd7ffb59900851a9e,
                    0xb49c40ea0c26a84e,
                    0x2d32dc8a76c869c3,
                    0x015de249f9323e2b,
                ])),
                Felt::new(BigInteger384([
                    0x3f45bec0a253654b,
                    0xecd2576ae087428b,
                    0xfec1026b88c52cbe,
                    0x310a4dabfcf04983,
                    0xf5249ff65949d9d6,
                    0x00c601afd4f422eb,
                ])),
                Felt::new(BigInteger384([
                    0xdfcaf5de51ffef65,
                    0xb2f7981d4950cc2e,
                    0x831d6e58d7777b86,
                    0x92433c0749379608,
                    0x4b5d6dbbc9f1428a,
                    0x011792c3f2fbfe31,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xfc1b39ba7d12dc15,
                    0xcdc757c83d348cfa,
                    0xc33d35c056a73fb4,
                    0xff8f55dc48714d4d,
                    0x2749dcd29019d567,
                    0x0114d35899f8cf2a,
                ])),
                Felt::new(BigInteger384([
                    0xa5cee8597db4c506,
                    0xf05ab8fc117f9c37,
                    0xa26c5a46ed3fa1ae,
                    0xdf2618c9cefa7872,
                    0xbc898c567bb1b4b3,
                    0x00dda954012ac2f0,
                ])),
                Felt::new(BigInteger384([
                    0x9e4ed720d673d4df,
                    0xc320624e1fc1f6a7,
                    0xafe3be7274598811,
                    0x52e8eae2b5028120,
                    0xd7c3dafe4e866f14,
                    0x00f35201f87f1726,
                ])),
                Felt::new(BigInteger384([
                    0x2ae8c1a25c9124cd,
                    0x5a649d067a569fca,
                    0x76f8c49f4647eb79,
                    0xa1188ef4f844e758,
                    0x6c648ced0607566a,
                    0x0011b7e81ab41086,
                ])),
                Felt::new(BigInteger384([
                    0x764dff05cf061d61,
                    0x220d68f9c6de75d5,
                    0x2470e8d4a8bbb734,
                    0x24091e91819f9eee,
                    0xb1933e4b51a28072,
                    0x015c2a7db0bd17af,
                ])),
                Felt::new(BigInteger384([
                    0x169a6f5ba638233c,
                    0xf0f6a5a163411290,
                    0x2a09515b0626ff15,
                    0x9a3e7cd1cf525cf4,
                    0x64a8fb335cd978ac,
                    0x00d5fca49e2f373c,
                ])),
                Felt::new(BigInteger384([
                    0x7fab12c83f56b714,
                    0x22efea75b3f8f775,
                    0xfb5a885fdb3f7028,
                    0x0c14789d10662900,
                    0xf5550b59c2a6af7e,
                    0x007b7283546ce39f,
                ])),
                Felt::new(BigInteger384([
                    0xbf2b2aa561b87cac,
                    0x002af8f8ee58f87d,
                    0x6687a3f592991441,
                    0x670273c1a87edbd3,
                    0x530afad6aec2440f,
                    0x00b1424dafe12533,
                ])),
                Felt::new(BigInteger384([
                    0x18ec8fe11e6341f1,
                    0x4f002c4ef8a95ed8,
                    0xf08c733ab8f75fb7,
                    0x25fb4915803a0a18,
                    0xc5924ad5da571113,
                    0x00ba365723c4f16b,
                ])),
                Felt::new(BigInteger384([
                    0xeaf291f1626579c3,
                    0x2fdcd0b690f6b708,
                    0xd1b6c96169a59a04,
                    0x83084b8f94735f35,
                    0xda3fefda268a0483,
                    0x01ab098fbd2b1c2c,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xca26cba29f9148ae,
                    0x36c61f6aebd392a7,
                    0x9d6415a18f629c6c,
                    0x62044cd1e2cc8dda,
                    0x589dab276430a160,
                    0x000d8f95d90b361a,
                ])),
                Felt::new(BigInteger384([
                    0x531bc3752188fbcc,
                    0x5fbc42f27e29f043,
                    0xb53b21376a81fba9,
                    0xa8fd2cb26108ee67,
                    0xe4487d03c422fe17,
                    0x0183763d68b38dde,
                ])),
                Felt::new(BigInteger384([
                    0x09a38b6134c18f72,
                    0xfbb189473e4b38b9,
                    0xb27cd8a2637878f1,
                    0x49e9d9d1cc97f5f8,
                    0xc5f1a7f3fe40ae49,
                    0x00d2d6e305d93274,
                ])),
                Felt::new(BigInteger384([
                    0xd8a694c7b34756be,
                    0x9b4e6d1d6eb7f6c1,
                    0xb90d353ebd34929c,
                    0x40cf83a987ed9bb5,
                    0x731cd8f4f218d847,
                    0x00bbda1b6b6de56b,
                ])),
                Felt::new(BigInteger384([
                    0x1cccbb4fabfa2359,
                    0xe6296206650d1111,
                    0x26a0080dea9315c2,
                    0x9b7edca8927bcb1e,
                    0xb2db5b36fe48e5f8,
                    0x00eaf124156d4d43,
                ])),
                Felt::new(BigInteger384([
                    0x00bb5d8320047163,
                    0x8cf8e7765adda1c8,
                    0xedd5e71ff9b86a7a,
                    0xed25f7aa846b0007,
                    0x1bef9950466f91a4,
                    0x009682ec7fc0bdb2,
                ])),
                Felt::new(BigInteger384([
                    0xed27826292590155,
                    0x9a2ab388e3f71f97,
                    0x02354d797e9e806f,
                    0x5549cd76fe86c1ce,
                    0xdca4ba558a5389ac,
                    0x00ea1b742deaf402,
                ])),
                Felt::new(BigInteger384([
                    0x69e9d37f03e4b991,
                    0x0efe02df914a1bab,
                    0x39d24f2bc9e265a8,
                    0x6eb3c409d0dae14c,
                    0x7ae69de70a1af150,
                    0x01abd467d9ce974f,
                ])),
                Felt::new(BigInteger384([
                    0x36987e758d0f9686,
                    0x050174dda0dee3bf,
                    0x91597f92d3697b23,
                    0x15f603622767f551,
                    0xc504b790ebe2ee6d,
                    0x008c58fed78145da,
                ])),
                Felt::new(BigInteger384([
                    0x13515eb1607ac536,
                    0x009ab9e11ea9cd50,
                    0xbc677bfe4c4f41ca,
                    0xd89225c916d1a3a5,
                    0xcf2617f476534fb7,
                    0x0153a84ec5bd0cb2,
                ])),
            ],
        ];

        let output_data = [
            [
                Felt::new(BigInteger384([
                    0x9c147636c58c2949,
                    0x5bc7827d50d42859,
                    0x176a9120acead12e,
                    0xf42306c36be320f9,
                    0xb39d9187976e342e,
                    0x01a22bd839a6840e,
                ])),
                Felt::new(BigInteger384([
                    0x4f3cafaa1d03395a,
                    0x3a420e9fc7760d1d,
                    0x9d9dbb6eb6695529,
                    0x2323312ba3b32a9e,
                    0x89a081b610c17e47,
                    0x003831ed98910dfb,
                ])),
                Felt::new(BigInteger384([
                    0x9a1d001da40d6458,
                    0x9eba8bf8304a0136,
                    0xfa34f99812dfa778,
                    0x8dc9d1c777c573c4,
                    0x6ac080ae24c69c9d,
                    0x01585cb41adb4643,
                ])),
                Felt::new(BigInteger384([
                    0x2ca4c62c21a7197f,
                    0x14cb847e2dc15e48,
                    0x61e3864e0464e2e0,
                    0xf2095f65a3ab1d10,
                    0x9cdad6bf714a0a39,
                    0x0149a08442776a84,
                ])),
                Felt::new(BigInteger384([
                    0xe83496649e3b4a78,
                    0x8bc54bf00b605353,
                    0x9e6b0cdbd2dcf271,
                    0xf8dc0c9ab363a10f,
                    0x8bc93f4f2598cfed,
                    0x018b4e96f0771a76,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xff2350e462dceb60,
                    0x7b5c25b109eda373,
                    0x1f5a38e8652a249d,
                    0x7bcb590dc7e15e1d,
                    0xd35a4d61c1573eb1,
                    0x019b88f612a10690,
                ])),
                Felt::new(BigInteger384([
                    0xe3c826a50d6d9cec,
                    0xd25abb6866a7a09e,
                    0xb7ff18781bdbba9a,
                    0x40d58681e96f0728,
                    0x6abf04ffd856c484,
                    0x00a665b5bbab8bd7,
                ])),
                Felt::new(BigInteger384([
                    0x556f7655da0238d4,
                    0x147abe0de49b6e4c,
                    0xd6dc5e631d146a95,
                    0xd7d541690787067e,
                    0xcfa20d8008e3823b,
                    0x0149891faed74370,
                ])),
                Felt::new(BigInteger384([
                    0xd8b941fcceaa4ab9,
                    0xc86ff7d75eac5ba8,
                    0x435d9e4f37489c80,
                    0x7274a8c8c473107c,
                    0xbf2cc76da0cef626,
                    0x00eaba7af792fa75,
                ])),
                Felt::new(BigInteger384([
                    0x477210ecfeb29ace,
                    0x602b3aa6f9c925b9,
                    0x271747f50e14c4c0,
                    0x12f2ee9e10c59b59,
                    0x44f3d7b3abb26693,
                    0x00eeb8d85a8ced7e,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdf692031ce537911,
                    0x73ecf573255d3e7f,
                    0xe38f060ff9104c19,
                    0x152d0ab49bc0b471,
                    0xd8324074bad42b22,
                    0x014facf31204d53b,
                ])),
                Felt::new(BigInteger384([
                    0x10d401e98ebe826e,
                    0x4bf699f019649a2c,
                    0xc9fd4937b546a628,
                    0xc79fcea8aa2ba304,
                    0x8d1e3d4b7eb16f35,
                    0x0193cd1d17357daf,
                ])),
                Felt::new(BigInteger384([
                    0xfe63f72cc20359fa,
                    0x42f9e6607d629e16,
                    0xd1846a57df51e746,
                    0xe333a1633d50af1a,
                    0x3812b3b224fe9dfb,
                    0x0019868caafcf980,
                ])),
                Felt::new(BigInteger384([
                    0x8f07c8ea1334c870,
                    0x460b09e740794c52,
                    0x607a705405979c62,
                    0xa0478810f2f0c752,
                    0x47655dfd8a63ca9c,
                    0x005838df127d4c6f,
                ])),
                Felt::new(BigInteger384([
                    0x00d2d428c1c6dd82,
                    0xd63314c716fc56ed,
                    0x6a940e612b0da448,
                    0xaaa5bda0e703b248,
                    0xb9a223c287bea7b1,
                    0x011039ce9a53aa0f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x111ea8a55914ae31,
                    0xd3f37d33e0a506b4,
                    0x100b375d7a84dd0a,
                    0xdb1ecd0f5730f5c0,
                    0xfa060c29ee0fd181,
                    0x00794b2f14d67844,
                ])),
                Felt::new(BigInteger384([
                    0x3da0deebe691d0c4,
                    0x2f75503b5027ed61,
                    0x63533c6c439f108e,
                    0xde7cbccb03cc4026,
                    0xd412757df1677362,
                    0x014f42f7ab6c4091,
                ])),
                Felt::new(BigInteger384([
                    0x531320fcdb007a64,
                    0xf600cf5efcc5638d,
                    0x9833cc3ce7ae6215,
                    0x0191b60332a45029,
                    0x0cdfb5d17cc7e537,
                    0x0114000ff8dd2d45,
                ])),
                Felt::new(BigInteger384([
                    0x683e3c60f953d6dd,
                    0xbf2c7e1c83bade58,
                    0xa637991adb40260f,
                    0x69908da018b122f4,
                    0xb200995b857c46ce,
                    0x00c5b11b08f71c89,
                ])),
                Felt::new(BigInteger384([
                    0xc7a46d4b0c3af47e,
                    0x407e314d54c6ce18,
                    0x25cf1eed8fe358ec,
                    0x48971c0a8c785df9,
                    0xcee3c7ed931d43dd,
                    0x00ee096e0877c5c8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xef2bb328596710a3,
                    0xaa13a63f811db07d,
                    0x9110c7ed3e878221,
                    0x37e24ce42410dd71,
                    0x4c05335b822d5aae,
                    0x017ada9295f14255,
                ])),
                Felt::new(BigInteger384([
                    0x2762384833c70261,
                    0x2380aa11e9e5e447,
                    0x85e81435e0b43827,
                    0xc9ba5c2801e066f2,
                    0x4515534beea42b38,
                    0x017b73355b1bdb90,
                ])),
                Felt::new(BigInteger384([
                    0x83b22d6ffe63bba1,
                    0x511056b6943a2dc4,
                    0xbf7ec93b028bdf06,
                    0xa1fe7d6197083bbc,
                    0x53561b5fee9cbbdf,
                    0x01611297a83cad88,
                ])),
                Felt::new(BigInteger384([
                    0x2b0e94c2289acde9,
                    0x813ca4f22af06219,
                    0xf6d1db1def00ebfa,
                    0xa32ff224b570071f,
                    0x3ac005575e5fcee6,
                    0x01093765ee01cf6e,
                ])),
                Felt::new(BigInteger384([
                    0xba9201b189fe2cd7,
                    0x55a7e827aae0a755,
                    0x33aa79107f5f3c70,
                    0xb6e25a671959e4a6,
                    0x752366b2fc5e92e0,
                    0x018ecd474fdf7404,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x8ee4ac49d6b521e2,
                    0xd457634eef4c36c5,
                    0xc93b6d59f0377ea6,
                    0xae518a8e3cfb32f9,
                    0x9d596ebfd18afe62,
                    0x00396cd0dfbb86b1,
                ])),
                Felt::new(BigInteger384([
                    0x01fe33edc7da6a23,
                    0x651dee4ce43c7c77,
                    0xd38cc4c961876c02,
                    0x72c6d1d6c0a6b899,
                    0x44c5a20819709e3a,
                    0x0198b8e809e50198,
                ])),
                Felt::new(BigInteger384([
                    0xca367c2e85053170,
                    0xcf7fbc3a24f1aa41,
                    0xbffd550eba409bd9,
                    0xd19d51a25402bedc,
                    0x67c67fd32477e6d2,
                    0x0069850b973716b5,
                ])),
                Felt::new(BigInteger384([
                    0x1a2e52a94d8073e7,
                    0xdb254f0f86e9807f,
                    0x75928cd23803ce90,
                    0x1afb106aa0559233,
                    0xc56fb4b18a3e0060,
                    0x019312749fd229ca,
                ])),
                Felt::new(BigInteger384([
                    0x38378660fe03a8a8,
                    0xbd225916e3b7a22d,
                    0x2e3fcc058f91f324,
                    0xf50b36ab0fc93064,
                    0x361e14fb46cf34ec,
                    0x003503e4709f4213,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2b1cd58abcab2737,
                    0xfdea6a068fcb8c72,
                    0x47fe34bb4feba8cd,
                    0x0565ec716586dabf,
                    0x6d662281d6bb00b2,
                    0x017666023a5d4a29,
                ])),
                Felt::new(BigInteger384([
                    0x13d0fe4ab9970b4c,
                    0x3c9c9dd9f87c9d9f,
                    0x78b17d2ce1036dfb,
                    0x3f84b4d240b8ccc6,
                    0xd3ff4dcad7cfd4bc,
                    0x019797bdf3de3bf7,
                ])),
                Felt::new(BigInteger384([
                    0xd0a9f03fcdaa6ca4,
                    0x038ddd14de21294c,
                    0x395e125c995aa59a,
                    0x0967085e64f73e7b,
                    0x11f72855a4a788bd,
                    0x013352c66a53df43,
                ])),
                Felt::new(BigInteger384([
                    0xb57e45a2e14355cc,
                    0x1dab57f82e47a77f,
                    0xc5acb072fd7375f7,
                    0x3e6391a8cee1171b,
                    0x043457273c080cd3,
                    0x01ac9e7202a28567,
                ])),
                Felt::new(BigInteger384([
                    0x3b88b4f95432c01d,
                    0xfee3bb8ad831457e,
                    0x88a6966cd8a8197e,
                    0x4f3d2e238c9b7203,
                    0x289d1e736c39caad,
                    0x00d744e273a4a0e4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xcc271fa3d5810bc2,
                    0x8ac303e42c64d503,
                    0x2bc7244e5b93a1f4,
                    0xc596c1eb4460b549,
                    0x8adae385f9e6c9a9,
                    0x0099199b37661bb1,
                ])),
                Felt::new(BigInteger384([
                    0xb1aff1ccfa793e21,
                    0x2b2759550f63612d,
                    0x594a94179ea71a14,
                    0xc1aacd2eec535aaa,
                    0x0888ab3c0e763073,
                    0x01a389c7f27667e0,
                ])),
                Felt::new(BigInteger384([
                    0xafd74c84bd5176e8,
                    0xa4b8f5f59133ac96,
                    0xc2d15b1e82a0b447,
                    0xe970963d1cb3b034,
                    0x4af2f879700c8543,
                    0x007363655098671b,
                ])),
                Felt::new(BigInteger384([
                    0xbd35159afba79af2,
                    0x5856c12950225725,
                    0xcb668fbfee18ba23,
                    0x7e1135e0702381b9,
                    0xcbead73abb2ad903,
                    0x00110e5e92f454dd,
                ])),
                Felt::new(BigInteger384([
                    0xbd60c467865a75a9,
                    0xec633caab8ccd6e5,
                    0xfbca8977d8aeb0da,
                    0x447be17bfcfaa970,
                    0xebb5ffaf4d2a9fd2,
                    0x001bbe9788f7040b,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x795692704bc46f0f,
                    0x8e107cdfc2e7fd2f,
                    0x8488bc4b59dd1032,
                    0x9413a670925ab553,
                    0x2c16c29cd73e58b8,
                    0x012b08cd9c3d620a,
                ])),
                Felt::new(BigInteger384([
                    0x9a3764a47ef5ed7d,
                    0x112303fdcebe3494,
                    0x4e61c785cbc267a4,
                    0xbb5f7ecce5bdad23,
                    0x18256ded8c777660,
                    0x0120d9f1ca57a3a6,
                ])),
                Felt::new(BigInteger384([
                    0xd608cf43b5546335,
                    0x96e78c634f185d13,
                    0x1a14fe5c48d819b2,
                    0x04a6087cc4e8daa4,
                    0xea79513f3540379a,
                    0x010b84cd315fe4a5,
                ])),
                Felt::new(BigInteger384([
                    0xc18bebea0f3edf15,
                    0xdd5d5083c6c1b43b,
                    0x6a97c0fd54172074,
                    0x186f4d32928ee455,
                    0x433239dde696199a,
                    0x003b164624b16a8a,
                ])),
                Felt::new(BigInteger384([
                    0xc2806251d4a2dd87,
                    0x12ff29f55be54eb4,
                    0x3753535f630872e0,
                    0x810f705596813596,
                    0xc047db62e8d020be,
                    0x000773a9ea226ed4,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x873ee496f66cb90c,
                    0x7e0ad91622ff5c6a,
                    0xeab67ade998be511,
                    0x38be7579a5a841a6,
                    0x7b3eb89a726ba696,
                    0x0007976a2cf09bce,
                ])),
                Felt::new(BigInteger384([
                    0xbf9c7d7e2e1ca3ee,
                    0xaa52ac604e531e04,
                    0x84cf0dc7d1c1fd6c,
                    0x12aea7cd07155b76,
                    0xbe7dd3f7de8177dc,
                    0x00910d3102dbb1d3,
                ])),
                Felt::new(BigInteger384([
                    0x981869a9b98e9df2,
                    0xaab22141c100e944,
                    0x5600d3cc613dc87c,
                    0xbd822489178b6fac,
                    0x60063c052c78cd6b,
                    0x019b95fd974ff40d,
                ])),
                Felt::new(BigInteger384([
                    0x7416ec5d79c7bd08,
                    0x47736803d2be4bf6,
                    0x6a875d6d798c3cd6,
                    0x03989b0d71488b27,
                    0xae9f1afc39108c6d,
                    0x009b65c44cfddc08,
                ])),
                Felt::new(BigInteger384([
                    0x69f7f626df174fb6,
                    0xc442156e38d7526c,
                    0x6ae77fc209847782,
                    0xb5c4210d8438891d,
                    0x23e0daef5394d1ee,
                    0x0136c08c1ca1643f,
                ])),
            ],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress(input));
        }

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 2));
        }

        let input_data = [
            vec![Felt::zero(); 10],
            vec![Felt::one(); 10],
            vec![
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            vec![
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x11e3d52b49d41dec,
                    0x45774316dbc8645b,
                    0x3e7916531972cfd6,
                    0x9c027f9775f8fed2,
                    0x8d3a620966a6d495,
                    0x00b44e089defbad7,
                ])),
                Felt::new(BigInteger384([
                    0x4fa69c688510e19c,
                    0x49ee84151048ee1b,
                    0x6e7f6625cfc655a0,
                    0xeba7a4e533bc66ea,
                    0xdbae88ae27c1aa4d,
                    0x00977a41fa306806,
                ])),
                Felt::new(BigInteger384([
                    0x208cc3c1fbd9fd1a,
                    0x9b8bd5d1f6195fd6,
                    0xae483d84f5687869,
                    0xaa9055602f4a8443,
                    0x819e71e5a3941ef6,
                    0x0080d20c45015316,
                ])),
                Felt::new(BigInteger384([
                    0x2afdc46448a5dc7d,
                    0x28b4cbdd597492a3,
                    0x2f20f3e03ad99b79,
                    0x408af9f71bb6fbbe,
                    0xba1e0f125e4aa527,
                    0x0198d14a99cf0c2f,
                ])),
                Felt::new(BigInteger384([
                    0x3d68dc8b2110c37d,
                    0x8a65926617f464b8,
                    0xc45db950b94d14c6,
                    0x62ff2e5820ae97ec,
                    0x99b8a33b9ee671c2,
                    0x007f2b375baaf218,
                ])),
                Felt::new(BigInteger384([
                    0x91d13736038f642c,
                    0x94b9d8716f7d2713,
                    0x97fd2b496a759c70,
                    0xdc051cd22c276d89,
                    0x1729ef9851732bca,
                    0x00260f7fa3ed08da,
                ])),
                Felt::new(BigInteger384([
                    0x554737e315a08e68,
                    0x16a3da898fb99c4b,
                    0x17434b8629094492,
                    0xbf793514d3e3e7ff,
                    0x720f1fb6793fa1e5,
                    0x00c29b6bd8473c06,
                ])),
                Felt::new(BigInteger384([
                    0x813bb0893bbae0b4,
                    0xea63dab4e0e54383,
                    0x89afab738964aaab,
                    0x605bb0d2d6fc6b72,
                    0x1e45424099cc78de,
                    0x012749e1cd716eb5,
                ])),
                Felt::new(BigInteger384([
                    0x2d7d27fde31f8bff,
                    0x900ac21237f78889,
                    0x3d2b71fb54250fdf,
                    0x95d307e6d7560501,
                    0xb8b6696f12f89119,
                    0x00dd905b83088392,
                ])),
                Felt::new(BigInteger384([
                    0xcad3116f46ce3130,
                    0xa2c057055caadf0d,
                    0xd98c72746d36cec3,
                    0xdcd3a40b2637ecd7,
                    0x12d29ad9750bfd00,
                    0x0137d8c92d32580a,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xe3ed471219223679,
                    0x218abe7249e2da1c,
                    0x437cdde8bcb2ea52,
                    0x4e657830bf2f517a,
                    0x33c10730f6201b75,
                    0x01718f01a5c6e0f1,
                ])),
                Felt::new(BigInteger384([
                    0xdeec35d55dcdc913,
                    0x70309615f0396cfe,
                    0x989a294483e9607d,
                    0xea02fd00e9270d8f,
                    0x21e14dffefcfc60a,
                    0x000b6300d51dd1a7,
                ])),
                Felt::new(BigInteger384([
                    0x8c68ecdf507e8cca,
                    0x0b03ca40f42b401a,
                    0x443b6b1e8e835bfd,
                    0x2b908398daebb8f9,
                    0x39eba48a2e8a2e01,
                    0x00df99fe67d026e9,
                ])),
                Felt::new(BigInteger384([
                    0x103b6bd0aa30c61a,
                    0xce20486c10124f88,
                    0xfe829b5f77c653a2,
                    0x3bec2b911824985f,
                    0xa0e608358e1c2a83,
                    0x003c2a4101436391,
                ])),
                Felt::new(BigInteger384([
                    0x4a0e3902c57be88c,
                    0x8f6005a8d4aa769e,
                    0x357389d506627874,
                    0xfca2c4b0b649c6a6,
                    0x49abcb6d7eeee0d1,
                    0x01601861900a073f,
                ])),
                Felt::new(BigInteger384([
                    0x2920159da4432be5,
                    0x82064bc911824524,
                    0x8c5dea1aa901b135,
                    0xa2581d9ccb4187d1,
                    0x4312cfdbccf82007,
                    0x011c8670d961ba3e,
                ])),
                Felt::new(BigInteger384([
                    0xd56de78495095e4b,
                    0x7eecba9cbdebd43a,
                    0x4cb4edad18302b90,
                    0x50f0bacc3fa60df6,
                    0x322747b1bb80bb4b,
                    0x0064933e6987a5f0,
                ])),
                Felt::new(BigInteger384([
                    0x19429aaf66cc1c69,
                    0xd97fec72fbdeaeb7,
                    0xab1be964096df4d6,
                    0xbe904bd7053e302f,
                    0x95cc6a01856106d4,
                    0x0080896b668a8bcb,
                ])),
                Felt::new(BigInteger384([
                    0x6fb998297db5b4ca,
                    0xe94d96bed94a17e6,
                    0x27f16b020a94862b,
                    0x5a4e2cdb45770088,
                    0xa80bd111d02f9c4a,
                    0x018d9b03109cd7ff,
                ])),
                Felt::new(BigInteger384([
                    0x81b3e79d7c630a37,
                    0x83d4ae8e42b9dbcd,
                    0xca68d7848d55ec95,
                    0x7b6fbe84d6c34407,
                    0x8e40fdccddffdb28,
                    0x0110e1a288f14796,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x445f3d099d06c0b4,
                    0xb7b27b69dff804be,
                    0xe016f9565fa42e22,
                    0x797fbfe882862b5c,
                    0xfeb98b670532562b,
                    0x01191d01d6c58d18,
                ])),
                Felt::new(BigInteger384([
                    0x71593d182a03812a,
                    0xa7af90c262fbbfe9,
                    0x15511cbabc4f1a94,
                    0x54a6cfe6ff6df9e5,
                    0xc7d398e8e540c24f,
                    0x009339a358d887d5,
                ])),
                Felt::new(BigInteger384([
                    0x164e84cd0d407d50,
                    0xdafb8bc0101936a6,
                    0x280c5434da72c9b2,
                    0xa1868de332ffcc50,
                    0x545a110842d50f76,
                    0x0184be6d1a141e2c,
                ])),
                Felt::new(BigInteger384([
                    0x40b25339df71e0d3,
                    0x6379d3c06af8c510,
                    0xb450e763464d9dc6,
                    0x90f92255713c85bd,
                    0xea18f3318be853aa,
                    0x0040ab49fffd12f2,
                ])),
                Felt::new(BigInteger384([
                    0x8257b36f492b0f58,
                    0x5bab292d8acdd89e,
                    0x65a14168123befb3,
                    0xac85617dc6a6a6dd,
                    0x3f2a78a1120f6a22,
                    0x018c0c0d74b0a90d,
                ])),
                Felt::new(BigInteger384([
                    0xa5bd79c805925996,
                    0x7142e08789ee633c,
                    0x050471b3d8951e03,
                    0xcf8e8e096e81a330,
                    0x8c6826f0c8a27ccb,
                    0x00aad003de961d3c,
                ])),
                Felt::new(BigInteger384([
                    0x34ccf6647bda4f57,
                    0x36632285c06bb986,
                    0xfc5e585d43d84299,
                    0xb5502bac94c54b02,
                    0xd3596009a77117c6,
                    0x017330333a4f1511,
                ])),
                Felt::new(BigInteger384([
                    0xc3551c1f0c7a8a75,
                    0x68dfb1a1287e3deb,
                    0xebd1ff1ddad982d8,
                    0x6e850e2ffb7b0b1c,
                    0x5644697d0983292b,
                    0x00bed1ffe55ce6ed,
                ])),
                Felt::new(BigInteger384([
                    0xac1be562943a7cd6,
                    0xc08f1f144cf6fbe1,
                    0x0fd8b04efdf9fff1,
                    0xa88080ba76724178,
                    0x8a9a5c6ec07f676d,
                    0x004b882d789358f1,
                ])),
                Felt::new(BigInteger384([
                    0xa7a13c984999b45c,
                    0xfe2ea7b25517c251,
                    0x834bbdf8f0f8fa4f,
                    0x6497af27c851401a,
                    0xc7bfa1900a736a2d,
                    0x01894e8b7be80804,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0x9af28e1f5054929f,
                    0x78162ec10944979b,
                    0x2be24c0be17bb4d3,
                    0x98ce80537e0929a6,
                    0x7092fc6da4afa508,
                    0x00da005dd7160b8a,
                ])),
                Felt::new(BigInteger384([
                    0x04f4f3dcae8d85f6,
                    0x46709ce529b0c208,
                    0x6fb50f9804aa2a9a,
                    0xbc3602448d5fd9b0,
                    0x56b7fba69f2a6c53,
                    0x01a18fa28a74e7a6,
                ])),
                Felt::new(BigInteger384([
                    0x3d3a162f733876ec,
                    0x3f5d300ed9809885,
                    0xda9023c372925ab8,
                    0xfab255ccf4c3d6f4,
                    0xe3304b71708472df,
                    0x0122b1217381a77a,
                ])),
                Felt::new(BigInteger384([
                    0x6adc12fad553fdad,
                    0x3be1769eaa519da8,
                    0xd09308e581523098,
                    0x6ea570c99693bc88,
                    0xfc8daa42f658b003,
                    0x003cf6c6cd72c340,
                ])),
                Felt::new(BigInteger384([
                    0xf25067e5b93cfb3d,
                    0x7ce69d2aa04bd9e2,
                    0xa7016c7bcb2e79d1,
                    0x4419dd426b83b278,
                    0xc27db0b4cce1a474,
                    0x00d7cde4cc674c2e,
                ])),
                Felt::new(BigInteger384([
                    0xd77fb8b44b1a253a,
                    0x1b91d0cf20190dc5,
                    0x8679153685a3a7b9,
                    0xd3227d8cf8a6bd97,
                    0xb95cbc9dcc5923eb,
                    0x014c336eb6a821bf,
                ])),
                Felt::new(BigInteger384([
                    0x2cc3c3ba736e42db,
                    0xe25c53e2cf10a04c,
                    0x37efae620606853f,
                    0xc14ba232f3e8cfc4,
                    0xecc34218bdafdd48,
                    0x00d1960eaa8beebc,
                ])),
                Felt::new(BigInteger384([
                    0x9a733b0037191b6e,
                    0xa86b3b30ad60e858,
                    0xf5acd6c9d3454f4f,
                    0xa6dcb9a0879971cc,
                    0x8073082b84900e49,
                    0x014fe7f7ae67178a,
                ])),
                Felt::new(BigInteger384([
                    0x83cebc0218f617e4,
                    0xf9e8e2cc38201f3e,
                    0x13d8cac9fbb2e9b2,
                    0x2150112af6f7eb39,
                    0xfa770daf6d12de16,
                    0x0191403b7e8680ab,
                ])),
                Felt::new(BigInteger384([
                    0x34de15720ca50652,
                    0x5a784e0003d96773,
                    0x418e8d4518de5deb,
                    0x7b212eb266cea27b,
                    0x24c994bde455efa8,
                    0x0117a4c58c4f94c0,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xd86a9c6c476c654b,
                    0xcafb392f55b4266b,
                    0xd06ae464ed4a86b4,
                    0x1691cabb720fdae9,
                    0x36a20d43615a5ad4,
                    0x0072465f530121dc,
                ])),
                Felt::new(BigInteger384([
                    0xc4bcba30fc29ae10,
                    0x4185903442f2e154,
                    0xbec47b1359270d99,
                    0x8184e76599e0e33e,
                    0x7f5ed52f1e494413,
                    0x015dfde140014538,
                ])),
                Felt::new(BigInteger384([
                    0xc42a8dd99e485117,
                    0xc2534a8685205ddb,
                    0x3ec3d683f08f64ca,
                    0xfc32c7407c022842,
                    0x6000f3d117c7faa5,
                    0x0091604392bc7a9a,
                ])),
                Felt::new(BigInteger384([
                    0x5f55f574ac6d5b2b,
                    0x669d0977a4b15886,
                    0x0be40b3381b31628,
                    0x480a92ecca256ff5,
                    0xe04e89bb49bd9c82,
                    0x0182d70332a948f0,
                ])),
                Felt::new(BigInteger384([
                    0x1c82e9f484f0af1f,
                    0xc0519a1ef3e838c4,
                    0xd0f0677aee6d0d4d,
                    0xcb9611e51e2e3088,
                    0xc3c435416c9016cf,
                    0x0150398c561d6b2c,
                ])),
                Felt::new(BigInteger384([
                    0xa8a40c73352b60d8,
                    0x472a21b8b8937fa5,
                    0x10994ce5f7f5434a,
                    0x5ab076db8de2183c,
                    0x01370463f1df400f,
                    0x006d583965a50e8e,
                ])),
                Felt::new(BigInteger384([
                    0x225d7a631fc3b148,
                    0x00b6963ec5f5e0b3,
                    0xc7bdf6b8f31cf0e9,
                    0x6c011af38f9f6717,
                    0x7cd5a1563f2a4054,
                    0x0001f26eaffa7269,
                ])),
                Felt::new(BigInteger384([
                    0xea257311e953706e,
                    0xc7164a40049e817d,
                    0x6ebbfbd0d5f00e0c,
                    0xcd15cf805341aaf9,
                    0xe358d8a4080cf2a2,
                    0x00ba7666eff6fdfe,
                ])),
                Felt::new(BigInteger384([
                    0xa33210697b389b57,
                    0x1e333daea6530a6f,
                    0xb8a2c11b59094a14,
                    0x0af89baabe6c979e,
                    0xe83473985729e9ca,
                    0x0197275d38e3a157,
                ])),
                Felt::new(BigInteger384([
                    0x977395ec5ef72815,
                    0x35983bd4da5fee4e,
                    0xccc5a18ab6942270,
                    0x254053ad1329ddc3,
                    0x44c9e6c555fb659a,
                    0x002b93d98a91c43f,
                ])),
            ],
            vec![
                Felt::new(BigInteger384([
                    0xca4d3d3b64cb2263,
                    0xd7f81507eded68f2,
                    0xedc66ad9b6d0a3eb,
                    0x00562de8288486a4,
                    0x2e0896279a91c27b,
                    0x00a45549a6857f2e,
                ])),
                Felt::new(BigInteger384([
                    0x2c959e8af638cbcb,
                    0x3c64d5c47f3e33fd,
                    0x064861f498da39aa,
                    0x0332b49dc75d518f,
                    0x94435e8c60709675,
                    0x0154df1f82b78293,
                ])),
                Felt::new(BigInteger384([
                    0x1bf60cbc2873c921,
                    0x0b3549e0cfa69a00,
                    0x4b56a1ca186a1a8a,
                    0x8a47042b9fa185fa,
                    0xb247f80684601a6a,
                    0x0089d9c13752c7f5,
                ])),
                Felt::new(BigInteger384([
                    0x34f8ef89ff827524,
                    0x5d492990da677f60,
                    0x746bf06bd0db1a17,
                    0x7f4b9eb1f04d4512,
                    0x180658d634da8b2b,
                    0x012c9af078c90302,
                ])),
                Felt::new(BigInteger384([
                    0x01b77550a3df227f,
                    0x1231d27977c83936,
                    0xd505e727508989ed,
                    0x5d120781a683952b,
                    0x1c0e1ffc35175278,
                    0x011aa16c271edac9,
                ])),
                Felt::new(BigInteger384([
                    0xb15f59fe69bb12c9,
                    0xedce62de9ce6d959,
                    0xa3722ebb5e2d4ed1,
                    0xe1e56c67262e9ec5,
                    0x0621b6b1f27e2ceb,
                    0x00612ab0c758280b,
                ])),
                Felt::new(BigInteger384([
                    0x04076c978f52cc06,
                    0x382c5c5e8bff2720,
                    0x12007a35980e2c0e,
                    0x45f75f3bc474c07b,
                    0x3f6f755680c15f97,
                    0x011f4f23f7bb0507,
                ])),
                Felt::new(BigInteger384([
                    0xb4cabd336b38c7ca,
                    0x90f41247f1654ca6,
                    0x83af53c5ea4f68e8,
                    0x747f21090e6ea49d,
                    0x684e12a4606fe65c,
                    0x00ba24fb41ed4564,
                ])),
                Felt::new(BigInteger384([
                    0x19684f56562e8948,
                    0xb880da0acedd13cb,
                    0xa373b3ee3b126fd7,
                    0xab9d41f273176a11,
                    0x28d372de16029263,
                    0x0130e99d58d41772,
                ])),
                Felt::new(BigInteger384([
                    0x951a15bced242d45,
                    0x0539cde486107a99,
                    0xe753eefa35690f1c,
                    0xccda0bdca83c90f8,
                    0xad4a577ee294cef9,
                    0x00c4a275d47a5c0a,
                ])),
            ],
        ];

        let output_data = [
            [Felt::new(BigInteger384([
                0x0b2d428f467f2aef,
                0x9032d5b6f1b5e848,
                0x52b1b2c21f59cb21,
                0x418ce7dddb8b42cf,
                0x7df198b91df54d8a,
                0x00fcfac2d8b22a88,
            ]))],
            [Felt::new(BigInteger384([
                0xc96c00c917a9a6a4,
                0x45aab9d91da633bf,
                0xbbd06f78b55bd30e,
                0xcb752a868b30dcec,
                0xbf2aedc1a92f0679,
                0x005a3c4c87f48b0c,
            ]))],
            [Felt::new(BigInteger384([
                0x746a365af410fb69,
                0xf104d9e9b39a1a01,
                0x0c3873f54a3b8a32,
                0xd6a80c8c5b47590e,
                0x11f4a7b19764182b,
                0x0108febe517e2115,
            ]))],
            [Felt::new(BigInteger384([
                0xc7a3d23a2035c4b2,
                0xcafd91afa6140412,
                0x99b233af9ce33eaa,
                0x390f35a230e0dfdf,
                0xcf668d419b962251,
                0x0133d4339b04a698,
            ]))],
            [Felt::new(BigInteger384([
                0xf1354496eed74d9f,
                0xcc39ab4b5a1fbc9f,
                0x5b69e4f403df3bc5,
                0x201552ef9fd85972,
                0xf5e197a244467228,
                0x018f166fc5ed213c,
            ]))],
            [Felt::new(BigInteger384([
                0x0c56fdd28f75d0b9,
                0x07d876b9f7786667,
                0x689e0397265e0e88,
                0xaf2c12926a94b7c9,
                0x421f2448b2e4dd70,
                0x007425db2a62b02b,
            ]))],
            [Felt::new(BigInteger384([
                0x87be28c1985d79a8,
                0x1abb76515ebde0f7,
                0xb978ed42395a4695,
                0x8fc69cc339df1746,
                0x7c065f6690dfe5c9,
                0x014857559cb98200,
            ]))],
            [Felt::new(BigInteger384([
                0xffcf616e4b701a0c,
                0xed1b9d80c7029e10,
                0xf5964a1c004914d3,
                0xcf9af6f14f15729e,
                0x2bd043879522fe92,
                0x00a24a4449e9e0fe,
            ]))],
            [Felt::new(BigInteger384([
                0x1f570e5088992c71,
                0xe35324220d7185e9,
                0xa35dd3c2cd4d18d7,
                0x17f2e6b7523681f0,
                0x36c50d2a35aca8f5,
                0x009b30d1e02f0ceb,
            ]))],
            [Felt::new(BigInteger384([
                0x1e4c7636dcbfe4e6,
                0x979d0da1a62868c9,
                0x53fa0bd3da571ec5,
                0x3763058edea525b8,
                0x98f8ea62a8676789,
                0x005f12b492b75dc6,
            ]))],
        ];

        for (input, expected) in input_data.iter().zip(output_data) {
            assert_eq!(expected.to_vec(), AnemoiHash::compress_k(input, 10));
        }
    }
}
