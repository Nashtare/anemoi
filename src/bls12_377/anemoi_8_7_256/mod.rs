use super::{sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 8 field elements or 384 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 8;
/// 7 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 7;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 4;

/// 2 elements (96-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 14 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 14;

// HELPER FUNCTIONS
// ================================================================================================

/// The field multiplicative generator: G = 15
const G: Felt = Felt::new(BigInteger384([
    0x15eefffffffff714,
    0x669be3a3bffffb5d,
    0xdc8ffe3035319f32,
    0xd10f7bf375757f17,
    0x6968af36d106a4b2,
    0x019016a3edcd115f,
]));

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2.double().double().double().double() - y2;
        *t -= beta_y2
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2.double().double().double().double() - y2;
        *t += beta_y2 + sbox::DELTA
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3]];
    let y: [Felt; NUM_COLUMNS] = [state[5], state[6], state[7], state[4]];

    let g_x0 = G * x[0];
    let g_x1 = G * x[1];
    let g_x2 = G * x[2];
    let g_x3 = G * x[3];
    let g_squared_x0 = G * g_x0;
    let g_squared_x1 = G * g_x1;

    state[0] = x[0] + x[1] + g_x1 + g_x2 + g_x3;
    state[2] = g_squared_x0 + g_squared_x1 + x[2] + x[3] + g_x3;
    state[1] = state[2] + g_x1 + g_x2 + g_x3;
    state[3] = state[0] + g_x0 + g_x1 + x[3];

    let g_y0 = G * y[0];
    let g_y1 = G * y[1];
    let g_y2 = G * y[2];
    let g_y3 = G * y[3];
    let g_squared_y0 = G * g_y0;
    let g_squared_y1 = G * g_y1;

    state[4] = y[0] + y[1] + g_y1 + g_y2 + g_y3;
    state[6] = g_squared_y0 + g_squared_y1 + y[2] + y[3] + g_y3;
    state[5] = state[6] + g_y1 + g_y2 + g_y3;
    state[7] = state[4] + g_y0 + g_y1 + y[3];
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 8],
            [Felt::one(); 8],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x8b730b66413449b4,
                    0x8f7d83c66997e016,
                    0x60c731a748800c46,
                    0xe02fa4976a4f167e,
                    0x8dfe7f1ffe12d095,
                    0x0177410a21b45f42,
                ])),
                Felt::new(BigInteger384([
                    0x3f948164b71514cb,
                    0x6b4ff27b83d2fbff,
                    0x9b393d0169217ef4,
                    0x39ae8bb0abb868dd,
                    0x0c04c6a3a98d52d3,
                    0x00dbb2333e4bff21,
                ])),
                Felt::new(BigInteger384([
                    0x87327147f1987469,
                    0xa03e2717b0ef7ef4,
                    0x05758c5785659384,
                    0x8c1081f087740be5,
                    0xfe1b269c1defd5f6,
                    0x00a60b7e2574d023,
                ])),
                Felt::new(BigInteger384([
                    0xd60a906cf4783973,
                    0x027c2dbf6542e924,
                    0xe854ed9ad1cccf00,
                    0x70b9ba5093a04408,
                    0xa6844d7fbf373c24,
                    0x0181c3ef8e079597,
                ])),
                Felt::new(BigInteger384([
                    0x8e5a2cc478749bdc,
                    0x8eb3e6c6acca4669,
                    0x0ec5ea62a9e88401,
                    0x8bff349972d0a726,
                    0x7bbebbca317d75b6,
                    0x009f692ef321c94e,
                ])),
                Felt::new(BigInteger384([
                    0x707fab2b8746d536,
                    0x89424bf8976f0d5f,
                    0xb01c90f268a17095,
                    0xec65730e9911520c,
                    0xb49f4085c5a45260,
                    0x00478d25512b44e3,
                ])),
                Felt::new(BigInteger384([
                    0x0c2f88bea9661ed4,
                    0x10fd0d1c5098478b,
                    0x03cd290da269236a,
                    0x48ccb3a73aee6e53,
                    0xb287cd3db642f119,
                    0x0148a3ab2485c597,
                ])),
                Felt::new(BigInteger384([
                    0x325ae60906bb3744,
                    0xf19bc11dde17d2bc,
                    0x7acb6a48d741fbb8,
                    0x9a2fa2f6b7bcc8c6,
                    0xdd4563f0190664bc,
                    0x0003767230766633,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5c17f0c0f74b4ef7,
                    0xf449a72fae4e9b44,
                    0xd64603c96b62ee1d,
                    0xd22bc565e4110edc,
                    0x8ea91c4bfed3714b,
                    0x019b594a3ed67d4f,
                ])),
                Felt::new(BigInteger384([
                    0x65a5085c6787f04b,
                    0xd820bf9fc6974f63,
                    0x7e7f29993102cf22,
                    0x1df9ffe9911faed9,
                    0x09cc39b18498a3a0,
                    0x01923b7f8e3dc73c,
                ])),
                Felt::new(BigInteger384([
                    0x1837413461ab771e,
                    0x97f704d68e58c956,
                    0xe58efb3e1fc9964f,
                    0xe5e4c95838dd0e94,
                    0x39d7d5adddcd5545,
                    0x011a4687901de353,
                ])),
                Felt::new(BigInteger384([
                    0x3328d28b69d0221e,
                    0xa610f3da7007c807,
                    0x10f525f373155c99,
                    0xaca4cc377a51d9e2,
                    0xfded3d9ee98ac5eb,
                    0x0067a22ceec83a6f,
                ])),
                Felt::new(BigInteger384([
                    0xf79ef487b13a3555,
                    0xf58c35fafdeb1bb5,
                    0x83f90eeb9ea98c33,
                    0x5a46db7c336d56ff,
                    0x7d148ea7745e598c,
                    0x00ae8a89f78a8dd8,
                ])),
                Felt::new(BigInteger384([
                    0x9d411bfb17e084b8,
                    0x9f4bd9b4ccf43f26,
                    0xbede7f4e041a6a87,
                    0x4ba51530d95bdb9f,
                    0x3694f45ffd2c843e,
                    0x01acaac876cbf68f,
                ])),
                Felt::new(BigInteger384([
                    0x93251dbba977ed1c,
                    0xb956e95e4d8a182e,
                    0xd2e29154184ba711,
                    0x44fdb6aed1865214,
                    0x691861b1244609df,
                    0x00b3958d9749e7f6,
                ])),
                Felt::new(BigInteger384([
                    0x0c1818bc058bfcfb,
                    0x67a17a2565c59aff,
                    0xd3e8bf9fd7654831,
                    0xdf2bc6acc7709489,
                    0x994658acb8c6eb36,
                    0x00b36590786cc076,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1d5633a0a89ffc36,
                    0x280a02dadb3745e0,
                    0xe4a5e31c3dd223b1,
                    0xe8cdf4c36793206d,
                    0xe9937e5535b63165,
                    0x012d08f8ae5d5a7f,
                ])),
                Felt::new(BigInteger384([
                    0x4a93d581a2b4efe1,
                    0xf29e09fc9254a5cb,
                    0xb41787c272dc9fac,
                    0x138a61474711945b,
                    0x937475f94a89fa52,
                    0x006f73c4ec464e59,
                ])),
                Felt::new(BigInteger384([
                    0xac72b3a5d2a04d9e,
                    0xa6f3de5422d4dc22,
                    0xd7fd4e0d1e3df360,
                    0xb563911d06c3b381,
                    0x046ea8d5e0bd823e,
                    0x00e9ce1a154124b9,
                ])),
                Felt::new(BigInteger384([
                    0xaa243db676c76f5f,
                    0xd38d9b9c7bf6bf43,
                    0x86e3b49b2ccee344,
                    0xf527e063481d1677,
                    0x7adece0ed21cdd5f,
                    0x00d2aa182289868b,
                ])),
                Felt::new(BigInteger384([
                    0xcb80ae6fdc11e373,
                    0xa308db63b5a0a1cf,
                    0x9eee88bd0d829ffe,
                    0x2d7c592713862671,
                    0xbb25f28797c83500,
                    0x009f3c3cff11bcc4,
                ])),
                Felt::new(BigInteger384([
                    0x3a995ea118ce115a,
                    0x48bc7adbfd269f69,
                    0xb8c1d28242769e35,
                    0x4740045e0f22aaf2,
                    0xa3039b3a8ec42ccd,
                    0x00e26e93438ef162,
                ])),
                Felt::new(BigInteger384([
                    0xac2a5f0fdda637d4,
                    0x53ad56f734bb0ad3,
                    0xe5561e5c09baa4cf,
                    0x9a04489912d57c80,
                    0x38d0f789facda4c4,
                    0x0107cb78fc514bbc,
                ])),
                Felt::new(BigInteger384([
                    0xa3b482ab952aa203,
                    0x0db51389f2ae6180,
                    0x23ea80357846c489,
                    0x3016d787db02b160,
                    0x1ecac7c98a7a707a,
                    0x017ca8184b918b29,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x62b49426de243912,
                    0x92235678db83536d,
                    0xf4dbe1cdc73dba3c,
                    0xf5f09ab579286636,
                    0x3a9243758cb3aba4,
                    0x0175002f58a3eb7c,
                ])),
                Felt::new(BigInteger384([
                    0xda81e083f95af2a2,
                    0x8fa1088fa90ff47a,
                    0x71a962e8d9c86b24,
                    0x9d4f99bfc356493f,
                    0x554db6a35d0ce131,
                    0x018abd63d825ca5a,
                ])),
                Felt::new(BigInteger384([
                    0x3d3d7747e89a14da,
                    0xf074ec333a9fee16,
                    0xc689fc4b968b941a,
                    0x6d6d98251fa8f9a0,
                    0x2ac87acd870f65be,
                    0x0149c9cf9bc439fe,
                ])),
                Felt::new(BigInteger384([
                    0x26cb47cf9a730ec2,
                    0x23f577a2aaccec5f,
                    0x26488d59372d4518,
                    0x0fc35a809ee90708,
                    0x769b089ee2d6b061,
                    0x0039dd30e4e95d51,
                ])),
                Felt::new(BigInteger384([
                    0xe76f97cdd90065d1,
                    0x8026bd815fd40906,
                    0x5ea58f7cfbb1940b,
                    0x05e37c2d921a4ceb,
                    0xa1d2afb85a73d8f1,
                    0x0059ad4f6f309e6d,
                ])),
                Felt::new(BigInteger384([
                    0x9af314c7e01f7a9d,
                    0xac7210bf2b70abcf,
                    0xe2da80285ff7ee4f,
                    0x6f9c0dfd5d301b68,
                    0x081ad127120f5364,
                    0x00de4463ecfec88c,
                ])),
                Felt::new(BigInteger384([
                    0xd9b2abeb93749a17,
                    0x72ab601e1b5157a4,
                    0xb8d258f85f958871,
                    0x1b2d90be87eee48a,
                    0x021f0b7df58cca39,
                    0x004f82e6afb176d7,
                ])),
                Felt::new(BigInteger384([
                    0x3d425e49a6e4cc64,
                    0x7e197ef56cbf6e20,
                    0x86e4bc509d147f29,
                    0x6710a443b6d669bf,
                    0x6d1d2d1e46176d6b,
                    0x00fce8c0297ef059,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x41bda80c32983e34,
                    0x682bf2f2198df70b,
                    0x5ee464a846474899,
                    0x54d9f20ba46b80be,
                    0xaa5c019f58d04032,
                    0x0077b819e9564565,
                ])),
                Felt::new(BigInteger384([
                    0xa402594baea3e306,
                    0x3613dd445755d5eb,
                    0xcb8768306c11096f,
                    0x74171b42bb826cf0,
                    0x30202b992296f41d,
                    0x0173598528fe841e,
                ])),
                Felt::new(BigInteger384([
                    0xb8aff2ff59a56fb0,
                    0xe79ff08388d2280f,
                    0x5a7765cd07c6121b,
                    0xa93150b62ab45532,
                    0x029d4ee978cf3b14,
                    0x012e93d3efb37054,
                ])),
                Felt::new(BigInteger384([
                    0x78a7d5a6ae996109,
                    0xa249ca6e54106afa,
                    0xdb8a8ba0a39039ae,
                    0x1de87cc4c695944e,
                    0x0aefcbcd598ea12e,
                    0x00a5b96e574b915d,
                ])),
                Felt::new(BigInteger384([
                    0x5db302ba90882fa3,
                    0x4af53fc1343d4398,
                    0x6a32dd8d75da7822,
                    0xc0547995eddc67cd,
                    0xaa6dfd35e078e481,
                    0x013d212c5eea395a,
                ])),
                Felt::new(BigInteger384([
                    0xa32ce3587fa3bafb,
                    0x8223752e7be55bfd,
                    0x88bf019cbc3e40fc,
                    0xad9f551205f93f1e,
                    0x8716aff6771e2afc,
                    0x00ba39b501ce5fcc,
                ])),
                Felt::new(BigInteger384([
                    0x4d54d6e4d94b5717,
                    0x692a74cc5d6deee4,
                    0x75d9f9b579f804de,
                    0xbdc0f76f6551b371,
                    0xc9236006d6c0ae55,
                    0x01a4e62e6611c6a2,
                ])),
                Felt::new(BigInteger384([
                    0xd51e6b02bff1996f,
                    0x586dfae0cfa43354,
                    0x8751c68c4ec5eb39,
                    0x8a27a6fedd910f17,
                    0x28895331a6a5fbd8,
                    0x00f2909d78b310c8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7316a9c332232d4a,
                    0x5d7f4fdcbd23d163,
                    0xddb2e0e3481e5107,
                    0x4c43522c633f92e3,
                    0xe904b31ebbd1b525,
                    0x0148b69cf2539567,
                ])),
                Felt::new(BigInteger384([
                    0x760e304471e5c59c,
                    0x57c433b0072ceb50,
                    0xd6e81c48f70d2125,
                    0x6a42e802f17a7b88,
                    0xd1f9ffc7a5845c53,
                    0x018833464978e3d2,
                ])),
                Felt::new(BigInteger384([
                    0xdfc6470c6deaea36,
                    0xf0ca32406f07a29d,
                    0x4c28619ccb9e0bb2,
                    0x36192cfe7169c9cb,
                    0xba11781ba445547c,
                    0x006b53274a6d71f4,
                ])),
                Felt::new(BigInteger384([
                    0x33123ed5ce7f8546,
                    0x0d57e3717a4961c5,
                    0x80a10bcb7b2f724b,
                    0x197176cd9c532288,
                    0xba031ed6f8ca19dd,
                    0x00bde1eebc2ac66f,
                ])),
                Felt::new(BigInteger384([
                    0xec19214f44c786bb,
                    0x9b34e24ce460d3d8,
                    0x2a9fc5ad2abe394a,
                    0x79a8d60b037adf1b,
                    0x55776e06e0652f48,
                    0x019cf95493508b5c,
                ])),
                Felt::new(BigInteger384([
                    0x3412d1306bb90918,
                    0x532be9d95bd7dd2c,
                    0x1c3e2501a8b1af21,
                    0xbe438b056f52c148,
                    0x89e3ca7b1d52feb2,
                    0x00093422915b7e7c,
                ])),
                Felt::new(BigInteger384([
                    0x2fce994745db4da6,
                    0xbedf71d6cfba62bb,
                    0xb1729960f61450f7,
                    0x9c42ac43052e904a,
                    0xffe63e929a3fc43f,
                    0x0073606e9fea6221,
                ])),
                Felt::new(BigInteger384([
                    0xc0eac66c4cf07642,
                    0x67dea3d7cbe56dd3,
                    0xf7e816f3839d2a49,
                    0x70947d26543e5a58,
                    0xf37c5f20a0e8bc6e,
                    0x0023c80001fcf815,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xbdfcf4d41b2cf0a3,
                    0x718ae79b359af80e,
                    0x8a4f84dc1860207b,
                    0x1d47dd237fdf5830,
                    0x3bb4d9e2cfb36393,
                    0x00be965c6b71b106,
                ])),
                Felt::new(BigInteger384([
                    0xf03476118cc4dfdf,
                    0x52c67ff30f24b293,
                    0x5625b5b22369fa42,
                    0x70477c963452b9ca,
                    0x79d97e1732aef849,
                    0x00278c146f72eb4a,
                ])),
                Felt::new(BigInteger384([
                    0x9f2cb843375342b7,
                    0xbc5493a1af4e3044,
                    0x0c835ed49e738511,
                    0xcb327c383d4a2519,
                    0xe4b6942aac85878e,
                    0x009fac7aaefc2f72,
                ])),
                Felt::new(BigInteger384([
                    0xc4530f91f97081fb,
                    0x806756508dc5b6e6,
                    0xdeb8147511a70702,
                    0xecf8f6ef3b455bbb,
                    0x45da607688012e23,
                    0x00c32b5a184950b3,
                ])),
                Felt::new(BigInteger384([
                    0x0bc8cca0c7976d6c,
                    0x7880d08c7ea12fd0,
                    0xe364a801cb3a9e76,
                    0xcdca0dba11fe5de5,
                    0xf03821490e8d3ae9,
                    0x00a174065021f310,
                ])),
                Felt::new(BigInteger384([
                    0x04961f4fbee2899d,
                    0x4a7dc23508e1eb4b,
                    0x8204f1a3e673caa9,
                    0x7772d950bf7c2bfa,
                    0x3e735bb3d6c86300,
                    0x0045fca9db71a589,
                ])),
                Felt::new(BigInteger384([
                    0x1c7247e5de1cb647,
                    0x6fe60a9a50c8de83,
                    0xa70c4de6708983b2,
                    0x1053037424ab3e29,
                    0x5a744afa3372e0c0,
                    0x0077efcf54dc4332,
                ])),
                Felt::new(BigInteger384([
                    0xbaa69151d7fe441c,
                    0xd4117a66319e2b8d,
                    0x48f5f97df7c6c20c,
                    0xbd2899b79e1baddd,
                    0xc3df679b2b007fd5,
                    0x001912aa576020f5,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x04c0507972ba79b8,
                    0x727741f805b86f26,
                    0xccb1bc1e0024415d,
                    0x31e1f553f71952bb,
                    0x28a0b11f4bca2c5f,
                    0x00a0690d1810e283,
                ])),
                Felt::new(BigInteger384([
                    0xece436454d9495b0,
                    0x684b08e41a74f908,
                    0x101f496072c6c3c7,
                    0x4fed4089c70c8368,
                    0x00af0d6adfe35172,
                    0x015a3d4834fbcc6f,
                ])),
                Felt::new(BigInteger384([
                    0x57a8ad7b0348b956,
                    0x5aea3c7b1a6ea434,
                    0x814ad04d32651b50,
                    0x88c540e929b6f122,
                    0xe12759551bb475d4,
                    0x014cfff36f98301e,
                ])),
                Felt::new(BigInteger384([
                    0x2b364a0dfb176307,
                    0x1070b37ee791e8a9,
                    0x4be1b5a6c944735e,
                    0x285368288ce48125,
                    0xd13d11d2158054d1,
                    0x0066fe329fb4ed83,
                ])),
                Felt::new(BigInteger384([
                    0xc6c375f378ad2021,
                    0x3745fca3340c7c69,
                    0xaf62245447f71668,
                    0x9d618f6b8a7c83a1,
                    0xdc76e8ee69203901,
                    0x019ec499678a3d3e,
                ])),
                Felt::new(BigInteger384([
                    0xa4921b53ac999df5,
                    0xfc561a10f704d43c,
                    0xb2d3165eaf03be77,
                    0x59ab9e0e97f4f81a,
                    0xc2f52db236a3450d,
                    0x00172b0cd034bd63,
                ])),
                Felt::new(BigInteger384([
                    0xf7c624876c947b80,
                    0x34cd13dcafd5dc6f,
                    0xb77699d0abe62e59,
                    0x6058a0c269491b02,
                    0x86017f9470c5abee,
                    0x00f64dfdb4b7b0ad,
                ])),
                Felt::new(BigInteger384([
                    0x77944d845d364006,
                    0x9ed5d99095fceb3c,
                    0xe1f699398dfa7a6b,
                    0x7de17d49fe9be24a,
                    0xd1b6e8f32d510d95,
                    0x014461ecc0735bff,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdc672fc2fb2acfa8,
                    0xa19af2239bb0f76a,
                    0x604e37b0526cabe6,
                    0x075d1d6f9d2b8b3e,
                    0xd13e00f10be9fbe4,
                    0x010606bee0685aa8,
                ])),
                Felt::new(BigInteger384([
                    0xbdd97fb7d467377b,
                    0xb2c4261651ba6119,
                    0x63eae7dd27da3780,
                    0x0e435ab1c20220d8,
                    0xc8a9e5a0b4540067,
                    0x0027e8aa05b269ea,
                ])),
                Felt::new(BigInteger384([
                    0xd0e8ef1e22d01d30,
                    0x374240ce20ee752e,
                    0xafd822dc58831257,
                    0x9cd67a6f7750c231,
                    0x9e63fe2a8f1c4d6b,
                    0x01283d0346215de4,
                ])),
                Felt::new(BigInteger384([
                    0x8d2dca902faae07e,
                    0x44dc560bf96ec4ab,
                    0xdf9a19e5eebfc684,
                    0xb8971c4248a196fa,
                    0x901f1ff464d1a8b0,
                    0x01807da0c1e9af01,
                ])),
                Felt::new(BigInteger384([
                    0x8a109540261210a5,
                    0x88156c10d9b086a1,
                    0x3a92f906a02b5400,
                    0x1b9f24795af61322,
                    0x32611dfa8861aa7d,
                    0x0191715a88e90b54,
                ])),
                Felt::new(BigInteger384([
                    0x762a63cef9a04fbd,
                    0x13d912440a55e370,
                    0xf0abb8db86532a39,
                    0xa34c66417c94ca1c,
                    0xf5a09980eaaad87c,
                    0x00a6cbb56e73c58c,
                ])),
                Felt::new(BigInteger384([
                    0xe839697186bd5aca,
                    0x10ee6ec9f5b4f8b2,
                    0x8e52fd9cb1e26286,
                    0xebc54059424470c8,
                    0xd8321caf23a9b8e4,
                    0x0133f29c560da645,
                ])),
                Felt::new(BigInteger384([
                    0xcfdaa08f3b1b4d2e,
                    0xb646fd9fa6743881,
                    0xc1c05e87ef5b33ff,
                    0x44a6da81a9f3bb26,
                    0x39157a206cb73a3e,
                    0x00dba8741546861a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x512029f8ace2f1df,
                    0x85f230c2a94e9f53,
                    0x00b0982346aa2331,
                    0x1e88a333b50d0c06,
                    0x449142f1e9b2b606,
                    0x019d8c5431677ed5,
                ])),
                Felt::new(BigInteger384([
                    0xc18bd2f1f57db4e6,
                    0x439bd122f13fd8a3,
                    0x33909997aabcc3c3,
                    0x81473fe1065af1a7,
                    0x2a16323041bd7153,
                    0x002a137676dfa4b7,
                ])),
                Felt::new(BigInteger384([
                    0x89ddf3b5a7708d81,
                    0x6cf73389a9a5a829,
                    0x08fa482186b326c3,
                    0x9c075d754362fe6c,
                    0x3be4cb948e251fed,
                    0x008a3237006e1052,
                ])),
                Felt::new(BigInteger384([
                    0x72fcc52ab0a0ca3a,
                    0x7ef2c2063f402ac9,
                    0x5c389ab47f2d0afc,
                    0xba3874414f318e51,
                    0x40f8ffec79d64d97,
                    0x019fc2445ff10629,
                ])),
                Felt::new(BigInteger384([
                    0xce8c06c3ab6dd43f,
                    0xaf72628acede20d2,
                    0xe9cb54bb59fa4cfe,
                    0x49f01625af755fe8,
                    0x89a0bbec3716390c,
                    0x0179470793950eb9,
                ])),
                Felt::new(BigInteger384([
                    0x93259d4013e7c8dd,
                    0x8ca866a278a601c9,
                    0x0c93a28785bd785c,
                    0x8e934aea1322d315,
                    0x35d5b886329998c7,
                    0x01677aaeb5393e66,
                ])),
                Felt::new(BigInteger384([
                    0xebe859eb10e4adfe,
                    0x0297be275ef9baed,
                    0xcc102a6e35dbc05b,
                    0x42786be320342a1e,
                    0x13ac4b219313c7bf,
                    0x0004ad0831cdeb95,
                ])),
                Felt::new(BigInteger384([
                    0x88f641ffebedfb9a,
                    0x0905397b2f00b8f0,
                    0x1239be7ca14c5150,
                    0xe53562fed27bab00,
                    0xe7d776344ee8c4f7,
                    0x000d684636462110,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc67f87478a372b20,
                    0x2da5e8486959dde1,
                    0x0a0122ba78b6f0f7,
                    0x338275a48891b596,
                    0x0eb0fce8dc86e01d,
                    0x017f8cc13f3d7b9e,
                ])),
                Felt::new(BigInteger384([
                    0x60594f0163b9dfda,
                    0xfdb6a01e8006293c,
                    0xed33734ff0cbdf0a,
                    0x6844da5f01eb6928,
                    0xc3e2fad792095ae0,
                    0x0116ad3efdfbe881,
                ])),
                Felt::new(BigInteger384([
                    0x285c514ed0570b96,
                    0x33b2cbd25d9c1293,
                    0xb4b8778660b726bc,
                    0x5be0395f32e6fd85,
                    0xdd85f8fdcb85856a,
                    0x01405d7c696c7268,
                ])),
                Felt::new(BigInteger384([
                    0xd8a411fefa135a95,
                    0x9b2f1d2452239f92,
                    0x124cb8845ed4ab76,
                    0x384fdfac2dc2d271,
                    0x9a0caaf28b68b465,
                    0x005b3b84c825b7df,
                ])),
                Felt::new(BigInteger384([
                    0xebaedcb01b52babe,
                    0x2340f24adf4864e1,
                    0xd60f219b4684adf1,
                    0x90e10bc7e23ad4bf,
                    0x3d7c38e868c2c83b,
                    0x015cbf693ee72e9b,
                ])),
                Felt::new(BigInteger384([
                    0xe88a5eb65f79f619,
                    0x12262da4db5f9808,
                    0x712884e9e7b29f24,
                    0x9d7592d72f72b136,
                    0x429a0102b49e5a2e,
                    0x014b32a64cda64e4,
                ])),
                Felt::new(BigInteger384([
                    0x02317ff61cb7bbc6,
                    0xf85ed0dc3f078cbf,
                    0xb3e0165af478a3c4,
                    0x22bab7e4b0101dd6,
                    0x086bd64aea3df0f1,
                    0x019dd86db0dc792f,
                ])),
                Felt::new(BigInteger384([
                    0x5abdafb1324c69ff,
                    0xf9f585d8bd09968d,
                    0x32aec8f3fab5411f,
                    0x3d03a58a6835ee1d,
                    0x5513fb5dfd8a44c5,
                    0x006d2f8fc58aaaec,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x30c4f8ddc66a58ba,
                    0xa6d98c68c5853d6d,
                    0x88b3de0b4ddc0a22,
                    0x958cb942dad5be2b,
                    0xcc9a81b63c4119ae,
                    0x00a5640806b0bbe4,
                ])),
                Felt::new(BigInteger384([
                    0x49bf81c5d33e5af8,
                    0x89d96c3634d0940c,
                    0xce074dd4ba9673df,
                    0xe44ac1d09098409f,
                    0x45975d53551a20ff,
                    0x0074467c5cde4cc1,
                ])),
                Felt::new(BigInteger384([
                    0xfdc16ed04c2d6eeb,
                    0x80ee72318a92faa8,
                    0x06e6ba046109ce85,
                    0xdb15eed8aae4c5ec,
                    0x988ff1f5e1a6c1be,
                    0x00541852ac556cc4,
                ])),
                Felt::new(BigInteger384([
                    0xa18b83ecbdc799d3,
                    0xc30f4a6661ecd036,
                    0xf43fff73ad4348dd,
                    0xa6bd05daffd61fd5,
                    0xc056ed493bc236a6,
                    0x00a0bee7c17ddeb4,
                ])),
                Felt::new(BigInteger384([
                    0x2d0971cd706c1782,
                    0x6f29caa727cba8e7,
                    0x2350d66f033073ac,
                    0x9eeb82aef91d462c,
                    0xdb0a62e0310f1b2b,
                    0x008e0cf7f5b730f1,
                ])),
                Felt::new(BigInteger384([
                    0xdb3390c4afeeff99,
                    0xe63125d6f6d4f946,
                    0x9ab2305a51a267a0,
                    0xb42a3b55008958ac,
                    0xb9345734a32c0f44,
                    0x015167c6ec2a2733,
                ])),
                Felt::new(BigInteger384([
                    0x222dcff2cbea539c,
                    0x90450d59971e3de8,
                    0xfca8f52b4bedd1b6,
                    0x415b81929081572e,
                    0x5ebf8f92188a9f61,
                    0x0176ee6f58a12cc6,
                ])),
                Felt::new(BigInteger384([
                    0xd1477d1812d234bd,
                    0x2e5e5818ac8e9b78,
                    0x6cdbce52587bda0a,
                    0x9c70bc9a22a2e40d,
                    0xca4b90570c27ea4e,
                    0x00ef0dd5ddae50f8,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x0256cb71681ed7bc,
                    0xd62e4092c23d7c32,
                    0xfbe31dc2d6dc851c,
                    0x272485dde63273d1,
                    0x438ed7c22a5704e0,
                    0x00076e5614c70205,
                ])),
                Felt::new(BigInteger384([
                    0x6741cb3eba492bea,
                    0x41367e7b99d081fd,
                    0x1cbcdf77a8caecc7,
                    0x3ae8a9b0b761c050,
                    0xd7509c6b9c8e42da,
                    0x008761143f4833ae,
                ])),
                Felt::new(BigInteger384([
                    0xc6b24c750b2394da,
                    0xdf3293e4ec5cdfa8,
                    0x50b72bbb9b4a6f50,
                    0xb569ab1e6fd5da84,
                    0xa2adfa9b6c342d6c,
                    0x01759477e15c26fc,
                ])),
                Felt::new(BigInteger384([
                    0x174638e525347bb2,
                    0xc56d2d11f01ed71c,
                    0x8216e637481a1437,
                    0xb58d84971b93d076,
                    0xea518351be88c8ae,
                    0x011680ce795654c6,
                ])),
                Felt::new(BigInteger384([
                    0x8883f901444473fd,
                    0xd6de1fc1d11cdc86,
                    0x538361d2ff7cf4de,
                    0x579c974f6b9984b8,
                    0x4e3537627eb042e2,
                    0x00e868650772fd56,
                ])),
                Felt::new(BigInteger384([
                    0x8aab347424163ff6,
                    0x54c687d98b76bf48,
                    0x09b946e77342fe77,
                    0x610f66b9fee1c37e,
                    0xd4e2c72b187145d0,
                    0x006475f8bd8a259a,
                ])),
                Felt::new(BigInteger384([
                    0x5f2997c8124b4da0,
                    0xdd80a80ba4654f5a,
                    0x6c6a8f6267186b3a,
                    0x330348d8278e8f6c,
                    0x15f117fa1c3af987,
                    0x00a9bee51dd0e5f4,
                ])),
                Felt::new(BigInteger384([
                    0x7f715a50896dc517,
                    0x8fe494e2fecd056f,
                    0x9cb04f0020270927,
                    0x4349e6f26973d72f,
                    0xd0f6bdc4c7d8861f,
                    0x0122b210aa53b059,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3b9fe6a8117c43e8,
                    0xf00b398b9950f8e5,
                    0x2f15e2e68c389a8f,
                    0xbe29d4dc20daa394,
                    0x7f75dc3fee41f988,
                    0x01777d5dc7a27fb3,
                ])),
                Felt::new(BigInteger384([
                    0x16545e5b4a62de8d,
                    0x1061e22db7b2c230,
                    0xf74c85d54c0d7818,
                    0x1b9b2255104118a2,
                    0x5a7e545661043637,
                    0x006ea7fdcdd9534c,
                ])),
                Felt::new(BigInteger384([
                    0xdf02c19888aaee3a,
                    0x3a427871e14e5f89,
                    0xd290cf7f212ca536,
                    0xa414ed13b5100d57,
                    0xd415353a39a75c18,
                    0x0019a5040c08986d,
                ])),
                Felt::new(BigInteger384([
                    0x138169d3b283624f,
                    0x3cc7b4c6f6528564,
                    0x677c66395198d2cd,
                    0x04586acff039ad5f,
                    0x8259c894feac9d9d,
                    0x017b5220a7a9d7c5,
                ])),
                Felt::new(BigInteger384([
                    0xd0b1e2fb0f5cd343,
                    0x6c8ecc471bbc95f5,
                    0xc07389a59644e44a,
                    0xbad9f249dab8654b,
                    0x9b4c406d51c14511,
                    0x000e97befb574fee,
                ])),
                Felt::new(BigInteger384([
                    0x448a45c66e87127f,
                    0xe622ed8248990573,
                    0x93fc6bb4b003bc16,
                    0x7e62ad218daa156b,
                    0x49c66cfc65e807c1,
                    0x01425fd56e6661a1,
                ])),
                Felt::new(BigInteger384([
                    0xd221b7ee1c8bb5c1,
                    0xf6cf075a0e44a7c0,
                    0x3c91d23fb2caee1e,
                    0x6e905c425633dbdf,
                    0xdd8b7611848606ad,
                    0x008131d315d7152a,
                ])),
                Felt::new(BigInteger384([
                    0x4d52c6a4470a623c,
                    0xb3ecd75142a36663,
                    0x16c0d6d045d09a88,
                    0x524bd86f3ff3fe37,
                    0x77e39a9b40b7b60d,
                    0x016543431ec764ab,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x0759f42a9e164a99,
                    0x40bca9df5088f0e0,
                    0x8de2028e64522064,
                    0x4059acec02b662cd,
                    0x18bfeb476786e753,
                    0x00ddaf40d6532c2f,
                ])),
                Felt::new(BigInteger384([
                    0x31cdb58d76059dd6,
                    0x9ab12c489d2f24c9,
                    0x4c955b5efac83a62,
                    0x8c44b49594da188f,
                    0xe56fb50786a49ebd,
                    0x010341cdc51df795,
                ])),
                Felt::new(BigInteger384([
                    0xeca9a7f3e6d372ec,
                    0x64ca417f8bcf0cd6,
                    0x1456143bf78b28b3,
                    0x1926a55e3a0c1ee9,
                    0x0f74a90aceac273c,
                    0x011e0be64ed70738,
                ])),
                Felt::new(BigInteger384([
                    0x159c45be2a1c9e89,
                    0xa66e4a85c635e23a,
                    0x380ed8cb8fb3612f,
                    0xfa3bb058f7d3511c,
                    0x174901d9b1069f51,
                    0x00d08b4e5ccde1af,
                ])),
                Felt::new(BigInteger384([
                    0x362f95bd38e5f779,
                    0x98d1155940440e58,
                    0x27046756ab80854f,
                    0xac83a45143d5512c,
                    0x7eea870b8afe363c,
                    0x0146f45aa0436ac9,
                ])),
                Felt::new(BigInteger384([
                    0x4258f3e26a2070cb,
                    0x97add8e013468a28,
                    0x01d719fb306f0063,
                    0x8fbed93fae02d5d8,
                    0x97b0a8d4740ee56d,
                    0x0195dc071fd3c637,
                ])),
                Felt::new(BigInteger384([
                    0x67b4a0e008735b42,
                    0x41941714410854ff,
                    0x0ba6afd603405624,
                    0xedd542039f43c0b8,
                    0x860ea97cc32a5c84,
                    0x00898c8351b94a2f,
                ])),
                Felt::new(BigInteger384([
                    0xeb30a4a51bd6fc73,
                    0xcbd59560fe4d64d2,
                    0xd484c2d554ffb03f,
                    0xbe71ff64bcd9708d,
                    0x6be506257dc4730a,
                    0x017a8ecb14149812,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x59ada6ce64e99334,
                    0xf3026884397c5561,
                    0x33db38570b024186,
                    0x247fd641ec51143f,
                    0xc96b8841f1d9ab6b,
                    0x00a98edc6dcc5c21,
                ])),
                Felt::new(BigInteger384([
                    0xe57242546fd46990,
                    0x2d59d4107446f152,
                    0x67ccb98fb53d2922,
                    0x691f321b30ee2816,
                    0x6e9ffb7b3464329b,
                    0x01591912079ee7c8,
                ])),
                Felt::new(BigInteger384([
                    0x383c883ebfe8e1d0,
                    0xb1cb49228ab34106,
                    0xe2e746fb11b20c12,
                    0xd048ceb930fcf2d3,
                    0x74bb065b1347d1c0,
                    0x018cc6502a59ed6f,
                ])),
                Felt::new(BigInteger384([
                    0x43284e6d878fc3db,
                    0xb13cbd5f529e508c,
                    0xbc6dacf47f6c131a,
                    0xc5d043feb8e20847,
                    0xe5086fd6398c01a3,
                    0x00e728951ec6b663,
                ])),
                Felt::new(BigInteger384([
                    0x3ef4e2cc9f96edf3,
                    0x7ae2f8f0453774ed,
                    0x0babe1c3a7820879,
                    0x88e19a1eaa1b6d00,
                    0x53b880beca687a6b,
                    0x00a3aaa9ce3b2125,
                ])),
                Felt::new(BigInteger384([
                    0x5a1d8c93c1ca28de,
                    0x6a173bb3776a60a4,
                    0xca5b8073d7297557,
                    0xa7af503e6b931d1b,
                    0xbe654b2dcd52cddc,
                    0x00889ece9eaedb35,
                ])),
                Felt::new(BigInteger384([
                    0xce9f26e1593221d8,
                    0x3fec53dcea5fb467,
                    0x1a48f320846c9edb,
                    0xd27b926669c3e29f,
                    0xc4d88e0c40cc077b,
                    0x00cb1a0f4b414f25,
                ])),
                Felt::new(BigInteger384([
                    0x2cf0dac3d506ac57,
                    0xd89791f929177ee8,
                    0x3793bcdaafdc6be7,
                    0xcdbc3a578e0fd79d,
                    0xf8dfb81f2f757418,
                    0x00a4147e7b044d7e,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xcca771f74dddd042,
                    0x50ae6e93a3295230,
                    0x1f61c150025341e1,
                    0x10626a3feead282d,
                    0xf1ce6c78d4635206,
                    0x005ab5fd63b820a2,
                ])),
                Felt::new(BigInteger384([
                    0x426411d9e7239e35,
                    0xca72c264173e8967,
                    0x4b543e29214376b5,
                    0x0ccfb08be9aaf871,
                    0xb5a8681002691570,
                    0x0105475a63253b5b,
                ])),
                Felt::new(BigInteger384([
                    0xaf55391ff213b09b,
                    0x3cb96fa7bb067ca4,
                    0x321ed4d476f86407,
                    0x81e53fe70bd9e425,
                    0x5d5386e5b830b320,
                    0x00d7d7a7bf0ca44e,
                ])),
                Felt::new(BigInteger384([
                    0x1b23fb515a0d8443,
                    0xfb95196fe8cca404,
                    0x0f41653f675d4b37,
                    0x9333de77ff3ab37c,
                    0x1128a0a949d4c615,
                    0x009bdef14a821bfe,
                ])),
                Felt::new(BigInteger384([
                    0x9ed2fb211fc76905,
                    0x0cd46af2ff636188,
                    0xbae32494c81ab219,
                    0x9acf554fad522742,
                    0xbc279f64d5828794,
                    0x00c069c5d2ad6055,
                ])),
                Felt::new(BigInteger384([
                    0xa0937eb44d12da19,
                    0xa02af30b3bf9924e,
                    0x73393b35ab16ab60,
                    0x07f7852a8a221167,
                    0x10ff7000a5c67ea2,
                    0x00f127aa03b4fdee,
                ])),
                Felt::new(BigInteger384([
                    0xd89bdcadf9c0017f,
                    0x8747dba221a53325,
                    0xbc853f70036cda43,
                    0x531a7563a58a210b,
                    0x6724a5fb2930c857,
                    0x005b8505d41eec7a,
                ])),
                Felt::new(BigInteger384([
                    0x1bb1f7dfcd2f7dfd,
                    0x779d228c60bb2199,
                    0xc516ca87c33d9714,
                    0xfc2d749ece7cef4c,
                    0xc8c4acfdcaa28edc,
                    0x01209fa611f7d09f,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb87f4a966f3a9966,
                    0x1c4260e2ad66c447,
                    0xc4efca567988f7a4,
                    0x39ad384b6ad580b9,
                    0x592f3a60ff3db926,
                    0x00c6f5e9ec2c370d,
                ])),
                Felt::new(BigInteger384([
                    0xe65c120bc2bc4f48,
                    0x4b7e345664d41d6f,
                    0xb11bfed1704309da,
                    0x05fb5bd666fb20db,
                    0xf1a6e3bb4a7cfcea,
                    0x000a575ebf3b90f7,
                ])),
                Felt::new(BigInteger384([
                    0xf91e18860eaa7ae9,
                    0x9880c97f5a964d72,
                    0xfbfaf6e318081fce,
                    0xed85fc869cd1b233,
                    0x7670ccd36591a0d4,
                    0x00912bdc66bb2475,
                ])),
                Felt::new(BigInteger384([
                    0x85801e96615100c7,
                    0x57f9c10ff6110a15,
                    0x233b96312becea37,
                    0xd817d0fb4a3ffed1,
                    0xf0a68fa2ce0d0519,
                    0x00f5f926acce2823,
                ])),
                Felt::new(BigInteger384([
                    0x2c5c71534dc43870,
                    0x8f6ded3b66abf848,
                    0xf7178c1357e5efb2,
                    0xd174c9d4df6ff930,
                    0x98b5036e8ab9d274,
                    0x00ede05106eaea60,
                ])),
                Felt::new(BigInteger384([
                    0x343ec1cba7500039,
                    0x6d19bdb55f1bcd83,
                    0x8c37c3631fb3b8d3,
                    0x1a871356a694cb83,
                    0xdd57b9ed62fb4824,
                    0x0146b26342dee19f,
                ])),
                Felt::new(BigInteger384([
                    0x9df44e86dac61902,
                    0xe8562e9a4b66f677,
                    0xabbefccafff08054,
                    0x22eed538593a9a57,
                    0xe0395e16b73be81f,
                    0x0015a0d37bb60b75,
                ])),
                Felt::new(BigInteger384([
                    0xa1464b58a16fd697,
                    0x34f9d11820818cd4,
                    0x6bff86c1915289ed,
                    0x669167bf8b428529,
                    0x3ff728d3cc9dcf23,
                    0x00527c82ecd4c8e7,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0xb84ebfffffffe409,
                    0x9132d225affff177,
                    0x77d13b548673857b,
                    0x1b6315703a7a08a5,
                    0x837227e22da91c38,
                    0x00c061dd4813ea92,
                ])),
                Felt::new(BigInteger384([
                    0x4e41fffffffecf58,
                    0x61c9d2407fff61ae,
                    0xabaee3c2e468a493,
                    0x7650676457f13552,
                    0xd26fb8b92f31c22d,
                    0x007685c662961a87,
                ])),
                Felt::new(BigInteger384([
                    0x9b8f3ffffffeea1f,
                    0x73183f21cfff6f98,
                    0x72d90fc172ef9efc,
                    0x518a8162fa6ff2b8,
                    0xe8e6bc560201afc6,
                    0x00d0f0ace07e1929,
                ])),
                Felt::new(BigInteger384([
                    0xdce93fffffffd197,
                    0x81947e684fffe7e1,
                    0x928826ff074173d2,
                    0x048af12891f742bc,
                    0x16c2108e76b05810,
                    0x011180fad721e016,
                ])),
                Felt::new(BigInteger384([
                    0xb84ebfffffffe409,
                    0x9132d225affff177,
                    0x77d13b548673857b,
                    0x1b6315703a7a08a5,
                    0x837227e22da91c38,
                    0x00c061dd4813ea92,
                ])),
                Felt::new(BigInteger384([
                    0x4e41fffffffecf58,
                    0x61c9d2407fff61ae,
                    0xabaee3c2e468a493,
                    0x7650676457f13552,
                    0xd26fb8b92f31c22d,
                    0x007685c662961a87,
                ])),
                Felt::new(BigInteger384([
                    0x9b8f3ffffffeea1f,
                    0x73183f21cfff6f98,
                    0x72d90fc172ef9efc,
                    0x518a8162fa6ff2b8,
                    0xe8e6bc560201afc6,
                    0x00d0f0ace07e1929,
                ])),
                Felt::new(BigInteger384([
                    0xdce93fffffffd197,
                    0x81947e684fffe7e1,
                    0x928826ff074173d2,
                    0x048af12891f742bc,
                    0x16c2108e76b05810,
                    0x011180fad721e016,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0xb84ebfffffffe409,
                    0x9132d225affff177,
                    0x77d13b548673857b,
                    0x1b6315703a7a08a5,
                    0x837227e22da91c38,
                    0x00c061dd4813ea92,
                ])),
                Felt::new(BigInteger384([
                    0x4e41fffffffecf58,
                    0x61c9d2407fff61ae,
                    0xabaee3c2e468a493,
                    0x7650676457f13552,
                    0xd26fb8b92f31c22d,
                    0x007685c662961a87,
                ])),
                Felt::new(BigInteger384([
                    0x9b8f3ffffffeea1f,
                    0x73183f21cfff6f98,
                    0x72d90fc172ef9efc,
                    0x518a8162fa6ff2b8,
                    0xe8e6bc560201afc6,
                    0x00d0f0ace07e1929,
                ])),
                Felt::new(BigInteger384([
                    0xdce93fffffffd197,
                    0x81947e684fffe7e1,
                    0x928826ff074173d2,
                    0x048af12891f742bc,
                    0x16c2108e76b05810,
                    0x011180fad721e016,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb84ebfffffffe409,
                    0x9132d225affff177,
                    0x77d13b548673857b,
                    0x1b6315703a7a08a5,
                    0x837227e22da91c38,
                    0x00c061dd4813ea92,
                ])),
                Felt::new(BigInteger384([
                    0x4e41fffffffecf58,
                    0x61c9d2407fff61ae,
                    0xabaee3c2e468a493,
                    0x7650676457f13552,
                    0xd26fb8b92f31c22d,
                    0x007685c662961a87,
                ])),
                Felt::new(BigInteger384([
                    0x9b8f3ffffffeea1f,
                    0x73183f21cfff6f98,
                    0x72d90fc172ef9efc,
                    0x518a8162fa6ff2b8,
                    0xe8e6bc560201afc6,
                    0x00d0f0ace07e1929,
                ])),
                Felt::new(BigInteger384([
                    0xdce93fffffffd197,
                    0x81947e684fffe7e1,
                    0x928826ff074173d2,
                    0x048af12891f742bc,
                    0x16c2108e76b05810,
                    0x011180fad721e016,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x70170fa5e1da8e75,
                    0x20bfa0923a855183,
                    0xde18c77017746e90,
                    0x587defeb6da66d6d,
                    0x13576415ff4ae4e3,
                    0x01529954d7f6b4a5,
                ])),
                Felt::new(BigInteger384([
                    0x5fc0448b5b490f59,
                    0x111add3e950e0c3d,
                    0x7678edc767c598ea,
                    0x6a9449a326125b1b,
                    0x46cf4d36de7bc676,
                    0x009e2431dfd376c9,
                ])),
                Felt::new(BigInteger384([
                    0xde4a8b959bd6848b,
                    0x1ecb58fee696b8e9,
                    0xcff385c18a01e43e,
                    0x8e46633956f5355e,
                    0x1492630f12b77288,
                    0x0188948d73b108c3,
                ])),
                Felt::new(BigInteger384([
                    0x99199cdd0b2740db,
                    0xbacfcfe26f760d63,
                    0x17db36f67e267f24,
                    0x3000222bbf2ad689,
                    0xeb5e9393d97b2a1b,
                    0x00b1e3b9af92c978,
                ])),
                Felt::new(BigInteger384([
                    0x7bd292c0563c720a,
                    0x0928dfd7807ff24c,
                    0xfc9864f34e86d483,
                    0x3180eb4fdc994770,
                    0x71ff1a0fcf05c7d1,
                    0x01517a9dcac31c2b,
                ])),
                Felt::new(BigInteger384([
                    0x2a95b1d4b94d599b,
                    0x8490b36d51a78e63,
                    0x0e3ec9cb75097776,
                    0x2e8232b812548171,
                    0x79172fcaf2190016,
                    0x0152d00cee78d567,
                ])),
                Felt::new(BigInteger384([
                    0x9897eb5099727527,
                    0xadaf037b0103aab9,
                    0x87ca3b2200de0ca5,
                    0x9113f6fa5c2b8cea,
                    0xf1ebf4e057bf779c,
                    0x010f8a4cff10c4ca,
                ])),
                Felt::new(BigInteger384([
                    0x85770348ca3831c7,
                    0xebc1295d3f81aa59,
                    0x06b37f3cd5022ad1,
                    0x30d948b17f34e44f,
                    0xc4502b1c2580e486,
                    0x0140b545bed91db5,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xf6fe17b42f60e4ac,
                    0x39ea16ac26ea85cd,
                    0xbe941c7f37f1cc43,
                    0x65adf37ac20daae0,
                    0x817a93823b788f3c,
                    0x002e252d690c060e,
                ])),
                Felt::new(BigInteger384([
                    0x03b3997843801d2b,
                    0x9745d79640a4edb6,
                    0x572f8c29a84dd935,
                    0x994888267361d82b,
                    0x7147d5e0711c2c5f,
                    0x00a6d543f18215d6,
                ])),
                Felt::new(BigInteger384([
                    0xd9a106c76ffe5af3,
                    0x46bd7f5f3abe22fc,
                    0xa00a76368e98d79a,
                    0xf33cb1e9e17ad5f2,
                    0x03866d34184883a7,
                    0x00b09b2c062cd1dd,
                ])),
                Felt::new(BigInteger384([
                    0x023accba43f74bc5,
                    0xf55539c7ac750169,
                    0x57ab208edb07eee6,
                    0x7040610982a112fa,
                    0x9f37d31ea88c1c2a,
                    0x0193c9043ee11b3a,
                ])),
                Felt::new(BigInteger384([
                    0xce4e34fe474e90ee,
                    0x9b856a4554834aaf,
                    0xcc0e4f3cad4dfc63,
                    0x562bff096fc647f9,
                    0x52253c0da0080342,
                    0x00df3938a7c918d4,
                ])),
                Felt::new(BigInteger384([
                    0xd423694d34955e6d,
                    0x168feeb3e4e79d88,
                    0xbf2c100d91aa229f,
                    0x787b6d85da90a0e3,
                    0x61cf36868bcfdfc3,
                    0x000178fb305cc5b2,
                ])),
                Felt::new(BigInteger384([
                    0x1c813203785995bf,
                    0x57fc794ae742000d,
                    0xc3abfec5472ad071,
                    0x0f4277e04ea84a34,
                    0x36fbdd86d635eaf0,
                    0x00e5d16b0cd123aa,
                ])),
                Felt::new(BigInteger384([
                    0xa287f58d7cc51fe1,
                    0x898bbb32873d06aa,
                    0xd5a157386d1a59d4,
                    0x5115defd952e97b5,
                    0xd78d6e44e4278d22,
                    0x007fb575e669500c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3e61fa70fc812db9,
                    0x25eccc87e1c53f64,
                    0x8d7640e65e8542d9,
                    0x65baff6022966bf9,
                    0xcc9ea3d7d847bc43,
                    0x00ac82ceb5138255,
                ])),
                Felt::new(BigInteger384([
                    0xefaa3f591d89e952,
                    0xa137bd5742056367,
                    0xfaefbb4550f2146f,
                    0xbbef7ad88050c418,
                    0x2c98dde036461086,
                    0x00613b78c767d357,
                ])),
                Felt::new(BigInteger384([
                    0xea6feea03524a408,
                    0x56b8c6f74df839ac,
                    0x47f0d84c51872c5d,
                    0x22d2dcf9f54ad37c,
                    0x5e29da574c29da54,
                    0x0195a9b8adc574c6,
                ])),
                Felt::new(BigInteger384([
                    0xd7bc71f854406ab2,
                    0x200971dd65c4667f,
                    0x845a156f26262dae,
                    0xa0eded2deb9aab05,
                    0x9ec6a88a472559a4,
                    0x01194f50996c5cf8,
                ])),
                Felt::new(BigInteger384([
                    0x1b3feda5e8686fa1,
                    0xe35e5d102e519996,
                    0xd8c60e579ee1160b,
                    0xa16206a98fc3f078,
                    0x7fd9d9f36f3603fe,
                    0x011a7f3b0378988f,
                ])),
                Felt::new(BigInteger384([
                    0x632e1842d3f16ddc,
                    0xb0d366f775e32607,
                    0x22385675ca999208,
                    0xd15a250d0c579459,
                    0xad90b164547ae2ab,
                    0x010c6bc7fb56a7fe,
                ])),
                Felt::new(BigInteger384([
                    0x6cf2ff5f5e1cca47,
                    0x8fab9c976be06b98,
                    0x37fcafbfa55e8a84,
                    0x93695fb3c8e526e1,
                    0x853b2401afdcd764,
                    0x00631ad151a60eeb,
                ])),
                Felt::new(BigInteger384([
                    0xe38c3ac7d7f75bc9,
                    0x6a2938669f34bb36,
                    0x5f259d35c8ee0d4f,
                    0x9eda3cf047968ce7,
                    0x405dc0b8b9f55ed2,
                    0x009c06386f9aa70c,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xbb88202d9241e116,
                    0x6f8a4ad4e5b2f212,
                    0xcb5aafd57053cf4f,
                    0xef2744828dc29fb2,
                    0xdbcd6389de7934f1,
                    0x003427d6f0b321f1,
                ])),
                Felt::new(BigInteger384([
                    0x6fbdcdbef1642b01,
                    0x968a813cb5291904,
                    0x2ab7325c643978f0,
                    0xbfe5d0b0db06b80e,
                    0x2d457394761f29b7,
                    0x01015a480d189488,
                ])),
                Felt::new(BigInteger384([
                    0x6e4cd6b433e046ae,
                    0x305115b84d396da5,
                    0xdc11123dfa1bcc4a,
                    0x443aba98698e4121,
                    0xc3488e0751428991,
                    0x0121a0197a0ba595,
                ])),
                Felt::new(BigInteger384([
                    0x56f197a590f3745b,
                    0x6762061f06c26725,
                    0x7982a1f41ed01251,
                    0x2ad5b2dfec1dd0ee,
                    0x195c23edb24e12d0,
                    0x01030e7744e7a28d,
                ])),
                Felt::new(BigInteger384([
                    0xb6dfd6202a2850a1,
                    0x9732b1200405f098,
                    0x1394b4386dcbdcbd,
                    0xf211bc894029d8a5,
                    0xd27813ab6e1bcff7,
                    0x00801febd9db07c5,
                ])),
                Felt::new(BigInteger384([
                    0x5efaa425955f3ab1,
                    0x67f7c4b4c1672899,
                    0xf5d07effbc780481,
                    0x84841c506cdf487b,
                    0x28cccdf5f7c83ef4,
                    0x0114f918ecd75fd9,
                ])),
                Felt::new(BigInteger384([
                    0x4bcec17a863334c5,
                    0x63bd45e0ef2b4d0c,
                    0xa7ecdc2bf038f3f6,
                    0xf27a687901175c02,
                    0x13578dc42b29fb19,
                    0x003a57c4e5277184,
                ])),
                Felt::new(BigInteger384([
                    0x1c7a3cc95e879f32,
                    0xf3c2b453c414a136,
                    0x117ac170baa9b42d,
                    0x69d466ec5ee156e3,
                    0x8c0c09cbf4c35bcd,
                    0x00e0e44d3febd946,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x614222393609cc7e,
                    0x497a995b9070d27d,
                    0x005e9af220c3c1f0,
                    0xdad77fae1a81e368,
                    0xbc88c050c36a781d,
                    0x017ddc951a79a6ab,
                ])),
                Felt::new(BigInteger384([
                    0x306be77d2a3668ab,
                    0xe22140295321b40e,
                    0x8d306e501e8eed9d,
                    0xb5f45717b13f05b2,
                    0x949204b66c0dba13,
                    0x00c21019df15fb6e,
                ])),
                Felt::new(BigInteger384([
                    0xde354915292e0aa4,
                    0xb3c7d7c57d18bd28,
                    0xf787d2d72161e444,
                    0xf84ef2356f1542e8,
                    0x7f8018ee7f6fa96b,
                    0x00a430dc8b79b0c1,
                ])),
                Felt::new(BigInteger384([
                    0x9ca116ccab2cc9ad,
                    0xb06dd4d8f5535463,
                    0xbdedfbde2b7d3601,
                    0xd035dec0ba7481e7,
                    0x8ca88a391f08961e,
                    0x00e09e1bd6f24aa9,
                ])),
                Felt::new(BigInteger384([
                    0xb36c86a1cb8a7b13,
                    0x0a6cae503816739b,
                    0x502e89278356f942,
                    0x07b5a96210c0ed5d,
                    0xd085d6721e659c21,
                    0x013c77dfcfec519f,
                ])),
                Felt::new(BigInteger384([
                    0xb68e66918db0adab,
                    0x88bc668889f4734a,
                    0xa80e8235f2c4b979,
                    0xe5ef9695bdc5a16e,
                    0x539ca5058b85f7ad,
                    0x014b9a3117d24d06,
                ])),
                Felt::new(BigInteger384([
                    0x7c513b5208f90e30,
                    0xa5c286e5af7cc523,
                    0x879e73b41df145db,
                    0x394be7c1dcb0e684,
                    0xfb3ae48f3c17a286,
                    0x015bcf011fb9e5ce,
                ])),
                Felt::new(BigInteger384([
                    0x2f9cdc8511acc1f4,
                    0x5272d63973c766f1,
                    0x63d24334ccb71ff8,
                    0xbef075a27dad1eaa,
                    0x4c067a92fcd5dd8c,
                    0x015044aa2ac7a313,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x430b25fd2abbcd28,
                    0xa8b4aaf41476bc3e,
                    0xf9929d014c933ba0,
                    0xbfba15045729dbed,
                    0xa6c1907cbc873f88,
                    0x00d0672eb829d6b2,
                ])),
                Felt::new(BigInteger384([
                    0x4213b5d50681ec4b,
                    0xea1719f4a3a32b77,
                    0x2f67b7e3f5a41d74,
                    0xd62e48d4bd91da03,
                    0x43c1098b73f0bef4,
                    0x0195e8bcf1c0b5d1,
                ])),
                Felt::new(BigInteger384([
                    0x9de3ec7a0dbd07d1,
                    0xa9230439a16750f0,
                    0xabe0e40a92dce352,
                    0x561cc7f238389faa,
                    0xe7d5972b0124357c,
                    0x0196ced6e4fea723,
                ])),
                Felt::new(BigInteger384([
                    0xef1fb21479847019,
                    0x5c9c403a9bfb0011,
                    0x0fe3eb0b5b29fc3f,
                    0x819bc462e4fab608,
                    0xc81bb5c4777aa5bd,
                    0x00981566b1e42fcf,
                ])),
                Felt::new(BigInteger384([
                    0xe3a3b84c57be71b6,
                    0x60086f0cc13601a6,
                    0xa3191050109b7e7d,
                    0x582f172a6f36ed94,
                    0x483fee36dd4cd33c,
                    0x013b74bd293e4f32,
                ])),
                Felt::new(BigInteger384([
                    0xf5d8210ba8c7e22e,
                    0x1c5543b0aee28e12,
                    0x60e33f0703124ecd,
                    0x1d37fd0a10188dd6,
                    0x0c7306f9397c616a,
                    0x00374beb8b0991ff,
                ])),
                Felt::new(BigInteger384([
                    0xe4677911d31f89b3,
                    0x11bcc0f3982f5066,
                    0xf5c0eee5121b0978,
                    0x027ece6ea0b1061c,
                    0x81c430c67666be71,
                    0x00582a6520602fe2,
                ])),
                Felt::new(BigInteger384([
                    0x9f8c5e7544ce248e,
                    0xc571787cb58b759a,
                    0x4f49e2aad0a81f8b,
                    0x6fc770093f5be059,
                    0xeb760f1d6d11c1a1,
                    0x00b93fb425e141ec,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
