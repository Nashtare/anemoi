use super::{sbox, BigInteger384, Felt};
use crate::{Jive, Sponge};
use ark_ff::{Field, One, Zero};
use unroll::unroll_for_loops;

/// Digest for Anemoi
mod digest;
/// Sponge for Anemoi
mod hasher;
/// MDS matrix for Anemoi
mod mds;
/// Round constants for Anemoi
mod round_constants;

pub use digest::AnemoiDigest;
pub use hasher::AnemoiHash;

// ANEMOI CONSTANTS
// ================================================================================================

/// Function state is set to 8 field elements or 384 bytes.
/// 1 element of the state is reserved for capacity.
pub const STATE_WIDTH: usize = 8;
/// 7 elements of the state are reserved for rate.
pub const RATE_WIDTH: usize = 7;

/// The state is divided into two even-length rows.
pub const NUM_COLUMNS: usize = 4;

/// 2 elements (96-bytes) are returned as digest.
pub const DIGEST_SIZE: usize = 2;

/// The number of rounds is set to 14 to provide 256-bit security level.
pub const NUM_HASH_ROUNDS: usize = 14;

// HELPER FUNCTIONS
// ================================================================================================

#[inline(always)]
/// Applies exponentiation of the current hash
/// state elements with the Anemoi S-Box.
pub(crate) fn apply_sbox(state: &mut [Felt; STATE_WIDTH]) {
    let mut x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
    let mut y: [Felt; NUM_COLUMNS] = state[NUM_COLUMNS..].try_into().unwrap();

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2.double().double().double().double() - y2;
        *t -= beta_y2
    });

    let mut x_alpha_inv = x;
    x_alpha_inv
        .iter_mut()
        .for_each(|t| *t = sbox::exp_inv_alpha(t));

    y.iter_mut()
        .enumerate()
        .for_each(|(i, t)| *t -= x_alpha_inv[i]);

    x.iter_mut().enumerate().for_each(|(i, t)| {
        let y2 = y[i].square();
        let beta_y2 = y2.double().double().double().double() - y2;
        *t += beta_y2 + sbox::DELTA
    });

    state[..NUM_COLUMNS].copy_from_slice(&x);
    state[NUM_COLUMNS..].copy_from_slice(&y);
}

#[inline(always)]
/// Applies matrix-vector multiplication of the current
/// hash state with the Anemoi MDS matrix.
pub(crate) fn apply_mds(state: &mut [Felt; STATE_WIDTH]) {
    let x: [Felt; NUM_COLUMNS] = [state[0], state[1], state[2], state[3]];
    let y: [Felt; NUM_COLUMNS] = [state[5], state[6], state[7], state[4]];

    let sum_coeffs = x[0] + x[1] + x[2] + x[3];
    state[0] = sum_coeffs + x[2] + x[3].double();
    state[1] = sum_coeffs + x[3] + x[0].double();
    state[2] = sum_coeffs + x[0] + x[1].double();
    state[3] = sum_coeffs + x[1] + x[2].double();

    let sum_coeffs = y[0] + y[1] + y[2] + y[3];
    state[4] = sum_coeffs + y[2] + y[3].double();
    state[5] = sum_coeffs + y[3] + y[0].double();
    state[6] = sum_coeffs + y[0] + y[1].double();
    state[7] = sum_coeffs + y[1] + y[2].double();
}

// ANEMOI PERMUTATION
// ================================================================================================

/// Applies Anemoi permutation to the provided state.
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_permutation(state: &mut [Felt; STATE_WIDTH]) {
    for i in 0..NUM_HASH_ROUNDS {
        apply_round(state, i);
    }

    apply_mds(state)
}

/// Anemoi round function;
/// implementation based on algorithm 3 of <https://eprint.iacr.org/2020/1143.pdf>
#[inline(always)]
#[unroll_for_loops]
pub(crate) fn apply_round(state: &mut [Felt; STATE_WIDTH], step: usize) {
    // determine which round constants to use
    let c = &round_constants::C[step % NUM_HASH_ROUNDS];
    let d = &round_constants::D[step % NUM_HASH_ROUNDS];

    for i in 0..NUM_COLUMNS {
        state[i] += c[i];
        state[NUM_COLUMNS + i] += d[i];
    }

    apply_mds(state);
    apply_sbox(state);
}

#[cfg(test)]
mod tests {
    use super::*;

    fn apply_naive_mds(state: &mut [Felt; STATE_WIDTH]) {
        let x: [Felt; NUM_COLUMNS] = state[..NUM_COLUMNS].try_into().unwrap();
        let mut y: [Felt; NUM_COLUMNS] = [Felt::zero(); NUM_COLUMNS];
        y[0..NUM_COLUMNS - 1].copy_from_slice(&state[NUM_COLUMNS + 1..]);
        y[NUM_COLUMNS - 1] = state[NUM_COLUMNS];

        let mut result = [Felt::zero(); STATE_WIDTH];
        for (i, r) in result.iter_mut().enumerate().take(NUM_COLUMNS) {
            for (j, s) in x.into_iter().enumerate().take(NUM_COLUMNS) {
                *r += s * mds::MDS[i * NUM_COLUMNS + j];
            }
        }
        for (i, r) in result.iter_mut().enumerate().skip(NUM_COLUMNS) {
            for (j, s) in y.into_iter().enumerate() {
                *r += s * mds::MDS[(i - NUM_COLUMNS) * NUM_COLUMNS + j];
            }
        }

        state.copy_from_slice(&result);
    }

    #[test]
    fn test_sbox() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 8],
            [Felt::one(); 8],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x8b730b66413449b4,
                    0x8f7d83c66997e016,
                    0x60c731a748800c46,
                    0xe02fa4976a4f167e,
                    0x8dfe7f1ffe12d095,
                    0x0177410a21b45f42,
                ])),
                Felt::new(BigInteger384([
                    0x3f948164b71514cb,
                    0x6b4ff27b83d2fbff,
                    0x9b393d0169217ef4,
                    0x39ae8bb0abb868dd,
                    0x0c04c6a3a98d52d3,
                    0x00dbb2333e4bff21,
                ])),
                Felt::new(BigInteger384([
                    0x87327147f1987469,
                    0xa03e2717b0ef7ef4,
                    0x05758c5785659384,
                    0x8c1081f087740be5,
                    0xfe1b269c1defd5f6,
                    0x00a60b7e2574d023,
                ])),
                Felt::new(BigInteger384([
                    0xd60a906cf4783973,
                    0x027c2dbf6542e924,
                    0xe854ed9ad1cccf00,
                    0x70b9ba5093a04408,
                    0xa6844d7fbf373c24,
                    0x0181c3ef8e079597,
                ])),
                Felt::new(BigInteger384([
                    0x8e5a2cc478749bdc,
                    0x8eb3e6c6acca4669,
                    0x0ec5ea62a9e88401,
                    0x8bff349972d0a726,
                    0x7bbebbca317d75b6,
                    0x009f692ef321c94e,
                ])),
                Felt::new(BigInteger384([
                    0x707fab2b8746d536,
                    0x89424bf8976f0d5f,
                    0xb01c90f268a17095,
                    0xec65730e9911520c,
                    0xb49f4085c5a45260,
                    0x00478d25512b44e3,
                ])),
                Felt::new(BigInteger384([
                    0x0c2f88bea9661ed4,
                    0x10fd0d1c5098478b,
                    0x03cd290da269236a,
                    0x48ccb3a73aee6e53,
                    0xb287cd3db642f119,
                    0x0148a3ab2485c597,
                ])),
                Felt::new(BigInteger384([
                    0x325ae60906bb3744,
                    0xf19bc11dde17d2bc,
                    0x7acb6a48d741fbb8,
                    0x9a2fa2f6b7bcc8c6,
                    0xdd4563f0190664bc,
                    0x0003767230766633,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x5c17f0c0f74b4ef7,
                    0xf449a72fae4e9b44,
                    0xd64603c96b62ee1d,
                    0xd22bc565e4110edc,
                    0x8ea91c4bfed3714b,
                    0x019b594a3ed67d4f,
                ])),
                Felt::new(BigInteger384([
                    0x65a5085c6787f04b,
                    0xd820bf9fc6974f63,
                    0x7e7f29993102cf22,
                    0x1df9ffe9911faed9,
                    0x09cc39b18498a3a0,
                    0x01923b7f8e3dc73c,
                ])),
                Felt::new(BigInteger384([
                    0x1837413461ab771e,
                    0x97f704d68e58c956,
                    0xe58efb3e1fc9964f,
                    0xe5e4c95838dd0e94,
                    0x39d7d5adddcd5545,
                    0x011a4687901de353,
                ])),
                Felt::new(BigInteger384([
                    0x3328d28b69d0221e,
                    0xa610f3da7007c807,
                    0x10f525f373155c99,
                    0xaca4cc377a51d9e2,
                    0xfded3d9ee98ac5eb,
                    0x0067a22ceec83a6f,
                ])),
                Felt::new(BigInteger384([
                    0xf79ef487b13a3555,
                    0xf58c35fafdeb1bb5,
                    0x83f90eeb9ea98c33,
                    0x5a46db7c336d56ff,
                    0x7d148ea7745e598c,
                    0x00ae8a89f78a8dd8,
                ])),
                Felt::new(BigInteger384([
                    0x9d411bfb17e084b8,
                    0x9f4bd9b4ccf43f26,
                    0xbede7f4e041a6a87,
                    0x4ba51530d95bdb9f,
                    0x3694f45ffd2c843e,
                    0x01acaac876cbf68f,
                ])),
                Felt::new(BigInteger384([
                    0x93251dbba977ed1c,
                    0xb956e95e4d8a182e,
                    0xd2e29154184ba711,
                    0x44fdb6aed1865214,
                    0x691861b1244609df,
                    0x00b3958d9749e7f6,
                ])),
                Felt::new(BigInteger384([
                    0x0c1818bc058bfcfb,
                    0x67a17a2565c59aff,
                    0xd3e8bf9fd7654831,
                    0xdf2bc6acc7709489,
                    0x994658acb8c6eb36,
                    0x00b36590786cc076,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x1d5633a0a89ffc36,
                    0x280a02dadb3745e0,
                    0xe4a5e31c3dd223b1,
                    0xe8cdf4c36793206d,
                    0xe9937e5535b63165,
                    0x012d08f8ae5d5a7f,
                ])),
                Felt::new(BigInteger384([
                    0x4a93d581a2b4efe1,
                    0xf29e09fc9254a5cb,
                    0xb41787c272dc9fac,
                    0x138a61474711945b,
                    0x937475f94a89fa52,
                    0x006f73c4ec464e59,
                ])),
                Felt::new(BigInteger384([
                    0xac72b3a5d2a04d9e,
                    0xa6f3de5422d4dc22,
                    0xd7fd4e0d1e3df360,
                    0xb563911d06c3b381,
                    0x046ea8d5e0bd823e,
                    0x00e9ce1a154124b9,
                ])),
                Felt::new(BigInteger384([
                    0xaa243db676c76f5f,
                    0xd38d9b9c7bf6bf43,
                    0x86e3b49b2ccee344,
                    0xf527e063481d1677,
                    0x7adece0ed21cdd5f,
                    0x00d2aa182289868b,
                ])),
                Felt::new(BigInteger384([
                    0xcb80ae6fdc11e373,
                    0xa308db63b5a0a1cf,
                    0x9eee88bd0d829ffe,
                    0x2d7c592713862671,
                    0xbb25f28797c83500,
                    0x009f3c3cff11bcc4,
                ])),
                Felt::new(BigInteger384([
                    0x3a995ea118ce115a,
                    0x48bc7adbfd269f69,
                    0xb8c1d28242769e35,
                    0x4740045e0f22aaf2,
                    0xa3039b3a8ec42ccd,
                    0x00e26e93438ef162,
                ])),
                Felt::new(BigInteger384([
                    0xac2a5f0fdda637d4,
                    0x53ad56f734bb0ad3,
                    0xe5561e5c09baa4cf,
                    0x9a04489912d57c80,
                    0x38d0f789facda4c4,
                    0x0107cb78fc514bbc,
                ])),
                Felt::new(BigInteger384([
                    0xa3b482ab952aa203,
                    0x0db51389f2ae6180,
                    0x23ea80357846c489,
                    0x3016d787db02b160,
                    0x1ecac7c98a7a707a,
                    0x017ca8184b918b29,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x62b49426de243912,
                    0x92235678db83536d,
                    0xf4dbe1cdc73dba3c,
                    0xf5f09ab579286636,
                    0x3a9243758cb3aba4,
                    0x0175002f58a3eb7c,
                ])),
                Felt::new(BigInteger384([
                    0xda81e083f95af2a2,
                    0x8fa1088fa90ff47a,
                    0x71a962e8d9c86b24,
                    0x9d4f99bfc356493f,
                    0x554db6a35d0ce131,
                    0x018abd63d825ca5a,
                ])),
                Felt::new(BigInteger384([
                    0x3d3d7747e89a14da,
                    0xf074ec333a9fee16,
                    0xc689fc4b968b941a,
                    0x6d6d98251fa8f9a0,
                    0x2ac87acd870f65be,
                    0x0149c9cf9bc439fe,
                ])),
                Felt::new(BigInteger384([
                    0x26cb47cf9a730ec2,
                    0x23f577a2aaccec5f,
                    0x26488d59372d4518,
                    0x0fc35a809ee90708,
                    0x769b089ee2d6b061,
                    0x0039dd30e4e95d51,
                ])),
                Felt::new(BigInteger384([
                    0xe76f97cdd90065d1,
                    0x8026bd815fd40906,
                    0x5ea58f7cfbb1940b,
                    0x05e37c2d921a4ceb,
                    0xa1d2afb85a73d8f1,
                    0x0059ad4f6f309e6d,
                ])),
                Felt::new(BigInteger384([
                    0x9af314c7e01f7a9d,
                    0xac7210bf2b70abcf,
                    0xe2da80285ff7ee4f,
                    0x6f9c0dfd5d301b68,
                    0x081ad127120f5364,
                    0x00de4463ecfec88c,
                ])),
                Felt::new(BigInteger384([
                    0xd9b2abeb93749a17,
                    0x72ab601e1b5157a4,
                    0xb8d258f85f958871,
                    0x1b2d90be87eee48a,
                    0x021f0b7df58cca39,
                    0x004f82e6afb176d7,
                ])),
                Felt::new(BigInteger384([
                    0x3d425e49a6e4cc64,
                    0x7e197ef56cbf6e20,
                    0x86e4bc509d147f29,
                    0x6710a443b6d669bf,
                    0x6d1d2d1e46176d6b,
                    0x00fce8c0297ef059,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x41bda80c32983e34,
                    0x682bf2f2198df70b,
                    0x5ee464a846474899,
                    0x54d9f20ba46b80be,
                    0xaa5c019f58d04032,
                    0x0077b819e9564565,
                ])),
                Felt::new(BigInteger384([
                    0xa402594baea3e306,
                    0x3613dd445755d5eb,
                    0xcb8768306c11096f,
                    0x74171b42bb826cf0,
                    0x30202b992296f41d,
                    0x0173598528fe841e,
                ])),
                Felt::new(BigInteger384([
                    0xb8aff2ff59a56fb0,
                    0xe79ff08388d2280f,
                    0x5a7765cd07c6121b,
                    0xa93150b62ab45532,
                    0x029d4ee978cf3b14,
                    0x012e93d3efb37054,
                ])),
                Felt::new(BigInteger384([
                    0x78a7d5a6ae996109,
                    0xa249ca6e54106afa,
                    0xdb8a8ba0a39039ae,
                    0x1de87cc4c695944e,
                    0x0aefcbcd598ea12e,
                    0x00a5b96e574b915d,
                ])),
                Felt::new(BigInteger384([
                    0x5db302ba90882fa3,
                    0x4af53fc1343d4398,
                    0x6a32dd8d75da7822,
                    0xc0547995eddc67cd,
                    0xaa6dfd35e078e481,
                    0x013d212c5eea395a,
                ])),
                Felt::new(BigInteger384([
                    0xa32ce3587fa3bafb,
                    0x8223752e7be55bfd,
                    0x88bf019cbc3e40fc,
                    0xad9f551205f93f1e,
                    0x8716aff6771e2afc,
                    0x00ba39b501ce5fcc,
                ])),
                Felt::new(BigInteger384([
                    0x4d54d6e4d94b5717,
                    0x692a74cc5d6deee4,
                    0x75d9f9b579f804de,
                    0xbdc0f76f6551b371,
                    0xc9236006d6c0ae55,
                    0x01a4e62e6611c6a2,
                ])),
                Felt::new(BigInteger384([
                    0xd51e6b02bff1996f,
                    0x586dfae0cfa43354,
                    0x8751c68c4ec5eb39,
                    0x8a27a6fedd910f17,
                    0x28895331a6a5fbd8,
                    0x00f2909d78b310c8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x7316a9c332232d4a,
                    0x5d7f4fdcbd23d163,
                    0xddb2e0e3481e5107,
                    0x4c43522c633f92e3,
                    0xe904b31ebbd1b525,
                    0x0148b69cf2539567,
                ])),
                Felt::new(BigInteger384([
                    0x760e304471e5c59c,
                    0x57c433b0072ceb50,
                    0xd6e81c48f70d2125,
                    0x6a42e802f17a7b88,
                    0xd1f9ffc7a5845c53,
                    0x018833464978e3d2,
                ])),
                Felt::new(BigInteger384([
                    0xdfc6470c6deaea36,
                    0xf0ca32406f07a29d,
                    0x4c28619ccb9e0bb2,
                    0x36192cfe7169c9cb,
                    0xba11781ba445547c,
                    0x006b53274a6d71f4,
                ])),
                Felt::new(BigInteger384([
                    0x33123ed5ce7f8546,
                    0x0d57e3717a4961c5,
                    0x80a10bcb7b2f724b,
                    0x197176cd9c532288,
                    0xba031ed6f8ca19dd,
                    0x00bde1eebc2ac66f,
                ])),
                Felt::new(BigInteger384([
                    0xec19214f44c786bb,
                    0x9b34e24ce460d3d8,
                    0x2a9fc5ad2abe394a,
                    0x79a8d60b037adf1b,
                    0x55776e06e0652f48,
                    0x019cf95493508b5c,
                ])),
                Felt::new(BigInteger384([
                    0x3412d1306bb90918,
                    0x532be9d95bd7dd2c,
                    0x1c3e2501a8b1af21,
                    0xbe438b056f52c148,
                    0x89e3ca7b1d52feb2,
                    0x00093422915b7e7c,
                ])),
                Felt::new(BigInteger384([
                    0x2fce994745db4da6,
                    0xbedf71d6cfba62bb,
                    0xb1729960f61450f7,
                    0x9c42ac43052e904a,
                    0xffe63e929a3fc43f,
                    0x0073606e9fea6221,
                ])),
                Felt::new(BigInteger384([
                    0xc0eac66c4cf07642,
                    0x67dea3d7cbe56dd3,
                    0xf7e816f3839d2a49,
                    0x70947d26543e5a58,
                    0xf37c5f20a0e8bc6e,
                    0x0023c80001fcf815,
                ])),
            ],
        ];

        let output = [
            [
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::new(BigInteger384([
                    0x56dcddddddddddd4,
                    0x2db2015f37777772,
                    0x8a5a595c4be8b110,
                    0x2041bbb36e056126,
                    0x7e422da67ad9b5fd,
                    0x007c276e8cf025e2,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0x59b3fa50b6287770,
                    0x8d8cc2314dc632d6,
                    0x29b1a14daf4e27f8,
                    0xedb8547b775eb818,
                    0xd8e661a68b195234,
                    0x0105b860faad5b24,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
                Felt::new(BigInteger384([
                    0xa578190a443f6866,
                    0xba8dc4fbbf9b29b6,
                    0x7eb0b8ad3adf4bee,
                    0x878939a768b75022,
                    0x5a0c806ddc201082,
                    0x00b44682633de315,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x3f83be968f6712f4,
                    0x7a14ed2c157a3e9f,
                    0x13379f76f22125ab,
                    0xd2b0fd505a8223b8,
                    0x90580d58fcb34c3f,
                    0x0073a0b34fa4fca9,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
                Felt::new(BigInteger384([
                    0x6af47e2abade4fc8,
                    0x1a826133f52d710b,
                    0x6c3926ec49ea6ba8,
                    0xbfd567223db99dfb,
                    0xca056d88e9e47a82,
                    0x0036eb7a315a0db0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0xea911dddddddd44f,
                    0xce8327424777727f,
                    0xe774a906518e4834,
                    0x527cf56b51022fb4,
                    0x6e646cdc5f7b965d,
                    0x00eb6a2e45f61af1,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
                Felt::new(BigInteger384([
                    0x823ac00000000099,
                    0xc5cabdc0b000004f,
                    0x7f75ae862f8c080d,
                    0x9ed4423b9278b089,
                    0x79467000ec64c452,
                    0x0120d3e434c71c50,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xbdfcf4d41b2cf0a3,
                    0x718ae79b359af80e,
                    0x8a4f84dc1860207b,
                    0x1d47dd237fdf5830,
                    0x3bb4d9e2cfb36393,
                    0x00be965c6b71b106,
                ])),
                Felt::new(BigInteger384([
                    0xf03476118cc4dfdf,
                    0x52c67ff30f24b293,
                    0x5625b5b22369fa42,
                    0x70477c963452b9ca,
                    0x79d97e1732aef849,
                    0x00278c146f72eb4a,
                ])),
                Felt::new(BigInteger384([
                    0x9f2cb843375342b7,
                    0xbc5493a1af4e3044,
                    0x0c835ed49e738511,
                    0xcb327c383d4a2519,
                    0xe4b6942aac85878e,
                    0x009fac7aaefc2f72,
                ])),
                Felt::new(BigInteger384([
                    0xc4530f91f97081fb,
                    0x806756508dc5b6e6,
                    0xdeb8147511a70702,
                    0xecf8f6ef3b455bbb,
                    0x45da607688012e23,
                    0x00c32b5a184950b3,
                ])),
                Felt::new(BigInteger384([
                    0x0bc8cca0c7976d6c,
                    0x7880d08c7ea12fd0,
                    0xe364a801cb3a9e76,
                    0xcdca0dba11fe5de5,
                    0xf03821490e8d3ae9,
                    0x00a174065021f310,
                ])),
                Felt::new(BigInteger384([
                    0x04961f4fbee2899d,
                    0x4a7dc23508e1eb4b,
                    0x8204f1a3e673caa9,
                    0x7772d950bf7c2bfa,
                    0x3e735bb3d6c86300,
                    0x0045fca9db71a589,
                ])),
                Felt::new(BigInteger384([
                    0x1c7247e5de1cb647,
                    0x6fe60a9a50c8de83,
                    0xa70c4de6708983b2,
                    0x1053037424ab3e29,
                    0x5a744afa3372e0c0,
                    0x0077efcf54dc4332,
                ])),
                Felt::new(BigInteger384([
                    0xbaa69151d7fe441c,
                    0xd4117a66319e2b8d,
                    0x48f5f97df7c6c20c,
                    0xbd2899b79e1baddd,
                    0xc3df679b2b007fd5,
                    0x001912aa576020f5,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x04c0507972ba79b8,
                    0x727741f805b86f26,
                    0xccb1bc1e0024415d,
                    0x31e1f553f71952bb,
                    0x28a0b11f4bca2c5f,
                    0x00a0690d1810e283,
                ])),
                Felt::new(BigInteger384([
                    0xece436454d9495b0,
                    0x684b08e41a74f908,
                    0x101f496072c6c3c7,
                    0x4fed4089c70c8368,
                    0x00af0d6adfe35172,
                    0x015a3d4834fbcc6f,
                ])),
                Felt::new(BigInteger384([
                    0x57a8ad7b0348b956,
                    0x5aea3c7b1a6ea434,
                    0x814ad04d32651b50,
                    0x88c540e929b6f122,
                    0xe12759551bb475d4,
                    0x014cfff36f98301e,
                ])),
                Felt::new(BigInteger384([
                    0x2b364a0dfb176307,
                    0x1070b37ee791e8a9,
                    0x4be1b5a6c944735e,
                    0x285368288ce48125,
                    0xd13d11d2158054d1,
                    0x0066fe329fb4ed83,
                ])),
                Felt::new(BigInteger384([
                    0xc6c375f378ad2021,
                    0x3745fca3340c7c69,
                    0xaf62245447f71668,
                    0x9d618f6b8a7c83a1,
                    0xdc76e8ee69203901,
                    0x019ec499678a3d3e,
                ])),
                Felt::new(BigInteger384([
                    0xa4921b53ac999df5,
                    0xfc561a10f704d43c,
                    0xb2d3165eaf03be77,
                    0x59ab9e0e97f4f81a,
                    0xc2f52db236a3450d,
                    0x00172b0cd034bd63,
                ])),
                Felt::new(BigInteger384([
                    0xf7c624876c947b80,
                    0x34cd13dcafd5dc6f,
                    0xb77699d0abe62e59,
                    0x6058a0c269491b02,
                    0x86017f9470c5abee,
                    0x00f64dfdb4b7b0ad,
                ])),
                Felt::new(BigInteger384([
                    0x77944d845d364006,
                    0x9ed5d99095fceb3c,
                    0xe1f699398dfa7a6b,
                    0x7de17d49fe9be24a,
                    0xd1b6e8f32d510d95,
                    0x014461ecc0735bff,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdc672fc2fb2acfa8,
                    0xa19af2239bb0f76a,
                    0x604e37b0526cabe6,
                    0x075d1d6f9d2b8b3e,
                    0xd13e00f10be9fbe4,
                    0x010606bee0685aa8,
                ])),
                Felt::new(BigInteger384([
                    0xbdd97fb7d467377b,
                    0xb2c4261651ba6119,
                    0x63eae7dd27da3780,
                    0x0e435ab1c20220d8,
                    0xc8a9e5a0b4540067,
                    0x0027e8aa05b269ea,
                ])),
                Felt::new(BigInteger384([
                    0xd0e8ef1e22d01d30,
                    0x374240ce20ee752e,
                    0xafd822dc58831257,
                    0x9cd67a6f7750c231,
                    0x9e63fe2a8f1c4d6b,
                    0x01283d0346215de4,
                ])),
                Felt::new(BigInteger384([
                    0x8d2dca902faae07e,
                    0x44dc560bf96ec4ab,
                    0xdf9a19e5eebfc684,
                    0xb8971c4248a196fa,
                    0x901f1ff464d1a8b0,
                    0x01807da0c1e9af01,
                ])),
                Felt::new(BigInteger384([
                    0x8a109540261210a5,
                    0x88156c10d9b086a1,
                    0x3a92f906a02b5400,
                    0x1b9f24795af61322,
                    0x32611dfa8861aa7d,
                    0x0191715a88e90b54,
                ])),
                Felt::new(BigInteger384([
                    0x762a63cef9a04fbd,
                    0x13d912440a55e370,
                    0xf0abb8db86532a39,
                    0xa34c66417c94ca1c,
                    0xf5a09980eaaad87c,
                    0x00a6cbb56e73c58c,
                ])),
                Felt::new(BigInteger384([
                    0xe839697186bd5aca,
                    0x10ee6ec9f5b4f8b2,
                    0x8e52fd9cb1e26286,
                    0xebc54059424470c8,
                    0xd8321caf23a9b8e4,
                    0x0133f29c560da645,
                ])),
                Felt::new(BigInteger384([
                    0xcfdaa08f3b1b4d2e,
                    0xb646fd9fa6743881,
                    0xc1c05e87ef5b33ff,
                    0x44a6da81a9f3bb26,
                    0x39157a206cb73a3e,
                    0x00dba8741546861a,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x512029f8ace2f1df,
                    0x85f230c2a94e9f53,
                    0x00b0982346aa2331,
                    0x1e88a333b50d0c06,
                    0x449142f1e9b2b606,
                    0x019d8c5431677ed5,
                ])),
                Felt::new(BigInteger384([
                    0xc18bd2f1f57db4e6,
                    0x439bd122f13fd8a3,
                    0x33909997aabcc3c3,
                    0x81473fe1065af1a7,
                    0x2a16323041bd7153,
                    0x002a137676dfa4b7,
                ])),
                Felt::new(BigInteger384([
                    0x89ddf3b5a7708d81,
                    0x6cf73389a9a5a829,
                    0x08fa482186b326c3,
                    0x9c075d754362fe6c,
                    0x3be4cb948e251fed,
                    0x008a3237006e1052,
                ])),
                Felt::new(BigInteger384([
                    0x72fcc52ab0a0ca3a,
                    0x7ef2c2063f402ac9,
                    0x5c389ab47f2d0afc,
                    0xba3874414f318e51,
                    0x40f8ffec79d64d97,
                    0x019fc2445ff10629,
                ])),
                Felt::new(BigInteger384([
                    0xce8c06c3ab6dd43f,
                    0xaf72628acede20d2,
                    0xe9cb54bb59fa4cfe,
                    0x49f01625af755fe8,
                    0x89a0bbec3716390c,
                    0x0179470793950eb9,
                ])),
                Felt::new(BigInteger384([
                    0x93259d4013e7c8dd,
                    0x8ca866a278a601c9,
                    0x0c93a28785bd785c,
                    0x8e934aea1322d315,
                    0x35d5b886329998c7,
                    0x01677aaeb5393e66,
                ])),
                Felt::new(BigInteger384([
                    0xebe859eb10e4adfe,
                    0x0297be275ef9baed,
                    0xcc102a6e35dbc05b,
                    0x42786be320342a1e,
                    0x13ac4b219313c7bf,
                    0x0004ad0831cdeb95,
                ])),
                Felt::new(BigInteger384([
                    0x88f641ffebedfb9a,
                    0x0905397b2f00b8f0,
                    0x1239be7ca14c5150,
                    0xe53562fed27bab00,
                    0xe7d776344ee8c4f7,
                    0x000d684636462110,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xc67f87478a372b20,
                    0x2da5e8486959dde1,
                    0x0a0122ba78b6f0f7,
                    0x338275a48891b596,
                    0x0eb0fce8dc86e01d,
                    0x017f8cc13f3d7b9e,
                ])),
                Felt::new(BigInteger384([
                    0x60594f0163b9dfda,
                    0xfdb6a01e8006293c,
                    0xed33734ff0cbdf0a,
                    0x6844da5f01eb6928,
                    0xc3e2fad792095ae0,
                    0x0116ad3efdfbe881,
                ])),
                Felt::new(BigInteger384([
                    0x285c514ed0570b96,
                    0x33b2cbd25d9c1293,
                    0xb4b8778660b726bc,
                    0x5be0395f32e6fd85,
                    0xdd85f8fdcb85856a,
                    0x01405d7c696c7268,
                ])),
                Felt::new(BigInteger384([
                    0xd8a411fefa135a95,
                    0x9b2f1d2452239f92,
                    0x124cb8845ed4ab76,
                    0x384fdfac2dc2d271,
                    0x9a0caaf28b68b465,
                    0x005b3b84c825b7df,
                ])),
                Felt::new(BigInteger384([
                    0xebaedcb01b52babe,
                    0x2340f24adf4864e1,
                    0xd60f219b4684adf1,
                    0x90e10bc7e23ad4bf,
                    0x3d7c38e868c2c83b,
                    0x015cbf693ee72e9b,
                ])),
                Felt::new(BigInteger384([
                    0xe88a5eb65f79f619,
                    0x12262da4db5f9808,
                    0x712884e9e7b29f24,
                    0x9d7592d72f72b136,
                    0x429a0102b49e5a2e,
                    0x014b32a64cda64e4,
                ])),
                Felt::new(BigInteger384([
                    0x02317ff61cb7bbc6,
                    0xf85ed0dc3f078cbf,
                    0xb3e0165af478a3c4,
                    0x22bab7e4b0101dd6,
                    0x086bd64aea3df0f1,
                    0x019dd86db0dc792f,
                ])),
                Felt::new(BigInteger384([
                    0x5abdafb1324c69ff,
                    0xf9f585d8bd09968d,
                    0x32aec8f3fab5411f,
                    0x3d03a58a6835ee1d,
                    0x5513fb5dfd8a44c5,
                    0x006d2f8fc58aaaec,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x30c4f8ddc66a58ba,
                    0xa6d98c68c5853d6d,
                    0x88b3de0b4ddc0a22,
                    0x958cb942dad5be2b,
                    0xcc9a81b63c4119ae,
                    0x00a5640806b0bbe4,
                ])),
                Felt::new(BigInteger384([
                    0x49bf81c5d33e5af8,
                    0x89d96c3634d0940c,
                    0xce074dd4ba9673df,
                    0xe44ac1d09098409f,
                    0x45975d53551a20ff,
                    0x0074467c5cde4cc1,
                ])),
                Felt::new(BigInteger384([
                    0xfdc16ed04c2d6eeb,
                    0x80ee72318a92faa8,
                    0x06e6ba046109ce85,
                    0xdb15eed8aae4c5ec,
                    0x988ff1f5e1a6c1be,
                    0x00541852ac556cc4,
                ])),
                Felt::new(BigInteger384([
                    0xa18b83ecbdc799d3,
                    0xc30f4a6661ecd036,
                    0xf43fff73ad4348dd,
                    0xa6bd05daffd61fd5,
                    0xc056ed493bc236a6,
                    0x00a0bee7c17ddeb4,
                ])),
                Felt::new(BigInteger384([
                    0x2d0971cd706c1782,
                    0x6f29caa727cba8e7,
                    0x2350d66f033073ac,
                    0x9eeb82aef91d462c,
                    0xdb0a62e0310f1b2b,
                    0x008e0cf7f5b730f1,
                ])),
                Felt::new(BigInteger384([
                    0xdb3390c4afeeff99,
                    0xe63125d6f6d4f946,
                    0x9ab2305a51a267a0,
                    0xb42a3b55008958ac,
                    0xb9345734a32c0f44,
                    0x015167c6ec2a2733,
                ])),
                Felt::new(BigInteger384([
                    0x222dcff2cbea539c,
                    0x90450d59971e3de8,
                    0xfca8f52b4bedd1b6,
                    0x415b81929081572e,
                    0x5ebf8f92188a9f61,
                    0x0176ee6f58a12cc6,
                ])),
                Felt::new(BigInteger384([
                    0xd1477d1812d234bd,
                    0x2e5e5818ac8e9b78,
                    0x6cdbce52587bda0a,
                    0x9c70bc9a22a2e40d,
                    0xca4b90570c27ea4e,
                    0x00ef0dd5ddae50f8,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_sbox(i);
        }

        for (&i, o) in input.iter().zip(output) {
            assert_eq!(i, o);
        }
    }

    #[test]
    fn test_mds() {
        // Generated from https://github.com/Nashtare/anemoi-hash/
        let mut input = [
            [Felt::zero(); 8],
            [Felt::one(); 8],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
            ],
            [
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::one(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x8622467a6d034d26,
                    0xcec2560b17b57613,
                    0x342e05a88ace4193,
                    0x1ccd1762688c1bd5,
                    0xf1dbeed66bd90c87,
                    0x0148fccb3d103fc5,
                ])),
                Felt::new(BigInteger384([
                    0x52c8b130695947d6,
                    0x9199ac1620a8eda1,
                    0x03182a83cef7623a,
                    0x430776bae761196a,
                    0x0e08c960e811c2df,
                    0x0033410fc7f2507d,
                ])),
                Felt::new(BigInteger384([
                    0x941f54d7fd95e7aa,
                    0xc8a9e7ad0b5ce639,
                    0xe2feb355dc7d3842,
                    0x0406f0b27b3e66ba,
                    0xed9de9a63c49c8ff,
                    0x0171b913d53bebc9,
                ])),
                Felt::new(BigInteger384([
                    0x82bc2a68acf815c4,
                    0x6165f4c03c7b0244,
                    0x4b4441c87122249f,
                    0xe280641efe47a432,
                    0xe68a15322cf63ea9,
                    0x000ad776192199cc,
                ])),
                Felt::new(BigInteger384([
                    0x95f823393ba2e2e5,
                    0xed4f7c1461ee1373,
                    0x5027df3ebd09fe43,
                    0x5ae451c97e06a64a,
                    0x76f7c15ecb760598,
                    0x007f508884712e4f,
                ])),
                Felt::new(BigInteger384([
                    0x261c8960f8677530,
                    0x17c4e64399025ba0,
                    0x1dd7ef3c181f382d,
                    0x992b5369a39d48b5,
                    0x9218c5b4a204f327,
                    0x00d85e657e56f6b1,
                ])),
                Felt::new(BigInteger384([
                    0x265a3eb3a204e5ca,
                    0x95f51098d4d97594,
                    0xfc34d74e20f7d43c,
                    0x4654f44947d03a76,
                    0x6adfbdb5a7a438e4,
                    0x0189df4f8388f823,
                ])),
                Felt::new(BigInteger384([
                    0x6e5a291af8cec99e,
                    0xf26bf5f2d6541e43,
                    0x1a2c08066d381448,
                    0x10cc54761cfdf381,
                    0xf90eebe1343d697f,
                    0x005bf0ea9a3c59c1,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x88e77ecd239af354,
                    0x48763f578dd615f3,
                    0xb6ea8473bafdc729,
                    0x4463ae3655bff36b,
                    0x13d6e55617a8b47e,
                    0x01910f7543ef0ded,
                ])),
                Felt::new(BigInteger384([
                    0xf5cbe87a44828703,
                    0x6d08f3f99684cede,
                    0xc372ba08883297e2,
                    0xb772c8300b497c65,
                    0xfab8caa70e06c799,
                    0x017ec05349332a79,
                ])),
                Felt::new(BigInteger384([
                    0xc66d93ddcb2affe9,
                    0xc1188e2639bd7083,
                    0x16e498b7ae18be6c,
                    0xeb31684e55cffc06,
                    0x2893b1fefc8a88c3,
                    0x00ff63748f8e6952,
                ])),
                Felt::new(BigInteger384([
                    0x5cd5554ee380cfe0,
                    0xde61b3e61d8184b5,
                    0x834b073f13e253a7,
                    0xc85e841f73a5ca56,
                    0x2ce0f9161cf827b2,
                    0x01635ab8f0d9ff6a,
                ])),
                Felt::new(BigInteger384([
                    0x5c5948d6b2e7b817,
                    0x32f82a2bf24f94b2,
                    0x58b08d542d0d13eb,
                    0xb72fdcb4b201b42e,
                    0x96cc30658452c41f,
                    0x00d7543a95e45d83,
                ])),
                Felt::new(BigInteger384([
                    0xb33b529eca552728,
                    0x8ccd2092622dff03,
                    0x221e980d30ebfa91,
                    0xba8e2de6b3e2e497,
                    0x616c9fac9c56f0c5,
                    0x00442c5eefd147fb,
                ])),
                Felt::new(BigInteger384([
                    0x5b860d85ac81ba62,
                    0x8502b81f4e767d58,
                    0x9881abb2e6af7580,
                    0x8e59b30ba622b674,
                    0x0a9735befd91c085,
                    0x007dad5197a0d388,
                ])),
                Felt::new(BigInteger384([
                    0x27810d3fa0718162,
                    0xe3f9491df966439d,
                    0x464943b599536921,
                    0x382597b5c8aba617,
                    0x95c4e10b7f53eb5f,
                    0x0116448b5ed17fd8,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xdd3b04133d4027a5,
                    0x8fa5d67ed93febe9,
                    0x602740c34aa5c25a,
                    0x15bef1771c41e5e0,
                    0xe09b284220296743,
                    0x0188e1e4bbb0d009,
                ])),
                Felt::new(BigInteger384([
                    0x6d602a473bf9856a,
                    0x538fee3540083a27,
                    0x446bb14d0518a774,
                    0xa2dec0d6ee4a7da8,
                    0x85bc8015c65d3f8f,
                    0x000426c941c22c7d,
                ])),
                Felt::new(BigInteger384([
                    0x02d09fd3f58eccc4,
                    0x9d194ead0428df08,
                    0x88c224ac747e5e93,
                    0xbb43e51f7e852606,
                    0x607637b97f921d3f,
                    0x0063e6bc2ed14ef4,
                ])),
                Felt::new(BigInteger384([
                    0xed80aa223a672323,
                    0x8a4d3f77ea7d7bab,
                    0xdb6422b659884631,
                    0xafea7ac4cf661161,
                    0x06e2c903c3d70c2e,
                    0x0134f4967c0e1aa1,
                ])),
                Felt::new(BigInteger384([
                    0xf4b8927f19395a64,
                    0x9c0725bbb8382fa9,
                    0x35cad08976a9a6f5,
                    0x3c8dab7b68e7525d,
                    0xb0fd8209fdab60b1,
                    0x00ac152cd848922c,
                ])),
                Felt::new(BigInteger384([
                    0xe40c6d6f2b49e437,
                    0xdbbe0c5874b4613d,
                    0x3fc06562c587b810,
                    0x9a30c68258d3ba93,
                    0xc6a9a4f10b39151e,
                    0x002b864d79b203fc,
                ])),
                Felt::new(BigInteger384([
                    0x18c2ae77714192e5,
                    0x5e07a3e303d85ca9,
                    0x6db34afc578cea39,
                    0x5df2f3f36e4bb575,
                    0xab93919ba39fe772,
                    0x010aea2900d2f5e3,
                ])),
                Felt::new(BigInteger384([
                    0x431a6467bed74d36,
                    0x11ea239dbc5f842a,
                    0x3de81cfb31c2f03d,
                    0x72e80e5109f4f817,
                    0x968cc1be629ef3b3,
                    0x00270786042717b7,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x414242a0fa791a90,
                    0xa04b0f0961fe404a,
                    0x9fcdecdd44b8c57c,
                    0x16d036803f655fdd,
                    0x3d2964771dd6001b,
                    0x00d12016349a5d4b,
                ])),
                Felt::new(BigInteger384([
                    0x75c297833b97ccc4,
                    0xeb62e01139c42169,
                    0x0fedb611d13aba64,
                    0x998bd4ee8ffaabce,
                    0x0e4f7712dde3da3a,
                    0x00d92785e62d5e63,
                ])),
                Felt::new(BigInteger384([
                    0x74ed7065df83d0a9,
                    0xb7bc636348885ee4,
                    0xb0931b7a4af4cf59,
                    0x9b1a3341aabdc7c8,
                    0xe83854a869c62f19,
                    0x0056271579fe37e1,
                ])),
                Felt::new(BigInteger384([
                    0x5dfe5cb766cd18a0,
                    0x72d479d33362e88e,
                    0x9cede035d3cb33d2,
                    0xdb5ede851d720174,
                    0xb386a68c952d33b6,
                    0x011c378efdf1cd8c,
                ])),
                Felt::new(BigInteger384([
                    0x8e7a57f66c747ac0,
                    0xd39258ff79259936,
                    0x0967d1a59057cd97,
                    0x19ebd334462eccb5,
                    0xdc46bf702bda9328,
                    0x00d576b69a274cd8,
                ])),
                Felt::new(BigInteger384([
                    0x83c51e4723667916,
                    0x2a42534b3774fb4c,
                    0xb113067bb0f973dd,
                    0xeab904087aa9b56f,
                    0xed24941f7bafeefb,
                    0x0035f986f61cbef9,
                ])),
                Felt::new(BigInteger384([
                    0x306eb9f2af8060bb,
                    0xeb903887b464d976,
                    0x0e04ab76f563d7ee,
                    0xfcd58e94012d2d27,
                    0x93610fe3a293d7ba,
                    0x0122c82f62558e9f,
                ])),
                Felt::new(BigInteger384([
                    0xe08c83b00daae394,
                    0x1f4ffdd0367cbc3d,
                    0x1977dcc31f4254d2,
                    0xc613962a287b23d4,
                    0xe4fd19b09edd5425,
                    0x016c71d8d91c5bcd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x442465a0e2d8d5ea,
                    0x77f74ff40e3626ca,
                    0xd5301d029b486569,
                    0xc12018c5e6730c7f,
                    0x6c1f9ae4f6e10a56,
                    0x00a2b22b0d06125a,
                ])),
                Felt::new(BigInteger384([
                    0x36c389440757b83c,
                    0x8c0227d694530a98,
                    0xb1510cd01cd6a789,
                    0x3b4438c15e8ee227,
                    0x6b6950bdcd310e1e,
                    0x013b5404bfcfb4e4,
                ])),
                Felt::new(BigInteger384([
                    0x2cceb25a4056ee65,
                    0xc0a84792fd8ef297,
                    0x71587e33547a3cee,
                    0x945ae6547e8b7ae2,
                    0x0b6887177b79d3af,
                    0x01679525587e5208,
                ])),
                Felt::new(BigInteger384([
                    0xa70f505abd5236fc,
                    0xcc7efe97ce3ed590,
                    0xb91e9da67f297428,
                    0x0fda465629c24ec3,
                    0xf1787d07c9b527d2,
                    0x013154b9ac4a8f49,
                ])),
                Felt::new(BigInteger384([
                    0x3a65de9a1380556e,
                    0x223b322e4b1f59f3,
                    0x635838c379dcc507,
                    0xd54abdb9293e97a7,
                    0xa9935ba7b68642e2,
                    0x00535ffe0f87eb56,
                ])),
                Felt::new(BigInteger384([
                    0x378909bef48f41c5,
                    0xa7da878dd4f14654,
                    0x3ed4861c91cc5146,
                    0x9648ee85e05f621e,
                    0xc1b4695f1ebd3bd5,
                    0x003fbc5a6bcc3b4d,
                ])),
                Felt::new(BigInteger384([
                    0x820f394aef6c7f33,
                    0x8c0243fdde4931cd,
                    0xc0eebd4c6599eb16,
                    0xd0fe4bd41dadab30,
                    0x2a620716cfc263fb,
                    0x01142866f2365061,
                ])),
                Felt::new(BigInteger384([
                    0x4038a0d069ef004d,
                    0x81f1c1c786b7d74b,
                    0x90ec7da2ae14f06a,
                    0x24110e832ee56ac7,
                    0xaad0e58e2a9319e2,
                    0x012adb0fa24e68c6,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xe4ef7827e18905fe,
                    0xe39fe571351ae335,
                    0xbbec4081dd4e3734,
                    0x10772bf6787d662f,
                    0x435fa3831cdea55e,
                    0x0089c1202131d0fe,
                ])),
                Felt::new(BigInteger384([
                    0x754ceed292444a9b,
                    0x15bd673bc79f17f9,
                    0xed005febeea228a0,
                    0x824de2f771133308,
                    0xd92877c11d3c356e,
                    0x00c938310ad656f7,
                ])),
                Felt::new(BigInteger384([
                    0xd354ef9ba52d1c54,
                    0x45a31fd04ba20a4c,
                    0xf8f7f5ded67a919e,
                    0x50b3c29d4b51e5eb,
                    0x666b57a4e51df533,
                    0x014655b66be6fbfc,
                ])),
                Felt::new(BigInteger384([
                    0xc19a8e45fae67707,
                    0x1a89239fbf6e4204,
                    0x883790c9a6de2b23,
                    0x27dbefa94567fbdb,
                    0x2a916d4c7bdf5935,
                    0x008065099ac9a4d1,
                ])),
                Felt::new(BigInteger384([
                    0xc68a27bbe5e0afb5,
                    0x13be9dd353cc4277,
                    0x8cf60e13c06da4a1,
                    0xc540c513f8a4c2cf,
                    0x169acc7dcc036087,
                    0x0157f025d9ba3452,
                ])),
                Felt::new(BigInteger384([
                    0x8c8c15cbcc8b5f11,
                    0x74326409600bc61b,
                    0x20664fbfe0813dc8,
                    0xf5e501a1cba35a04,
                    0x62138f88f9ce6dd2,
                    0x0023708d6e536597,
                ])),
                Felt::new(BigInteger384([
                    0x21ba2b19fc403247,
                    0x6e25deb244e2d901,
                    0xfd525a47eb3a1b36,
                    0x971c03a7de4fa503,
                    0x732f548d1287d44b,
                    0x011ef71a7698f68f,
                ])),
                Felt::new(BigInteger384([
                    0x8d82ece2d4cdd04b,
                    0x23085f5de5093de5,
                    0xd7275e8eb6f1f5fa,
                    0x6594d264042d3ca0,
                    0x93dcea917c9fb8b3,
                    0x000b7cc46f199e9c,
                ])),
            ],
        ];

        let mut input2 = input;

        let output = [
            [Felt::zero(); 8],
            [
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
            ],
            [
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::new(BigInteger384([
                    0x09907ffffffffbd6,
                    0x0aada2101ffffdd6,
                    0x1e892543555a2fa0,
                    0x2ae0721e037c8e09,
                    0x8e3a0cbba8650fe5,
                    0x0081582105678e62,
                ])),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
                Felt::zero(),
            ],
            [
                Felt::new(BigInteger384([
                    0x7f4ca094d870a59a,
                    0xe7caf533a48936f4,
                    0xa12997d1f213f231,
                    0xdb1de7f93f56c82d,
                    0x0248bf997a1e8aeb,
                    0x0123c1d8cb551368,
                ])),
                Felt::new(BigInteger384([
                    0xefacee4907e94277,
                    0x443467985c1c3a9c,
                    0xbc4f4bd50007d077,
                    0x140de7f995f3e15b,
                    0x4b9d98ad7bef5316,
                    0x008af09f3f52fc72,
                ])),
                Felt::new(BigInteger384([
                    0x11689fc6c0a06f3a,
                    0x4e4ad23d793d9d88,
                    0x6200bb9b5c0f76b9,
                    0xb4f233e0fed767b7,
                    0x55842d271fe4d6de,
                    0x014bd8c390cad4c4,
                ])),
                Felt::new(BigInteger384([
                    0xdbb391cbe56fa991,
                    0x6837423227990645,
                    0xd1c48feb013afb70,
                    0x4308ad35a471ec5e,
                    0x6aa0427bd7ec503b,
                    0x0104d2ca1e7b0b2a,
                ])),
                Felt::new(BigInteger384([
                    0xe10203f63ef296e3,
                    0x2c699c76e04e4814,
                    0x00f5aff3d6929fc7,
                    0xdd8032159d9335ef,
                    0xc78793c83b437d5c,
                    0x013b9c9794220b71,
                ])),
                Felt::new(BigInteger384([
                    0xa3e00a63fb4fd4bf,
                    0x652c99b2aa10cd9d,
                    0xb35e44f72285b594,
                    0x8a0358b648d419fe,
                    0xb5776c3112f8ab59,
                    0x0062dda95a5d5fd8,
                ])),
                Felt::new(BigInteger384([
                    0xaf771b310b4f483d,
                    0x74f6fb4828d349b1,
                    0x1ed4c2e8d542df9c,
                    0x087ac222b5db8c5e,
                    0xbbeb5ac88824db27,
                    0x0070b31446e21a33,
                ])),
                Felt::new(BigInteger384([
                    0xc4bd655262808080,
                    0xc3204d95979fb504,
                    0x58136e9b30a543c4,
                    0x64b5fd4f055f03c3,
                    0x774bb4e11397cb54,
                    0x0074917a913fefcd,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x88e2ceefa8f5e9c4,
                    0x5f9c98fb005a53f7,
                    0x97469aba38da6edc,
                    0xa8a691a262d16515,
                    0x0732e27b56869690,
                    0x00d1837e07f3b4b4,
                ])),
                Felt::new(BigInteger384([
                    0x776ee35d418000a3,
                    0x510ed59dc4c78aa5,
                    0x6aec03aaecdaeb1a,
                    0x7dde01a144db8590,
                    0xd96c02126c554f16,
                    0x0190e43b0f6967d1,
                ])),
                Felt::new(BigInteger384([
                    0x7d49e035c3694b75,
                    0x0448ca5346798dba,
                    0xb79bec092e60000e,
                    0xe0015fab9208c099,
                    0x8e25b8f453c20218,
                    0x0199fab36d06af6e,
                ])),
                Felt::new(BigInteger384([
                    0x8b71a0a9f1a1d0f0,
                    0xd0fab34e959989ef,
                    0x6b07defc47611ddb,
                    0xba8db9e1dc9f48d4,
                    0xd0bd6cf527279788,
                    0x0088f1d3ff0149ab,
                ])),
                Felt::new(BigInteger384([
                    0xe3b51527d0710c90,
                    0x2d88d1a4ea5fc1ab,
                    0xf46a4c98a34da617,
                    0x905a18a2fe82c917,
                    0x09411771dfa4f8b7,
                    0x0069b0a4bf7300ff,
                ])),
                Felt::new(BigInteger384([
                    0x4b5a244f11c22168,
                    0x473cfcc3f305e764,
                    0xb8a10dd8f8ce662d,
                    0x3043d9f8ec904b8f,
                    0x65c44b1a814d73ff,
                    0x00b2aae2c224c484,
                ])),
                Felt::new(BigInteger384([
                    0xf2d1a3e4ed88b6ed,
                    0x917d22443b754e5e,
                    0x6ed53fdd683442b1,
                    0xdb393574d2f11fb3,
                    0x82b9e6865bc74024,
                    0x009284ec6bb0c615,
                ])),
                Felt::new(BigInteger384([
                    0xae099e3fb794d826,
                    0x30947e8a4d9d593c,
                    0x21d42158c9365ce3,
                    0xe879a9fb094dbd47,
                    0x7c04cd7153e51c5c,
                    0x004efa0c8a1c9958,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x89a42c69138caffd,
                    0x772e08a951125723,
                    0xeb697cfd1738218a,
                    0xf07c5f0272e9a90d,
                    0xe93b6194eb4c2a2c,
                    0x00e9051787f0b792,
                ])),
                Felt::new(BigInteger384([
                    0xcec02a995e170f5f,
                    0x5807ca3de4ebd442,
                    0x289e54f12473b97a,
                    0x96a908195c8d29d7,
                    0x7cddab9b7b948609,
                    0x00b3b3483caddd26,
                ])),
                Felt::new(BigInteger384([
                    0xe8d650f25e62cf6d,
                    0x134b4b3a013ee0fc,
                    0xb3d11870fe898fd7,
                    0x4b02d1714f645503,
                    0x2d4ec601fd91242d,
                    0x015a9eebb7fd6d4c,
                ])),
                Felt::new(BigInteger384([
                    0xa3dc623fd046bbe6,
                    0x6a4823dff04878fb,
                    0x20c26fb997c7e32f,
                    0x08ece96241e23d88,
                    0x87e38d1d162eb7da,
                    0x009563b6182d0ead,
                ])),
                Felt::new(BigInteger384([
                    0x571c1c3365e620b2,
                    0x0398ae21b9f45538,
                    0x8cbd97927084e7a5,
                    0x5f5725a413d53030,
                    0x25d934a693d67395,
                    0x002c4a7cdc22be00,
                ])),
                Felt::new(BigInteger384([
                    0x6c6ac02ae4694187,
                    0x242edabd5ec563e0,
                    0xb77ed7030d310894,
                    0xfe65d2cf53956e71,
                    0x31dd4080b69f92a8,
                    0x015e74ab0adc2d00,
                ])),
                Felt::new(BigInteger384([
                    0x40225d2b826928b5,
                    0x516d932b09898c4a,
                    0xfe66d4dfc6103600,
                    0xc96a6ec56d7cb8dc,
                    0x4b2236fc8859a282,
                    0x00ee733ca2c271b3,
                ])),
                Felt::new(BigInteger384([
                    0xc9880a14638c4c05,
                    0x3b7c2a2b09bbd6b7,
                    0xccc35e770c817430,
                    0xb716d0f1ba473902,
                    0x05fe83ec9ebe8d58,
                    0x000611d2308ba742,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0x2bc09116297fd283,
                    0x0e820b8e36fbd926,
                    0x8ad153f5f922e20c,
                    0x2a447fa87a5264ed,
                    0xe3cc673f48e9f7fc,
                    0x00a08da1c14a6157,
                ])),
                Felt::new(BigInteger384([
                    0xdb59493ad8211e5a,
                    0x24874c6a7f0d1247,
                    0x7cec320063d469d9,
                    0xe16bdae230ed5b6b,
                    0xc26034f885a29561,
                    0x00d06f29b28f167f,
                ])),
                Felt::new(BigInteger384([
                    0x279dd8e8ee0a84b2,
                    0xe82d83b05d342c42,
                    0x600bd110edc5e553,
                    0x22546fb9f40b51b5,
                    0xee4f181a8e671605,
                    0x009566904c5da86d,
                ])),
                Felt::new(BigInteger384([
                    0xdf7c9f9077013eb1,
                    0xe303b8a082828857,
                    0x3069c74627c54c25,
                    0xc24fa4c17b1be92a,
                    0x3981eba1d2dae31d,
                    0x0145a7653d576d6e,
                ])),
                Felt::new(BigInteger384([
                    0x91a1a77d339a1136,
                    0x8a077aa5344418e0,
                    0xb164b9da67cd8637,
                    0x7310aab49c7a55b0,
                    0x8ca3047399aa4cc9,
                    0x01a75ab991d1b8ff,
                ])),
                Felt::new(BigInteger384([
                    0xaf2dc8650047a50f,
                    0x02b527b0238bba05,
                    0x0f9e7a98d42f9388,
                    0x82a6235a2418e396,
                    0x6be3595232f38cae,
                    0x017f9f7e228c9f37,
                ])),
                Felt::new(BigInteger384([
                    0x78c3060ccf6d72ae,
                    0xc4f58f30abbad86e,
                    0x52399735c39cb9f0,
                    0x5d898f5264a5a830,
                    0x02ff1fc963ef70c5,
                    0x010b85593f2e9fb9,
                ])),
                Felt::new(BigInteger384([
                    0x009f753317dc6004,
                    0xd6b7a1b9fcda7c27,
                    0xa71e3c99a1bacfc8,
                    0xe7ff4f1738cff9b2,
                    0x8638a96716c5091e,
                    0x00dd6d0e812ff8d0,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb59044a9a2d50fe0,
                    0x8e998da748639740,
                    0x18c0766df66ac34a,
                    0xec1d8966bb8b827b,
                    0xa9d759e765a0125d,
                    0x0188458f239dd581,
                ])),
                Felt::new(BigInteger384([
                    0x69fb0d366add9653,
                    0xf160e76499021cad,
                    0x98a994995957dd05,
                    0xca288e47e023d1d4,
                    0x85358b920e332b89,
                    0x0034c00638e118e4,
                ])),
                Felt::new(BigInteger384([
                    0xec4e69c2d961f9e5,
                    0xc4eee885e5333582,
                    0x6cfcf39078935286,
                    0x6fb6a0ae8d0c3ae0,
                    0xfe701520e7ff159d,
                    0x00d7612aff2fe108,
                ])),
                Felt::new(BigInteger384([
                    0x45fb1f926fdf4888,
                    0x2b3aa29d0dc7e94e,
                    0xaa3963f4af5f7771,
                    0x81e541dd442c2e6e,
                    0x777d31ecae3f5b4c,
                    0x001a4affcb91acef,
                ])),
                Felt::new(BigInteger384([
                    0xdf29a078f25ac1da,
                    0x705b2b1d42083490,
                    0x0dbe24994d13dc47,
                    0xfb03dca5d5a982b6,
                    0xb1fc43088df609c7,
                    0x0147464ea1acfd6a,
                ])),
                Felt::new(BigInteger384([
                    0xd39d348c5e09efa9,
                    0x1be346431a138ffa,
                    0x97227a6c48bac963,
                    0x2e39ed753e444483,
                    0xe100d490ea5724ae,
                    0x004883f5c76f1fe8,
                ])),
                Felt::new(BigInteger384([
                    0xe0c3fec934d356db,
                    0x52c6b73e8695534d,
                    0x57dfd3f54e3c4142,
                    0x4a7ffeeb6f0c8d90,
                    0x044217f747f724b2,
                    0x002f7e2518c2891c,
                ])),
                Felt::new(BigInteger384([
                    0xa79cfd6024b5967d,
                    0x22cd6f41e0ca89c2,
                    0x79f58bd1b2ffe5ba,
                    0x2b5ae197ceca55d0,
                    0x6dcd729dae9db8a5,
                    0x01314f82ff5ccefa,
                ])),
            ],
            [
                Felt::new(BigInteger384([
                    0xb69bb103aedaee53,
                    0x8f1cdf604248d5d5,
                    0xd6a917f93f642c7a,
                    0x5d57d54b4d8d1df5,
                    0x166201323210f521,
                    0x005625088ce3dba2,
                ])),
                Felt::new(BigInteger384([
                    0x7093e371d1d966f5,
                    0x0d3bc416d16e4ff0,
                    0xec45748436b12623,
                    0x1fd954e4aec31c1c,
                    0xd25f890777723ab0,
                    0x015126cee05bedbb,
                ])),
                Felt::new(BigInteger384([
                    0x2f9afaa919f27f25,
                    0x23822c393c235aa8,
                    0x632f00e0d5bfcd0b,
                    0xd1ff2540d20f0c94,
                    0x508461f9ac8b5dbe,
                    0x002b36c1224814f1,
                ])),
                Felt::new(BigInteger384([
                    0x7c0872e5f07f6734,
                    0xb56b1f2cd6ad7412,
                    0xac324c30b6c49072,
                    0xe0a19b8d7f223f33,
                    0x00d2f5ff3cac6d58,
                    0x0164e8dcce0de4f4,
                ])),
                Felt::new(BigInteger384([
                    0x8dd051df2409410a,
                    0x1e82c324da65e24d,
                    0x160f6ad14ccc5ad6,
                    0x59846b74995c860b,
                    0xee1c0d7123bbf96b,
                    0x005682d008ff0395,
                ])),
                Felt::new(BigInteger384([
                    0xd7e428d802717f2d,
                    0xe72beb4a91a7ee27,
                    0x11b1ffde507883cb,
                    0x349bb13334c64e32,
                    0xce067b343b570511,
                    0x00e83146b4970cc0,
                ])),
                Felt::new(BigInteger384([
                    0xc84241844885d4f5,
                    0x3b86a6d267959796,
                    0x5efa569a85fdd7cf,
                    0xa7adf1cd2d1d7b66,
                    0x3bb6c8479a94df4d,
                    0x01aabec859bb5ff6,
                ])),
                Felt::new(BigInteger384([
                    0x3501da642955e433,
                    0x9f3f22d28cb97445,
                    0xef9069b028266ac4,
                    0xe5d6914b8b84f59f,
                    0x8e2db954877e0e95,
                    0x007f50a953024108,
                ])),
            ],
        ];

        for i in input.iter_mut() {
            apply_mds(i);
        }
        for i in input2.iter_mut() {
            apply_naive_mds(i);
        }

        for (index, (&i_1, i_2)) in input.iter().zip(input2).enumerate() {
            assert_eq!(output[index], i_1);
            assert_eq!(output[index], i_2);
        }
    }
}
